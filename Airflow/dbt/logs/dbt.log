[0m07:46:08.743873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c0872270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c0878170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00be057dd0>]}


============================== 07:46:08.754323 | 4d57272f-bd24-4850-9836-1da66861542c ==============================
[0m07:46:08.754323 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:46:08.755993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:46:08.768820 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_stock_project'
[0m07:46:08.771785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.13064376, "process_user_time": 1.923377, "process_kernel_time": 0.250875, "process_mem_max_rss": "169928", "process_in_blocks": "62736", "command_success": false, "process_out_blocks": "0"}
[0m07:46:08.772945 [debug] [MainThread]: Command `dbt run` failed at 07:46:08.772649 after 0.13 seconds
[0m07:46:08.773864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00be2deb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00be6de870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00be056570>]}
[0m07:46:08.774752 [debug] [MainThread]: Flushing usage events
[0m07:47:50.220307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03d656c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03d514e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03e240aa0>]}


============================== 07:47:50.234148 | d63cf237-fac1-4418-a23f-28a35f2c49af ==============================
[0m07:47:50.234148 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:47:50.235832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:47:50.248191 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_stock_project'
[0m07:47:50.251245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.11875757, "process_user_time": 1.967301, "process_kernel_time": 0.233236, "process_mem_max_rss": "169932", "process_in_blocks": "63624", "command_success": false, "process_out_blocks": "0"}
[0m07:47:50.253267 [debug] [MainThread]: Command `dbt run` failed at 07:47:50.252689 after 0.12 seconds
[0m07:47:50.254655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03d536c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03cac2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03d0c9b80>]}
[0m07:47:50.256083 [debug] [MainThread]: Flushing usage events
[0m15:19:45.924764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd305403650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3079db1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd304f94cb0>]}


============================== 15:19:45.934757 | 8efe9868-4186-4f1f-a014-c83ed4208f90 ==============================
[0m15:19:45.934757 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:19:45.935971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:19:47.609966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2db4468d0>]}
[0m15:19:47.661033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2db54c290>]}
[0m15:19:47.664017 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m15:19:47.770181 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:19:47.778511 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:19:47.779713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cf347da0>]}
[0m15:19:49.612454 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:19:49.613846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cefb2780>]}
[0m15:19:49.897801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ceffbdd0>]}
[0m15:19:50.095638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd306466fc0>]}
[0m15:19:50.096982 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 459 macros
[0m15:19:50.098079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ced79730>]}
[0m15:19:50.100914 [info ] [MainThread]: 
[0m15:19:50.102290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:50.108124 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m15:19:50.122925 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m15:19:50.124153 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m15:19:50.125438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:51.617015 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.492 seconds
[0m15:19:51.620214 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m15:19:51.762171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m15:19:51.772479 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m15:19:51.773702 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m15:19:51.774546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:52.395136 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.621 seconds
[0m15:19:52.397937 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m15:19:52.549187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3065c48c0>]}
[0m15:19:52.550439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:52.551198 [info ] [MainThread]: 
[0m15:19:52.563416 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m15:19:52.564687 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m15:19:52.565994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m15:19:52.566946 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m15:19:52.576793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m15:19:52.623110 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m15:19:52.656737 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m15:19:52.698096 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m15:19:52.699174 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (

with actual as (
  select
    symbol,
    date::date     as trade_date,
    actual::float  as actual_close
  from USER_DB_GATOR.raw.FINAL_DATA
  where actual is not null
),

forecast as (
  select
    symbol,
    date::date     as forecast_date,
    forecast::float    as predicted_close,
    lower_bound::float as lower_bound,
    upper_bound::float as upper_bound
  from USER_DB_GATOR.raw.FINAL_DATA
  where forecast is not null
)

select
  f.forecast_date,
  f.symbol,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close
from forecast f
left join actual a
  on f.symbol        = a.symbol
 and f.forecast_date = a.trade_date
        );
[0m15:19:52.700024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:54.805184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.105 seconds
[0m15:19:54.832273 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m15:19:55.002281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ccadac60>]}
[0m15:19:55.004056 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 2.43s]
[0m15:19:55.005804 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m15:19:55.006926 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m15:19:55.008056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m15:19:55.009141 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m15:19:55.012928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m15:19:55.049341 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m15:19:55.050404 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m15:19:55.051399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m15:19:55.052210 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m15:19:55.056511 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m15:19:55.077102 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m15:19:55.078210 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m15:19:55.079400 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_indicators ........................ [RUN]
[0m15:19:55.080536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m15:19:55.081737 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m15:19:55.086459 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m15:19:55.106354 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m15:19:55.111103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m15:19:55.130212 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m15:19:55.131709 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_GATOR.raw.STOCK
        );
[0m15:19:55.133079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:56.856569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.723 seconds
[0m15:19:56.859559 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m15:19:57.009391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cedc33b0>]}
[0m15:19:57.011766 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.93s]
[0m15:19:57.013578 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m15:19:57.014954 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m15:19:57.016313 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.volume_summary .......................... [RUN]
[0m15:19:57.017628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m15:19:57.018796 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m15:19:57.024495 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m15:19:57.047146 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m15:19:57.051559 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m15:19:57.077460 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m15:19:57.078516 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_GATOR.raw.STOCK
        );
[0m15:19:57.079419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:58.279224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.200 seconds
[0m15:19:58.282015 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m15:19:58.419693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8efe9868-4186-4f1f-a014-c83ed4208f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2cef6a6f0>]}
[0m15:19:58.421419 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.40s]
[0m15:19:58.423236 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m15:19:58.426550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:58.427856 [debug] [MainThread]: Connection 'model.dbt_stock_project.volume_summary' was properly closed.
[0m15:19:58.428944 [info ] [MainThread]: 
[0m15:19:58.430063 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m15:19:58.431722 [debug] [MainThread]: Command end result
[0m15:19:58.543700 [info ] [MainThread]: 
[0m15:19:58.544728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:58.545572 [info ] [MainThread]: 
[0m15:19:58.546278 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:19:58.548379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.782719, "process_user_time": 6.056938, "process_kernel_time": 2.447599, "process_mem_max_rss": "251968", "process_in_blocks": "136200", "process_out_blocks": "4872"}
[0m15:19:58.549447 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:58.549311 after 12.78 seconds
[0m15:19:58.550220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd305403650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ccbf19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd305903830>]}
[0m15:19:58.551017 [debug] [MainThread]: Flushing usage events
[0m15:20:03.197886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617702bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61754a8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6175abeff0>]}


============================== 15:20:03.206736 | 22a043a4-9cc3-4d51-a522-774be6cff65d ==============================
[0m15:20:03.206736 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:20:03.208565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:20:04.209221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a043a4-9cc3-4d51-a522-774be6cff65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6144344470>]}
[0m15:20:04.259768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a043a4-9cc3-4d51-a522-774be6cff65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f723920>]}
[0m15:20:04.261541 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m15:20:04.351103 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:20:04.801947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:04.803022 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:04.846324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22a043a4-9cc3-4d51-a522-774be6cff65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61443448c0>]}
[0m15:20:05.069354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22a043a4-9cc3-4d51-a522-774be6cff65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613eef9a00>]}
[0m15:20:05.070499 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 459 macros
[0m15:20:05.071946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a043a4-9cc3-4d51-a522-774be6cff65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f74f7d0>]}
[0m15:20:05.075745 [info ] [MainThread]: 
[0m15:20:05.077109 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:20:05.083145 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m15:20:05.109692 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m15:20:05.110701 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m15:20:05.111588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:05.741158 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.629 seconds
[0m15:20:05.744260 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m15:20:05.887925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a043a4-9cc3-4d51-a522-774be6cff65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f0d64e0>]}
[0m15:20:05.890242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:05.891754 [info ] [MainThread]: 
[0m15:20:05.901283 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m15:20:05.902635 [info ] [Thread-1 (]: 1 of 9 START test not_null_actual_vs_forecast_forecast_date .................... [RUN]
[0m15:20:05.904061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e)
[0m15:20:05.905401 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m15:20:05.921563 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"
[0m15:20:05.960490 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m15:20:05.980574 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"
[0m15:20:06.030277 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"
[0m15:20:06.031428 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select forecast_date
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where forecast_date is null



      
    ) dbt_internal_test
[0m15:20:06.032409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:07.001173 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.969 seconds
[0m15:20:07.016394 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e: Close
[0m15:20:07.169363 [info ] [Thread-1 (]: 1 of 9 PASS not_null_actual_vs_forecast_forecast_date .......................... [[32mPASS[0m in 1.26s]
[0m15:20:07.171167 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m15:20:07.172715 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m15:20:07.174675 [info ] [Thread-1 (]: 2 of 9 START test not_null_actual_vs_forecast_lower_bound ...................... [RUN]
[0m15:20:07.176858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e, now test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676)
[0m15:20:07.178370 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m15:20:07.183625 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"
[0m15:20:07.217799 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m15:20:07.222321 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"
[0m15:20:07.252852 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"
[0m15:20:07.253980 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_bound
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where lower_bound is null



      
    ) dbt_internal_test
[0m15:20:07.254979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:08.027177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m15:20:08.030499 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676: Close
[0m15:20:08.177701 [info ] [Thread-1 (]: 2 of 9 PASS not_null_actual_vs_forecast_lower_bound ............................ [[32mPASS[0m in 1.00s]
[0m15:20:08.179158 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m15:20:08.180235 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m15:20:08.181468 [info ] [Thread-1 (]: 3 of 9 START test not_null_actual_vs_forecast_predicted_close .................. [RUN]
[0m15:20:08.182704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676, now test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759)
[0m15:20:08.183712 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m15:20:08.190686 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"
[0m15:20:08.226337 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m15:20:08.230097 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"
[0m15:20:08.262524 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"
[0m15:20:08.263585 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select predicted_close
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where predicted_close is null



      
    ) dbt_internal_test
[0m15:20:08.264328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:09.009371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m15:20:09.012267 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759: Close
[0m15:20:09.158181 [info ] [Thread-1 (]: 3 of 9 PASS not_null_actual_vs_forecast_predicted_close ........................ [[32mPASS[0m in 0.97s]
[0m15:20:09.159860 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m15:20:09.160987 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m15:20:09.161998 [info ] [Thread-1 (]: 4 of 9 START test not_null_actual_vs_forecast_symbol ........................... [RUN]
[0m15:20:09.163067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759, now test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3)
[0m15:20:09.164071 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m15:20:09.169784 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"
[0m15:20:09.196297 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m15:20:09.200471 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"
[0m15:20:09.218510 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"
[0m15:20:09.219854 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where symbol is null



      
    ) dbt_internal_test
[0m15:20:09.221291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:09.896735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m15:20:09.901913 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3: Close
[0m15:20:10.027377 [info ] [Thread-1 (]: 4 of 9 PASS not_null_actual_vs_forecast_symbol ................................. [[32mPASS[0m in 0.86s]
[0m15:20:10.029075 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m15:20:10.030103 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m15:20:10.031237 [info ] [Thread-1 (]: 5 of 9 START test not_null_actual_vs_forecast_upper_bound ...................... [RUN]
[0m15:20:10.032512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3, now test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed)
[0m15:20:10.033627 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m15:20:10.041581 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"
[0m15:20:10.063357 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m15:20:10.067654 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"
[0m15:20:10.089493 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"
[0m15:20:10.090561 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_bound
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where upper_bound is null



      
    ) dbt_internal_test
[0m15:20:10.091410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:10.853593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m15:20:10.856732 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed: Close
[0m15:20:10.982011 [info ] [Thread-1 (]: 5 of 9 PASS not_null_actual_vs_forecast_upper_bound ............................ [[32mPASS[0m in 0.95s]
[0m15:20:10.983393 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m15:20:10.984419 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m15:20:10.985484 [info ] [Thread-1 (]: 6 of 9 START test not_null_stock_indicators_symbol ............................. [RUN]
[0m15:20:10.986811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m15:20:10.987800 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m15:20:10.993271 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m15:20:11.015725 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m15:20:11.019629 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m15:20:11.041452 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m15:20:11.042794 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m15:20:11.044255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:11.673528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m15:20:11.676525 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m15:20:11.792312 [info ] [Thread-1 (]: 6 of 9 PASS not_null_stock_indicators_symbol ................................... [[32mPASS[0m in 0.81s]
[0m15:20:11.793559 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m15:20:11.794507 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m15:20:11.795557 [info ] [Thread-1 (]: 7 of 9 START test not_null_stock_indicators_trade_date ......................... [RUN]
[0m15:20:11.796467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m15:20:11.797229 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m15:20:11.802632 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m15:20:11.828697 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m15:20:11.833636 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m15:20:11.856247 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m15:20:11.857271 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m15:20:11.858147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:12.247006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m15:20:12.249918 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m15:20:12.380761 [info ] [Thread-1 (]: 7 of 9 PASS not_null_stock_indicators_trade_date ............................... [[32mPASS[0m in 0.58s]
[0m15:20:12.382549 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m15:20:12.383824 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m15:20:12.385102 [info ] [Thread-1 (]: 8 of 9 START test not_null_volume_summary_symbol ............................... [RUN]
[0m15:20:12.386496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m15:20:12.387787 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m15:20:12.393862 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m15:20:12.418783 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m15:20:12.423758 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m15:20:12.444585 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m15:20:12.445695 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m15:20:12.446593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:12.864346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m15:20:12.867874 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m15:20:13.009111 [info ] [Thread-1 (]: 8 of 9 PASS not_null_volume_summary_symbol ..................................... [[32mPASS[0m in 0.62s]
[0m15:20:13.010752 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m15:20:13.011939 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m15:20:13.013135 [info ] [Thread-1 (]: 9 of 9 START test not_null_volume_summary_trade_date ........................... [RUN]
[0m15:20:13.014300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m15:20:13.015353 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m15:20:13.022809 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m15:20:13.042619 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m15:20:13.046860 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m15:20:13.066376 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m15:20:13.067612 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m15:20:13.068480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:13.610896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m15:20:13.613700 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m15:20:13.731560 [info ] [Thread-1 (]: 9 of 9 PASS not_null_volume_summary_trade_date ................................. [[32mPASS[0m in 0.72s]
[0m15:20:13.733567 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m15:20:13.738094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:13.739513 [debug] [MainThread]: Connection 'test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15' was properly closed.
[0m15:20:13.740745 [info ] [MainThread]: 
[0m15:20:13.742227 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 8.66 seconds (8.66s).
[0m15:20:13.745022 [debug] [MainThread]: Command end result
[0m15:20:13.850180 [info ] [MainThread]: 
[0m15:20:13.851335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:13.853040 [info ] [MainThread]: 
[0m15:20:13.855205 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:20:13.857253 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.762295, "process_user_time": 4.541059, "process_kernel_time": 1.920719, "process_mem_max_rss": "229412", "process_in_blocks": "1976", "process_out_blocks": "8"}
[0m15:20:13.858681 [debug] [MainThread]: Command `dbt test` succeeded at 15:20:13.858529 after 10.76 seconds
[0m15:20:13.860115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61754d5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f579ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f3f5550>]}
[0m15:20:13.861480 [debug] [MainThread]: Flushing usage events
[0m15:20:17.954632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c52182f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c7c56f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c51e2150>]}


============================== 15:20:17.962202 | 426ee59e-c174-492d-952f-b2f37b58c0a8 ==============================
[0m15:20:17.962202 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:20:17.963454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:18.944513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '426ee59e-c174-492d-952f-b2f37b58c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58fa97e90>]}
[0m15:20:19.004730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '426ee59e-c174-492d-952f-b2f37b58c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58f61d730>]}
[0m15:20:19.006478 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m15:20:19.100296 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:20:19.525254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:19.526376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:19.570584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '426ee59e-c174-492d-952f-b2f37b58c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58f3246b0>]}
[0m15:20:19.764315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '426ee59e-c174-492d-952f-b2f37b58c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58f0f0410>]}
[0m15:20:19.765902 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 459 macros
[0m15:20:19.767017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '426ee59e-c174-492d-952f-b2f37b58c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58f2e7800>]}
[0m15:20:19.769542 [info ] [MainThread]: 
[0m15:20:19.771349 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:20:19.774570 [debug] [MainThread]: Command end result
[0m15:20:19.885133 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.030196, "process_user_time": 3.483917, "process_kernel_time": 1.771992, "process_mem_max_rss": "222968", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m15:20:19.886417 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:20:19.886255 after 2.03 seconds
[0m15:20:19.887503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c7c56f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58f324920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c58d2ea0>]}
[0m15:20:19.889072 [debug] [MainThread]: Flushing usage events
[0m15:31:30.110818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49096abda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490816e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49093ee150>]}


============================== 15:31:30.119173 | d34a654b-06dc-4338-9e2f-1f7930abcf35 ==============================
[0m15:31:30.119173 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:31:30.120415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:31:32.086323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd34a654b-06dc-4338-9e2f-1f7930abcf35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4907504260>]}
[0m15:31:32.145156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd34a654b-06dc-4338-9e2f-1f7930abcf35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d1de77a0>]}
[0m15:31:32.147642 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m15:31:32.274948 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:31:32.886502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:31:32.888215 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/moving_averages.sql
[0m15:31:32.889490 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/rsi.sql
[0m15:31:33.174218 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_stock_project.moving_averages' (models/output/moving_averages.sql) depends on a node named 'stg_stock_prices' which was not found
[0m15:31:33.177614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1587763, "process_user_time": 4.064103, "process_kernel_time": 2.092409, "process_mem_max_rss": "238436", "process_in_blocks": "122920", "command_success": false, "process_out_blocks": "0"}
[0m15:31:33.179234 [debug] [MainThread]: Command `dbt run` failed at 15:31:33.178957 after 3.16 seconds
[0m15:31:33.180394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4907d45d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d180ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d18d9f70>]}
[0m15:31:33.181769 [debug] [MainThread]: Flushing usage events
[0m15:46:27.044038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6801d83170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6803fc7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6801d83cb0>]}


============================== 15:46:27.052877 | ac985577-fc06-4efc-a165-062c17c6db79 ==============================
[0m15:46:27.052877 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:46:27.054183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:28.899954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cbe27b60>]}
[0m15:46:28.949365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cb950cb0>]}
[0m15:46:28.952132 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m15:46:29.051342 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:46:29.568447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m15:46:29.569775 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/rsi.sql
[0m15:46:29.570778 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/moving_averages.sql
[0m15:46:29.572300 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/input/sources.yml
[0m15:46:29.803493 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:46:29.804869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cb61b5c0>]}
[0m15:46:30.139169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c9350f50>]}
[0m15:46:30.412135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cb65a930>]}
[0m15:46:30.413505 [info ] [MainThread]: Found 7 models, 9 data tests, 3 sources, 459 macros
[0m15:46:30.414665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c93120f0>]}
[0m15:46:30.418888 [info ] [MainThread]: 
[0m15:46:30.420514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:46:30.429102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m15:46:30.448631 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m15:46:30.449707 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m15:46:30.450729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:31.098062 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.647 seconds
[0m15:46:31.100417 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m15:46:31.238407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m15:46:31.250133 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m15:46:31.251385 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m15:46:31.252570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:31.685178 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.432 seconds
[0m15:46:31.690207 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m15:46:31.835572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6802b8b890>]}
[0m15:46:31.837235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:31.838389 [info ] [MainThread]: 
[0m15:46:31.850992 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m15:46:31.852299 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m15:46:31.853328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m15:46:31.854214 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m15:46:31.863534 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m15:46:31.901532 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m15:46:31.932277 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m15:46:31.964881 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m15:46:31.966078 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (

with actual as (
  select
    symbol,
    date::date     as trade_date,
    actual::float  as actual_close
  from USER_DB_BLUEJAY.raw.FINAL_DATA
  where actual is not null
),

forecast as (
  select
    symbol,
    date::date     as forecast_date,
    forecast::float    as predicted_close,
    lower_bound::float as lower_bound,
    upper_bound::float as upper_bound
  from USER_DB_BLUEJAY.raw.FINAL_DATA
  where forecast is not null
)

select
  f.forecast_date,
  f.symbol,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close
from forecast f
left join actual a
  on f.symbol        = a.symbol
 and f.forecast_date = a.trade_date
        );
[0m15:46:31.967255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:33.998911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.032 seconds
[0m15:46:34.027344 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m15:46:34.166912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cb9122a0>]}
[0m15:46:34.168366 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 2.31s]
[0m15:46:34.169524 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m15:46:34.170491 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m15:46:34.171516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m15:46:34.172391 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m15:46:34.178152 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m15:46:34.205229 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m15:46:34.206408 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m15:46:34.207535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m15:46:34.208475 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m15:46:34.212162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m15:46:34.237110 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m15:46:34.238137 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m15:46:34.239315 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m15:46:34.240959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m15:46:34.242270 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m15:46:34.246108 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m15:46:34.274285 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m15:46:34.278485 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m15:46:34.308949 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m15:46:34.310072 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m15:46:34.310999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:35.679237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.368 seconds
[0m15:46:35.685102 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m15:46:35.808074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c86f8890>]}
[0m15:46:35.810155 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.57s]
[0m15:46:35.812131 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m15:46:35.813962 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m15:46:35.815269 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m15:46:35.816736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m15:46:35.818045 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m15:46:35.823364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m15:46:35.848747 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m15:46:35.853869 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m15:46:35.880808 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m15:46:35.882204 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m15:46:35.883327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:37.196472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m15:46:37.200362 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m15:46:37.327947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c8717530>]}
[0m15:46:37.329381 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.51s]
[0m15:46:37.330585 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m15:46:37.331569 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m15:46:37.332703 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m15:46:37.334012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m15:46:37.335036 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m15:46:37.348555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m15:46:37.370353 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m15:46:37.375562 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m15:46:37.399523 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m15:46:37.400735 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close_price,

    -- 7-day moving average
    ROUND(
      AVG(close_price) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close_price) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close_price) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m15:46:37.401755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:37.846149 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbdcb2-0305-0be2-0004-59ff00284506
[0m15:46:37.847280 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 23 at position 4
invalid identifier 'CLOSE_PRICE'
[0m15:46:37.848289 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m15:46:38.007394 [debug] [Thread-1 (]: Database Error in model moving_averages (models/output/moving_averages.sql)
  000904 (42000): SQL compilation error: error line 23 at position 4
  invalid identifier 'CLOSE_PRICE'
  compiled code at target/run/dbt_stock_project/models/output/moving_averages.sql
[0m15:46:38.008821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c8750350>]}
[0m15:46:38.010258 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.moving_averages ................ [[31mERROR[0m in 0.68s]
[0m15:46:38.011796 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m15:46:38.012911 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m15:46:38.014286 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m15:46:38.015507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m15:46:38.016534 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m15:46:38.034302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m15:46:38.058834 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m15:46:38.064496 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m15:46:38.091703 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m15:46:38.092951 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/marts/rsi_prices.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close_price,
    LAG(close_price) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close_price,
    prev_close,
    CASE 
      WHEN close_price - prev_close > 0 THEN close_price - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close_price - prev_close < 0 THEN ABS(close_price - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close_price,
    
    -- 14-day average gain and loss
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,

    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close_price,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d,0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m15:46:38.093974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:38.632205 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbdcb2-0305-0bb8-0004-59ff0028248e
[0m15:46:38.633453 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 4
invalid identifier 'CLOSE_PRICE'
[0m15:46:38.634639 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m15:46:38.786704 [debug] [Thread-1 (]: Database Error in model rsi (models/output/rsi.sql)
  000904 (42000): SQL compilation error: error line 21 at position 4
  invalid identifier 'CLOSE_PRICE'
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m15:46:38.788478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac985577-fc06-4efc-a165-062c17c6db79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d2ef7ef0>]}
[0m15:46:38.790105 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model analytics.rsi ............................ [[31mERROR[0m in 0.77s]
[0m15:46:38.791957 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m15:46:38.794906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:38.795836 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m15:46:38.796724 [info ] [MainThread]: 
[0m15:46:38.797834 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m15:46:38.799426 [debug] [MainThread]: Command end result
[0m15:46:38.894694 [info ] [MainThread]: 
[0m15:46:38.895813 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:46:38.896690 [info ] [MainThread]: 
[0m15:46:38.897607 [error] [MainThread]:   Database Error in model moving_averages (models/output/moving_averages.sql)
  000904 (42000): SQL compilation error: error line 23 at position 4
  invalid identifier 'CLOSE_PRICE'
  compiled code at target/run/dbt_stock_project/models/output/moving_averages.sql
[0m15:46:38.898495 [info ] [MainThread]: 
[0m15:46:38.899344 [error] [MainThread]:   Database Error in model rsi (models/output/rsi.sql)
  000904 (42000): SQL compilation error: error line 21 at position 4
  invalid identifier 'CLOSE_PRICE'
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m15:46:38.899882 [info ] [MainThread]: 
[0m15:46:38.900538 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m15:46:38.902268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.94805, "process_user_time": 4.838195, "process_kernel_time": 2.28696, "process_mem_max_rss": "242904", "process_in_blocks": "129400", "process_out_blocks": "8", "command_success": false}
[0m15:46:38.903511 [debug] [MainThread]: Command `dbt run` failed at 15:46:38.903328 after 11.95 seconds
[0m15:46:38.904857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cb44c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68017e6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68017e60c0>]}
[0m15:46:38.906358 [debug] [MainThread]: Flushing usage events
[0m15:53:29.154863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b51e7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b26788f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2678200>]}


============================== 15:53:29.162438 | eaa5722a-845e-45d9-be2f-33fc230da50c ==============================
[0m15:53:29.162438 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:53:29.163602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m15:53:30.115073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7580cbe210>]}
[0m15:53:30.174966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7580e790a0>]}
[0m15:53:30.176676 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m15:53:30.282088 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:53:30.759071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:53:30.760668 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m15:53:30.761886 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m15:53:31.009229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7580862630>]}
[0m15:53:31.213242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7572937c20>]}
[0m15:53:31.215356 [info ] [MainThread]: Found 7 models, 9 data tests, 3 sources, 459 macros
[0m15:53:31.217800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75808a7d10>]}
[0m15:53:31.221258 [info ] [MainThread]: 
[0m15:53:31.223011 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:53:31.228493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m15:53:31.244865 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m15:53:31.246335 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m15:53:31.247668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:31.923505 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.676 seconds
[0m15:53:31.925968 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m15:53:32.075442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m15:53:32.086021 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m15:53:32.086969 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m15:53:32.087762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:32.510068 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.422 seconds
[0m15:53:32.514663 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m15:53:32.657373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7580e7a930>]}
[0m15:53:32.658774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:53:32.659768 [info ] [MainThread]: 
[0m15:53:32.669251 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m15:53:32.670588 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m15:53:32.671680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m15:53:32.672636 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m15:53:32.681487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m15:53:32.707787 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m15:53:32.737852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m15:53:32.772509 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m15:53:32.773505 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (

with actual as (
  select
    symbol,
    date::date     as trade_date,
    actual::float  as actual_close
  from USER_DB_BLUEJAY.raw.FINAL_DATA
  where actual is not null
),

forecast as (
  select
    symbol,
    date::date     as forecast_date,
    forecast::float    as predicted_close,
    lower_bound::float as lower_bound,
    upper_bound::float as upper_bound
  from USER_DB_BLUEJAY.raw.FINAL_DATA
  where forecast is not null
)

select
  f.forecast_date,
  f.symbol,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close
from forecast f
left join actual a
  on f.symbol        = a.symbol
 and f.forecast_date = a.trade_date
        );
[0m15:53:32.774334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:34.635804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.861 seconds
[0m15:53:34.666714 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m15:53:34.803522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7580e3a570>]}
[0m15:53:34.804983 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 2.13s]
[0m15:53:34.806090 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m15:53:34.807029 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m15:53:34.808041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m15:53:34.809220 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m15:53:34.813034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m15:53:34.838490 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m15:53:34.839675 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m15:53:34.840713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m15:53:34.841680 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m15:53:34.845657 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m15:53:34.870570 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m15:53:34.871770 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m15:53:34.872897 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m15:53:34.873992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m15:53:34.874934 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m15:53:34.878900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m15:53:34.906904 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m15:53:34.911024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m15:53:34.934804 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m15:53:34.935818 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m15:53:34.936653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:36.304753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.368 seconds
[0m15:53:36.309119 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m15:53:36.470089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7571fa6a50>]}
[0m15:53:36.471578 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.60s]
[0m15:53:36.472949 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m15:53:36.474323 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m15:53:36.475829 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m15:53:36.477196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m15:53:36.478323 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m15:53:36.482496 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m15:53:36.518775 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m15:53:36.522813 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m15:53:36.556206 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m15:53:36.557521 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m15:53:36.558474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:38.047939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.489 seconds
[0m15:53:38.051801 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m15:53:38.187549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7571e6aae0>]}
[0m15:53:38.189229 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.71s]
[0m15:53:38.190564 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m15:53:38.191634 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m15:53:38.192904 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m15:53:38.194249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m15:53:38.195200 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m15:53:38.207593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m15:53:38.236319 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m15:53:38.241004 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m15:53:38.267238 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m15:53:38.268654 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m15:53:38.269681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:39.641740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.375 seconds
[0m15:53:39.644514 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m15:53:39.772213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b3f3f890>]}
[0m15:53:39.774189 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.58s]
[0m15:53:39.775903 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m15:53:39.776898 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m15:53:39.778062 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m15:53:39.779016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m15:53:39.780025 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m15:53:39.797357 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m15:53:39.839099 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m15:53:39.842989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m15:53:39.870481 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m15:53:39.871875 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/marts/rsi_prices.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,

    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d,0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m15:53:39.873127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:40.908765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.036 seconds
[0m15:53:40.911785 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m15:53:41.039040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa5722a-845e-45d9-be2f-33fc230da50c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7571e8b380>]}
[0m15:53:41.040453 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.26s]
[0m15:53:41.041668 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m15:53:41.044843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:41.046033 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m15:53:41.047402 [info ] [MainThread]: 
[0m15:53:41.049187 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.82 seconds (9.82s).
[0m15:53:41.051145 [debug] [MainThread]: Command end result
[0m15:53:41.167797 [info ] [MainThread]: 
[0m15:53:41.169300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:41.170268 [info ] [MainThread]: 
[0m15:53:41.171339 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:53:41.173123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.115107, "process_user_time": 4.121653, "process_kernel_time": 1.8762, "process_mem_max_rss": "237472", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m15:53:41.174340 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:41.174088 after 12.12 seconds
[0m15:53:41.175267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2d84710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75b2cd6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f757293f8f0>]}
[0m15:53:41.176299 [debug] [MainThread]: Flushing usage events
[0m15:53:45.281183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8439340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ba7c1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b7ea68d0>]}


============================== 15:53:45.289114 | 1bd36509-bb08-460c-9912-d36be17cf86c ==============================
[0m15:53:45.289114 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:53:45.290297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:53:46.289159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bd36509-bb08-460c-9912-d36be17cf86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b91ba8a0>]}
[0m15:53:46.339994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bd36509-bb08-460c-9912-d36be17cf86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8a57830>]}
[0m15:53:46.342063 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m15:53:46.428231 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:53:47.016067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:47.017435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:47.056815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bd36509-bb08-460c-9912-d36be17cf86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe183498ad0>]}
[0m15:53:47.268800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bd36509-bb08-460c-9912-d36be17cf86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1825128d0>]}
[0m15:53:47.270146 [info ] [MainThread]: Found 7 models, 9 data tests, 3 sources, 459 macros
[0m15:53:47.271208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd36509-bb08-460c-9912-d36be17cf86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b908a420>]}
[0m15:53:47.273815 [info ] [MainThread]: 
[0m15:53:47.275276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:53:47.281028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m15:53:47.304629 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m15:53:47.305763 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m15:53:47.307179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:47.890216 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.583 seconds
[0m15:53:47.893206 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m15:53:48.018747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bd36509-bb08-460c-9912-d36be17cf86c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b971c1a0>]}
[0m15:53:48.019869 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:53:48.020885 [info ] [MainThread]: 
[0m15:53:48.032787 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m15:53:48.034013 [info ] [Thread-1 (]: 1 of 9 START test not_null_actual_vs_forecast_forecast_date .................... [RUN]
[0m15:53:48.035136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e)
[0m15:53:48.035951 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m15:53:48.054764 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"
[0m15:53:48.086563 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m15:53:48.109733 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"
[0m15:53:48.135198 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"
[0m15:53:48.136183 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select forecast_date
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where forecast_date is null



      
    ) dbt_internal_test
[0m15:53:48.137084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:48.826986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m15:53:48.839736 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e: Close
[0m15:53:48.982379 [info ] [Thread-1 (]: 1 of 9 PASS not_null_actual_vs_forecast_forecast_date .......................... [[32mPASS[0m in 0.95s]
[0m15:53:48.984263 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m15:53:48.985413 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m15:53:48.986309 [info ] [Thread-1 (]: 2 of 9 START test not_null_actual_vs_forecast_lower_bound ...................... [RUN]
[0m15:53:48.987251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e, now test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676)
[0m15:53:48.988081 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m15:53:48.993135 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"
[0m15:53:49.023445 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m15:53:49.027201 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"
[0m15:53:49.057802 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"
[0m15:53:49.058812 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_bound
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where lower_bound is null



      
    ) dbt_internal_test
[0m15:53:49.059592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:49.699825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.640 seconds
[0m15:53:49.705073 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676: Close
[0m15:53:49.825487 [info ] [Thread-1 (]: 2 of 9 PASS not_null_actual_vs_forecast_lower_bound ............................ [[32mPASS[0m in 0.84s]
[0m15:53:49.827307 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m15:53:49.828805 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m15:53:49.829899 [info ] [Thread-1 (]: 3 of 9 START test not_null_actual_vs_forecast_predicted_close .................. [RUN]
[0m15:53:49.831032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676, now test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759)
[0m15:53:49.832487 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m15:53:49.837402 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"
[0m15:53:49.884686 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m15:53:49.889938 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"
[0m15:53:49.931266 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"
[0m15:53:49.932907 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select predicted_close
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where predicted_close is null



      
    ) dbt_internal_test
[0m15:53:49.934476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:50.291455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m15:53:50.294446 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759: Close
[0m15:53:50.427605 [info ] [Thread-1 (]: 3 of 9 PASS not_null_actual_vs_forecast_predicted_close ........................ [[32mPASS[0m in 0.60s]
[0m15:53:50.429019 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m15:53:50.430574 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m15:53:50.432183 [info ] [Thread-1 (]: 4 of 9 START test not_null_actual_vs_forecast_symbol ........................... [RUN]
[0m15:53:50.434046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759, now test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3)
[0m15:53:50.435460 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m15:53:50.442645 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"
[0m15:53:50.472498 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m15:53:50.476818 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"
[0m15:53:50.502266 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"
[0m15:53:50.503485 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where symbol is null



      
    ) dbt_internal_test
[0m15:53:50.504616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:51.121490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m15:53:51.125967 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3: Close
[0m15:53:51.246212 [info ] [Thread-1 (]: 4 of 9 PASS not_null_actual_vs_forecast_symbol ................................. [[32mPASS[0m in 0.81s]
[0m15:53:51.248452 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m15:53:51.250076 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m15:53:51.251251 [info ] [Thread-1 (]: 5 of 9 START test not_null_actual_vs_forecast_upper_bound ...................... [RUN]
[0m15:53:51.252401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3, now test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed)
[0m15:53:51.253530 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m15:53:51.258956 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"
[0m15:53:51.287863 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m15:53:51.292215 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"
[0m15:53:51.319555 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"
[0m15:53:51.320667 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_bound
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where upper_bound is null



      
    ) dbt_internal_test
[0m15:53:51.321747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:51.690322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m15:53:51.693976 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed: Close
[0m15:53:51.808440 [info ] [Thread-1 (]: 5 of 9 PASS not_null_actual_vs_forecast_upper_bound ............................ [[32mPASS[0m in 0.56s]
[0m15:53:51.810102 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m15:53:51.811220 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m15:53:51.812230 [info ] [Thread-1 (]: 6 of 9 START test not_null_stock_indicators_symbol ............................. [RUN]
[0m15:53:51.813318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m15:53:51.814491 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m15:53:51.822814 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m15:53:51.850558 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m15:53:51.854267 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m15:53:51.877640 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m15:53:51.878755 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m15:53:51.879612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:52.433066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m15:53:52.436214 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m15:53:52.569455 [info ] [Thread-1 (]: 6 of 9 PASS not_null_stock_indicators_symbol ................................... [[32mPASS[0m in 0.76s]
[0m15:53:52.571321 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m15:53:52.572687 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m15:53:52.574050 [info ] [Thread-1 (]: 7 of 9 START test not_null_stock_indicators_trade_date ......................... [RUN]
[0m15:53:52.575304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m15:53:52.576469 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m15:53:52.582859 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m15:53:52.625066 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m15:53:52.629021 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m15:53:52.658962 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m15:53:52.660056 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m15:53:52.661010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:53.379026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m15:53:53.382136 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m15:53:53.512852 [info ] [Thread-1 (]: 7 of 9 PASS not_null_stock_indicators_trade_date ............................... [[32mPASS[0m in 0.94s]
[0m15:53:53.514487 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m15:53:53.515802 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m15:53:53.516993 [info ] [Thread-1 (]: 8 of 9 START test not_null_volume_summary_symbol ............................... [RUN]
[0m15:53:53.518177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m15:53:53.519134 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m15:53:53.524101 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m15:53:53.570865 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m15:53:53.575392 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m15:53:53.621379 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m15:53:53.623075 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m15:53:53.624718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:54.081339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m15:53:54.084566 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m15:53:54.202608 [info ] [Thread-1 (]: 8 of 9 PASS not_null_volume_summary_symbol ..................................... [[32mPASS[0m in 0.68s]
[0m15:53:54.204042 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m15:53:54.205064 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m15:53:54.206348 [info ] [Thread-1 (]: 9 of 9 START test not_null_volume_summary_trade_date ........................... [RUN]
[0m15:53:54.207667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m15:53:54.208677 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m15:53:54.215649 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m15:53:54.244334 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m15:53:54.249534 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m15:53:54.275715 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m15:53:54.277013 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m15:53:54.278301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:54.716871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m15:53:54.719827 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m15:53:54.844716 [info ] [Thread-1 (]: 9 of 9 PASS not_null_volume_summary_trade_date ................................. [[32mPASS[0m in 0.64s]
[0m15:53:54.846524 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m15:53:54.849071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:54.850114 [debug] [MainThread]: Connection 'test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15' was properly closed.
[0m15:53:54.851047 [info ] [MainThread]: 
[0m15:53:54.851890 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m15:53:54.853659 [debug] [MainThread]: Command end result
[0m15:53:54.958965 [info ] [MainThread]: 
[0m15:53:54.960129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:54.961284 [info ] [MainThread]: 
[0m15:53:54.962438 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:53:54.964305 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.78456, "process_user_time": 4.155129, "process_kernel_time": 1.948953, "process_mem_max_rss": "244036", "process_in_blocks": "1976", "process_out_blocks": "8"}
[0m15:53:54.966424 [debug] [MainThread]: Command `dbt test` succeeded at 15:53:54.966100 after 9.79 seconds
[0m15:53:54.968092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8271340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b89467e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8a57a70>]}
[0m15:53:54.969964 [debug] [MainThread]: Flushing usage events
[0m15:53:59.221227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2842080f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2843674aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28422d0b60>]}


============================== 15:53:59.228675 | fef8d6f4-4510-4ab0-ab8d-d0664e3fca74 ==============================
[0m15:53:59.228675 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:53:59.229799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:54:00.168860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fef8d6f4-4510-4ab0-ab8d-d0664e3fca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2842f4e7b0>]}
[0m15:54:00.233477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fef8d6f4-4510-4ab0-ab8d-d0664e3fca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f281024a030>]}
[0m15:54:00.235534 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m15:54:00.348320 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:54:00.844406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:54:00.845764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:54:00.890892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fef8d6f4-4510-4ab0-ab8d-d0664e3fca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f281014b9e0>]}
[0m15:54:01.113686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fef8d6f4-4510-4ab0-ab8d-d0664e3fca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f280be2ec30>]}
[0m15:54:01.114808 [info ] [MainThread]: Found 7 models, 9 data tests, 3 sources, 459 macros
[0m15:54:01.116261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fef8d6f4-4510-4ab0-ab8d-d0664e3fca74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2810554530>]}
[0m15:54:01.118860 [info ] [MainThread]: 
[0m15:54:01.120331 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:54:01.122862 [debug] [MainThread]: Command end result
[0m15:54:01.223438 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.1013339, "process_user_time": 3.421142, "process_kernel_time": 1.856044, "process_mem_max_rss": "227740", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m15:54:01.224400 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:54:01.224264 after 2.10 seconds
[0m15:54:01.225380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2842279d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2810432ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28422d20c0>]}
[0m15:54:01.226255 [debug] [MainThread]: Flushing usage events
[0m23:22:11.085133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d21a5ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d22345d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d21a5ede0>]}


============================== 23:22:11.093690 | 9eaa6e3c-3abb-4f06-aec1-d3f211faedbf ==============================
[0m23:22:11.093690 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:22:11.095311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:22:12.232786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eaa6e3c-3abb-4f06-aec1-d3f211faedbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2296b680>]}
[0m23:22:12.286427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eaa6e3c-3abb-4f06-aec1-d3f211faedbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d223260c0>]}
[0m23:22:12.289740 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:22:12.389272 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:22:12.867982 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_stock_project: output/schema.yml - Runtime Error
    Syntax error near line 39
    ------------------------------
    36 |           - not_null
    37 |           -positive_values    
    38 |   
    39 |   - name: rsi
    40 |     description: "Relative Strength Index (RSI) calculated from stock prices"
    41 |     columns:
    42 |       - name: trade_date
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 37, column 11
    could not find expected ':'
      in "<unicode string>", line 39, column 3
[0m23:22:12.871811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9499744, "process_user_time": 3.310036, "process_kernel_time": 2.134875, "process_mem_max_rss": "224804", "process_in_blocks": "92384", "process_out_blocks": "2192", "command_success": false}
[0m23:22:12.873065 [debug] [MainThread]: Command `dbt run` failed at 23:22:12.872856 after 1.95 seconds
[0m23:22:12.874262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d225b6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cebda88f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ceb914110>]}
[0m23:22:12.875495 [debug] [MainThread]: Flushing usage events
[0m23:26:23.509462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04adaaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04a1c7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04a3d3860>]}


============================== 23:26:23.515075 | b4f04826-e56f-453f-87b4-94f6dc1b47e8 ==============================
[0m23:26:23.515075 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:26:23.516369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:26:24.402953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f04826-e56f-453f-87b4-94f6dc1b47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd013bd75f0>]}
[0m23:26:24.448736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f04826-e56f-453f-87b4-94f6dc1b47e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd013859010>]}
[0m23:26:24.450136 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:26:24.532788 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:26:24.779785 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_stock_project: output/schema.yml - Runtime Error
    Syntax error near line 39
    ------------------------------
    36 |           - not_null
    37 |           -positive_values    
    38 |   
    39 |   - name: rsi
    40 |     description: "Relative Strength Index (RSI) calculated from stock prices"
    41 |     columns:
    42 |       - name: trade_date
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 37, column 11
    could not find expected ':'
      in "<unicode string>", line 39, column 3
[0m23:26:24.781122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3681767, "process_user_time": 2.975588, "process_kernel_time": 1.817306, "process_mem_max_rss": "222284", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:26:24.781864 [debug] [MainThread]: Command `dbt run` failed at 23:26:24.781758 after 1.37 seconds
[0m23:26:24.782424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd04adaaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01f929a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd049297cb0>]}
[0m23:26:24.783117 [debug] [MainThread]: Flushing usage events
[0m23:27:56.572510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90ca9c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90c899c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90e278170>]}


============================== 23:27:56.580485 | 694b6656-75b9-4f63-b985-152dd24682b1 ==============================
[0m23:27:56.580485 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:27:56.581682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:27:57.445063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90dbf64e0>]}
[0m23:27:57.508522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8dc7ff350>]}
[0m23:27:57.510357 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:27:57.613604 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:27:58.194895 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m23:27:58.196576 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m23:27:58.197492 [debug] [MainThread]: Partial parsing: deleted file: dbt_stock_project://models/output/actual_vs_forecast.sql
[0m23:27:58.403514 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:27:58.405066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8dcfe7800>]}
[0m23:27:58.641733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d43928a0>]}
[0m23:27:58.875138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d42f4170>]}
[0m23:27:58.876912 [info ] [MainThread]: Found 6 models, 27 data tests, 3 sources, 459 macros
[0m23:27:58.878402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d428d670>]}
[0m23:27:58.882227 [info ] [MainThread]: 
[0m23:27:58.883773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:27:58.890066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m23:27:58.902410 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m23:27:58.903664 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m23:27:58.904982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:59.498070 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.593 seconds
[0m23:27:59.500873 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m23:27:59.606727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m23:27:59.617096 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m23:27:59.618174 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m23:27:59.618894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:59.979662 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.361 seconds
[0m23:27:59.982966 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m23:28:00.084712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d6767e30>]}
[0m23:28:00.086413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:28:00.088002 [info ] [MainThread]: 
[0m23:28:00.103255 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m23:28:00.105167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m23:28:00.106319 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m23:28:00.116429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m23:28:00.138704 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m23:28:00.140138 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m23:28:00.143054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m23:28:00.144195 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m23:28:00.148216 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m23:28:00.169136 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m23:28:00.170756 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m23:28:00.172317 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m23:28:00.173928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m23:28:00.175462 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m23:28:00.180491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m23:28:00.198438 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m23:28:00.233287 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m23:28:00.250765 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m23:28:00.251600 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m23:28:00.252248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:01.772056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.520 seconds
[0m23:28:01.796837 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m23:28:01.903870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d6a4e8d0>]}
[0m23:28:01.905494 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.73s]
[0m23:28:01.906636 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m23:28:01.907609 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m23:28:01.908555 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m23:28:01.909581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m23:28:01.910470 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m23:28:01.914052 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m23:28:01.939405 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m23:28:01.943086 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m23:28:01.959145 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m23:28:01.960304 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m23:28:01.961080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:03.116214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.155 seconds
[0m23:28:03.121491 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m23:28:03.219201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d4123680>]}
[0m23:28:03.220810 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.31s]
[0m23:28:03.222055 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m23:28:03.223011 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m23:28:03.224190 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m23:28:03.225266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m23:28:03.226096 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m23:28:03.237237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m23:28:03.274167 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m23:28:03.278360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m23:28:03.312293 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m23:28:03.313689 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m23:28:03.315594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:04.731469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.416 seconds
[0m23:28:04.734024 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m23:28:04.867319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90db5baa0>]}
[0m23:28:04.869958 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.64s]
[0m23:28:04.872218 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m23:28:04.873800 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m23:28:04.875264 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m23:28:04.876795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m23:28:04.878255 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m23:28:04.968298 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m23:28:04.998938 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m23:28:05.002594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m23:28:05.029516 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m23:28:05.030520 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/marts/rsi_prices.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,

    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d,0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m23:28:05.031331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:05.982199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.951 seconds
[0m23:28:05.984907 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m23:28:06.090290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '694b6656-75b9-4f63-b985-152dd24682b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8dcf999d0>]}
[0m23:28:06.092779 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.21s]
[0m23:28:06.094575 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m23:28:06.097680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:06.098750 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m23:28:06.099876 [info ] [MainThread]: 
[0m23:28:06.101086 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.22 seconds (7.22s).
[0m23:28:06.103548 [debug] [MainThread]: Command end result
[0m23:28:06.236849 [info ] [MainThread]: 
[0m23:28:06.239034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:28:06.240039 [info ] [MainThread]: 
[0m23:28:06.241482 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:28:06.243533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.770081, "process_user_time": 3.983053, "process_kernel_time": 1.976401, "process_mem_max_rss": "240832", "process_in_blocks": "2896", "process_out_blocks": "8"}
[0m23:28:06.245051 [debug] [MainThread]: Command `dbt run` succeeded at 23:28:06.244892 after 9.77 seconds
[0m23:28:06.246381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90d363740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe90f3ce990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d435c230>]}
[0m23:28:06.247798 [debug] [MainThread]: Flushing usage events
[0m23:28:09.760388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fafc2d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faf6f8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb0328470>]}


============================== 23:28:09.769214 | 51c73160-7ae4-4249-9eab-5cc56d39903c ==============================
[0m23:28:09.769214 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:28:09.770538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:28:10.718740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51c73160-7ae4-4249-9eab-5cc56d39903c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7ed6c0b0>]}
[0m23:28:10.781485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51c73160-7ae4-4249-9eab-5cc56d39903c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7f5f9a90>]}
[0m23:28:10.782811 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:28:10.861790 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:28:11.413250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:28:11.414462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:28:11.456647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c73160-7ae4-4249-9eab-5cc56d39903c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7de90920>]}
[0m23:28:11.679867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51c73160-7ae4-4249-9eab-5cc56d39903c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7d07dd60>]}
[0m23:28:11.681234 [info ] [MainThread]: Found 6 models, 27 data tests, 3 sources, 459 macros
[0m23:28:11.682494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c73160-7ae4-4249-9eab-5cc56d39903c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7ec9b170>]}
[0m23:28:11.687252 [info ] [MainThread]: 
[0m23:28:11.688823 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:28:11.693617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m23:28:11.709094 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m23:28:11.710548 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m23:28:11.711682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:12.241612 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.530 seconds
[0m23:28:12.244812 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m23:28:12.377341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c73160-7ae4-4249-9eab-5cc56d39903c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7d2d67b0>]}
[0m23:28:12.379271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:28:12.380399 [info ] [MainThread]: 
[0m23:28:12.390362 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:28:12.391822 [info ] [Thread-1 (]: 1 of 27 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m23:28:12.393077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m23:28:12.394423 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:28:12.409993 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m23:28:12.449837 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:28:12.469426 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m23:28:12.513113 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m23:28:12.515085 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m23:28:12.516704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:13.275536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m23:28:13.292068 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m23:28:13.396251 [info ] [Thread-1 (]: 1 of 27 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 1.00s]
[0m23:28:13.397591 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:28:13.398642 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:28:13.399489 [info ] [Thread-1 (]: 2 of 27 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m23:28:13.400482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m23:28:13.401454 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:28:13.407151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m23:28:13.428168 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:28:13.432240 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m23:28:13.453311 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m23:28:13.454535 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m23:28:13.456393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:13.816898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.360 seconds
[0m23:28:13.820120 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m23:28:13.960485 [info ] [Thread-1 (]: 2 of 27 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.56s]
[0m23:28:13.962727 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:28:13.964381 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:28:13.965818 [info ] [Thread-1 (]: 3 of 27 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m23:28:13.967338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m23:28:13.968404 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:28:13.973830 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m23:28:14.002970 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:28:14.008140 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m23:28:14.042582 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m23:28:14.043971 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m23:28:14.045274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:14.341728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m23:28:14.345425 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m23:28:14.445909 [info ] [Thread-1 (]: 3 of 27 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.48s]
[0m23:28:14.447466 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:28:14.448713 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:28:14.449705 [info ] [Thread-1 (]: 4 of 27 START test not_null_moving_averages_symbol ............................. [RUN]
[0m23:28:14.450669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m23:28:14.451378 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:28:14.458139 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m23:28:14.478748 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:28:14.482577 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m23:28:14.502834 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m23:28:14.503865 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m23:28:14.505254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:15.060263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m23:28:15.065436 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m23:28:15.179887 [info ] [Thread-1 (]: 4 of 27 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.73s]
[0m23:28:15.181758 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:28:15.183099 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:28:15.184188 [info ] [Thread-1 (]: 5 of 27 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m23:28:15.185284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m23:28:15.186313 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:28:15.192452 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m23:28:15.224948 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:28:15.228820 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m23:28:15.257963 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m23:28:15.259645 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m23:28:15.261121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:15.639471 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m23:28:15.644725 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m23:28:15.777456 [info ] [Thread-1 (]: 5 of 27 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.59s]
[0m23:28:15.779774 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:28:15.781288 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:28:15.782778 [info ] [Thread-1 (]: 6 of 27 START test not_null_rsi_rsi_14d ........................................ [RUN]
[0m23:28:15.784505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m23:28:15.786088 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:28:15.793125 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m23:28:15.833886 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:28:15.838703 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m23:28:15.866696 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m23:28:15.867791 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m23:28:15.868669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:16.208997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m23:28:16.214054 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m23:28:16.324742 [info ] [Thread-1 (]: 6 of 27 PASS not_null_rsi_rsi_14d .............................................. [[32mPASS[0m in 0.54s]
[0m23:28:16.326124 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:28:16.327293 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:28:16.328548 [info ] [Thread-1 (]: 7 of 27 START test not_null_rsi_symbol ......................................... [RUN]
[0m23:28:16.329588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m23:28:16.330477 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:28:16.337283 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m23:28:16.359626 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:28:16.363416 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m23:28:16.384621 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m23:28:16.386083 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m23:28:16.387150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:16.840021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m23:28:16.844879 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m23:28:16.954214 [info ] [Thread-1 (]: 7 of 27 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.62s]
[0m23:28:16.955817 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:28:16.956923 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:28:16.957831 [info ] [Thread-1 (]: 8 of 27 START test not_null_rsi_trade_date ..................................... [RUN]
[0m23:28:16.958660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m23:28:16.959383 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:28:16.963989 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m23:28:16.977836 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:28:16.980973 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m23:28:16.994642 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m23:28:16.995563 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m23:28:16.996243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:17.331615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.335 seconds
[0m23:28:17.334306 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m23:28:17.430736 [info ] [Thread-1 (]: 8 of 27 PASS not_null_rsi_trade_date ........................................... [[32mPASS[0m in 0.47s]
[0m23:28:17.432074 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:28:17.433106 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:28:17.434136 [info ] [Thread-1 (]: 9 of 27 START test not_null_stock_indicators_rsi_14d ........................... [RUN]
[0m23:28:17.435480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m23:28:17.436727 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:28:17.442616 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m23:28:17.456353 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:28:17.461534 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m23:28:17.480593 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m23:28:17.481842 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m23:28:17.482822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:17.736042 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe420-0205-0c96-0004-59ff002ce416
[0m23:28:17.737193 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m23:28:17.738397 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m23:28:17.878548 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m23:28:17.879853 [error] [Thread-1 (]: 9 of 27 ERROR not_null_stock_indicators_rsi_14d ................................ [[31mERROR[0m in 0.44s]
[0m23:28:17.881063 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:28:17.881975 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:28:17.883339 [info ] [Thread-1 (]: 10 of 27 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m23:28:17.884403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m23:28:17.885187 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:28:17.890311 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m23:28:17.923710 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:28:17.927400 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m23:28:17.955968 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m23:28:17.957453 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m23:28:17.958667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:18.276324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m23:28:18.281205 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m23:28:18.389027 [info ] [Thread-1 (]: 10 of 27 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.50s]
[0m23:28:18.391187 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:28:18.392809 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:28:18.394257 [info ] [Thread-1 (]: 11 of 27 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m23:28:18.396015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m23:28:18.397620 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:28:18.406141 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m23:28:18.441156 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:28:18.445333 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m23:28:18.476058 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m23:28:18.477164 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m23:28:18.478132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:19.032610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m23:28:19.035544 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m23:28:19.133453 [info ] [Thread-1 (]: 11 of 27 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.74s]
[0m23:28:19.135690 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:28:19.137455 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:28:19.139031 [info ] [Thread-1 (]: 12 of 27 START test not_null_volume_summary_symbol ............................. [RUN]
[0m23:28:19.140524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m23:28:19.141697 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:28:19.147540 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m23:28:19.174684 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:28:19.179993 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m23:28:19.203015 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m23:28:19.204495 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m23:28:19.205529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:19.531736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m23:28:19.535370 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m23:28:19.634646 [info ] [Thread-1 (]: 12 of 27 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.49s]
[0m23:28:19.636064 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:28:19.637200 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:28:19.638076 [info ] [Thread-1 (]: 13 of 27 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m23:28:19.638996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m23:28:19.639686 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:28:19.645067 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m23:28:19.659569 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:28:19.663301 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m23:28:19.682819 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m23:28:19.683911 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m23:28:19.684766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:19.957060 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe420-0205-0bb1-0004-59ff002cf3e2
[0m23:28:19.958405 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m23:28:19.959751 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m23:28:20.063234 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m23:28:20.064616 [error] [Thread-1 (]: 13 of 27 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.43s]
[0m23:28:20.065965 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:28:20.067033 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:28:20.067900 [info ] [Thread-1 (]: 14 of 27 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m23:28:20.069163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m23:28:20.070257 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:28:20.075956 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m23:28:20.102370 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:28:20.106244 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m23:28:20.127103 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m23:28:20.128127 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m23:28:20.128899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:20.531868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m23:28:20.534544 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m23:28:20.647489 [info ] [Thread-1 (]: 14 of 27 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.58s]
[0m23:28:20.649496 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:28:20.651001 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m23:28:20.652178 [info ] [Thread-1 (]: 15 of 27 START test positive_values_moving_averages_close_price_14d_ma ......... [RUN]
[0m23:28:20.653551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0)
[0m23:28:20.654738 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m23:28:20.666158 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:20.667451 [error] [Thread-1 (]: 15 of 27 ERROR positive_values_moving_averages_close_price_14d_ma .............. [[31mERROR[0m in 0.01s]
[0m23:28:20.668655 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m23:28:20.669679 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m23:28:20.670600 [info ] [Thread-1 (]: 16 of 27 START test positive_values_moving_averages_close_price_30d_ma ......... [RUN]
[0m23:28:20.671463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0, now test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77)
[0m23:28:20.672271 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m23:28:20.677430 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:20.678517 [error] [Thread-1 (]: 16 of 27 ERROR positive_values_moving_averages_close_price_30d_ma .............. [[31mERROR[0m in 0.01s]
[0m23:28:20.679621 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m23:28:20.680704 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m23:28:20.681690 [info ] [Thread-1 (]: 17 of 27 START test positive_values_moving_averages_close_price_7d_ma .......... [RUN]
[0m23:28:20.682773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77, now test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba)
[0m23:28:20.683806 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m23:28:20.689522 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:20.690752 [error] [Thread-1 (]: 17 of 27 ERROR positive_values_moving_averages_close_price_7d_ma ............... [[31mERROR[0m in 0.01s]
[0m23:28:20.691977 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m23:28:20.693129 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m23:28:20.694138 [info ] [Thread-1 (]: 18 of 27 START test positive_values_volume_summary_total_volume ................ [RUN]
[0m23:28:20.695450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba, now test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd)
[0m23:28:20.696482 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m23:28:20.701016 [debug] [Thread-1 (]: Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:20.702296 [error] [Thread-1 (]: 18 of 27 ERROR positive_values_volume_summary_total_volume ..................... [[31mERROR[0m in 0.01s]
[0m23:28:20.703453 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m23:28:20.704616 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m23:28:20.705560 [info ] [Thread-1 (]: 19 of 27 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m23:28:20.706883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m23:28:20.707891 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m23:28:20.712787 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:20.713881 [error] [Thread-1 (]: 19 of 27 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.01s]
[0m23:28:20.715160 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m23:28:20.716245 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m23:28:20.717250 [info ] [Thread-1 (]: 20 of 27 START test range_stock_indicators_rsi_14d__100__0 ..................... [RUN]
[0m23:28:20.718445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4)
[0m23:28:20.719287 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m23:28:20.724371 [debug] [Thread-1 (]: Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:20.725502 [error] [Thread-1 (]: 20 of 27 ERROR range_stock_indicators_rsi_14d__100__0 .......................... [[31mERROR[0m in 0.01s]
[0m23:28:20.726829 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m23:28:20.728006 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m23:28:20.728937 [info ] [Thread-1 (]: 21 of 27 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m23:28:20.730183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m23:28:20.731164 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m23:28:20.739397 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m23:28:20.766982 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m23:28:20.771309 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m23:28:20.795254 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m23:28:20.796285 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:28:20.797111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:21.198081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m23:28:21.200742 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m23:28:21.307766 [info ] [Thread-1 (]: 21 of 27 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.58s]
[0m23:28:21.309614 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m23:28:21.310938 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m23:28:21.312159 [info ] [Thread-1 (]: 22 of 27 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m23:28:21.313299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m23:28:21.314446 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m23:28:21.322641 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m23:28:21.350037 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m23:28:21.354751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m23:28:21.376723 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m23:28:21.378006 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:28:21.379035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:21.858602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m23:28:21.863413 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m23:28:21.988204 [info ] [Thread-1 (]: 22 of 27 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.67s]
[0m23:28:21.989388 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m23:28:21.990344 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m23:28:21.991163 [info ] [Thread-1 (]: 23 of 27 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m23:28:21.992010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m23:28:21.992852 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m23:28:21.999386 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m23:28:22.023820 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m23:28:22.027876 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m23:28:22.052666 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m23:28:22.054113 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:28:22.055166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:22.523572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m23:28:22.528440 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m23:28:22.640340 [info ] [Thread-1 (]: 23 of 27 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.65s]
[0m23:28:22.641689 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m23:28:22.642830 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m23:28:22.643786 [info ] [Thread-1 (]: 24 of 27 START test unique_moving_averages_trade_date .......................... [RUN]
[0m23:28:22.644819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5, now test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f)
[0m23:28:22.645636 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m23:28:22.652940 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"
[0m23:28:22.680784 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m23:28:22.684909 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"
[0m23:28:22.710967 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"
[0m23:28:22.712008 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:22.712943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:23.153880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m23:28:23.156575 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f: Close
[0m23:28:23.258482 [error] [Thread-1 (]: 24 of 27 FAIL 180 unique_moving_averages_trade_date ............................ [[31mFAIL 180[0m in 0.61s]
[0m23:28:23.260578 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m23:28:23.262090 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m23:28:23.263408 [info ] [Thread-1 (]: 25 of 27 START test unique_rsi_trade_date ...................................... [RUN]
[0m23:28:23.264827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f, now test.dbt_stock_project.unique_rsi_trade_date.5701679003)
[0m23:28:23.265749 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m23:28:23.271220 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_trade_date.5701679003"
[0m23:28:23.293486 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m23:28:23.296842 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_trade_date.5701679003"
[0m23:28:23.321745 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_trade_date.5701679003"
[0m23:28:23.323404 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_trade_date.5701679003: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_trade_date.5701679003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:23.324615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:23.627731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m23:28:23.632267 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_trade_date.5701679003: Close
[0m23:28:23.748361 [error] [Thread-1 (]: 25 of 27 FAIL 180 unique_rsi_trade_date ........................................ [[31mFAIL 180[0m in 0.48s]
[0m23:28:23.750613 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m23:28:23.752214 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m23:28:23.753537 [info ] [Thread-1 (]: 26 of 27 START test unique_stock_indicators_trade_date ......................... [RUN]
[0m23:28:23.754772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_trade_date.5701679003, now test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093)
[0m23:28:23.755913 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m23:28:23.760606 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"
[0m23:28:23.788224 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m23:28:23.792168 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"
[0m23:28:23.817286 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"
[0m23:28:23.818370 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:23.819412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:24.266545 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m23:28:24.269029 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093: Close
[0m23:28:24.499726 [error] [Thread-1 (]: 26 of 27 FAIL 180 unique_stock_indicators_trade_date ........................... [[31mFAIL 180[0m in 0.74s]
[0m23:28:24.501133 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m23:28:24.502335 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m23:28:24.503585 [info ] [Thread-1 (]: 27 of 27 START test unique_volume_summary_trade_date ........................... [RUN]
[0m23:28:24.504760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093, now test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8)
[0m23:28:24.505594 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m23:28:24.594358 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"
[0m23:28:24.614075 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m23:28:24.617942 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"
[0m23:28:24.634271 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"
[0m23:28:24.635351 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:24.636552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:25.062633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m23:28:25.066841 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8: Close
[0m23:28:25.165514 [error] [Thread-1 (]: 27 of 27 FAIL 180 unique_volume_summary_trade_date ............................. [[31mFAIL 180[0m in 0.66s]
[0m23:28:25.166962 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m23:28:25.170485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:25.171708 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8' was properly closed.
[0m23:28:25.172419 [info ] [MainThread]: 
[0m23:28:25.173243 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 13.48 seconds (13.48s).
[0m23:28:25.176669 [debug] [MainThread]: Command end result
[0m23:28:25.318817 [info ] [MainThread]: 
[0m23:28:25.320450 [info ] [MainThread]: [31mCompleted with 12 errors and 0 warnings:[0m
[0m23:28:25.321686 [info ] [MainThread]: 
[0m23:28:25.322776 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m23:28:25.323753 [info ] [MainThread]: 
[0m23:28:25.324634 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m23:28:25.325436 [info ] [MainThread]: 
[0m23:28:25.326336 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:25.327105 [info ] [MainThread]: 
[0m23:28:25.327859 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:25.328482 [info ] [MainThread]: 
[0m23:28:25.329059 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:25.329635 [info ] [MainThread]: 
[0m23:28:25.330237 [error] [MainThread]:   Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:25.330791 [info ] [MainThread]: 
[0m23:28:25.331363 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:25.331971 [info ] [MainThread]: 
[0m23:28:25.332768 [error] [MainThread]:   Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:28:25.333376 [info ] [MainThread]: 
[0m23:28:25.334606 [error] [MainThread]: [31mFailure in test unique_moving_averages_trade_date (models/output/schema.yml)[0m
[0m23:28:25.335947 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m23:28:25.337184 [info ] [MainThread]: 
[0m23:28:25.338056 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_moving_averages_trade_date.sql
[0m23:28:25.338947 [info ] [MainThread]: 
[0m23:28:25.339687 [error] [MainThread]: [31mFailure in test unique_rsi_trade_date (models/output/schema.yml)[0m
[0m23:28:25.340384 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m23:28:25.341210 [info ] [MainThread]: 
[0m23:28:25.342034 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_rsi_trade_date.sql
[0m23:28:25.342952 [info ] [MainThread]: 
[0m23:28:25.343908 [error] [MainThread]: [31mFailure in test unique_stock_indicators_trade_date (models/output/schema.yml)[0m
[0m23:28:25.344782 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m23:28:25.345749 [info ] [MainThread]: 
[0m23:28:25.346688 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_stock_indicators_trade_date.sql
[0m23:28:25.347483 [info ] [MainThread]: 
[0m23:28:25.348536 [error] [MainThread]: [31mFailure in test unique_volume_summary_trade_date (models/output/schema.yml)[0m
[0m23:28:25.349498 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m23:28:25.350490 [info ] [MainThread]: 
[0m23:28:25.351497 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_volume_summary_trade_date.sql
[0m23:28:25.352414 [info ] [MainThread]: 
[0m23:28:25.353816 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=12 SKIP=0 TOTAL=27
[0m23:28:25.355490 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 15.696699, "process_user_time": 4.603891, "process_kernel_time": 1.930664, "process_mem_max_rss": "237488", "process_in_blocks": "2712", "process_out_blocks": "24", "command_success": false}
[0m23:28:25.356705 [debug] [MainThread]: Command `dbt test` failed at 23:28:25.356576 after 15.70 seconds
[0m23:28:25.357883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fafcc1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8563d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7f614ce0>]}
[0m23:28:25.359037 [debug] [MainThread]: Flushing usage events
[0m23:38:50.673958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367c7b46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367c69e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367c7b6cf0>]}


============================== 23:38:50.682498 | c6a6da7c-b7ed-4030-8851-1417a886b1ed ==============================
[0m23:38:50.682498 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:38:50.683489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:38:52.396867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3646e38860>]}
[0m23:38:52.441917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3647e2c770>]}
[0m23:38:52.444248 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:38:52.527763 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:38:52.881715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:38:52.882886 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m23:38:52.883653 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m23:38:53.109806 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:38:53.111396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3646398380>]}
[0m23:38:53.395846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364628b620>]}
[0m23:38:53.541126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36441acfb0>]}
[0m23:38:53.542291 [info ] [MainThread]: Found 6 models, 27 data tests, 3 sources, 459 macros
[0m23:38:53.543294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3644190b00>]}
[0m23:38:53.546372 [info ] [MainThread]: 
[0m23:38:53.547638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:38:53.552751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m23:38:53.567664 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m23:38:53.568505 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m23:38:53.569364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:54.118532 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.549 seconds
[0m23:38:54.122465 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m23:38:54.249315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m23:38:54.259785 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m23:38:54.260932 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m23:38:54.261787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:54.663087 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.401 seconds
[0m23:38:54.665623 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m23:38:54.761420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364646dfd0>]}
[0m23:38:54.762406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:38:54.763337 [info ] [MainThread]: 
[0m23:38:54.772825 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m23:38:54.774566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m23:38:54.775724 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m23:38:54.783934 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m23:38:54.800670 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m23:38:54.801774 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m23:38:54.802769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m23:38:54.803613 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m23:38:54.807365 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m23:38:54.827717 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m23:38:54.828498 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m23:38:54.829434 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m23:38:54.830335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m23:38:54.830892 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m23:38:54.833655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m23:38:54.847549 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m23:38:54.876210 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m23:38:54.896244 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m23:38:54.897211 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m23:38:54.897821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:56.309104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.411 seconds
[0m23:38:56.336332 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m23:38:56.435003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36469269f0>]}
[0m23:38:56.436334 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.60s]
[0m23:38:56.437367 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m23:38:56.438206 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m23:38:56.439077 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m23:38:56.440185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m23:38:56.441503 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m23:38:56.445866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m23:38:56.460308 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m23:38:56.464467 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m23:38:56.480119 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m23:38:56.480887 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m23:38:56.481459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:57.494005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.012 seconds
[0m23:38:57.496559 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m23:38:57.580425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360f55dcd0>]}
[0m23:38:57.581829 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.14s]
[0m23:38:57.582938 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m23:38:57.583791 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m23:38:57.584714 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m23:38:57.585667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m23:38:57.586318 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m23:38:57.601672 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m23:38:57.618008 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m23:38:57.621922 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m23:38:57.638395 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m23:38:57.639310 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
    SELECT
        s1.symbol,
        s1.trade_date,
        s1.close,

        -- 7-day moving average without window function
        (SELECT ROUND(AVG(s2.close), 2)
         FROM __dbt__cte__stock s2
         WHERE s1.symbol = s2.symbol
         AND s2.trade_date BETWEEN DATEADD(day, -6, s1.trade_date) AND s1.trade_date
        ) AS close_price_7d_ma,

        -- 14-day moving average without window function
        (SELECT ROUND(AVG(s3.close), 2)
         FROM __dbt__cte__stock s3
         WHERE s1.symbol = s3.symbol
         AND s3.trade_date BETWEEN DATEADD(day, -13, s1.trade_date) AND s1.trade_date
        ) AS close_price_14d_ma,

        -- 30-day moving average without window function
        (SELECT ROUND(AVG(s4.close), 2)
         FROM __dbt__cte__stock s4
         WHERE s1.symbol = s4.symbol
         AND s4.trade_date BETWEEN DATEADD(day, -29, s1.trade_date) AND s1.trade_date
        ) AS close_price_30d_ma

    FROM base s1
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date;
[0m23:38:57.640623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:58.021673 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe42a-0205-0f94-0004-59ff002cccba
[0m23:38:58.023076 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 50 at position 27 unexpected ';'.
[0m23:38:58.024683 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m23:38:58.129674 [debug] [Thread-1 (]: Database Error in model moving_averages (models/output/moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/moving_averages.sql
[0m23:38:58.130989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360f55cf80>]}
[0m23:38:58.132269 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model analytics.moving_averages ................ [[31mERROR[0m in 0.55s]
[0m23:38:58.133522 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m23:38:58.134636 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m23:38:58.135768 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m23:38:58.136766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m23:38:58.137765 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m23:38:58.160223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m23:38:58.188901 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m23:38:58.195564 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m23:38:58.228882 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m23:38:58.230251 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT
        s1.symbol,
        s1.trade_date,
        s1.close,
        s2.close AS prev_close
    FROM __dbt__cte__stock s1
    LEFT JOIN __dbt__cte__stock s2
        ON s1.symbol = s2.symbol
        AND s1.trade_date = DATEADD(day, 1, s2.trade_date)  -- Get previous day's close
),

gains_losses AS (
    SELECT
        symbol,
        trade_date,
        close,
        prev_close,
        CASE 
            WHEN close - prev_close > 0 THEN close - prev_close
            ELSE 0
        END AS gain,
        CASE 
            WHEN close - prev_close < 0 THEN ABS(close - prev_close)
            ELSE 0
        END AS loss
    FROM base
),

rsi_final AS (
    SELECT
        symbol,
        trade_date,
        close,
        (SELECT AVG(gain) FROM gains_losses g WHERE g.symbol = gl.symbol AND g.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_gain_14d,
        (SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_loss_14d,
        CASE 
            WHEN (SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) = 0 THEN 100
            ELSE ROUND(100 - (100 / (1 + (
                (SELECT AVG(gain) FROM gains_losses g WHERE g.symbol = gl.symbol AND g.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date)
                / NULLIF((SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date),0)
            ))), 2)
        END AS rsi_14d
    FROM gains_losses gl
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date;
[0m23:38:58.231270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:58.591442 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe42a-0205-0f94-0004-59ff002cccbe
[0m23:38:58.593652 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 62 at position 27 unexpected ';'.
[0m23:38:58.595798 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m23:38:58.700909 [debug] [Thread-1 (]: Database Error in model rsi (models/output/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m23:38:58.702144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a6da7c-b7ed-4030-8851-1417a886b1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360f589bb0>]}
[0m23:38:58.703401 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.rsi ............................ [[31mERROR[0m in 0.57s]
[0m23:38:58.704703 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m23:38:58.707327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:58.708562 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m23:38:58.709563 [info ] [MainThread]: 
[0m23:38:58.710596 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m23:38:58.712148 [debug] [MainThread]: Command end result
[0m23:38:58.810726 [info ] [MainThread]: 
[0m23:38:58.811885 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:38:58.812969 [info ] [MainThread]: 
[0m23:38:58.813994 [error] [MainThread]:   Database Error in model moving_averages (models/output/moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/moving_averages.sql
[0m23:38:58.815141 [info ] [MainThread]: 
[0m23:38:58.816167 [error] [MainThread]:   Database Error in model rsi (models/output/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m23:38:58.817133 [info ] [MainThread]: 
[0m23:38:58.818313 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m23:38:58.821152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.233389, "process_user_time": 4.316956, "process_kernel_time": 2.143169, "process_mem_max_rss": "238188", "process_in_blocks": "129360", "process_out_blocks": "8", "command_success": false}
[0m23:38:58.822410 [debug] [MainThread]: Command `dbt run` failed at 23:38:58.822278 after 8.23 seconds
[0m23:38:58.823562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d27dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36462c47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36462c4410>]}
[0m23:38:58.824550 [debug] [MainThread]: Flushing usage events
[0m23:40:30.590966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d77241220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7810bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d76bac0b0>]}


============================== 23:40:30.599614 | b4b6b468-e08f-4843-9fc5-e2f10502acf3 ==============================
[0m23:40:30.599614 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:40:30.601063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:40:32.380857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4492b170>]}
[0m23:40:32.430325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d454f7fe0>]}
[0m23:40:32.433074 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:40:32.520484 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:40:32.972781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:40:32.974558 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m23:40:32.975580 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m23:40:33.186847 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:40:33.188067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d444bcc80>]}
[0m23:40:33.461990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4421c530>]}
[0m23:40:33.656945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d441d6c60>]}
[0m23:40:33.658011 [info ] [MainThread]: Found 6 models, 27 data tests, 3 sources, 459 macros
[0m23:40:33.658946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3df21c10>]}
[0m23:40:33.661903 [info ] [MainThread]: 
[0m23:40:33.663132 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:40:33.668050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m23:40:33.682732 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m23:40:33.683797 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m23:40:33.684684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:34.310129 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.625 seconds
[0m23:40:34.312526 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m23:40:34.404955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m23:40:34.414078 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m23:40:34.415209 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m23:40:34.416135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:34.840668 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.424 seconds
[0m23:40:34.843514 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m23:40:34.939615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3df21a90>]}
[0m23:40:34.941012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:34.942030 [info ] [MainThread]: 
[0m23:40:34.951314 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m23:40:34.952418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m23:40:34.953315 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m23:40:34.961702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m23:40:34.980250 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m23:40:34.981113 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m23:40:34.981889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m23:40:34.982613 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m23:40:34.986200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m23:40:35.004371 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m23:40:35.005623 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m23:40:35.007251 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m23:40:35.008793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m23:40:35.009923 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m23:40:35.014557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m23:40:35.034769 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m23:40:35.062819 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m23:40:35.082350 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m23:40:35.083032 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m23:40:35.083716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:36.197004 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.113 seconds
[0m23:40:36.223558 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m23:40:36.341008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d76badb50>]}
[0m23:40:36.342756 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.33s]
[0m23:40:36.344213 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m23:40:36.345337 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m23:40:36.346406 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m23:40:36.347340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m23:40:36.348278 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m23:40:36.351830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m23:40:36.368449 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m23:40:36.372727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m23:40:36.398796 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m23:40:36.399867 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m23:40:36.400727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:37.292464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.891 seconds
[0m23:40:37.298267 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m23:40:37.417930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3d4222d0>]}
[0m23:40:37.419200 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.07s]
[0m23:40:37.420397 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m23:40:37.421197 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m23:40:37.422260 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m23:40:37.423623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m23:40:37.424552 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m23:40:37.438733 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m23:40:37.466328 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m23:40:37.470649 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m23:40:37.502020 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m23:40:37.503341 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
    SELECT
        s1.symbol,
        s1.trade_date,
        s1.close,

        -- 7-day moving average without window function
        (SELECT ROUND(AVG(s2.close), 2)
         FROM __dbt__cte__stock s2
         WHERE s1.symbol = s2.symbol
         AND s2.trade_date BETWEEN DATEADD(day, -6, s1.trade_date) AND s1.trade_date
        ) AS close_price_7d_ma,

        -- 14-day moving average without window function
        (SELECT ROUND(AVG(s3.close), 2)
         FROM __dbt__cte__stock s3
         WHERE s1.symbol = s3.symbol
         AND s3.trade_date BETWEEN DATEADD(day, -13, s1.trade_date) AND s1.trade_date
        ) AS close_price_14d_ma,

        -- 30-day moving average without window function
        (SELECT ROUND(AVG(s4.close), 2)
         FROM __dbt__cte__stock s4
         WHERE s1.symbol = s4.symbol
         AND s4.trade_date BETWEEN DATEADD(day, -29, s1.trade_date) AND s1.trade_date
        ) AS close_price_30d_ma

    FROM base s1
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m23:40:37.504422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:38.819980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.316 seconds
[0m23:40:38.822551 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m23:40:38.952983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3d45ff80>]}
[0m23:40:38.954231 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.53s]
[0m23:40:38.955439 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m23:40:38.956917 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m23:40:38.958375 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m23:40:38.959443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m23:40:38.960225 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m23:40:38.981560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m23:40:39.000946 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m23:40:39.005526 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m23:40:39.019843 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m23:40:39.020672 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT
        s1.symbol,
        s1.trade_date,
        s1.close,
        s2.close AS prev_close
    FROM __dbt__cte__stock s1
    LEFT JOIN __dbt__cte__stock s2
        ON s1.symbol = s2.symbol
        AND s1.trade_date = DATEADD(day, 1, s2.trade_date)  -- Get previous day's close
),

gains_losses AS (
    SELECT
        symbol,
        trade_date,
        close,
        prev_close,
        CASE 
            WHEN close - prev_close > 0 THEN close - prev_close
            ELSE 0
        END AS gain,
        CASE 
            WHEN close - prev_close < 0 THEN ABS(close - prev_close)
            ELSE 0
        END AS loss
    FROM base
),

rsi_final AS (
    SELECT
        symbol,
        trade_date,
        close,
        (SELECT AVG(gain) FROM gains_losses g WHERE g.symbol = gl.symbol AND g.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_gain_14d,
        (SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_loss_14d,
        CASE 
            WHEN (SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) = 0 THEN 100
            ELSE ROUND(100 - (100 / (1 + (
                (SELECT AVG(gain) FROM gains_losses g WHERE g.symbol = gl.symbol AND g.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date)
                / NULLIF((SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date),0)
            ))), 2)
        END AS rsi_14d
    FROM gains_losses gl
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m23:40:39.021499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:40.394579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.373 seconds
[0m23:40:40.397802 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m23:40:40.518238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b6b468-e08f-4843-9fc5-e2f10502acf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d441765d0>]}
[0m23:40:40.519495 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.56s]
[0m23:40:40.520548 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m23:40:40.523303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:40.524313 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m23:40:40.525426 [info ] [MainThread]: 
[0m23:40:40.526276 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m23:40:40.527693 [debug] [MainThread]: Command end result
[0m23:40:40.645869 [info ] [MainThread]: 
[0m23:40:40.646955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:40.647921 [info ] [MainThread]: 
[0m23:40:40.648896 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:40:40.651699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.150044, "process_user_time": 4.332812, "process_kernel_time": 1.908535, "process_mem_max_rss": "249868", "process_in_blocks": "129104", "process_out_blocks": "8"}
[0m23:40:40.653108 [debug] [MainThread]: Command `dbt run` succeeded at 23:40:40.652951 after 10.15 seconds
[0m23:40:40.654189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d765b9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d76783050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d765830e0>]}
[0m23:40:40.655439 [debug] [MainThread]: Flushing usage events
[0m23:40:44.511877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d007f4b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d025c7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d01cf8d70>]}


============================== 23:40:44.517812 | ea3e3d12-1838-4d4f-b325-2c95f6cddf9c ==============================
[0m23:40:44.517812 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:40:44.519305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:40:45.397036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea3e3d12-1838-4d4f-b325-2c95f6cddf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d03579e20>]}
[0m23:40:45.463258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea3e3d12-1838-4d4f-b325-2c95f6cddf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ccac0d7c0>]}
[0m23:40:45.464697 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:40:45.548119 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:40:45.889406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:40:45.890436 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:40:45.928854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea3e3d12-1838-4d4f-b325-2c95f6cddf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d004269f0>]}
[0m23:40:46.118130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea3e3d12-1838-4d4f-b325-2c95f6cddf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ccaa97f20>]}
[0m23:40:46.119927 [info ] [MainThread]: Found 6 models, 27 data tests, 3 sources, 459 macros
[0m23:40:46.120940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea3e3d12-1838-4d4f-b325-2c95f6cddf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd115fc80>]}
[0m23:40:46.125418 [info ] [MainThread]: 
[0m23:40:46.126884 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:40:46.131739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m23:40:46.147133 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m23:40:46.148475 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m23:40:46.149804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:46.577371 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.428 seconds
[0m23:40:46.579743 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m23:40:46.720257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea3e3d12-1838-4d4f-b325-2c95f6cddf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cca64d340>]}
[0m23:40:46.722237 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:46.723584 [info ] [MainThread]: 
[0m23:40:46.735830 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:40:46.737422 [info ] [Thread-1 (]: 1 of 27 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m23:40:46.739115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m23:40:46.740128 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:40:46.757167 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m23:40:46.787948 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:40:46.807132 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m23:40:46.841701 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m23:40:46.842642 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m23:40:46.843394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:47.198508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.355 seconds
[0m23:40:47.209752 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m23:40:47.318050 [info ] [Thread-1 (]: 1 of 27 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.58s]
[0m23:40:47.319262 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:40:47.320302 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:40:47.321406 [info ] [Thread-1 (]: 2 of 27 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m23:40:47.322607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m23:40:47.323449 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:40:47.328412 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m23:40:47.357993 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:40:47.361646 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m23:40:47.388133 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m23:40:47.389306 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m23:40:47.390249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:47.817136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m23:40:47.819394 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m23:40:47.930297 [info ] [Thread-1 (]: 2 of 27 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.61s]
[0m23:40:47.931600 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:40:47.932546 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:40:47.933595 [info ] [Thread-1 (]: 3 of 27 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m23:40:47.934921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m23:40:47.935686 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:40:47.941798 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m23:40:47.966959 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:40:47.970546 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m23:40:47.991092 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m23:40:47.991971 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m23:40:47.992591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:48.543109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m23:40:48.545743 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m23:40:48.642126 [info ] [Thread-1 (]: 3 of 27 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.71s]
[0m23:40:48.643423 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:40:48.644436 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:40:48.645274 [info ] [Thread-1 (]: 4 of 27 START test not_null_moving_averages_symbol ............................. [RUN]
[0m23:40:48.646292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m23:40:48.647334 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:40:48.652822 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m23:40:48.673490 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:40:48.676949 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m23:40:48.694771 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m23:40:48.695760 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m23:40:48.696436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:49.419287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m23:40:49.422932 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m23:40:49.518306 [info ] [Thread-1 (]: 4 of 27 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.87s]
[0m23:40:49.519981 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:40:49.521311 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:40:49.522625 [info ] [Thread-1 (]: 5 of 27 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m23:40:49.523987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m23:40:49.525039 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:40:49.531139 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m23:40:49.562464 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:40:49.565803 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m23:40:49.593469 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m23:40:49.594603 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m23:40:49.595469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:49.927161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m23:40:49.929866 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m23:40:50.063854 [info ] [Thread-1 (]: 5 of 27 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.54s]
[0m23:40:50.065769 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:40:50.067213 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:40:50.068541 [info ] [Thread-1 (]: 6 of 27 START test not_null_rsi_rsi_14d ........................................ [RUN]
[0m23:40:50.069958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m23:40:50.070737 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:40:50.075293 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m23:40:50.109853 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:40:50.113523 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m23:40:50.143579 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m23:40:50.144751 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m23:40:50.145788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:50.577128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m23:40:50.580571 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m23:40:50.685087 [info ] [Thread-1 (]: 6 of 27 PASS not_null_rsi_rsi_14d .............................................. [[32mPASS[0m in 0.61s]
[0m23:40:50.686689 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:40:50.688226 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:40:50.689544 [info ] [Thread-1 (]: 7 of 27 START test not_null_rsi_symbol ......................................... [RUN]
[0m23:40:50.691085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m23:40:50.692196 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:40:50.699562 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m23:40:50.724254 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:40:50.729211 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m23:40:50.752697 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m23:40:50.754138 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m23:40:50.755367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:51.167659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m23:40:51.169789 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m23:40:51.264148 [info ] [Thread-1 (]: 7 of 27 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.57s]
[0m23:40:51.265597 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:40:51.266550 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:40:51.267396 [info ] [Thread-1 (]: 8 of 27 START test not_null_rsi_trade_date ..................................... [RUN]
[0m23:40:51.268446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m23:40:51.269288 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:40:51.274316 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m23:40:51.301082 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:40:51.304960 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m23:40:51.325251 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m23:40:51.326233 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m23:40:51.327068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:51.684667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m23:40:51.687341 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m23:40:51.835229 [info ] [Thread-1 (]: 8 of 27 PASS not_null_rsi_trade_date ........................................... [[32mPASS[0m in 0.57s]
[0m23:40:51.836604 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:40:51.837518 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:40:51.838485 [info ] [Thread-1 (]: 9 of 27 START test not_null_stock_indicators_rsi_14d ........................... [RUN]
[0m23:40:51.839672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m23:40:51.840512 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:40:51.845359 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m23:40:51.866812 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:40:51.871778 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m23:40:51.889905 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m23:40:51.890770 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m23:40:51.891641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:52.229772 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe42c-0205-0bb1-0004-59ff002cf706
[0m23:40:52.230707 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m23:40:52.231435 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m23:40:52.324662 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m23:40:52.326036 [error] [Thread-1 (]: 9 of 27 ERROR not_null_stock_indicators_rsi_14d ................................ [[31mERROR[0m in 0.49s]
[0m23:40:52.327234 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:40:52.328208 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:40:52.329494 [info ] [Thread-1 (]: 10 of 27 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m23:40:52.330411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m23:40:52.331139 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:40:52.337907 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m23:40:52.358829 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:40:52.363003 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m23:40:52.386423 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m23:40:52.388907 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m23:40:52.390707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:52.757759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m23:40:52.760120 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m23:40:52.860671 [info ] [Thread-1 (]: 10 of 27 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.53s]
[0m23:40:52.861936 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:40:52.862924 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:40:52.863716 [info ] [Thread-1 (]: 11 of 27 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m23:40:52.864830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m23:40:52.865575 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:40:52.869999 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m23:40:52.889282 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:40:52.892965 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m23:40:52.909128 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m23:40:52.910057 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m23:40:52.910723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:53.362382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m23:40:53.365053 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m23:40:53.486877 [info ] [Thread-1 (]: 11 of 27 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.62s]
[0m23:40:53.488587 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:40:53.489801 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:40:53.491061 [info ] [Thread-1 (]: 12 of 27 START test not_null_volume_summary_symbol ............................. [RUN]
[0m23:40:53.492222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m23:40:53.493177 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:40:53.499152 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m23:40:53.522539 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:40:53.526562 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m23:40:53.548797 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m23:40:53.549875 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m23:40:53.550819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:53.903331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m23:40:53.906386 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m23:40:54.016937 [info ] [Thread-1 (]: 12 of 27 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.52s]
[0m23:40:54.018207 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:40:54.018998 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:40:54.019667 [info ] [Thread-1 (]: 13 of 27 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m23:40:54.020518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m23:40:54.021413 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:40:54.026565 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m23:40:54.049502 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:40:54.052928 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m23:40:54.070750 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m23:40:54.071845 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m23:40:54.073032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:54.358745 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe42c-0205-0c98-0004-59ff002cd7c2
[0m23:40:54.360485 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m23:40:54.362356 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m23:40:54.476842 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m23:40:54.478251 [error] [Thread-1 (]: 13 of 27 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.46s]
[0m23:40:54.479600 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:40:54.480687 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:40:54.481608 [info ] [Thread-1 (]: 14 of 27 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m23:40:54.483042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m23:40:54.484040 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:40:54.489663 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m23:40:54.516459 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:40:54.520728 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m23:40:54.547815 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m23:40:54.549080 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m23:40:54.550079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:54.909303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m23:40:54.914507 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m23:40:55.036811 [info ] [Thread-1 (]: 14 of 27 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.55s]
[0m23:40:55.039471 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:40:55.041248 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m23:40:55.042534 [info ] [Thread-1 (]: 15 of 27 START test positive_values_moving_averages_close_price_14d_ma ......... [RUN]
[0m23:40:55.044542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0)
[0m23:40:55.045797 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m23:40:55.059481 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:55.060972 [error] [Thread-1 (]: 15 of 27 ERROR positive_values_moving_averages_close_price_14d_ma .............. [[31mERROR[0m in 0.02s]
[0m23:40:55.062304 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m23:40:55.063460 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m23:40:55.064520 [info ] [Thread-1 (]: 16 of 27 START test positive_values_moving_averages_close_price_30d_ma ......... [RUN]
[0m23:40:55.065686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0, now test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77)
[0m23:40:55.066786 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m23:40:55.074088 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:55.075310 [error] [Thread-1 (]: 16 of 27 ERROR positive_values_moving_averages_close_price_30d_ma .............. [[31mERROR[0m in 0.01s]
[0m23:40:55.076641 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m23:40:55.078421 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m23:40:55.079479 [info ] [Thread-1 (]: 17 of 27 START test positive_values_moving_averages_close_price_7d_ma .......... [RUN]
[0m23:40:55.080642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77, now test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba)
[0m23:40:55.081716 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m23:40:55.087625 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:55.089817 [error] [Thread-1 (]: 17 of 27 ERROR positive_values_moving_averages_close_price_7d_ma ............... [[31mERROR[0m in 0.01s]
[0m23:40:55.091440 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m23:40:55.092872 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m23:40:55.094236 [info ] [Thread-1 (]: 18 of 27 START test positive_values_volume_summary_total_volume ................ [RUN]
[0m23:40:55.095352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba, now test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd)
[0m23:40:55.096328 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m23:40:55.103138 [debug] [Thread-1 (]: Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:55.104473 [error] [Thread-1 (]: 18 of 27 ERROR positive_values_volume_summary_total_volume ..................... [[31mERROR[0m in 0.01s]
[0m23:40:55.106265 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m23:40:55.107114 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m23:40:55.108094 [info ] [Thread-1 (]: 19 of 27 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m23:40:55.109057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m23:40:55.109981 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m23:40:55.116004 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:55.117153 [error] [Thread-1 (]: 19 of 27 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.01s]
[0m23:40:55.118297 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m23:40:55.119296 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m23:40:55.120111 [info ] [Thread-1 (]: 20 of 27 START test range_stock_indicators_rsi_14d__100__0 ..................... [RUN]
[0m23:40:55.121180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4)
[0m23:40:55.122554 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m23:40:55.128854 [debug] [Thread-1 (]: Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:55.130476 [error] [Thread-1 (]: 20 of 27 ERROR range_stock_indicators_rsi_14d__100__0 .......................... [[31mERROR[0m in 0.01s]
[0m23:40:55.131798 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m23:40:55.133008 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m23:40:55.134017 [info ] [Thread-1 (]: 21 of 27 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m23:40:55.135260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m23:40:55.135981 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m23:40:55.146133 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m23:40:55.173049 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m23:40:55.176774 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m23:40:55.195547 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m23:40:55.196707 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:40:55.197819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:55.574121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m23:40:55.576544 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m23:40:55.672185 [info ] [Thread-1 (]: 21 of 27 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.54s]
[0m23:40:55.673861 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m23:40:55.675057 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m23:40:55.676197 [info ] [Thread-1 (]: 22 of 27 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m23:40:55.677234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m23:40:55.678178 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m23:40:55.685462 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m23:40:55.717093 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m23:40:55.721103 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m23:40:55.758917 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m23:40:55.760293 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:40:55.761704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:56.154356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m23:40:56.159694 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m23:40:56.282527 [info ] [Thread-1 (]: 22 of 27 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.60s]
[0m23:40:56.284687 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m23:40:56.286122 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m23:40:56.287426 [info ] [Thread-1 (]: 23 of 27 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m23:40:56.289034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m23:40:56.290441 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m23:40:56.296754 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m23:40:56.328741 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m23:40:56.332607 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m23:40:56.361109 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m23:40:56.362122 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:40:56.363146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:56.745602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m23:40:56.749873 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m23:40:56.885260 [info ] [Thread-1 (]: 23 of 27 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.60s]
[0m23:40:56.886517 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m23:40:56.887608 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m23:40:56.888587 [info ] [Thread-1 (]: 24 of 27 START test unique_moving_averages_trade_date .......................... [RUN]
[0m23:40:56.889933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5, now test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f)
[0m23:40:56.891070 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m23:40:56.898522 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"
[0m23:40:56.920465 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m23:40:56.925070 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"
[0m23:40:56.951963 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"
[0m23:40:56.952908 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:40:56.953561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:57.291628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m23:40:57.294064 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f: Close
[0m23:40:57.396890 [error] [Thread-1 (]: 24 of 27 FAIL 180 unique_moving_averages_trade_date ............................ [[31mFAIL 180[0m in 0.51s]
[0m23:40:57.398070 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m23:40:57.398914 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m23:40:57.399785 [info ] [Thread-1 (]: 25 of 27 START test unique_rsi_trade_date ...................................... [RUN]
[0m23:40:57.400588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f, now test.dbt_stock_project.unique_rsi_trade_date.5701679003)
[0m23:40:57.401334 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m23:40:57.406638 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_trade_date.5701679003"
[0m23:40:57.427827 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m23:40:57.431738 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_trade_date.5701679003"
[0m23:40:57.456511 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_trade_date.5701679003"
[0m23:40:57.457511 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_trade_date.5701679003: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_trade_date.5701679003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:40:57.458394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:57.857498 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m23:40:57.860281 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_trade_date.5701679003: Close
[0m23:40:58.001633 [error] [Thread-1 (]: 25 of 27 FAIL 180 unique_rsi_trade_date ........................................ [[31mFAIL 180[0m in 0.60s]
[0m23:40:58.003018 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m23:40:58.004149 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m23:40:58.005736 [info ] [Thread-1 (]: 26 of 27 START test unique_stock_indicators_trade_date ......................... [RUN]
[0m23:40:58.007234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_trade_date.5701679003, now test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093)
[0m23:40:58.008260 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m23:40:58.013701 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"
[0m23:40:58.034532 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m23:40:58.038012 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"
[0m23:40:58.057528 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"
[0m23:40:58.058486 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:40:58.059382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:58.363269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m23:40:58.368512 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093: Close
[0m23:40:58.462573 [error] [Thread-1 (]: 26 of 27 FAIL 180 unique_stock_indicators_trade_date ........................... [[31mFAIL 180[0m in 0.46s]
[0m23:40:58.463900 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m23:40:58.464998 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m23:40:58.465901 [info ] [Thread-1 (]: 27 of 27 START test unique_volume_summary_trade_date ........................... [RUN]
[0m23:40:58.466855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093, now test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8)
[0m23:40:58.467688 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m23:40:58.536779 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"
[0m23:40:58.582156 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m23:40:58.585911 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"
[0m23:40:58.633319 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"
[0m23:40:58.635058 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:40:58.636693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:58.993229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m23:40:58.998361 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8: Close
[0m23:40:59.100110 [error] [Thread-1 (]: 27 of 27 FAIL 180 unique_volume_summary_trade_date ............................. [[31mFAIL 180[0m in 0.63s]
[0m23:40:59.102375 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m23:40:59.107559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:59.109172 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8' was properly closed.
[0m23:40:59.110703 [info ] [MainThread]: 
[0m23:40:59.111875 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 12.98 seconds (12.98s).
[0m23:40:59.117257 [debug] [MainThread]: Command end result
[0m23:40:59.217206 [info ] [MainThread]: 
[0m23:40:59.218262 [info ] [MainThread]: [31mCompleted with 12 errors and 0 warnings:[0m
[0m23:40:59.219125 [info ] [MainThread]: 
[0m23:40:59.220041 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m23:40:59.220876 [info ] [MainThread]: 
[0m23:40:59.221733 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m23:40:59.222711 [info ] [MainThread]: 
[0m23:40:59.223524 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:59.224211 [info ] [MainThread]: 
[0m23:40:59.225004 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:59.225680 [info ] [MainThread]: 
[0m23:40:59.226375 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:59.227010 [info ] [MainThread]: 
[0m23:40:59.227752 [error] [MainThread]:   Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:59.228625 [info ] [MainThread]: 
[0m23:40:59.229361 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:59.230159 [info ] [MainThread]: 
[0m23:40:59.231005 [error] [MainThread]:   Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:40:59.231910 [info ] [MainThread]: 
[0m23:40:59.232729 [error] [MainThread]: [31mFailure in test unique_moving_averages_trade_date (models/output/schema.yml)[0m
[0m23:40:59.233616 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m23:40:59.234412 [info ] [MainThread]: 
[0m23:40:59.235080 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_moving_averages_trade_date.sql
[0m23:40:59.235805 [info ] [MainThread]: 
[0m23:40:59.236530 [error] [MainThread]: [31mFailure in test unique_rsi_trade_date (models/output/schema.yml)[0m
[0m23:40:59.237306 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m23:40:59.237929 [info ] [MainThread]: 
[0m23:40:59.238867 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_rsi_trade_date.sql
[0m23:40:59.239833 [info ] [MainThread]: 
[0m23:40:59.240612 [error] [MainThread]: [31mFailure in test unique_stock_indicators_trade_date (models/output/schema.yml)[0m
[0m23:40:59.241493 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m23:40:59.242179 [info ] [MainThread]: 
[0m23:40:59.242878 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_stock_indicators_trade_date.sql
[0m23:40:59.243571 [info ] [MainThread]: 
[0m23:40:59.244229 [error] [MainThread]: [31mFailure in test unique_volume_summary_trade_date (models/output/schema.yml)[0m
[0m23:40:59.244932 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m23:40:59.245597 [info ] [MainThread]: 
[0m23:40:59.246221 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_volume_summary_trade_date.sql
[0m23:40:59.246777 [info ] [MainThread]: 
[0m23:40:59.247373 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=12 SKIP=0 TOTAL=27
[0m23:40:59.248442 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 14.841487, "process_user_time": 4.369496, "process_kernel_time": 1.93865, "process_mem_max_rss": "238652", "process_in_blocks": "2704", "process_out_blocks": "8", "command_success": false}
[0m23:40:59.249321 [debug] [MainThread]: Command `dbt test` failed at 23:40:59.249236 after 14.84 seconds
[0m23:40:59.249911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbbf0b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ccba37ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0083f6e0>]}
[0m23:40:59.250502 [debug] [MainThread]: Flushing usage events
[0m23:51:23.875067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c7a7d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c7a7f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c7a7d580>]}


============================== 23:51:23.883822 | 3efed6f9-449a-4351-b082-cdb1225da81f ==============================
[0m23:51:23.883822 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:51:23.884841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:51:25.663866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3efed6f9-449a-4351-b082-cdb1225da81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73922bbda0>]}
[0m23:51:25.723064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3efed6f9-449a-4351-b082-cdb1225da81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c7e0f260>]}
[0m23:51:25.725367 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:51:25.819937 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:51:26.561548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 5 files changed.
[0m23:51:26.563066 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/New folder/schema.yml
[0m23:51:26.564088 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/New folder/moving_averages.sql
[0m23:51:26.565032 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/New folder/volume_summary.sql
[0m23:51:26.565855 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/New folder/stock_indicators.sql
[0m23:51:26.566699 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/New folder/rsi.sql
[0m23:51:26.568066 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m23:51:26.568866 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m23:51:26.569631 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/volume_summary.sql
[0m23:51:26.570273 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m23:51:26.570951 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/stock_indicators.sql
[0m23:51:26.742654 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "volume_summary".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("volume_summary").
  
  To fix this, change the name of one of these resources:
  - model.dbt_stock_project.volume_summary (models/output/volume_summary.sql)
  - model.dbt_stock_project.volume_summary (models/output/New folder/volume_summary.sql)
[0m23:51:26.745917 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9691896, "process_user_time": 3.488201, "process_kernel_time": 2.088979, "process_mem_max_rss": "233096", "process_in_blocks": "122936", "command_success": false, "process_out_blocks": "0"}
[0m23:51:26.747095 [debug] [MainThread]: Command `dbt run` failed at 23:51:26.746990 after 2.97 seconds
[0m23:51:26.748485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c7647bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c7665b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73919da150>]}
[0m23:51:26.749882 [debug] [MainThread]: Flushing usage events
[0m23:53:08.970087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc71480d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc73ef2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc73213da0>]}


============================== 23:53:08.981045 | af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6 ==============================
[0m23:53:08.981045 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:53:08.982343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:10.601802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc72a1e450>]}
[0m23:53:10.667385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4787e090>]}
[0m23:53:10.670068 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:53:10.771069 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:53:11.288807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m23:53:11.292311 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m23:53:11.293379 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m23:53:11.294506 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m23:53:11.295531 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/volume_summary.sql
[0m23:53:11.296468 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/stock_indicators.sql
[0m23:53:11.514472 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:53:11.516035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b30ea50>]}
[0m23:53:11.752130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc390b1910>]}
[0m23:53:11.978696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc390d2f90>]}
[0m23:53:11.980100 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m23:53:11.981235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc39150140>]}
[0m23:53:11.985109 [info ] [MainThread]: 
[0m23:53:11.986556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:53:11.996625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m23:53:12.013680 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m23:53:12.014791 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m23:53:12.015859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:12.552610 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m23:53:12.554905 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m23:53:12.656667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m23:53:12.667193 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m23:53:12.668435 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m23:53:12.669444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:13.021575 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.352 seconds
[0m23:53:13.024862 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m23:53:13.134279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b8e5550>]}
[0m23:53:13.135921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:53:13.137248 [info ] [MainThread]: 
[0m23:53:13.149517 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m23:53:13.150944 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m23:53:13.152235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.moving_averages)
[0m23:53:13.153371 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m23:53:13.163153 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m23:53:13.193536 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m23:53:13.223096 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m23:53:13.240306 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m23:53:13.241503 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/moving_averages.sql
with staging as (
  select
    DATE       as trade_date,
    SYMBOL     as symbol,
    CLOSE      as close_price
  from USER_DB_BLUEJAY.raw.STOCK
)

select
  trade_date,
  symbol,
  avg(close_price) over (partition by symbol order by trade_date rows between 6 preceding and current row)  as close_price_7d_ma,
  avg(close_price) over (partition by symbol order by trade_date rows between 13 preceding and current row) as close_price_14d_ma,
  avg(close_price) over (partition by symbol order by trade_date rows between 29 preceding and current row) as close_price_30d_ma
from staging
        );
[0m23:53:13.242459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:15.023429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.781 seconds
[0m23:53:15.051521 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m23:53:15.179170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b87e9c0>]}
[0m23:53:15.180497 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 2.03s]
[0m23:53:15.181611 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m23:53:15.182418 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m23:53:15.183305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.stock)
[0m23:53:15.184004 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m23:53:15.188429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m23:53:15.211930 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m23:53:15.212967 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m23:53:15.213830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m23:53:15.214571 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m23:53:15.218274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m23:53:15.242381 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m23:53:15.243498 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m23:53:15.244540 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m23:53:15.245584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m23:53:15.246412 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m23:53:15.249088 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m23:53:15.270783 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m23:53:15.274432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m23:53:15.299250 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m23:53:15.300587 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (-- models/stock_indicators.sql
with staging as (
  select
    date            as trade_date,
    symbol,
    close,
    lag(close) over (partition by symbol order by date) as prev_close
  from raw.stock
),
base as (
  select
    trade_date,
    symbol,
    close,
    prev_close
  from staging
),
gains_losses as (
  select
    trade_date,
    symbol,
    greatest(close - prev_close, 0) as gain,
    greatest(prev_close - close, 0) as loss
  from base
),
avg_gain_loss as (
  select
    trade_date,
    symbol,
    avg(gain) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_gain,
    avg(loss) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_loss
  from gains_losses
),
final as (
  select
    trade_date,
    symbol,
    coalesce(
      case
        when avg_loss = 0 then 100
        else 100 - (100 / (1 + (avg_gain / avg_loss)))
      end,
      0
    ) as rsi_14d
  from avg_gain_loss
)

select * from final
        );
[0m23:53:15.302071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:16.372089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.073 seconds
[0m23:53:16.376134 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m23:53:16.464026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc385f3cb0>]}
[0m23:53:16.465420 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.22s]
[0m23:53:16.466598 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m23:53:16.467518 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m23:53:16.468614 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m23:53:16.469588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m23:53:16.470401 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m23:53:16.474667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m23:53:16.497671 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m23:53:16.501505 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m23:53:16.525079 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m23:53:16.526321 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/volume_summary.sql
with staging as (
  select
    DATE    as trade_date,
    SYMBOL  as symbol,
    VOLUME  as volume
  from USER_DB_BLUEJAY.raw.STOCK
)

select
  trade_date,
  symbol,
  sum(volume) as total_volume
from staging
group by trade_date, symbol
        );
[0m23:53:16.527226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:17.314485 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.787 seconds
[0m23:53:17.317674 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m23:53:17.410801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc385d4e90>]}
[0m23:53:17.412581 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 0.94s]
[0m23:53:17.413988 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m23:53:17.415001 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m23:53:17.416092 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m23:53:17.417298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.rsi)
[0m23:53:17.418333 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m23:53:17.434964 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m23:53:17.461946 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m23:53:17.466177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m23:53:17.494143 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m23:53:17.495124 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/rsi.sql

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base as (
    select
        symbol,
        trade_date,
        close,
        lag(close) over (partition by symbol order by trade_date) as prev_close
    from __dbt__cte__stock
),
gains_losses as (
    select
        symbol,
        trade_date,
        greatest(close - prev_close, 0) as gain,
        greatest(prev_close - close, 0) as loss
    from base
),
avg_calc as (
    select
        symbol,
        trade_date,
        avg(gain) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_gain_14d,
        avg(loss) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_loss_14d
    from gains_losses
),
rsi_calc as (
    select
        symbol,
        trade_date,
        case
            when avg_loss_14d = 0 then 100
            else round(100 - (100 / (1 + (avg_gain_14d / nullif(avg_loss_14d, 0)))), 2)
        end as rsi_14d
    from avg_calc
),
rsi_final as (
    select
        symbol,
        trade_date,
        coalesce(rsi_14d, 0) as rsi_14d
    from rsi_calc
)
select *
from rsi_final
        );
[0m23:53:17.496090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:18.464150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.968 seconds
[0m23:53:18.466852 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m23:53:18.552863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af2614d3-ef6f-4c69-afe2-5afa7a6eb9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc729837a0>]}
[0m23:53:18.554183 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.14s]
[0m23:53:18.555361 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m23:53:18.558014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:18.558928 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m23:53:18.559796 [info ] [MainThread]: 
[0m23:53:18.560608 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m23:53:18.561890 [debug] [MainThread]: Command end result
[0m23:53:18.742316 [info ] [MainThread]: 
[0m23:53:18.743532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:18.744559 [info ] [MainThread]: 
[0m23:53:18.745512 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:53:18.747893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.880423, "process_user_time": 4.365713, "process_kernel_time": 2.079673, "process_mem_max_rss": "243316", "process_in_blocks": "128832", "process_out_blocks": "8"}
[0m23:53:18.749055 [debug] [MainThread]: Command `dbt run` succeeded at 23:53:18.748888 after 9.88 seconds
[0m23:53:18.749925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc41d65e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc41d65d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc385e39e0>]}
[0m23:53:18.750752 [debug] [MainThread]: Flushing usage events
[0m23:53:22.033653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c465b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c54d5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c39f9910>]}


============================== 23:53:22.040251 | e800d034-f8a9-4ef0-86d1-8914cc95c2ee ==============================
[0m23:53:22.040251 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:53:22.041279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:22.980525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e800d034-f8a9-4ef0-86d1-8914cc95c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169306a570>]}
[0m23:53:23.032627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e800d034-f8a9-4ef0-86d1-8914cc95c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1691b753d0>]}
[0m23:53:23.033908 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m23:53:23.123186 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:53:23.406665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:53:23.408002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:53:23.456795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e800d034-f8a9-4ef0-86d1-8914cc95c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169198f9e0>]}
[0m23:53:23.643201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e800d034-f8a9-4ef0-86d1-8914cc95c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169159b5c0>]}
[0m23:53:23.644422 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m23:53:23.645310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e800d034-f8a9-4ef0-86d1-8914cc95c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169187c6e0>]}
[0m23:53:23.648632 [info ] [MainThread]: 
[0m23:53:23.650134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:53:23.655631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m23:53:23.675590 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m23:53:23.676877 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m23:53:23.678030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:24.173975 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.496 seconds
[0m23:53:24.177955 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m23:53:24.266783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e800d034-f8a9-4ef0-86d1-8914cc95c2ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16919ba210>]}
[0m23:53:24.268095 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:53:24.269029 [info ] [MainThread]: 
[0m23:53:24.282899 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m23:53:24.284545 [info ] [Thread-1 (]: 1 of 18 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date  [RUN]
[0m23:53:24.286091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19)
[0m23:53:24.287310 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m23:53:24.313566 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:53:24.314887 [error] [Thread-1 (]: 1 of 18 ERROR dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date  [[31mERROR[0m in 0.03s]
[0m23:53:24.316018 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m23:53:24.317094 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m23:53:24.318198 [info ] [Thread-1 (]: 2 of 18 START test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date  [RUN]
[0m23:53:24.319255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d)
[0m23:53:24.320107 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m23:53:24.325969 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:53:24.327481 [error] [Thread-1 (]: 2 of 18 ERROR dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date ... [[31mERROR[0m in 0.01s]
[0m23:53:24.329241 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m23:53:24.330745 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m23:53:24.332137 [info ] [Thread-1 (]: 3 of 18 START test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date  [RUN]
[0m23:53:24.333573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9)
[0m23:53:24.334794 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m23:53:24.340590 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:53:24.342240 [error] [Thread-1 (]: 3 of 18 ERROR dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date  [[31mERROR[0m in 0.01s]
[0m23:53:24.343910 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m23:53:24.345154 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m23:53:24.346425 [info ] [Thread-1 (]: 4 of 18 START test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date  [RUN]
[0m23:53:24.347843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d)
[0m23:53:24.348986 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m23:53:24.354051 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:53:24.355083 [error] [Thread-1 (]: 4 of 18 ERROR dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date  [[31mERROR[0m in 0.01s]
[0m23:53:24.356314 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m23:53:24.357826 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:53:24.359187 [info ] [Thread-1 (]: 5 of 18 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m23:53:24.360298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m23:53:24.361341 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:53:24.370535 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m23:53:24.417448 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:53:24.436586 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m23:53:24.482880 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m23:53:24.484298 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m23:53:24.485559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:25.432537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.947 seconds
[0m23:53:25.444136 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m23:53:25.550012 [info ] [Thread-1 (]: 5 of 18 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 1.19s]
[0m23:53:25.551581 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m23:53:25.553010 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:53:25.553954 [info ] [Thread-1 (]: 6 of 18 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m23:53:25.555062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m23:53:25.556076 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:53:25.561772 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m23:53:25.585575 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:53:25.589225 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m23:53:25.604697 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m23:53:25.605786 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m23:53:25.606713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:25.994397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m23:53:25.996813 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m23:53:26.085778 [info ] [Thread-1 (]: 6 of 18 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.53s]
[0m23:53:26.087065 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m23:53:26.088066 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:53:26.089054 [info ] [Thread-1 (]: 7 of 18 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m23:53:26.090077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m23:53:26.091043 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:53:26.095890 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m23:53:26.119436 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:53:26.123040 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m23:53:26.142528 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m23:53:26.143592 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m23:53:26.144524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:26.706167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m23:53:26.708859 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m23:53:26.821074 [info ] [Thread-1 (]: 7 of 18 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.73s]
[0m23:53:26.823201 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m23:53:26.824869 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:53:26.826266 [info ] [Thread-1 (]: 8 of 18 START test not_null_moving_averages_symbol ............................. [RUN]
[0m23:53:26.827767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m23:53:26.829106 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:53:26.836279 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m23:53:26.869610 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:53:26.873792 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m23:53:26.902735 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m23:53:26.903941 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m23:53:26.904840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:27.228478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.323 seconds
[0m23:53:27.233625 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m23:53:27.322714 [info ] [Thread-1 (]: 8 of 18 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.49s]
[0m23:53:27.324140 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m23:53:27.325281 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:53:27.326279 [info ] [Thread-1 (]: 9 of 18 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m23:53:27.327370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m23:53:27.328370 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:53:27.333111 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m23:53:27.374222 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:53:27.378969 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m23:53:27.429665 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m23:53:27.431344 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m23:53:27.432786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:28.029612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m23:53:28.031979 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m23:53:28.123195 [info ] [Thread-1 (]: 9 of 18 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.80s]
[0m23:53:28.124703 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m23:53:28.125780 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:53:28.126635 [info ] [Thread-1 (]: 10 of 18 START test not_null_rsi_rsi_14d ....................................... [RUN]
[0m23:53:28.127904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m23:53:28.128697 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:53:28.134688 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m23:53:28.155929 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:53:28.159782 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m23:53:28.180511 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m23:53:28.181613 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m23:53:28.182463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:28.522950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.340 seconds
[0m23:53:28.526998 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m23:53:28.618089 [info ] [Thread-1 (]: 10 of 18 PASS not_null_rsi_rsi_14d ............................................. [[32mPASS[0m in 0.49s]
[0m23:53:28.619548 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m23:53:28.620573 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:53:28.621391 [info ] [Thread-1 (]: 11 of 18 START test not_null_rsi_symbol ........................................ [RUN]
[0m23:53:28.622299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m23:53:28.623511 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:53:28.628729 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m23:53:28.647104 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:53:28.650787 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m23:53:28.671150 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m23:53:28.672013 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m23:53:28.673191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:28.981707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.309 seconds
[0m23:53:28.984227 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m23:53:29.075573 [info ] [Thread-1 (]: 11 of 18 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.45s]
[0m23:53:29.076999 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m23:53:29.077960 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:53:29.079039 [info ] [Thread-1 (]: 12 of 18 START test not_null_rsi_trade_date .................................... [RUN]
[0m23:53:29.080076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m23:53:29.080848 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:53:29.085633 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m23:53:29.101709 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:53:29.105041 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m23:53:29.121352 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m23:53:29.122409 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m23:53:29.123254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:29.454288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.331 seconds
[0m23:53:29.457514 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m23:53:29.563612 [info ] [Thread-1 (]: 12 of 18 PASS not_null_rsi_trade_date .......................................... [[32mPASS[0m in 0.48s]
[0m23:53:29.564798 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m23:53:29.565700 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:53:29.566555 [info ] [Thread-1 (]: 13 of 18 START test not_null_stock_indicators_rsi_14d .......................... [RUN]
[0m23:53:29.567442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m23:53:29.568226 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:53:29.572491 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m23:53:29.591343 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:53:29.594688 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m23:53:29.608299 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m23:53:29.609068 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m23:53:29.609732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:29.976748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m23:53:29.979193 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m23:53:30.077481 [info ] [Thread-1 (]: 13 of 18 PASS not_null_stock_indicators_rsi_14d ................................ [[32mPASS[0m in 0.51s]
[0m23:53:30.079151 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m23:53:30.080401 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:53:30.081651 [info ] [Thread-1 (]: 14 of 18 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m23:53:30.082829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m23:53:30.083828 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:53:30.089209 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m23:53:30.119913 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:53:30.125074 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m23:53:30.152187 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m23:53:30.153236 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m23:53:30.154022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:30.478014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m23:53:30.480669 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m23:53:30.579938 [info ] [Thread-1 (]: 14 of 18 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.50s]
[0m23:53:30.581427 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m23:53:30.582646 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:53:30.583805 [info ] [Thread-1 (]: 15 of 18 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m23:53:30.585208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m23:53:30.586180 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:53:30.591713 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m23:53:30.622217 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:53:30.626072 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m23:53:30.657448 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m23:53:30.659153 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m23:53:30.660029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:30.981235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m23:53:30.984180 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m23:53:31.095851 [info ] [Thread-1 (]: 15 of 18 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.51s]
[0m23:53:31.098184 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m23:53:31.099600 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:53:31.101039 [info ] [Thread-1 (]: 16 of 18 START test not_null_volume_summary_symbol ............................. [RUN]
[0m23:53:31.102174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m23:53:31.103281 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:53:31.109205 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m23:53:31.143660 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:53:31.146898 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m23:53:31.177178 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m23:53:31.178227 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m23:53:31.179071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:31.511720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m23:53:31.514426 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m23:53:31.611493 [info ] [Thread-1 (]: 16 of 18 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.51s]
[0m23:53:31.612745 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m23:53:31.613610 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:53:31.614515 [info ] [Thread-1 (]: 17 of 18 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m23:53:31.615285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m23:53:31.615852 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:53:31.620521 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m23:53:31.642223 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:53:31.645897 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m23:53:31.672036 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m23:53:31.673315 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m23:53:31.674608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:31.999008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m23:53:32.004014 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m23:53:32.098899 [info ] [Thread-1 (]: 17 of 18 PASS not_null_volume_summary_total_volume ............................. [[32mPASS[0m in 0.48s]
[0m23:53:32.100966 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m23:53:32.102688 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:53:32.104275 [info ] [Thread-1 (]: 18 of 18 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m23:53:32.106005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m23:53:32.107293 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:53:32.112855 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m23:53:32.143159 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:53:32.146600 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m23:53:32.173487 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m23:53:32.174751 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m23:53:32.175736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:32.582463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m23:53:32.585030 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m23:53:32.701327 [info ] [Thread-1 (]: 18 of 18 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.59s]
[0m23:53:32.702589 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m23:53:32.704808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:32.705488 [debug] [MainThread]: Connection 'test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15' was properly closed.
[0m23:53:32.706333 [info ] [MainThread]: 
[0m23:53:32.707234 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 9.06 seconds (9.06s).
[0m23:53:32.710052 [debug] [MainThread]: Command end result
[0m23:53:32.897186 [info ] [MainThread]: 
[0m23:53:32.898466 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m23:53:32.899317 [info ] [MainThread]: 
[0m23:53:32.900204 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:53:32.901136 [info ] [MainThread]: 
[0m23:53:32.902321 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:53:32.903122 [info ] [MainThread]: 
[0m23:53:32.904089 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:53:32.904851 [info ] [MainThread]: 
[0m23:53:32.905646 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:53:32.906625 [info ] [MainThread]: 
[0m23:53:32.907792 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=4 SKIP=0 TOTAL=18
[0m23:53:32.909500 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.949332, "process_user_time": 4.3436, "process_kernel_time": 1.790449, "process_mem_max_rss": "234756", "process_in_blocks": "2312", "process_out_blocks": "8", "command_success": false}
[0m23:53:32.910630 [debug] [MainThread]: Command `dbt test` failed at 23:53:32.910485 after 10.95 seconds
[0m23:53:32.911502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c7327500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c54d5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16909f3170>]}
[0m23:53:32.912279 [debug] [MainThread]: Flushing usage events
[0m00:02:47.156656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b04ca270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b079e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b072bbf0>]}


============================== 00:02:47.163791 | 4e0ea4b8-6b2d-407c-88a4-442955aac796 ==============================
[0m00:02:47.163791 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:02:47.164981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:02:48.169874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777a963170>]}
[0m00:02:48.229348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b04ca270>]}
[0m00:02:48.231052 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:02:48.321165 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:02:48.806533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:02:48.808239 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:02:48.809672 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m00:02:49.007602 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:02:49.009273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777aec1970>]}
[0m00:02:49.196820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777a224470>]}
[0m00:02:49.391513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7778191310>]}
[0m00:02:49.392895 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:02:49.393701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777a903a40>]}
[0m00:02:49.397259 [info ] [MainThread]: 
[0m00:02:49.398714 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:02:49.404213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:02:49.420217 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:02:49.421263 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:02:49.421997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:49.878261 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.456 seconds
[0m00:02:49.880947 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:02:49.997283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:02:50.006643 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:02:50.007697 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:02:50.008649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:02:50.323582 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.315 seconds
[0m00:02:50.326422 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:02:50.419874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777a29d610>]}
[0m00:02:50.420889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:02:50.421607 [info ] [MainThread]: 
[0m00:02:50.432019 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:02:50.433505 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:02:50.434494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.moving_averages)
[0m00:02:50.435763 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:02:50.445093 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:02:50.459156 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:02:50.494262 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:02:50.518976 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:02:50.520053 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/moving_averages.sql
WITH staging AS (
    SELECT DISTINCT  -- Ensures unique rows in source data
        DATE AS trade_date,
        SYMBOL AS symbol,
        CLOSE AS close_price
    FROM USER_DB_BLUEJAY.raw.STOCK
),

moving_avg_calc AS (
    SELECT
        trade_date,
        symbol,
        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS close_price_7d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS close_price_14d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS close_price_30d_ma
    FROM staging
)

SELECT DISTINCT * FROM moving_avg_calc  -- Ensures distinct rows in final output
ORDER BY symbol, trade_date;
[0m00:02:50.520975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:50.821855 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe442-0205-0f94-0004-59ff002d14de
[0m00:02:50.823061 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 27 unexpected ';'.
[0m00:02:50.823940 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:02:50.917276 [debug] [Thread-1 (]: Database Error in model moving_averages (models/output/moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/moving_averages.sql
[0m00:02:50.919147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b0cf5b50>]}
[0m00:02:50.920143 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model analytics.moving_averages ................ [[31mERROR[0m in 0.48s]
[0m00:02:50.921261 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:02:50.922020 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:02:50.923208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.stock)
[0m00:02:50.924035 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:02:50.927540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:02:50.942733 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:02:50.943511 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:02:50.944461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:02:50.945032 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:02:50.949114 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:02:50.961300 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:02:50.962456 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:02:50.963613 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:02:50.964785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:02:50.965511 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:02:50.968213 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:02:50.984971 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:02:50.988817 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:02:51.003201 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:02:51.004050 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (-- models/stock_indicators.sql
with staging as (
  select
    date            as trade_date,
    symbol,
    close,
    lag(close) over (partition by symbol order by date) as prev_close
  from raw.stock
),
base as (
  select
    trade_date,
    symbol,
    close,
    prev_close
  from staging
),
gains_losses as (
  select
    trade_date,
    symbol,
    greatest(close - prev_close, 0) as gain,
    greatest(prev_close - close, 0) as loss
  from base
),
avg_gain_loss as (
  select
    trade_date,
    symbol,
    avg(gain) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_gain,
    avg(loss) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_loss
  from gains_losses
),
final as (
  select
    trade_date,
    symbol,
    coalesce(
      case
        when avg_loss = 0 then 100
        else 100 - (100 / (1 + (avg_gain / avg_loss)))
      end,
      0
    ) as rsi_14d
  from avg_gain_loss
)

select * from final
        );
[0m00:02:51.004730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:51.903783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m00:02:51.927474 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:02:52.047151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777a8c2c30>]}
[0m00:02:52.048990 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.08s]
[0m00:02:52.050508 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:02:52.051573 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:02:52.052524 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:02:52.053423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:02:52.054330 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:02:52.058111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:02:52.085228 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:02:52.088958 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:02:52.114375 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:02:52.115671 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/volume_summary.sql
with staging as (
  select
    DATE    as trade_date,
    SYMBOL  as symbol,
    VOLUME  as volume
  from USER_DB_BLUEJAY.raw.STOCK
)

select
  trade_date,
  symbol,
  sum(volume) as total_volume
from staging
group by trade_date, symbol
        );
[0m00:02:52.116826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:53.286997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.170 seconds
[0m00:02:53.291308 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:02:53.385674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7771c77080>]}
[0m00:02:53.387447 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.33s]
[0m00:02:53.388799 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:02:53.389843 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:02:53.390914 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:02:53.391964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.rsi)
[0m00:02:53.392965 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:02:53.409742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:02:53.432372 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:02:53.436508 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:02:53.464681 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:02:53.466033 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/rsi.sql
WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT s1.symbol, s1.trade_date, s1.close, s2.close AS prev_close
    FROM __dbt__cte__stock s1
    LEFT JOIN __dbt__cte__stock s2
        ON s1.symbol = s2.symbol AND s1.trade_date = DATEADD(day, 1, s2.trade_date)  -- Get previous day's close
),

gains_losses AS (
    SELECT 
        symbol, trade_date, 
        GREATEST(close - prev_close, 0) AS gain, 
        GREATEST(prev_close - close, 0) AS loss
    FROM base
),

avg_calc AS (
    SELECT gl.symbol, gl.trade_date, 
        (SELECT AVG(gain) FROM gains_losses g WHERE g.symbol = gl.symbol AND g.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_gain_14d,
        (SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_loss_14d
    FROM gains_losses gl
),

rsi_final AS (
    SELECT symbol, trade_date, 
        CASE 
            WHEN avg_loss_14d = 0 THEN 100
            ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
        END AS rsi_14d
    FROM avg_calc
)

SELECT DISTINCT * FROM rsi_final  -- Ensure distinct values
ORDER BY symbol, trade_date;
[0m00:02:53.467132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:02:53.753001 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe442-0205-0c96-0004-59ff002ceee2
[0m00:02:53.754270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 48 at position 27 unexpected ';'.
[0m00:02:53.755872 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:02:53.876770 [debug] [Thread-1 (]: Database Error in model rsi (models/output/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m00:02:53.878029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e0ea4b8-6b2d-407c-88a4-442955aac796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7771ca7950>]}
[0m00:02:53.879496 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.rsi ............................ [[31mERROR[0m in 0.49s]
[0m00:02:53.880870 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:02:53.882855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:53.883818 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:02:53.884631 [info ] [MainThread]: 
[0m00:02:53.885518 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m00:02:53.886818 [debug] [MainThread]: Command end result
[0m00:02:54.067317 [info ] [MainThread]: 
[0m00:02:54.068804 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:02:54.070042 [info ] [MainThread]: 
[0m00:02:54.071261 [error] [MainThread]:   Database Error in model moving_averages (models/output/moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/moving_averages.sql
[0m00:02:54.072267 [info ] [MainThread]: 
[0m00:02:54.073162 [error] [MainThread]:   Database Error in model rsi (models/output/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m00:02:54.074421 [info ] [MainThread]: 
[0m00:02:54.075445 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m00:02:54.077198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.006187, "process_user_time": 4.107037, "process_kernel_time": 2.002939, "process_mem_max_rss": "252380", "process_in_blocks": "400", "process_out_blocks": "8", "command_success": false}
[0m00:02:54.078596 [debug] [MainThread]: Command `dbt run` failed at 00:02:54.078310 after 7.01 seconds
[0m00:02:54.080006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b079e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b050d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b050dfd0>]}
[0m00:02:54.081425 [debug] [MainThread]: Flushing usage events
[0m00:03:35.388802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16764cb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16770d5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167684d880>]}


============================== 00:03:35.395205 | b80ec263-62e7-4d3d-94ad-b6760b9e29bf ==============================
[0m00:03:35.395205 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:03:35.396689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:03:36.295418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f164469a3c0>]}
[0m00:03:36.366376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1644b3d4f0>]}
[0m00:03:36.368082 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:03:36.452492 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:03:36.800188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:03:36.801483 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m00:03:36.802755 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:03:37.011153 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:03:37.012395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1644355970>]}
[0m00:03:37.212844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163fe53e60>]}
[0m00:03:37.393111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163dca7bf0>]}
[0m00:03:37.394268 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:03:37.395247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16442c6300>]}
[0m00:03:37.398563 [info ] [MainThread]: 
[0m00:03:37.400001 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:03:37.405172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:03:37.420190 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:03:37.421517 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:03:37.422668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:37.872118 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.449 seconds
[0m00:03:37.874383 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:03:37.984598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:03:37.993663 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:03:37.994680 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:03:37.995536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:38.319462 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.324 seconds
[0m00:03:38.322216 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:03:38.436155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163fde4b30>]}
[0m00:03:38.437562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:38.438454 [info ] [MainThread]: 
[0m00:03:38.448556 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:03:38.449879 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:03:38.451208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.moving_averages)
[0m00:03:38.452171 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:03:38.460600 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:03:38.482047 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:03:38.512333 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:03:38.553760 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:03:38.554768 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/moving_averages.sql
WITH staging AS (
    SELECT DISTINCT  -- Ensures unique rows in source data
        DATE AS trade_date,
        SYMBOL AS symbol,
        CLOSE AS close_price
    FROM USER_DB_BLUEJAY.raw.STOCK
),

moving_avg_calc AS (
    SELECT
        trade_date,
        symbol,
        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS close_price_7d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS close_price_14d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS close_price_30d_ma
    FROM staging
)

SELECT DISTINCT * FROM moving_avg_calc  -- Ensures distinct rows in final output
ORDER BY symbol, trade_date
        );
[0m00:03:38.555842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:39.572772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.017 seconds
[0m00:03:39.600256 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:03:39.699535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163d10ae10>]}
[0m00:03:39.700971 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.25s]
[0m00:03:39.702141 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:03:39.703177 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:03:39.704287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.stock)
[0m00:03:39.705181 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:03:39.709130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:03:39.729648 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:03:39.730764 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:03:39.731700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:03:39.732495 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:03:39.736505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:03:39.756563 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:03:39.757481 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:03:39.758302 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:03:39.759085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:03:39.759607 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:03:39.761888 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:03:39.775063 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:03:39.780330 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:03:39.798589 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:03:39.799600 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (-- models/stock_indicators.sql
with staging as (
  select
    date            as trade_date,
    symbol,
    close,
    lag(close) over (partition by symbol order by date) as prev_close
  from raw.stock
),
base as (
  select
    trade_date,
    symbol,
    close,
    prev_close
  from staging
),
gains_losses as (
  select
    trade_date,
    symbol,
    greatest(close - prev_close, 0) as gain,
    greatest(prev_close - close, 0) as loss
  from base
),
avg_gain_loss as (
  select
    trade_date,
    symbol,
    avg(gain) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_gain,
    avg(loss) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_loss
  from gains_losses
),
final as (
  select
    trade_date,
    symbol,
    coalesce(
      case
        when avg_loss = 0 then 100
        else 100 - (100 / (1 + (avg_gain / avg_loss)))
      end,
      0
    ) as rsi_14d
  from avg_gain_loss
)

select * from final
        );
[0m00:03:39.800474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:40.616755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m00:03:40.619946 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:03:40.765639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163d16bf80>]}
[0m00:03:40.767125 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.01s]
[0m00:03:40.768537 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:03:40.769404 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:03:40.770477 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:03:40.771480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:03:40.772568 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:03:40.776893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:03:40.793322 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:03:40.797292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:03:40.819129 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:03:40.820070 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/volume_summary.sql
with staging as (
  select
    DATE    as trade_date,
    SYMBOL  as symbol,
    VOLUME  as volume
  from USER_DB_BLUEJAY.raw.STOCK
)

select
  trade_date,
  symbol,
  sum(volume) as total_volume
from staging
group by trade_date, symbol
        );
[0m00:03:40.820867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:41.575684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m00:03:41.578787 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:03:41.676167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163d1347a0>]}
[0m00:03:41.677563 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 0.90s]
[0m00:03:41.679052 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:03:41.680463 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:03:41.682151 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:03:41.683332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.rsi)
[0m00:03:41.684327 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:03:41.703434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:03:41.724510 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:03:41.730171 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:03:41.751161 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:03:41.752459 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/rsi.sql
WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT s1.symbol, s1.trade_date, s1.close, s2.close AS prev_close
    FROM __dbt__cte__stock s1
    LEFT JOIN __dbt__cte__stock s2
        ON s1.symbol = s2.symbol AND s1.trade_date = DATEADD(day, 1, s2.trade_date)  -- Get previous day's close
),

gains_losses AS (
    SELECT 
        symbol, trade_date, 
        GREATEST(close - prev_close, 0) AS gain, 
        GREATEST(prev_close - close, 0) AS loss
    FROM base
),

avg_calc AS (
    SELECT gl.symbol, gl.trade_date, 
        (SELECT AVG(gain) FROM gains_losses g WHERE g.symbol = gl.symbol AND g.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_gain_14d,
        (SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_loss_14d
    FROM gains_losses gl
),

rsi_final AS (
    SELECT symbol, trade_date, 
        CASE 
            WHEN avg_loss_14d = 0 THEN 100
            ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
        END AS rsi_14d
    FROM avg_calc
)

SELECT DISTINCT * FROM rsi_final  -- Ensure distinct values
ORDER BY symbol, trade_date
        );
[0m00:03:41.753726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:43.227527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.474 seconds
[0m00:03:43.230755 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:03:43.364446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b80ec263-62e7-4d3d-94ad-b6760b9e29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16775c3860>]}
[0m00:03:43.365898 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.68s]
[0m00:03:43.366969 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:03:43.369203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:43.369974 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:03:43.370793 [info ] [MainThread]: 
[0m00:03:43.371573 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m00:03:43.372845 [debug] [MainThread]: Command end result
[0m00:03:43.538357 [info ] [MainThread]: 
[0m00:03:43.539401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:03:43.540109 [info ] [MainThread]: 
[0m00:03:43.540872 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:03:43.542130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.241429, "process_user_time": 3.869173, "process_kernel_time": 2.013954, "process_mem_max_rss": "235724", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:03:43.542972 [debug] [MainThread]: Command `dbt run` succeeded at 00:03:43.542865 after 8.24 seconds
[0m00:03:43.543585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16760578f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163dba8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163dc0ab10>]}
[0m00:03:43.544231 [debug] [MainThread]: Flushing usage events
[0m00:03:47.636078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e444b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e37cbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e4448260>]}


============================== 00:03:47.641465 | 09991d49-07d8-4d74-ab37-51a87b6739a3 ==============================
[0m00:03:47.641465 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:03:47.642344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:03:48.499845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09991d49-07d8-4d74-ab37-51a87b6739a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b2586240>]}
[0m00:03:48.545653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09991d49-07d8-4d74-ab37-51a87b6739a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b2d8c5f0>]}
[0m00:03:48.547284 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:03:48.628769 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:03:49.106559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:03:49.107902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:03:49.158186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09991d49-07d8-4d74-ab37-51a87b6739a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e68e0a40>]}
[0m00:03:49.373601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09991d49-07d8-4d74-ab37-51a87b6739a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e31b37a0>]}
[0m00:03:49.374500 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:03:49.375161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09991d49-07d8-4d74-ab37-51a87b6739a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b31dcc50>]}
[0m00:03:49.378762 [info ] [MainThread]: 
[0m00:03:49.380044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:03:49.385184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:03:49.401491 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:03:49.402509 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:03:49.403299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:49.852608 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.449 seconds
[0m00:03:49.855656 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:03:49.954571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09991d49-07d8-4d74-ab37-51a87b6739a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b1370c50>]}
[0m00:03:49.955955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:49.956748 [info ] [MainThread]: 
[0m00:03:49.969016 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m00:03:49.970039 [info ] [Thread-1 (]: 1 of 18 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date  [RUN]
[0m00:03:49.971111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19)
[0m00:03:49.972125 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m00:03:49.990327 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:03:49.991447 [error] [Thread-1 (]: 1 of 18 ERROR dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date  [[31mERROR[0m in 0.02s]
[0m00:03:49.992428 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m00:03:49.993194 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m00:03:49.994826 [info ] [Thread-1 (]: 2 of 18 START test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date  [RUN]
[0m00:03:49.996034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d)
[0m00:03:49.997042 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m00:03:50.002799 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:03:50.004018 [error] [Thread-1 (]: 2 of 18 ERROR dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date ... [[31mERROR[0m in 0.01s]
[0m00:03:50.005170 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m00:03:50.006169 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m00:03:50.007041 [info ] [Thread-1 (]: 3 of 18 START test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date  [RUN]
[0m00:03:50.008030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9)
[0m00:03:50.008911 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m00:03:50.014317 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:03:50.015792 [error] [Thread-1 (]: 3 of 18 ERROR dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date  [[31mERROR[0m in 0.01s]
[0m00:03:50.017024 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m00:03:50.018047 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m00:03:50.019033 [info ] [Thread-1 (]: 4 of 18 START test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date  [RUN]
[0m00:03:50.020125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d)
[0m00:03:50.021139 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m00:03:50.026377 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:03:50.027573 [error] [Thread-1 (]: 4 of 18 ERROR dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date  [[31mERROR[0m in 0.01s]
[0m00:03:50.029119 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m00:03:50.030222 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:03:50.031341 [info ] [Thread-1 (]: 5 of 18 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:03:50.032350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:03:50.033374 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:03:50.042986 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:03:50.063356 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:03:50.083404 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:03:50.104518 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:03:50.105337 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:03:50.106132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:50.512047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m00:03:50.520951 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:03:50.626118 [info ] [Thread-1 (]: 5 of 18 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.59s]
[0m00:03:50.628302 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:03:50.629781 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:03:50.631032 [info ] [Thread-1 (]: 6 of 18 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:03:50.632381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:03:50.633590 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:03:50.639452 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:03:50.670001 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:03:50.673409 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:03:50.702002 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:03:50.703106 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:03:50.704008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:51.148073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m00:03:51.150585 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:03:51.257716 [info ] [Thread-1 (]: 6 of 18 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.62s]
[0m00:03:51.259685 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:03:51.261015 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:03:51.263128 [info ] [Thread-1 (]: 7 of 18 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:03:51.265202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:03:51.266965 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:03:51.272711 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:03:51.302891 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:03:51.306686 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:03:51.325768 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:03:51.326611 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:03:51.327456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:51.774022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m00:03:51.778513 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:03:51.895976 [info ] [Thread-1 (]: 7 of 18 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.63s]
[0m00:03:51.897486 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:03:51.898439 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:03:51.899349 [info ] [Thread-1 (]: 8 of 18 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:03:51.900419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:03:51.901210 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:03:51.906815 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:03:51.926601 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:03:51.931181 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:03:51.946756 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:03:51.947848 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:03:51.948646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:52.422361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m00:03:52.425030 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:03:52.531158 [info ] [Thread-1 (]: 8 of 18 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.63s]
[0m00:03:52.533290 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:03:52.534711 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:03:52.535999 [info ] [Thread-1 (]: 9 of 18 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:03:52.537249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:03:52.538329 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:03:52.544375 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:03:52.567685 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:03:52.571739 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:03:52.596035 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:03:52.597145 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:03:52.598362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:52.900620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m00:03:52.903655 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:03:53.015562 [info ] [Thread-1 (]: 9 of 18 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.48s]
[0m00:03:53.017023 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:03:53.017918 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:03:53.018693 [info ] [Thread-1 (]: 10 of 18 START test not_null_rsi_rsi_14d ....................................... [RUN]
[0m00:03:53.019735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:03:53.020764 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:03:53.026551 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:03:53.050849 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:03:53.054751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:03:53.073898 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:03:53.075026 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:03:53.075864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:53.419002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m00:03:53.423943 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:03:53.543093 [error] [Thread-1 (]: 10 of 18 FAIL 3 not_null_rsi_rsi_14d ........................................... [[31mFAIL 3[0m in 0.52s]
[0m00:03:53.544940 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:03:53.546474 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:03:53.547639 [info ] [Thread-1 (]: 11 of 18 START test not_null_rsi_symbol ........................................ [RUN]
[0m00:03:53.548940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:03:53.550063 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:03:53.556615 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:03:53.577098 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:03:53.581449 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:03:53.606552 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:03:53.607816 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:03:53.609116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:54.020241 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m00:03:54.023242 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:03:54.122725 [info ] [Thread-1 (]: 11 of 18 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.57s]
[0m00:03:54.124656 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:03:54.125901 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:03:54.127105 [info ] [Thread-1 (]: 12 of 18 START test not_null_rsi_trade_date .................................... [RUN]
[0m00:03:54.128794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:03:54.129898 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:03:54.135010 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:03:54.163402 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:03:54.167264 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:03:54.201033 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:03:54.202273 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:03:54.203331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:54.474776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m00:03:54.479365 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:03:54.575784 [info ] [Thread-1 (]: 12 of 18 PASS not_null_rsi_trade_date .......................................... [[32mPASS[0m in 0.45s]
[0m00:03:54.577658 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:03:54.579250 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:03:54.580598 [info ] [Thread-1 (]: 13 of 18 START test not_null_stock_indicators_rsi_14d .......................... [RUN]
[0m00:03:54.581909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:03:54.582925 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:03:54.587953 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:03:54.615611 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:03:54.619086 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:03:54.635680 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:03:54.636677 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:03:54.637390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:55.006099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m00:03:55.008951 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:03:55.119597 [info ] [Thread-1 (]: 13 of 18 PASS not_null_stock_indicators_rsi_14d ................................ [[32mPASS[0m in 0.54s]
[0m00:03:55.121067 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:03:55.122132 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:03:55.123082 [info ] [Thread-1 (]: 14 of 18 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:03:55.124034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:03:55.124913 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:03:55.130154 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:03:55.160629 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:03:55.164734 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:03:55.197097 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:03:55.198357 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:03:55.199358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:55.635668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.436 seconds
[0m00:03:55.638073 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:03:55.732256 [info ] [Thread-1 (]: 14 of 18 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.61s]
[0m00:03:55.733392 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:03:55.734171 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:03:55.734879 [info ] [Thread-1 (]: 15 of 18 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:03:55.735763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:03:55.736687 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:03:55.742028 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:03:55.760008 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:03:55.763739 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:03:55.781480 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:03:55.782289 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:03:55.782964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:56.065188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m00:03:56.069337 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:03:56.162577 [info ] [Thread-1 (]: 15 of 18 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.43s]
[0m00:03:56.164700 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:03:56.166038 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:03:56.167190 [info ] [Thread-1 (]: 16 of 18 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:03:56.168626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:03:56.169761 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:03:56.174760 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:03:56.205139 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:03:56.208557 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:03:56.235439 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:03:56.236681 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:03:56.237594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:56.671570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.434 seconds
[0m00:03:56.674335 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:03:56.766460 [info ] [Thread-1 (]: 16 of 18 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.60s]
[0m00:03:56.767695 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:03:56.768635 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:03:56.769346 [info ] [Thread-1 (]: 17 of 18 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:03:56.770232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:03:56.771090 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:03:56.776286 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:03:56.792974 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:03:56.796582 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:03:56.809450 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:03:56.810222 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:03:56.811025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:57.186013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m00:03:57.188967 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:03:57.307339 [info ] [Thread-1 (]: 17 of 18 PASS not_null_volume_summary_total_volume ............................. [[32mPASS[0m in 0.54s]
[0m00:03:57.309298 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:03:57.310794 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:03:57.312257 [info ] [Thread-1 (]: 18 of 18 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:03:57.313979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:03:57.315492 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:03:57.321065 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:03:57.355260 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:03:57.359565 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:03:57.383305 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:03:57.384419 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:03:57.385298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:57.657346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m00:03:57.662593 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:03:57.783320 [info ] [Thread-1 (]: 18 of 18 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.47s]
[0m00:03:57.785066 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:03:57.788401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:57.789621 [debug] [MainThread]: Connection 'test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15' was properly closed.
[0m00:03:57.790823 [info ] [MainThread]: 
[0m00:03:57.792001 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 8.41 seconds (8.41s).
[0m00:03:57.795408 [debug] [MainThread]: Command end result
[0m00:03:57.980836 [info ] [MainThread]: 
[0m00:03:57.982099 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m00:03:57.983092 [info ] [MainThread]: 
[0m00:03:57.984198 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:03:57.985204 [info ] [MainThread]: 
[0m00:03:57.985990 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:03:57.986537 [info ] [MainThread]: 
[0m00:03:57.987486 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:03:57.988225 [info ] [MainThread]: 
[0m00:03:57.988957 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:03:57.989758 [info ] [MainThread]: 
[0m00:03:57.990445 [error] [MainThread]: [31mFailure in test not_null_rsi_rsi_14d (models/output/schema.yml)[0m
[0m00:03:57.991060 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m00:03:57.991709 [info ] [MainThread]: 
[0m00:03:57.992532 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/not_null_rsi_rsi_14d.sql
[0m00:03:57.993372 [info ] [MainThread]: 
[0m00:03:57.994324 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=5 SKIP=0 TOTAL=18
[0m00:03:57.995834 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.427028, "process_user_time": 4.151844, "process_kernel_time": 1.943286, "process_mem_max_rss": "238520", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:03:57.997312 [debug] [MainThread]: Command `dbt test` failed at 00:03:57.997169 after 10.43 seconds
[0m00:03:57.998228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e449a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6b1addd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e37f2b40>]}
[0m00:03:57.999076 [debug] [MainThread]: Flushing usage events
[0m00:12:07.964563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0375edfef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0372c4f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03733f0bf0>]}


============================== 00:12:07.972404 | 63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e ==============================
[0m00:12:07.972404 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:12:07.973762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:12:08.918805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f034113d970>]}
[0m00:12:08.966766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0340e17320>]}
[0m00:12:08.968267 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:12:09.045755 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:12:09.335677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:12:09.337267 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:12:09.338461 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/volume_summary.sql
[0m00:12:09.530109 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:12:09.531531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0340ad92b0>]}
[0m00:12:09.711907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033b74a300>]}
[0m00:12:09.920782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033b759ca0>]}
[0m00:12:09.922424 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:12:09.923733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033b7c79e0>]}
[0m00:12:09.926676 [info ] [MainThread]: 
[0m00:12:09.928149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:12:09.932777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:12:09.946277 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:12:09.947487 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:12:09.948573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:10.424719 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.476 seconds
[0m00:12:10.426904 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:12:10.527325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:12:10.538365 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:12:10.539790 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:12:10.540976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:10.812714 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.272 seconds
[0m00:12:10.815158 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:12:10.906618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033b72d9a0>]}
[0m00:12:10.907889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:10.908753 [info ] [MainThread]: 
[0m00:12:10.918609 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:12:10.919883 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:12:10.921300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.moving_averages)
[0m00:12:10.922171 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:12:10.931133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:12:10.946272 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:12:10.976931 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:12:10.998634 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:12:10.999507 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/moving_averages.sql
WITH staging AS (
    SELECT   -- Ensures unique rows in source data
        DATE AS trade_date,
        SYMBOL AS symbol,
        CLOSE AS close_price
    FROM USER_DB_BLUEJAY.raw.STOCK
),

moving_avg_calc AS (
    SELECT
        trade_date,
        symbol,
        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS close_price_7d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS close_price_14d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS close_price_30d_ma
    FROM staging
)

SELECT DISTINCT * FROM moving_avg_calc  -- Ensures distinct rows in final output
ORDER BY symbol, trade_date
        );
[0m00:12:11.000270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:12.495930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m00:12:12.522027 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:12:12.641831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0340ddab70>]}
[0m00:12:12.643230 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.72s]
[0m00:12:12.644590 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:12:12.645662 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:12:12.646869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.stock)
[0m00:12:12.648100 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:12:12.651477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:12:12.680907 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:12:12.682110 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:12:12.683142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:12:12.684261 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:12:12.688395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:12:12.711405 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:12:12.712523 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:12:12.713684 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:12:12.714672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:12:12.715561 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:12:12.718293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:12:12.743289 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:12:12.748628 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:12:12.773314 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:12:12.774537 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (-- models/stock_indicators.sql
with staging as (
  select
    date            as trade_date,
    symbol,
    close,
    lag(close) over (partition by symbol order by date) as prev_close
  from raw.stock
),
base as (
  select
    trade_date,
    symbol,
    close,
    prev_close
  from staging
),
gains_losses as (
  select
    trade_date,
    symbol,
    greatest(close - prev_close, 0) as gain,
    greatest(prev_close - close, 0) as loss
  from base
),
avg_gain_loss as (
  select
    trade_date,
    symbol,
    avg(gain) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_gain,
    avg(loss) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_loss
  from gains_losses
),
final as (
  select
    trade_date,
    symbol,
    coalesce(
      case
        when avg_loss = 0 then 100
        else 100 - (100 / (1 + (avg_gain / avg_loss)))
      end,
      0
    ) as rsi_14d
  from avg_gain_loss
)

select * from final
        );
[0m00:12:12.776877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:14.029515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.252 seconds
[0m00:12:14.035110 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:12:14.151548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033ac483e0>]}
[0m00:12:14.153851 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.44s]
[0m00:12:14.156082 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:12:14.157744 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:12:14.159195 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:12:14.160617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:12:14.161786 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:12:14.165615 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:12:14.192762 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:12:14.196582 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:12:14.223557 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:12:14.225228 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/volume_summary.sql
with staging as (
  select distinct
    DATE    as trade_date,
    SYMBOL  as symbol,
    VOLUME  as volume
  from USER_DB_BLUEJAY.raw.STOCK
)

select
  trade_date,
  symbol,
  sum(volume) as total_volume
from staging
group by trade_date, symbol
        );
[0m00:12:14.226597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:15.267659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.041 seconds
[0m00:12:15.271117 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:12:15.407003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033ac22420>]}
[0m00:12:15.408358 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.25s]
[0m00:12:15.409349 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:12:15.410196 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:12:15.411036 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:12:15.411887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.rsi)
[0m00:12:15.412510 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:12:15.429131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:12:15.452658 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:12:15.458414 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:12:15.478601 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:12:15.480118 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/rsi.sql
WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT s1.symbol, s1.trade_date, s1.close, s2.close AS prev_close
    FROM __dbt__cte__stock s1
    LEFT JOIN __dbt__cte__stock s2
        ON s1.symbol = s2.symbol AND s1.trade_date = DATEADD(day, 1, s2.trade_date)  -- Get previous day's close
),

gains_losses AS (
    SELECT 
        symbol, trade_date, 
        GREATEST(close - prev_close, 0) AS gain, 
        GREATEST(prev_close - close, 0) AS loss
    FROM base
),

avg_calc AS (
    SELECT gl.symbol, gl.trade_date, 
        (SELECT AVG(gain) FROM gains_losses g WHERE g.symbol = gl.symbol AND g.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_gain_14d,
        (SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_loss_14d
    FROM gains_losses gl
),

rsi_final AS (
    SELECT symbol, trade_date, 
        CASE 
            WHEN avg_loss_14d = 0 THEN 100
            ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
        END AS rsi_14d
    FROM avg_calc
)

SELECT DISTINCT * FROM rsi_final  -- Ensure distinct values
ORDER BY symbol, trade_date
        );
[0m00:12:15.481424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:16.816408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.339 seconds
[0m00:12:16.819724 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:12:16.919805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63b40d1c-8330-4994-b1ee-6f7fd6cc3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0373eebaa0>]}
[0m00:12:16.921106 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.51s]
[0m00:12:16.922326 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:12:16.925184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:16.926209 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:12:16.927285 [info ] [MainThread]: 
[0m00:12:16.928346 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m00:12:16.929970 [debug] [MainThread]: Command end result
[0m00:12:17.152952 [info ] [MainThread]: 
[0m00:12:17.154219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:12:17.155262 [info ] [MainThread]: 
[0m00:12:17.156356 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:12:17.158157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.302739, "process_user_time": 3.875805, "process_kernel_time": 2.017406, "process_mem_max_rss": "246988", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:12:17.159288 [debug] [MainThread]: Command `dbt run` succeeded at 00:12:17.159104 after 9.30 seconds
[0m00:12:17.160218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0372d136b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033acd23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033acd3050>]}
[0m00:12:17.161283 [debug] [MainThread]: Flushing usage events
[0m00:12:20.977981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35db6152b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ddfe6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35dd184170>]}


============================== 00:12:20.983998 | c267d0b2-325e-4ef6-91e7-5a87f1edbc95 ==============================
[0m00:12:20.983998 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:12:20.985262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:12:21.825520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c267d0b2-325e-4ef6-91e7-5a87f1edbc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35db821c70>]}
[0m00:12:21.871678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c267d0b2-325e-4ef6-91e7-5a87f1edbc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35a9e71220>]}
[0m00:12:21.873308 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:12:21.976468 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:12:22.351130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:12:22.352036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:12:22.400517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c267d0b2-325e-4ef6-91e7-5a87f1edbc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35db628f80>]}
[0m00:12:22.600275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c267d0b2-325e-4ef6-91e7-5a87f1edbc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35a9150fe0>]}
[0m00:12:22.601682 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:12:22.602685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c267d0b2-325e-4ef6-91e7-5a87f1edbc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35a999b200>]}
[0m00:12:22.606116 [info ] [MainThread]: 
[0m00:12:22.607532 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:12:22.613259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:12:22.631762 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:12:22.633001 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:12:22.633988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:23.101955 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.468 seconds
[0m00:12:23.104519 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:12:23.223711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c267d0b2-325e-4ef6-91e7-5a87f1edbc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35a966bb00>]}
[0m00:12:23.224920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:23.225741 [info ] [MainThread]: 
[0m00:12:23.235459 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m00:12:23.236822 [info ] [Thread-1 (]: 1 of 18 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date  [RUN]
[0m00:12:23.238116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19)
[0m00:12:23.239065 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m00:12:23.254573 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:23.255894 [error] [Thread-1 (]: 1 of 18 ERROR dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date  [[31mERROR[0m in 0.02s]
[0m00:12:23.257107 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m00:12:23.258024 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m00:12:23.259276 [info ] [Thread-1 (]: 2 of 18 START test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date  [RUN]
[0m00:12:23.260069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d)
[0m00:12:23.260695 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m00:12:23.266469 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:23.267392 [error] [Thread-1 (]: 2 of 18 ERROR dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date ... [[31mERROR[0m in 0.01s]
[0m00:12:23.268536 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m00:12:23.269468 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m00:12:23.270249 [info ] [Thread-1 (]: 3 of 18 START test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date  [RUN]
[0m00:12:23.271281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9)
[0m00:12:23.272129 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m00:12:23.277487 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:23.278546 [error] [Thread-1 (]: 3 of 18 ERROR dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date  [[31mERROR[0m in 0.01s]
[0m00:12:23.279557 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m00:12:23.280605 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m00:12:23.281453 [info ] [Thread-1 (]: 4 of 18 START test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date  [RUN]
[0m00:12:23.282481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d)
[0m00:12:23.283445 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m00:12:23.288980 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:23.290195 [error] [Thread-1 (]: 4 of 18 ERROR dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date  [[31mERROR[0m in 0.01s]
[0m00:12:23.291391 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m00:12:23.292429 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:12:23.293274 [info ] [Thread-1 (]: 5 of 18 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:12:23.294365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:12:23.295252 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:12:23.307090 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:12:23.330171 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:12:23.352708 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:12:23.374502 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:12:23.375283 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:12:23.376121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:23.908401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m00:12:23.918434 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:12:24.017598 [info ] [Thread-1 (]: 5 of 18 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.72s]
[0m00:12:24.019239 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:12:24.020278 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:12:24.021186 [info ] [Thread-1 (]: 6 of 18 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:12:24.022203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:12:24.023040 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:12:24.028199 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:12:24.050225 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:12:24.053963 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:12:24.067625 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:12:24.068641 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:12:24.069596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:24.557272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m00:12:24.561562 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:12:24.675541 [info ] [Thread-1 (]: 6 of 18 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.65s]
[0m00:12:24.677000 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:12:24.678274 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:12:24.679351 [info ] [Thread-1 (]: 7 of 18 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:12:24.680538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:12:24.681340 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:12:24.686733 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:12:24.717017 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:12:24.722029 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:12:24.757795 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:12:24.759201 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:12:24.760298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:25.423115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m00:12:25.426585 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:12:25.552172 [info ] [Thread-1 (]: 7 of 18 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.87s]
[0m00:12:25.553418 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:12:25.554453 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:12:25.555432 [info ] [Thread-1 (]: 8 of 18 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:12:25.556546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:12:25.557411 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:12:25.563153 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:12:25.586185 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:12:25.590320 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:12:25.609503 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:12:25.610526 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:12:25.611409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:25.897124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m00:12:25.899474 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:12:26.033348 [info ] [Thread-1 (]: 8 of 18 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.48s]
[0m00:12:26.036539 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:12:26.038405 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:12:26.039672 [info ] [Thread-1 (]: 9 of 18 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:12:26.040898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:12:26.041988 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:12:26.046528 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:12:26.079072 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:12:26.082898 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:12:26.126662 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:12:26.127860 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:12:26.129017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:26.716130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.587 seconds
[0m00:12:26.720308 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:12:26.825324 [info ] [Thread-1 (]: 9 of 18 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.78s]
[0m00:12:26.826851 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:12:26.828046 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:12:26.829202 [info ] [Thread-1 (]: 10 of 18 START test not_null_rsi_rsi_14d ....................................... [RUN]
[0m00:12:26.830307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:12:26.831336 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:12:26.838340 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:12:26.868649 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:12:26.872628 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:12:26.899794 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:12:26.901053 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:12:26.902318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:27.246858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m00:12:27.250804 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:12:27.385553 [error] [Thread-1 (]: 10 of 18 FAIL 3 not_null_rsi_rsi_14d ........................................... [[31mFAIL 3[0m in 0.55s]
[0m00:12:27.387089 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:12:27.388475 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:12:27.389343 [info ] [Thread-1 (]: 11 of 18 START test not_null_rsi_symbol ........................................ [RUN]
[0m00:12:27.390496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:12:27.391533 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:12:27.397357 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:12:27.419563 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:12:27.423278 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:12:27.440870 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:12:27.441926 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:12:27.442854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:27.878277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m00:12:27.882675 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:12:27.993062 [info ] [Thread-1 (]: 11 of 18 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.60s]
[0m00:12:27.994640 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:12:27.995682 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:12:27.996808 [info ] [Thread-1 (]: 12 of 18 START test not_null_rsi_trade_date .................................... [RUN]
[0m00:12:27.997808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:12:27.998829 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:12:28.004795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:12:28.034487 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:12:28.038537 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:12:28.053998 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:12:28.054837 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:12:28.055501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:28.320402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m00:12:28.323706 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:12:28.427962 [info ] [Thread-1 (]: 12 of 18 PASS not_null_rsi_trade_date .......................................... [[32mPASS[0m in 0.43s]
[0m00:12:28.429474 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:12:28.430492 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:12:28.431630 [info ] [Thread-1 (]: 13 of 18 START test not_null_stock_indicators_rsi_14d .......................... [RUN]
[0m00:12:28.432751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:12:28.433622 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:12:28.440797 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:12:28.463481 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:12:28.467377 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:12:28.486800 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:12:28.487895 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:12:28.489016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:28.837391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m00:12:28.840180 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:12:28.944682 [info ] [Thread-1 (]: 13 of 18 PASS not_null_stock_indicators_rsi_14d ................................ [[32mPASS[0m in 0.51s]
[0m00:12:28.946467 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:12:28.947897 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:12:28.948965 [info ] [Thread-1 (]: 14 of 18 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:12:28.950176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:12:28.951250 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:12:28.956711 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:12:28.992613 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:12:28.996820 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:12:29.034672 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:12:29.036220 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:12:29.037585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:29.408817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.371 seconds
[0m00:12:29.413441 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:12:29.509439 [info ] [Thread-1 (]: 14 of 18 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.56s]
[0m00:12:29.511036 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:12:29.512094 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:12:29.512874 [info ] [Thread-1 (]: 15 of 18 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:12:29.513623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:12:29.514485 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:12:29.519649 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:12:29.555233 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:12:29.559245 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:12:29.590864 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:12:29.592228 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:12:29.593276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:29.889469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m00:12:29.892141 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:12:30.003244 [info ] [Thread-1 (]: 15 of 18 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.49s]
[0m00:12:30.005324 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:12:30.006386 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:12:30.007622 [info ] [Thread-1 (]: 16 of 18 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:12:30.008742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:12:30.009730 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:12:30.014660 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:12:30.039325 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:12:30.042923 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:12:30.062473 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:12:30.063542 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:12:30.064540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:30.413931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m00:12:30.416410 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:12:30.531280 [info ] [Thread-1 (]: 16 of 18 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.52s]
[0m00:12:30.533080 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:12:30.534448 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:12:30.535903 [info ] [Thread-1 (]: 17 of 18 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:12:30.537388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:12:30.538622 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:12:30.544253 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:12:30.574575 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:12:30.578895 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:12:30.615959 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:12:30.617381 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:12:30.618604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:31.166818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m00:12:31.170204 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:12:31.266492 [info ] [Thread-1 (]: 17 of 18 PASS not_null_volume_summary_total_volume ............................. [[32mPASS[0m in 0.73s]
[0m00:12:31.267877 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:12:31.269187 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:12:31.270626 [info ] [Thread-1 (]: 18 of 18 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:12:31.271853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:12:31.272726 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:12:31.278031 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:12:31.306280 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:12:31.309455 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:12:31.324120 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:12:31.324850 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:12:31.325421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:31.640991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m00:12:31.643848 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:12:31.757919 [info ] [Thread-1 (]: 18 of 18 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.49s]
[0m00:12:31.759670 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:12:31.762421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:31.763433 [debug] [MainThread]: Connection 'test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15' was properly closed.
[0m00:12:31.764330 [info ] [MainThread]: 
[0m00:12:31.765234 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 9.16 seconds (9.16s).
[0m00:12:31.768321 [debug] [MainThread]: Command end result
[0m00:12:31.965325 [info ] [MainThread]: 
[0m00:12:31.966577 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m00:12:31.968015 [info ] [MainThread]: 
[0m00:12:31.969792 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:31.971239 [info ] [MainThread]: 
[0m00:12:31.972698 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:31.973904 [info ] [MainThread]: 
[0m00:12:31.975116 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:31.976064 [info ] [MainThread]: 
[0m00:12:31.977030 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:31.977819 [info ] [MainThread]: 
[0m00:12:31.978829 [error] [MainThread]: [31mFailure in test not_null_rsi_rsi_14d (models/output/schema.yml)[0m
[0m00:12:31.979714 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m00:12:31.980557 [info ] [MainThread]: 
[0m00:12:31.981609 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/not_null_rsi_rsi_14d.sql
[0m00:12:31.982510 [info ] [MainThread]: 
[0m00:12:31.983405 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=5 SKIP=0 TOTAL=18
[0m00:12:31.985228 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 11.100043, "process_user_time": 4.036001, "process_kernel_time": 1.892621, "process_mem_max_rss": "240352", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:12:31.986684 [debug] [MainThread]: Command `dbt test` failed at 00:12:31.986554 after 11.10 seconds
[0m00:12:31.987656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35dc709e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35dc70a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35dc1ee9f0>]}
[0m00:12:31.988687 [debug] [MainThread]: Flushing usage events
[0m00:16:12.117155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1e4a6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b4b14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b4b12b0>]}


============================== 00:16:12.123620 | 80e43419-afbc-478b-8dc9-0be9c9ab4edd ==============================
[0m00:16:12.123620 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:16:12.124864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:16:13.066833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be939aba0>]}
[0m00:16:13.115912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be920b3e0>]}
[0m00:16:13.117621 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:16:13.189809 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:16:13.535764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:16:13.536888 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m00:16:13.537895 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/volume_summary.sql
[0m00:16:13.745432 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:16:13.746513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be8b3cd40>]}
[0m00:16:13.940678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be8df76e0>]}
[0m00:16:14.151530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be8df40e0>]}
[0m00:16:14.153242 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:16:14.154517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1af59d30>]}
[0m00:16:14.157932 [info ] [MainThread]: 
[0m00:16:14.159497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:16:14.164659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:16:14.178028 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:16:14.179422 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:16:14.180567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:14.657257 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.477 seconds
[0m00:16:14.659694 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:16:14.767626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:16:14.778219 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:16:14.779236 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:16:14.780158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:15.088598 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.308 seconds
[0m00:16:15.091053 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:16:15.230009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be8a2d2b0>]}
[0m00:16:15.231568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:15.232702 [info ] [MainThread]: 
[0m00:16:15.242334 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:16:15.243706 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:16:15.244790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.moving_averages)
[0m00:16:15.245754 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:16:15.254207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:16:15.279886 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:16:15.308688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:16:15.350573 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:16:15.352261 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/moving_averages.sql
WITH staging AS (
    SELECT   -- Ensures unique rows in source data
        DATE AS trade_date,
        SYMBOL AS symbol,
        CLOSE AS close_price
    FROM USER_DB_BLUEJAY.raw.STOCK
),

moving_avg_calc AS (
    SELECT
        trade_date,
        symbol,
        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS close_price_7d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS close_price_14d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS close_price_30d_ma
    FROM staging
)

SELECT DISTINCT * FROM moving_avg_calc  -- Ensures distinct rows in final output
ORDER BY symbol, trade_date
        );
[0m00:16:15.353965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:16.399591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.049 seconds
[0m00:16:16.425112 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:16:16.527578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b5198b0>]}
[0m00:16:16.529663 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.28s]
[0m00:16:16.530936 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:16:16.531989 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:16:16.532981 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:16:16.533885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m00:16:16.534859 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:16:16.538892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:16:16.565676 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:16:16.570055 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:16:16.588405 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:16:16.589410 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (with base_data as (
    select
        date as trade_date,
        symbol,
        close,
        row_number() over (partition by date, symbol order by close desc) as row_num
    from USER_DB_BLUEJAY.raw.STOCK
),

deduplicated as (
    select *
    from base_data
    where row_num = 1
),

rsi_calc as (
    select
        trade_date,
        symbol,
        close,
        avg(case when price_change > 0 then price_change else 0 end) over (
            partition by symbol
            order by trade_date
            rows between 13 preceding and current row
        ) as avg_gain,
        abs(avg(case when price_change < 0 then price_change else 0 end)) over (
            partition by symbol
            order by trade_date
            rows between 13 preceding and current row
        ) as avg_loss
    from (
        select *,
               close - lag(close) over (partition by symbol order by trade_date) as price_change
        from deduplicated
    ) t
),

final as (
    select
        trade_date,
        symbol,
        case
            when avg_loss = 0 then 100
            else round(100 - (100 / (1 + (avg_gain / nullif(avg_loss, 0)))), 2)
        end as rsi_14d
    from rsi_calc
)

select *
from (
    select *,
           row_number() over (partition by symbol, trade_date order by rsi_14d desc nulls last) as row_num
    from final
) t
where row_num = 1
        );
[0m00:16:16.590147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:16.989999 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe450-0205-0fb8-0004-59ff002d0b46
[0m00:16:16.991216 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002303 (0A000): SQL compilation error: error line 31 at position 12
Sliding window frame unsupported for function ABS
[0m00:16:16.992182 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:16:17.095810 [debug] [Thread-1 (]: Database Error in model rsi (models/output/rsi.sql)
  002303 (0A000): SQL compilation error: error line 31 at position 12
  Sliding window frame unsupported for function ABS
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m00:16:17.097103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be8a1ddc0>]}
[0m00:16:17.098327 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model analytics.rsi ............................ [[31mERROR[0m in 0.56s]
[0m00:16:17.099404 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:16:17.100349 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:16:17.101472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.rsi, now model.dbt_stock_project.stock)
[0m00:16:17.102389 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:16:17.106721 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:16:17.136071 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:16:17.136991 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:16:17.137745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:16:17.138408 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:16:17.141746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:16:17.156933 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:16:17.157862 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:16:17.158574 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:16:17.159424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:16:17.160031 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:16:17.162751 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:16:17.171992 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:16:17.175010 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:16:17.186439 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:16:17.187162 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (-- models/stock_indicators.sql
with staging as (
  select
    date            as trade_date,
    symbol,
    close,
    lag(close) over (partition by symbol order by date) as prev_close
  from raw.stock
),
base as (
  select
    trade_date,
    symbol,
    close,
    prev_close
  from staging
),
gains_losses as (
  select
    trade_date,
    symbol,
    greatest(close - prev_close, 0) as gain,
    greatest(prev_close - close, 0) as loss
  from base
),
avg_gain_loss as (
  select
    trade_date,
    symbol,
    avg(gain) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_gain,
    avg(loss) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_loss
  from gains_losses
),
final as (
  select
    trade_date,
    symbol,
    coalesce(
      case
        when avg_loss = 0 then 100
        else 100 - (100 / (1 + (avg_gain / avg_loss)))
      end,
      0
    ) as rsi_14d
  from avg_gain_loss
)

select * from final
        );
[0m00:16:17.187722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:17.985611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m00:16:17.988606 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:16:18.090807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be20d5f70>]}
[0m00:16:18.092341 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 0.93s]
[0m00:16:18.093774 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:16:18.094822 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:16:18.096090 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:16:18.097372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:16:18.098381 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:16:18.101978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:16:18.134027 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:16:18.137623 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:16:18.167752 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:16:18.169186 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/volume_summary.sql
with staging as (
    select
        date as trade_date,
        symbol,
        volume,
        row_number() over (partition by date, symbol order by volume desc) as row_num
    from USER_DB_BLUEJAY.raw.STOCK
),

deduplicated as (
    select *
    from staging
    where row_num = 1
),

aggregated as (
    select
        trade_date,
        symbol,
        sum(volume) as total_volume
    from deduplicated
    group by trade_date, symbol
)

select * from aggregated
        );
[0m00:16:18.170293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:19.095953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.925 seconds
[0m00:16:19.099025 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:16:19.212670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e43419-afbc-478b-8dc9-0be9c9ab4edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1be292bcb0>]}
[0m00:16:19.215019 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.11s]
[0m00:16:19.216748 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:16:19.219413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:19.220538 [debug] [MainThread]: Connection 'model.dbt_stock_project.volume_summary' was properly closed.
[0m00:16:19.221799 [info ] [MainThread]: 
[0m00:16:19.222962 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m00:16:19.224777 [debug] [MainThread]: Command end result
[0m00:16:19.398254 [info ] [MainThread]: 
[0m00:16:19.399275 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:16:19.400085 [info ] [MainThread]: 
[0m00:16:19.401236 [error] [MainThread]:   Database Error in model rsi (models/output/rsi.sql)
  002303 (0A000): SQL compilation error: error line 31 at position 12
  Sliding window frame unsupported for function ABS
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m00:16:19.402263 [info ] [MainThread]: 
[0m00:16:19.402982 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:16:19.404692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.3951907, "process_user_time": 3.8695, "process_kernel_time": 1.955009, "process_mem_max_rss": "254308", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:16:19.405979 [debug] [MainThread]: Command `dbt run` failed at 00:16:19.405778 after 7.40 seconds
[0m00:16:19.406921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1e4a6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1e068bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1d78e840>]}
[0m00:16:19.407814 [debug] [MainThread]: Flushing usage events
[0m00:17:40.038547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb945876030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9458c35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb945c7b2f0>]}


============================== 00:17:40.045855 | 42f3a5db-8d79-4403-a0b7-3a14c82b598a ==============================
[0m00:17:40.045855 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:17:40.047117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:17:40.869679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb946786960>]}
[0m00:17:40.918588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90fbb3590>]}
[0m00:17:40.920166 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:17:41.026560 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:17:41.497526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:17:41.498918 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m00:17:41.714390 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:17:41.715694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f6679b0>]}
[0m00:17:41.912486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90d707470>]}
[0m00:17:42.127532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f837470>]}
[0m00:17:42.129058 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:17:42.130242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90faf6180>]}
[0m00:17:42.133706 [info ] [MainThread]: 
[0m00:17:42.134982 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:42.140175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:17:42.153560 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:17:42.154919 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:17:42.156112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:42.691112 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.535 seconds
[0m00:17:42.693493 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:17:42.806035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:17:42.817327 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:17:42.818344 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:17:42.819248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:43.143806 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.325 seconds
[0m00:17:43.146538 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:17:43.237261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90d67bf80>]}
[0m00:17:43.238282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:17:43.239071 [info ] [MainThread]: 
[0m00:17:43.249156 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:17:43.250328 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:17:43.251377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.moving_averages)
[0m00:17:43.252042 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:17:43.260689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:17:43.281457 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:17:43.309164 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:17:43.326910 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:17:43.327906 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/moving_averages.sql
WITH staging AS (
    SELECT   -- Ensures unique rows in source data
        DATE AS trade_date,
        SYMBOL AS symbol,
        CLOSE AS close_price
    FROM USER_DB_BLUEJAY.raw.STOCK
),

moving_avg_calc AS (
    SELECT
        trade_date,
        symbol,
        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS close_price_7d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS close_price_14d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS close_price_30d_ma
    FROM staging
)

SELECT DISTINCT * FROM moving_avg_calc  -- Ensures distinct rows in final output
ORDER BY symbol, trade_date
        );
[0m00:17:43.328946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:44.562773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.234 seconds
[0m00:17:44.596567 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:17:44.689598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9460a5c10>]}
[0m00:17:44.690694 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.44s]
[0m00:17:44.691607 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:17:44.692232 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:17:44.693072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.stock)
[0m00:17:44.693606 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:17:44.697400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:17:44.712550 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:17:44.713658 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:17:44.714795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:17:44.715728 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:17:44.719518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:17:44.733346 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:17:44.734155 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:17:44.735017 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:17:44.735851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:17:44.736584 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:17:44.739041 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:17:44.751357 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:17:44.755202 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:17:44.770464 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:17:44.771565 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (-- models/stock_indicators.sql
with staging as (
  select
    date            as trade_date,
    symbol,
    close,
    lag(close) over (partition by symbol order by date) as prev_close
  from raw.stock
),
base as (
  select
    trade_date,
    symbol,
    close,
    prev_close
  from staging
),
gains_losses as (
  select
    trade_date,
    symbol,
    greatest(close - prev_close, 0) as gain,
    greatest(prev_close - close, 0) as loss
  from base
),
avg_gain_loss as (
  select
    trade_date,
    symbol,
    avg(gain) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_gain,
    avg(loss) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_loss
  from gains_losses
),
final as (
  select
    trade_date,
    symbol,
    coalesce(
      case
        when avg_loss = 0 then 100
        else 100 - (100 / (1 + (avg_gain / avg_loss)))
      end,
      0
    ) as rsi_14d
  from avg_gain_loss
)

select * from final
        );
[0m00:17:44.772570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:45.607104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.834 seconds
[0m00:17:45.610060 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:17:45.709475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90cb201a0>]}
[0m00:17:45.710992 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 0.97s]
[0m00:17:45.712368 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:17:45.713463 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:17:45.715016 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:17:45.716525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:17:45.717649 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:17:45.721818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:17:45.740898 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:17:45.746429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:17:45.761309 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:17:45.762154 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/volume_summary.sql
with staging as (
    select
        date as trade_date,
        symbol,
        volume,
        row_number() over (partition by date, symbol order by volume desc) as row_num
    from USER_DB_BLUEJAY.raw.STOCK
),

deduplicated as (
    select *
    from staging
    where row_num = 1
),

aggregated as (
    select
        trade_date,
        symbol,
        sum(volume) as total_volume
    from deduplicated
    group by trade_date, symbol
)

select * from aggregated
        );
[0m00:17:45.762987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:46.563793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m00:17:46.566705 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:17:46.661325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90cb09ca0>]}
[0m00:17:46.663415 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 0.94s]
[0m00:17:46.664938 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:17:46.666130 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:17:46.667318 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:17:46.668599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.rsi)
[0m00:17:46.669647 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:17:46.685842 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:17:46.719750 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:17:46.724836 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:17:46.759530 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:17:46.760720 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT s1.symbol, s1.trade_date, s1.close, s2.close AS prev_close
    FROM __dbt__cte__stock s1
    LEFT JOIN __dbt__cte__stock s2
        ON s1.symbol = s2.symbol AND s1.trade_date = DATEADD(day, 1, s2.trade_date)  -- Get previous day's close
),

gains_losses AS (
    SELECT 
        symbol, trade_date, 
        GREATEST(close - prev_close, 0) AS gain, 
        GREATEST(prev_close - close, 0) AS loss
    FROM base
),

avg_calc AS (
    SELECT gl.symbol, gl.trade_date, 
        (SELECT AVG(gain) FROM gains_losses g WHERE g.symbol = gl.symbol AND g.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_gain_14d,
        (SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_loss_14d
    FROM gains_losses gl
),

rsi_final AS (
    SELECT symbol, trade_date, 
        CASE 
            WHEN avg_loss_14d = 0 THEN 100
            ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
        END AS rsi_14d
    FROM avg_calc
)

SELECT DISTINCT * FROM rsi_final  -- Ensure distinct values
ORDER BY symbol, trade_date;
[0m00:17:46.762094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:47.069070 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe451-0205-0c96-0004-59ff002d47ca
[0m00:17:47.070679 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 47 at position 27 unexpected ';'.
[0m00:17:47.072153 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:17:47.186230 [debug] [Thread-1 (]: Database Error in model rsi (models/output/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 47 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m00:17:47.187386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42f3a5db-8d79-4403-a0b7-3a14c82b598a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90cb186b0>]}
[0m00:17:47.188561 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.rsi ............................ [[31mERROR[0m in 0.52s]
[0m00:17:47.189628 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:17:47.192767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:47.194018 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:17:47.195251 [info ] [MainThread]: 
[0m00:17:47.196693 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m00:17:47.198366 [debug] [MainThread]: Command end result
[0m00:17:47.409622 [info ] [MainThread]: 
[0m00:17:47.411114 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:17:47.412473 [info ] [MainThread]: 
[0m00:17:47.413967 [error] [MainThread]:   Database Error in model rsi (models/output/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 47 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m00:17:47.415120 [info ] [MainThread]: 
[0m00:17:47.416213 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:17:47.418093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.479554, "process_user_time": 3.972646, "process_kernel_time": 1.835868, "process_mem_max_rss": "247432", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:17:47.419114 [debug] [MainThread]: Command `dbt run` failed at 00:17:47.418930 after 7.48 seconds
[0m00:17:47.420097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb945bb8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb94504e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90cce6450>]}
[0m00:17:47.420947 [debug] [MainThread]: Flushing usage events
[0m00:18:47.503170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff0aaa7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff07c93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff03d0ec0>]}


============================== 00:18:47.510189 | b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31 ==============================
[0m00:18:47.510189 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:18:47.511617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:18:48.415260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fba2a3b30>]}
[0m00:18:48.459938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fba637bf0>]}
[0m00:18:48.461442 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:18:48.539989 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:18:48.872929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:18:48.874069 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m00:18:49.074643 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:18:49.075937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb9ebf5c0>]}
[0m00:18:49.256423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb3d7aa80>]}
[0m00:18:49.465634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fba0d9be0>]}
[0m00:18:49.467235 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:18:49.468549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb3c8f980>]}
[0m00:18:49.471800 [info ] [MainThread]: 
[0m00:18:49.473294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:18:49.478680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:18:49.490756 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:18:49.491925 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:18:49.492846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:49.926700 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.434 seconds
[0m00:18:49.928887 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:18:50.028832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:18:50.039415 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:18:50.040653 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:18:50.041657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:50.376789 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.335 seconds
[0m00:18:50.379291 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:18:50.477611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb3248110>]}
[0m00:18:50.479054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:50.480125 [info ] [MainThread]: 
[0m00:18:50.488931 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:18:50.490033 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:18:50.491180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.moving_averages)
[0m00:18:50.492279 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:18:50.499870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:18:50.526070 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:18:50.554315 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:18:50.592608 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:18:50.593664 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/moving_averages.sql
WITH staging AS (
    SELECT   -- Ensures unique rows in source data
        DATE AS trade_date,
        SYMBOL AS symbol,
        CLOSE AS close_price
    FROM USER_DB_BLUEJAY.raw.STOCK
),

moving_avg_calc AS (
    SELECT
        trade_date,
        symbol,
        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS close_price_7d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS close_price_14d_ma,

        AVG(close_price) OVER (
            PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
        ) AS close_price_30d_ma
    FROM staging
)

SELECT DISTINCT * FROM moving_avg_calc  -- Ensures distinct rows in final output
ORDER BY symbol, trade_date
        );
[0m00:18:50.594709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:51.444361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.850 seconds
[0m00:18:51.470774 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:18:51.569822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fba41e510>]}
[0m00:18:51.571762 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.08s]
[0m00:18:51.573124 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:18:51.574242 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:18:51.575384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.stock)
[0m00:18:51.576624 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:18:51.580821 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:18:51.609488 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:18:51.611221 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:18:51.612495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:18:51.613455 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:18:51.617008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:18:51.653087 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:18:51.654831 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:18:51.656401 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:18:51.658194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:18:51.659709 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:18:51.663468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:18:51.701554 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:18:51.707361 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:18:51.739437 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:18:51.740542 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (-- models/stock_indicators.sql
with staging as (
  select
    date            as trade_date,
    symbol,
    close,
    lag(close) over (partition by symbol order by date) as prev_close
  from raw.stock
),
base as (
  select
    trade_date,
    symbol,
    close,
    prev_close
  from staging
),
gains_losses as (
  select
    trade_date,
    symbol,
    greatest(close - prev_close, 0) as gain,
    greatest(prev_close - close, 0) as loss
  from base
),
avg_gain_loss as (
  select
    trade_date,
    symbol,
    avg(gain) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_gain,
    avg(loss) over (partition by symbol order by trade_date rows between 13 preceding and current row) as avg_loss
  from gains_losses
),
final as (
  select
    trade_date,
    symbol,
    coalesce(
      case
        when avg_loss = 0 then 100
        else 100 - (100 / (1 + (avg_gain / avg_loss)))
      end,
      0
    ) as rsi_14d
  from avg_gain_loss
)

select * from final
        );
[0m00:18:51.741548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:53.165412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.424 seconds
[0m00:18:53.168302 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:18:53.275363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb3103230>]}
[0m00:18:53.277710 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.62s]
[0m00:18:53.279819 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:18:53.281407 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:18:53.283238 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:18:53.284969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:18:53.286537 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:18:53.291970 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:18:53.314815 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:18:53.319741 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:18:53.343242 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:18:53.344780 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/volume_summary.sql
with staging as (
    select
        date as trade_date,
        symbol,
        volume,
        row_number() over (partition by date, symbol order by volume desc) as row_num
    from USER_DB_BLUEJAY.raw.STOCK
),

deduplicated as (
    select *
    from staging
    where row_num = 1
),

aggregated as (
    select
        trade_date,
        symbol,
        sum(volume) as total_volume
    from deduplicated
    group by trade_date, symbol
)

select * from aggregated
        );
[0m00:18:53.345927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:54.260924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.915 seconds
[0m00:18:54.264037 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:18:54.362914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fb3107f80>]}
[0m00:18:54.364543 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.08s]
[0m00:18:54.365994 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:18:54.366915 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:18:54.367907 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:18:54.369055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.rsi)
[0m00:18:54.370003 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:18:54.387723 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:18:54.407789 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:18:54.412464 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:18:54.427254 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:18:54.428301 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT s1.symbol, s1.trade_date, s1.close, s2.close AS prev_close
    FROM __dbt__cte__stock s1
    LEFT JOIN __dbt__cte__stock s2
        ON s1.symbol = s2.symbol AND s1.trade_date = DATEADD(day, 1, s2.trade_date)  -- Get previous day's close
),

gains_losses AS (
    SELECT 
        symbol, trade_date, 
        GREATEST(close - prev_close, 0) AS gain, 
        GREATEST(prev_close - close, 0) AS loss
    FROM base
),

avg_calc AS (
    SELECT gl.symbol, gl.trade_date, 
        (SELECT AVG(gain) FROM gains_losses g WHERE g.symbol = gl.symbol AND g.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_gain_14d,
        (SELECT AVG(loss) FROM gains_losses l WHERE l.symbol = gl.symbol AND l.trade_date BETWEEN gl.trade_date - 13 AND gl.trade_date) AS avg_loss_14d
    FROM gains_losses gl
),

rsi_final AS (
    SELECT symbol, trade_date, 
        CASE 
            WHEN avg_loss_14d = 0 THEN 100
            ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
        END AS rsi_14d
    FROM avg_calc
)

SELECT DISTINCT * FROM rsi_final  -- Ensure distinct values
ORDER BY symbol, trade_date
        );
[0m00:18:54.429566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:55.707312 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.278 seconds
[0m00:18:55.713465 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:18:55.824072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea60ab-6b9b-4d5a-aa4c-533ea4cc3d31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff15938c0>]}
[0m00:18:55.826123 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.45s]
[0m00:18:55.828464 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:18:55.833044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:55.834709 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:18:55.836038 [info ] [MainThread]: 
[0m00:18:55.837154 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m00:18:55.839134 [debug] [MainThread]: Command end result
[0m00:18:56.020194 [info ] [MainThread]: 
[0m00:18:56.021329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:18:56.022112 [info ] [MainThread]: 
[0m00:18:56.022798 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:18:56.024009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.618174, "process_user_time": 4.040527, "process_kernel_time": 1.945739, "process_mem_max_rss": "244916", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:18:56.024728 [debug] [MainThread]: Command `dbt run` succeeded at 00:18:56.024633 after 8.62 seconds
[0m00:18:56.025440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff0aaa7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff0ebeb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff04e92b0>]}
[0m00:18:56.026144 [debug] [MainThread]: Flushing usage events
[0m00:18:59.602468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2f657da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2f211c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2fa45070>]}


============================== 00:18:59.609452 | 677d05c1-3458-4128-9ad9-8de855c038e5 ==============================
[0m00:18:59.609452 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:18:59.610952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:19:00.457440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '677d05c1-3458-4128-9ad9-8de855c038e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfe246f00>]}
[0m00:19:00.505104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '677d05c1-3458-4128-9ad9-8de855c038e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfe244950>]}
[0m00:19:00.506446 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:19:00.606019 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:19:00.904652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:19:00.905626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:19:00.948739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '677d05c1-3458-4128-9ad9-8de855c038e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2f543b90>]}
[0m00:19:01.145961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '677d05c1-3458-4128-9ad9-8de855c038e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfd3547d0>]}
[0m00:19:01.147172 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:19:01.148190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677d05c1-3458-4128-9ad9-8de855c038e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfeb44680>]}
[0m00:19:01.151476 [info ] [MainThread]: 
[0m00:19:01.152771 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:01.157798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:19:01.174426 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:19:01.175848 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:19:01.176848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:01.597614 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.421 seconds
[0m00:19:01.601520 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:19:01.694800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677d05c1-3458-4128-9ad9-8de855c038e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfce08650>]}
[0m00:19:01.696674 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:01.697609 [info ] [MainThread]: 
[0m00:19:01.708370 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m00:19:01.709517 [info ] [Thread-1 (]: 1 of 18 START test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date  [RUN]
[0m00:19:01.710863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19)
[0m00:19:01.712052 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m00:19:01.729995 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:19:01.731270 [error] [Thread-1 (]: 1 of 18 ERROR dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date  [[31mERROR[0m in 0.02s]
[0m00:19:01.732499 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19
[0m00:19:01.733527 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m00:19:01.734851 [info ] [Thread-1 (]: 2 of 18 START test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date  [RUN]
[0m00:19:01.736215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date.3fa9395c19, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d)
[0m00:19:01.737303 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m00:19:01.743761 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:19:01.745349 [error] [Thread-1 (]: 2 of 18 ERROR dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date ... [[31mERROR[0m in 0.01s]
[0m00:19:01.746627 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d
[0m00:19:01.747636 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m00:19:01.748651 [info ] [Thread-1 (]: 3 of 18 START test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date  [RUN]
[0m00:19:01.749596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date.f1dda2bc6d, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9)
[0m00:19:01.750343 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m00:19:01.756958 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:19:01.757833 [error] [Thread-1 (]: 3 of 18 ERROR dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date  [[31mERROR[0m in 0.01s]
[0m00:19:01.758879 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9
[0m00:19:01.759954 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m00:19:01.761322 [info ] [Thread-1 (]: 4 of 18 START test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date  [RUN]
[0m00:19:01.763000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date.dc81451bf9, now test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d)
[0m00:19:01.764156 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m00:19:01.770505 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:19:01.771893 [error] [Thread-1 (]: 4 of 18 ERROR dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date  [[31mERROR[0m in 0.01s]
[0m00:19:01.773137 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d
[0m00:19:01.774199 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:19:01.775244 [info ] [Thread-1 (]: 5 of 18 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:19:01.776442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date.1c74f0c07d, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:19:01.777918 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:19:01.790194 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:19:01.808861 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:19:01.831272 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:19:01.846943 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:19:01.847942 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:19:01.848772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:02.246785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m00:19:02.254536 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:19:02.372592 [info ] [Thread-1 (]: 5 of 18 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.60s]
[0m00:19:02.373923 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:19:02.374868 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:19:02.375809 [info ] [Thread-1 (]: 6 of 18 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:19:02.376670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:19:02.377326 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:19:02.382482 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:19:02.410101 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:19:02.413667 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:19:02.428888 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:19:02.429723 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:19:02.430468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:02.697351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.267 seconds
[0m00:19:02.700393 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:19:02.819002 [info ] [Thread-1 (]: 6 of 18 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.44s]
[0m00:19:02.820202 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:19:02.821027 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:19:02.821724 [info ] [Thread-1 (]: 7 of 18 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:19:02.822550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:19:02.823188 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:19:02.828465 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:19:02.846876 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:19:02.850348 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:19:02.867673 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:19:02.868648 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:19:02.869462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:03.252544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m00:19:03.257508 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:19:03.630185 [info ] [Thread-1 (]: 7 of 18 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.81s]
[0m00:19:03.631365 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:19:03.632193 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:19:03.633051 [info ] [Thread-1 (]: 8 of 18 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:19:03.634264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:19:03.635179 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:19:03.640617 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:19:03.656169 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:19:03.659724 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:19:03.679733 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:19:03.680758 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:19:03.682052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:04.168436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m00:19:04.170798 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:19:04.278434 [info ] [Thread-1 (]: 8 of 18 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.64s]
[0m00:19:04.280734 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:19:04.282247 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:19:04.283441 [info ] [Thread-1 (]: 9 of 18 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:19:04.284715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:19:04.285939 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:19:04.291604 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:19:04.327585 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:19:04.333314 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:19:04.375455 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:19:04.377200 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:19:04.379141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:04.809990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m00:19:04.812840 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:19:04.904051 [info ] [Thread-1 (]: 9 of 18 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.62s]
[0m00:19:04.905322 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:19:04.906256 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:19:04.907051 [info ] [Thread-1 (]: 10 of 18 START test not_null_rsi_rsi_14d ....................................... [RUN]
[0m00:19:04.908080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:19:04.908762 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:19:04.914033 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:19:04.929791 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:19:04.933303 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:19:04.953843 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:19:04.954713 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:19:04.955385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:05.288940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m00:19:05.291781 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:19:05.408039 [error] [Thread-1 (]: 10 of 18 FAIL 3 not_null_rsi_rsi_14d ........................................... [[31mFAIL 3[0m in 0.50s]
[0m00:19:05.410340 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:19:05.412283 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:19:05.414049 [info ] [Thread-1 (]: 11 of 18 START test not_null_rsi_symbol ........................................ [RUN]
[0m00:19:05.416268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:19:05.417876 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:19:05.423917 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:19:05.450905 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:19:05.454236 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:19:05.488543 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:19:05.490421 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:19:05.492034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:05.911276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m00:19:05.915316 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:19:06.025216 [info ] [Thread-1 (]: 11 of 18 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.61s]
[0m00:19:06.027212 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:19:06.028593 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:19:06.029814 [info ] [Thread-1 (]: 12 of 18 START test not_null_rsi_trade_date .................................... [RUN]
[0m00:19:06.031332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:19:06.032370 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:19:06.037441 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:19:06.071596 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:19:06.075248 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:19:06.117034 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:19:06.118592 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:19:06.120001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:06.465287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.345 seconds
[0m00:19:06.467936 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:19:06.568753 [info ] [Thread-1 (]: 12 of 18 PASS not_null_rsi_trade_date .......................................... [[32mPASS[0m in 0.54s]
[0m00:19:06.569871 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:19:06.571086 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:19:06.571804 [info ] [Thread-1 (]: 13 of 18 START test not_null_stock_indicators_rsi_14d .......................... [RUN]
[0m00:19:06.572596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:19:06.573220 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:19:06.577846 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:19:06.596870 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:19:06.600324 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:19:06.616700 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:19:06.617618 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:19:06.618369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:06.944271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m00:19:06.946992 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:19:07.070806 [info ] [Thread-1 (]: 13 of 18 PASS not_null_stock_indicators_rsi_14d ................................ [[32mPASS[0m in 0.50s]
[0m00:19:07.072454 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:19:07.073711 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:19:07.074799 [info ] [Thread-1 (]: 14 of 18 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:19:07.075931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:19:07.077003 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:19:07.082790 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:19:07.120417 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:19:07.125551 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:19:07.154477 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:19:07.155525 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:19:07.156380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:07.515563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m00:19:07.518846 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:19:07.657631 [info ] [Thread-1 (]: 14 of 18 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.58s]
[0m00:19:07.659702 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:19:07.661070 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:19:07.662424 [info ] [Thread-1 (]: 15 of 18 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:19:07.663881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:19:07.664887 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:19:07.670436 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:19:07.699760 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:19:07.703873 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:19:07.738114 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:19:07.739402 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:19:07.740492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:08.128570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m00:19:08.131541 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:19:08.233369 [info ] [Thread-1 (]: 15 of 18 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.57s]
[0m00:19:08.234658 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:19:08.235825 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:19:08.236718 [info ] [Thread-1 (]: 16 of 18 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:19:08.237749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:19:08.238456 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:19:08.243580 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:19:08.264425 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:19:08.267726 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:19:08.283996 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:19:08.285075 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:19:08.285775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:08.792098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m00:19:08.797071 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:19:08.893049 [info ] [Thread-1 (]: 16 of 18 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.65s]
[0m00:19:08.894986 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:19:08.896682 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:19:08.898100 [info ] [Thread-1 (]: 17 of 18 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:19:08.899210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:19:08.900144 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:19:08.905365 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:19:08.942654 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:19:08.948145 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:19:08.987367 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:19:08.988817 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:19:08.990173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:09.303256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.313 seconds
[0m00:19:09.308132 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:19:09.407428 [info ] [Thread-1 (]: 17 of 18 PASS not_null_volume_summary_total_volume ............................. [[32mPASS[0m in 0.51s]
[0m00:19:09.409309 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:19:09.410688 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:19:09.411695 [info ] [Thread-1 (]: 18 of 18 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:19:09.412923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:19:09.413758 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:19:09.419459 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:19:09.441455 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:19:09.445207 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:19:09.461932 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:19:09.462789 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:19:09.463599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:09.870785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m00:19:09.873847 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:19:09.971331 [info ] [Thread-1 (]: 18 of 18 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.56s]
[0m00:19:09.972748 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:19:09.975085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:09.975971 [debug] [MainThread]: Connection 'test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15' was properly closed.
[0m00:19:09.976704 [info ] [MainThread]: 
[0m00:19:09.977419 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 8.82 seconds (8.82s).
[0m00:19:09.980371 [debug] [MainThread]: Command end result
[0m00:19:10.173550 [info ] [MainThread]: 
[0m00:19:10.174695 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m00:19:10.175475 [info ] [MainThread]: 
[0m00:19:10.176550 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_moving_averages_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:19:10.177638 [info ] [MainThread]: 
[0m00:19:10.179139 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_rsi_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:19:10.179955 [info ] [MainThread]: 
[0m00:19:10.181084 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_indicators_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:19:10.182094 [info ] [MainThread]: 
[0m00:19:10.183232 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_volume_summary_symbol__trade_date (models/output/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:19:10.184002 [info ] [MainThread]: 
[0m00:19:10.184816 [error] [MainThread]: [31mFailure in test not_null_rsi_rsi_14d (models/output/schema.yml)[0m
[0m00:19:10.185553 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m00:19:10.186345 [info ] [MainThread]: 
[0m00:19:10.187555 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/not_null_rsi_rsi_14d.sql
[0m00:19:10.188567 [info ] [MainThread]: 
[0m00:19:10.189642 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=5 SKIP=0 TOTAL=18
[0m00:19:10.190992 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.673481, "process_user_time": 4.046237, "process_kernel_time": 1.852856, "process_mem_max_rss": "250472", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:19:10.192277 [debug] [MainThread]: Command `dbt test` failed at 00:19:10.192164 after 10.67 seconds
[0m00:19:10.193190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2fdc9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfec84ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfc35e3c0>]}
[0m00:19:10.194027 [debug] [MainThread]: Flushing usage events
[0m00:23:16.027568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c00188440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bffbc53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c01753d70>]}


============================== 00:23:16.034646 | 2b46d7ac-478a-43d5-b989-8b2f9e0c721a ==============================
[0m00:23:16.034646 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:23:16.035875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:23:16.895673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b46d7ac-478a-43d5-b989-8b2f9e0c721a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c008d0da0>]}
[0m00:23:16.959356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b46d7ac-478a-43d5-b989-8b2f9e0c721a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0028b800>]}
[0m00:23:16.961172 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:23:17.047779 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:23:17.500320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:23:17.502076 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/stock_indicators.sql
[0m00:23:17.503372 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m00:23:17.504720 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:23:17.721728 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:23:17.722910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b46d7ac-478a-43d5-b989-8b2f9e0c721a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc97db2f0>]}
[0m00:23:17.918896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b46d7ac-478a-43d5-b989-8b2f9e0c721a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3baf545280>]}
[0m00:23:18.066906 [error] [MainThread]: Encountered an error:
Found a cycle: model.dbt_stock_project.rsi
[0m00:23:18.069156 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.dbt_stock_project.rsi

[0m00:23:18.071032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1421006, "process_user_time": 3.384177, "process_kernel_time": 1.921018, "process_mem_max_rss": "245180", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:23:18.072660 [debug] [MainThread]: Command `dbt run` failed at 00:23:18.072542 after 2.14 seconds
[0m00:23:18.073661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c01753d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bc980cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bcb630ce0>]}
[0m00:23:18.074632 [debug] [MainThread]: Flushing usage events
[0m00:32:53.500721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2169f87b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f216dbe8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f216a64f1a0>]}


============================== 00:32:53.509397 | 799b1d08-ef41-4fcf-a296-d7bd3989f444 ==============================
[0m00:32:53.509397 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:32:53.510620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:32:55.275383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '799b1d08-ef41-4fcf-a296-d7bd3989f444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2169c2f800>]}
[0m00:32:55.332367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '799b1d08-ef41-4fcf-a296-d7bd3989f444', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f216aa495b0>]}
[0m00:32:55.334476 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:32:55.425316 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:32:55.908001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m00:32:55.909709 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m00:32:55.911060 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:32:55.912208 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/stock_indicators.sql
[0m00:32:55.913061 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/volume_summary.sql
[0m00:32:55.913762 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m00:32:56.137959 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:32:56.139584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '799b1d08-ef41-4fcf-a296-d7bd3989f444', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2133df1250>]}
[0m00:32:56.231843 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/output/schema.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', "source('raw', 'stock')"), ('field', 'symbol')] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:32:56.236009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.812394, "process_user_time": 3.469823, "process_kernel_time": 2.20531, "process_mem_max_rss": "239272", "process_in_blocks": "122936", "command_success": false, "process_out_blocks": "0"}
[0m00:32:56.237315 [debug] [MainThread]: Command `dbt run` failed at 00:32:56.237182 after 2.81 seconds
[0m00:32:56.238519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f216a305070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f213841bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f216ad66690>]}
[0m00:32:56.239797 [debug] [MainThread]: Flushing usage events
[0m00:34:17.289438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14106b15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f140ff32930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1410c46120>]}


============================== 00:34:17.298752 | 54abc532-0e40-42d7-b510-2ee8d4e04589 ==============================
[0m00:34:17.298752 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:34:17.299971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:34:19.078901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1410f23d70>]}
[0m00:34:19.141775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13da2a1a30>]}
[0m00:34:19.144368 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:34:19.246752 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:34:19.633525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m00:34:19.635369 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m00:34:19.636289 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:34:19.637092 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m00:34:19.637805 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/stock_indicators.sql
[0m00:34:19.638505 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/volume_summary.sql
[0m00:34:19.854329 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:34:19.855914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d9cac320>]}
[0m00:34:20.127332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d80ce210>]}
[0m00:34:20.325680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d9eb3dd0>]}
[0m00:34:20.327170 [info ] [MainThread]: Found 6 models, 23 data tests, 3 sources, 459 macros
[0m00:34:20.328299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d9c198e0>]}
[0m00:34:20.331618 [info ] [MainThread]: 
[0m00:34:20.333062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:34:20.338660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:34:20.354710 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:34:20.356132 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:34:20.357187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:20.929644 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.572 seconds
[0m00:34:20.932131 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:34:21.058646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:34:21.068054 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:34:21.069039 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:34:21.069909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:21.345031 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.275 seconds
[0m00:34:21.349665 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:34:21.458031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d9eb3770>]}
[0m00:34:21.459990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:34:21.461295 [info ] [MainThread]: 
[0m00:34:21.471224 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:34:21.472500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m00:34:21.473976 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:34:21.483342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:34:21.520230 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:34:21.521660 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:34:21.522948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:34:21.524307 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:34:21.528604 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:34:21.566130 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:34:21.567441 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:34:21.569196 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:34:21.570705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:34:21.572032 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:34:21.577548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:34:21.609101 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:34:21.636309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:34:21.673827 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:34:21.675156 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:34:21.677257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:23.561328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.884 seconds
[0m00:34:23.586346 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:34:23.679067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13da262ea0>]}
[0m00:34:23.680451 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 2.11s]
[0m00:34:23.682200 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:34:23.683437 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:34:23.684694 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:34:23.686111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:34:23.686938 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:34:23.691317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:34:23.712754 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:34:23.717153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:34:23.738795 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:34:23.740007 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:34:23.741260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:24.754657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.013 seconds
[0m00:34:24.757860 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:34:24.858462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13b3967ce0>]}
[0m00:34:24.860678 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.17s]
[0m00:34:24.862221 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:34:24.863236 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:34:24.864482 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:34:24.865582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m00:34:24.866492 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:34:24.878577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:34:24.909744 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:34:24.914495 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:34:24.943397 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:34:24.944589 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m00:34:24.945942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:25.886264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.940 seconds
[0m00:34:25.889966 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:34:25.991426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1411373da0>]}
[0m00:34:25.993046 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.13s]
[0m00:34:25.995127 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:34:25.996401 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:34:25.997648 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:34:25.998794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m00:34:25.999830 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:34:26.017370 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:34:26.045551 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:34:26.127212 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:34:26.154227 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:34:26.155335 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/marts/rsi_prices.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,

    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d,0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m00:34:26.156390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:27.366123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.210 seconds
[0m00:34:27.369013 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:34:27.462727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54abc532-0e40-42d7-b510-2ee8d4e04589', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d9c6c170>]}
[0m00:34:27.465024 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.46s]
[0m00:34:27.466982 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:34:27.470491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:27.471619 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:34:27.472884 [info ] [MainThread]: 
[0m00:34:27.474011 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.14 seconds (7.14s).
[0m00:34:27.476660 [debug] [MainThread]: Command end result
[0m00:34:27.606398 [info ] [MainThread]: 
[0m00:34:27.607780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:27.609627 [info ] [MainThread]: 
[0m00:34:27.611168 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:34:27.613792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.4224415, "process_user_time": 4.467522, "process_kernel_time": 2.084843, "process_mem_max_rss": "244264", "process_in_blocks": "130200", "process_out_blocks": "8"}
[0m00:34:27.615269 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:27.615134 after 10.42 seconds
[0m00:34:27.616537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13db77d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14101bde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13d81204d0>]}
[0m00:34:27.617736 [debug] [MainThread]: Flushing usage events
[0m00:34:31.065482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed336e2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31957f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31e30bf0>]}


============================== 00:34:31.072009 | aac46206-e36f-4be0-9c2c-118f889ce1c5 ==============================
[0m00:34:31.072009 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:34:31.073448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:34:31.928590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aac46206-e36f-4be0-9c2c-118f889ce1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed326c6810>]}
[0m00:34:31.974542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aac46206-e36f-4be0-9c2c-118f889ce1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3112a3c0>]}
[0m00:34:31.976220 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:34:32.053664 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:34:32.602446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:32.603608 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:32.642783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aac46206-e36f-4be0-9c2c-118f889ce1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecfb248680>]}
[0m00:34:32.870793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aac46206-e36f-4be0-9c2c-118f889ce1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecfaf735f0>]}
[0m00:34:32.872011 [info ] [MainThread]: Found 6 models, 23 data tests, 3 sources, 459 macros
[0m00:34:32.872811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac46206-e36f-4be0-9c2c-118f889ce1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecfb21f800>]}
[0m00:34:32.876596 [info ] [MainThread]: 
[0m00:34:32.878069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:34:32.884202 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:34:32.902962 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:34:32.904182 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:34:32.905321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:33.379506 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.474 seconds
[0m00:34:33.381920 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:34:33.471823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac46206-e36f-4be0-9c2c-118f889ce1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed30d79be0>]}
[0m00:34:33.473190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:34:33.474186 [info ] [MainThread]: 
[0m00:34:33.483514 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:34:33.484735 [info ] [Thread-1 (]: 1 of 23 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:34:33.485858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:34:33.486796 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:34:33.503327 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:34:33.525143 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:34:33.546266 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:34:33.578329 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:34:33.579708 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:34:33.580776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:33.992786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m00:34:34.002617 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:34:34.095677 [info ] [Thread-1 (]: 1 of 23 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.61s]
[0m00:34:34.097214 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:34:34.098379 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:34:34.099346 [info ] [Thread-1 (]: 2 of 23 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:34:34.100215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:34:34.100816 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:34:34.105916 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:34:34.121902 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:34:34.125569 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:34:34.141118 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:34:34.142209 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:34:34.143181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:34.407123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m00:34:34.410180 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:34:34.510912 [info ] [Thread-1 (]: 2 of 23 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.41s]
[0m00:34:34.512359 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:34:34.513540 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:34:34.514315 [info ] [Thread-1 (]: 3 of 23 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:34:34.515174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:34:34.515984 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:34:34.521500 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:34:34.546381 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:34:34.550982 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:34:34.580887 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:34:34.582362 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:34:34.583483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:34.999334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m00:34:35.003549 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:34:35.099927 [info ] [Thread-1 (]: 3 of 23 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.58s]
[0m00:34:35.102020 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:34:35.103191 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:34:35.104239 [info ] [Thread-1 (]: 4 of 23 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:34:35.105652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:34:35.106621 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:34:35.114687 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:34:35.144786 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:34:35.148967 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:34:35.178287 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:34:35.179646 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:34:35.180777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:35.550996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.370 seconds
[0m00:34:35.554278 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:34:35.644480 [info ] [Thread-1 (]: 4 of 23 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.54s]
[0m00:34:35.646197 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:34:35.647204 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:34:35.648052 [info ] [Thread-1 (]: 5 of 23 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:34:35.648862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:34:35.649645 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:34:35.654749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:34:35.675894 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:34:35.680917 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:34:35.701463 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:34:35.702564 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:34:35.703542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:36.109675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m00:34:36.112842 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:34:36.223911 [info ] [Thread-1 (]: 5 of 23 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.57s]
[0m00:34:36.225380 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:34:36.226687 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:34:36.227620 [info ] [Thread-1 (]: 6 of 23 START test not_null_rsi_rsi_14d ........................................ [RUN]
[0m00:34:36.228556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:34:36.229363 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:34:36.234525 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:34:36.253127 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:34:36.256662 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:34:36.271721 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:34:36.272709 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:34:36.273356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:36.841444 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m00:34:36.844676 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:34:36.931428 [info ] [Thread-1 (]: 6 of 23 PASS not_null_rsi_rsi_14d .............................................. [[32mPASS[0m in 0.70s]
[0m00:34:36.932615 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:34:36.933359 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:34:36.934110 [info ] [Thread-1 (]: 7 of 23 START test not_null_rsi_symbol ......................................... [RUN]
[0m00:34:36.934895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:34:36.935515 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:34:36.940500 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:34:36.962661 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:34:36.966291 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:34:36.981764 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:34:36.982629 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:34:36.983363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:37.295601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m00:34:37.301328 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:34:37.439747 [info ] [Thread-1 (]: 7 of 23 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.50s]
[0m00:34:37.442174 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:34:37.444235 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:34:37.446109 [info ] [Thread-1 (]: 8 of 23 START test not_null_rsi_trade_date ..................................... [RUN]
[0m00:34:37.447551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:34:37.448903 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:34:37.453831 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:34:37.484595 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:34:37.488257 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:34:37.518345 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:34:37.519556 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:34:37.520540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:37.905115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m00:34:37.909563 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:34:38.005563 [info ] [Thread-1 (]: 8 of 23 PASS not_null_rsi_trade_date ........................................... [[32mPASS[0m in 0.56s]
[0m00:34:38.007413 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:34:38.008814 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:34:38.009993 [info ] [Thread-1 (]: 9 of 23 START test not_null_stock_indicators_rsi_14d ........................... [RUN]
[0m00:34:38.011235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:34:38.012209 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:34:38.017596 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:34:38.047545 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:34:38.051250 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:34:38.082136 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:34:38.083250 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:34:38.084096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:38.439834 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe462-0205-0f94-0004-59ff002d540a
[0m00:34:38.441004 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m00:34:38.442189 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:34:38.544564 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:34:38.545839 [error] [Thread-1 (]: 9 of 23 ERROR not_null_stock_indicators_rsi_14d ................................ [[31mERROR[0m in 0.53s]
[0m00:34:38.547047 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:34:38.547848 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:34:38.549076 [info ] [Thread-1 (]: 10 of 23 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:34:38.550048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:34:38.550710 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:34:38.556370 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:34:38.572624 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:34:38.576611 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:34:38.594578 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:34:38.595633 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:34:38.596316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:38.933909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m00:34:38.936770 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:34:39.031574 [info ] [Thread-1 (]: 10 of 23 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.48s]
[0m00:34:39.033092 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:34:39.034232 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:34:39.035430 [info ] [Thread-1 (]: 11 of 23 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:34:39.036710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:34:39.037907 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:34:39.043944 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:34:39.078812 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:34:39.083187 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:34:39.109840 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:34:39.111732 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:34:39.112891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:39.488219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m00:34:39.493526 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:34:39.597887 [info ] [Thread-1 (]: 11 of 23 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.56s]
[0m00:34:39.600050 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:34:39.601642 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:34:39.603172 [info ] [Thread-1 (]: 12 of 23 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:34:39.604789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:34:39.606110 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:34:39.612061 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:34:39.645601 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:34:39.649436 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:34:39.687511 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:34:39.689339 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:34:39.690831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:40.050082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m00:34:40.054709 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:34:40.162395 [info ] [Thread-1 (]: 12 of 23 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.56s]
[0m00:34:40.163822 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:34:40.164759 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:34:40.165873 [info ] [Thread-1 (]: 13 of 23 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:34:40.167160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:34:40.168177 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:34:40.173609 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:34:40.202726 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:34:40.206584 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:34:40.224190 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:34:40.225179 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:34:40.226277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:40.505715 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe462-0205-0c96-0004-59ff002d4d56
[0m00:34:40.507023 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m00:34:40.508225 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:34:40.636059 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:34:40.637448 [error] [Thread-1 (]: 13 of 23 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.47s]
[0m00:34:40.638473 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:34:40.639371 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:34:40.640225 [info ] [Thread-1 (]: 14 of 23 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:34:40.641260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:34:40.642017 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:34:40.647192 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:34:40.678367 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:34:40.681919 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:34:40.699267 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:34:40.700264 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:34:40.701319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:41.103904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m00:34:41.106707 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:34:41.232519 [info ] [Thread-1 (]: 14 of 23 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.59s]
[0m00:34:41.233999 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:34:41.235145 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:34:41.236381 [info ] [Thread-1 (]: 15 of 23 START test positive_values_moving_averages_close_price_14d_ma ......... [RUN]
[0m00:34:41.237617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0)
[0m00:34:41.238549 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:34:41.249890 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:41.251332 [error] [Thread-1 (]: 15 of 23 ERROR positive_values_moving_averages_close_price_14d_ma .............. [[31mERROR[0m in 0.01s]
[0m00:34:41.252536 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:34:41.253603 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:34:41.254698 [info ] [Thread-1 (]: 16 of 23 START test positive_values_moving_averages_close_price_30d_ma ......... [RUN]
[0m00:34:41.255850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0, now test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77)
[0m00:34:41.256946 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:34:41.263533 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:41.265067 [error] [Thread-1 (]: 16 of 23 ERROR positive_values_moving_averages_close_price_30d_ma .............. [[31mERROR[0m in 0.01s]
[0m00:34:41.266344 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:34:41.267591 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:34:41.268858 [info ] [Thread-1 (]: 17 of 23 START test positive_values_moving_averages_close_price_7d_ma .......... [RUN]
[0m00:34:41.270112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77, now test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba)
[0m00:34:41.271262 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:34:41.276369 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:41.277812 [error] [Thread-1 (]: 17 of 23 ERROR positive_values_moving_averages_close_price_7d_ma ............... [[31mERROR[0m in 0.01s]
[0m00:34:41.279255 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:34:41.280557 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m00:34:41.281823 [info ] [Thread-1 (]: 18 of 23 START test positive_values_volume_summary_total_volume ................ [RUN]
[0m00:34:41.283159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba, now test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd)
[0m00:34:41.284463 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m00:34:41.289752 [debug] [Thread-1 (]: Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:41.291038 [error] [Thread-1 (]: 18 of 23 ERROR positive_values_volume_summary_total_volume ..................... [[31mERROR[0m in 0.01s]
[0m00:34:41.292368 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m00:34:41.293707 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:34:41.295243 [info ] [Thread-1 (]: 19 of 23 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m00:34:41.296591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m00:34:41.297696 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:34:41.303128 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:41.304409 [error] [Thread-1 (]: 19 of 23 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.01s]
[0m00:34:41.305631 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:34:41.306858 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:34:41.307981 [info ] [Thread-1 (]: 20 of 23 START test range_stock_indicators_rsi_14d__100__0 ..................... [RUN]
[0m00:34:41.309284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4)
[0m00:34:41.310222 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:34:41.315691 [debug] [Thread-1 (]: Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:41.317136 [error] [Thread-1 (]: 20 of 23 ERROR range_stock_indicators_rsi_14d__100__0 .......................... [[31mERROR[0m in 0.01s]
[0m00:34:41.318459 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:34:41.319835 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:34:41.321084 [info ] [Thread-1 (]: 21 of 23 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m00:34:41.322533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m00:34:41.323638 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:34:41.333272 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:34:41.382548 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:34:41.387253 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:34:41.435398 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:34:41.436785 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:34:41.437810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:41.853310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.415 seconds
[0m00:34:41.858365 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m00:34:41.955234 [info ] [Thread-1 (]: 21 of 23 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.63s]
[0m00:34:41.956965 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:34:41.958073 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:34:41.959269 [info ] [Thread-1 (]: 22 of 23 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m00:34:41.960521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m00:34:41.962334 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:34:41.969631 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:34:42.009478 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:34:42.101520 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:34:42.133148 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:34:42.134257 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:34:42.135046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:42.573879 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m00:34:42.579663 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m00:34:42.686263 [info ] [Thread-1 (]: 22 of 23 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.73s]
[0m00:34:42.687673 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:34:42.688531 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:34:42.689534 [info ] [Thread-1 (]: 23 of 23 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m00:34:42.690671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m00:34:42.691754 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:34:42.701967 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:34:42.726644 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:34:42.730620 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:34:42.755940 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:34:42.757024 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:34:42.757892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:43.112982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.355 seconds
[0m00:34:43.115955 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m00:34:43.210105 [info ] [Thread-1 (]: 23 of 23 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.52s]
[0m00:34:43.211785 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:34:43.214087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:43.214977 [debug] [MainThread]: Connection 'test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5' was properly closed.
[0m00:34:43.215928 [info ] [MainThread]: 
[0m00:34:43.216890 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 10.34 seconds (10.34s).
[0m00:34:43.220267 [debug] [MainThread]: Command end result
[0m00:34:43.342327 [info ] [MainThread]: 
[0m00:34:43.344066 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m00:34:43.345401 [info ] [MainThread]: 
[0m00:34:43.346976 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:34:43.348049 [info ] [MainThread]: 
[0m00:34:43.350710 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:34:43.351786 [info ] [MainThread]: 
[0m00:34:43.352835 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:43.354432 [info ] [MainThread]: 
[0m00:34:43.355393 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:43.356205 [info ] [MainThread]: 
[0m00:34:43.357159 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:43.358125 [info ] [MainThread]: 
[0m00:34:43.359405 [error] [MainThread]:   Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:43.360894 [info ] [MainThread]: 
[0m00:34:43.362207 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:43.363143 [info ] [MainThread]: 
[0m00:34:43.364037 [error] [MainThread]:   Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:34:43.364872 [info ] [MainThread]: 
[0m00:34:43.365845 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=8 SKIP=0 TOTAL=23
[0m00:34:43.367230 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.377817, "process_user_time": 4.398875, "process_kernel_time": 1.87229, "process_mem_max_rss": "238652", "process_in_blocks": "2704", "process_out_blocks": "8", "command_success": false}
[0m00:34:43.368271 [debug] [MainThread]: Command `dbt test` failed at 00:34:43.368084 after 12.38 seconds
[0m00:34:43.369119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31ff3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed31ff1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecfb31c890>]}
[0m00:34:43.369844 [debug] [MainThread]: Flushing usage events
[0m00:39:12.245240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b858470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0c8bbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0ae00aa0>]}


============================== 00:39:12.252476 | fb1ee85c-4a6e-427b-9c3f-067015ecc410 ==============================
[0m00:39:12.252476 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:39:12.253589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:39:13.154722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b889700>]}
[0m00:39:13.215986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b2f4b90>]}
[0m00:39:13.217526 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:39:13.305299 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:39:13.742771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:39:13.744978 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:39:13.746514 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m00:39:13.967156 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:39:13.968358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd896bef0>]}
[0m00:39:14.185180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd89bc530>]}
[0m00:39:14.399721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd3355e80>]}
[0m00:39:14.401238 [info ] [MainThread]: Found 6 models, 23 data tests, 3 sources, 459 macros
[0m00:39:14.402429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd33e3aa0>]}
[0m00:39:14.406892 [info ] [MainThread]: 
[0m00:39:14.408318 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:39:14.412948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:39:14.426483 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:39:14.428023 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:39:14.429383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:15.017549 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.588 seconds
[0m00:39:15.021283 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:39:15.137788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:39:15.147927 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:39:15.149027 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:39:15.150177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:39:15.677602 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.527 seconds
[0m00:39:15.680372 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:39:15.791056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8af0440>]}
[0m00:39:15.792361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:15.793319 [info ] [MainThread]: 
[0m00:39:15.802974 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:39:15.804004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m00:39:15.805362 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:39:15.813694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:39:15.843092 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:39:15.844236 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:39:15.845277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:39:15.846177 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:39:15.849637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:39:15.875010 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:39:15.875970 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:39:15.876888 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:39:15.877868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:39:15.878508 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:39:15.882088 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:39:15.902505 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:39:15.932399 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:39:15.966137 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:39:15.967429 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:39:15.968558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:16.994974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.030 seconds
[0m00:39:17.017472 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:39:17.132595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8f26cc0>]}
[0m00:39:17.134203 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.25s]
[0m00:39:17.135650 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:39:17.136663 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:39:17.137547 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:39:17.138560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:39:17.139369 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:39:17.143243 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:39:17.162560 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:39:17.166524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:39:17.179894 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:39:17.180721 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:39:17.181689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:18.122048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.940 seconds
[0m00:39:18.125174 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:39:18.220407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8c30dd0>]}
[0m00:39:18.221925 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.08s]
[0m00:39:18.223301 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:39:18.224576 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:39:18.225783 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:39:18.227416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m00:39:18.228298 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:39:18.245644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:39:18.265083 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:39:18.269852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:39:18.284664 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:39:18.285729 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT *
  FROM __dbt__cte__stock
  WHERE close IS NOT NULL AND close > 0
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average, only if enough rows exist
    CASE 
      WHEN COUNT(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ) = 7
      THEN ROUND(AVG(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2)
      ELSE NULL
    END AS close_price_7d_ma,

    -- 14-day moving average
    CASE 
      WHEN COUNT(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ) = 14
      THEN ROUND(AVG(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2)
      ELSE NULL
    END AS close_price_14d_ma,

    -- 30-day moving average
    CASE 
      WHEN COUNT(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ) = 30
      THEN ROUND(AVG(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2)
      ELSE NULL
    END AS close_price_30d_ma

  FROM base
)

SELECT *
FROM moving_avg_calc
WHERE close_price_7d_ma IS NOT NULL  -- optional: ensure final output passes not_null
ORDER BY symbol, trade_date
        );
[0m00:39:18.286501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:19.293445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.007 seconds
[0m00:39:19.297024 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:39:19.423992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0c02b9b0>]}
[0m00:39:19.426400 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.20s]
[0m00:39:19.428268 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:39:19.429375 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:39:19.430564 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:39:19.431569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m00:39:19.432345 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:39:19.453198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:39:19.485536 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:39:19.489956 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:39:19.534109 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:39:19.535742 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
  WHERE close > 0  -- Filter out non-positive close prices
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss, only calculate after enough data is available
    CASE 
      WHEN COUNT(gain) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(gain) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_gain_14d,

    CASE 
      WHEN COUNT(loss) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(loss) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      WHEN avg_gain_14d IS NULL OR avg_loss_14d IS NULL THEN NULL  -- Ensure valid RSI
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * 
FROM rsi_final
WHERE rsi_14d IS NOT NULL  -- Ensure that RSI is valid
ORDER BY symbol, trade_date
        );
[0m00:39:19.537329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:20.472165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.935 seconds
[0m00:39:20.475053 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:39:20.703451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1ee85c-4a6e-427b-9c3f-067015ecc410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd2819af0>]}
[0m00:39:20.704833 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.27s]
[0m00:39:20.706275 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:39:20.708506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:20.709243 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:39:20.710057 [info ] [MainThread]: 
[0m00:39:20.711018 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m00:39:20.712483 [debug] [MainThread]: Command end result
[0m00:39:20.897291 [info ] [MainThread]: 
[0m00:39:20.898287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:39:20.899097 [info ] [MainThread]: 
[0m00:39:20.899813 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:39:20.901346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.757293, "process_user_time": 4.12946, "process_kernel_time": 1.840749, "process_mem_max_rss": "242272", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:39:20.903198 [debug] [MainThread]: Command `dbt run` succeeded at 00:39:20.902960 after 8.76 seconds
[0m00:39:20.904366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b858470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b428ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0c167bc0>]}
[0m00:39:20.905290 [debug] [MainThread]: Flushing usage events
[0m00:39:24.852965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a16ab200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a16bbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a16b99a0>]}


============================== 00:39:24.860141 | 6ec1897c-409c-43cf-889c-27c41c07f8f9 ==============================
[0m00:39:24.860141 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:39:24.861371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:39:25.849314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ec1897c-409c-43cf-889c-27c41c07f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05700676e0>]}
[0m00:39:25.896296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ec1897c-409c-43cf-889c-27c41c07f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056b5e9fa0>]}
[0m00:39:25.897990 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:39:25.998790 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:39:26.514460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:39:26.515552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:39:26.562290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ec1897c-409c-43cf-889c-27c41c07f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056b3376e0>]}
[0m00:39:26.766834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ec1897c-409c-43cf-889c-27c41c07f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0571bb4f80>]}
[0m00:39:26.767945 [info ] [MainThread]: Found 6 models, 23 data tests, 3 sources, 459 macros
[0m00:39:26.769396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ec1897c-409c-43cf-889c-27c41c07f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a0ed8a70>]}
[0m00:39:26.773070 [info ] [MainThread]: 
[0m00:39:26.774255 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:39:26.779493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:39:26.797341 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:39:26.798517 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:39:26.799640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:39:27.228703 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.429 seconds
[0m00:39:27.231963 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:39:27.367761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ec1897c-409c-43cf-889c-27c41c07f8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f056ae3fb90>]}
[0m00:39:27.369539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:39:27.370831 [info ] [MainThread]: 
[0m00:39:27.380102 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:39:27.381458 [info ] [Thread-1 (]: 1 of 23 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:39:27.382736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:39:27.383755 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:39:27.402303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:39:27.431244 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:39:27.455442 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:39:27.483143 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:39:27.484248 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:39:27.485645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:27.907014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m00:39:27.916183 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:39:28.012522 [error] [Thread-1 (]: 1 of 23 FAIL 21 not_null_moving_averages_close_price_14d_ma .................... [[31mFAIL 21[0m in 0.63s]
[0m00:39:28.014026 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:39:28.015235 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:39:28.016362 [info ] [Thread-1 (]: 2 of 23 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:39:28.017510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:39:28.018669 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:39:28.024137 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:39:28.054352 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:39:28.058191 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:39:28.082392 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:39:28.083594 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:39:28.084573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:28.538854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m00:39:28.541986 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:39:28.638358 [error] [Thread-1 (]: 2 of 23 FAIL 69 not_null_moving_averages_close_price_30d_ma .................... [[31mFAIL 69[0m in 0.62s]
[0m00:39:28.640210 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:39:28.641422 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:39:28.642513 [info ] [Thread-1 (]: 3 of 23 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:39:28.643701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:39:28.644726 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:39:28.649756 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:39:28.682992 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:39:28.688047 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:39:28.725104 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:39:28.726367 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:39:28.727456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:29.002752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m00:39:29.007306 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:39:29.122105 [info ] [Thread-1 (]: 3 of 23 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.48s]
[0m00:39:29.123897 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:39:29.125264 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:39:29.126592 [info ] [Thread-1 (]: 4 of 23 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:39:29.128010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:39:29.129186 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:39:29.135248 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:39:29.170744 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:39:29.176275 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:39:29.213261 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:39:29.214653 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:39:29.215770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:29.737522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m00:39:29.740659 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:39:29.837991 [info ] [Thread-1 (]: 4 of 23 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.71s]
[0m00:39:29.839204 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:39:29.840578 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:39:29.841593 [info ] [Thread-1 (]: 5 of 23 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:39:29.842516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:39:29.843315 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:39:29.849008 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:39:29.871136 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:39:29.877349 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:39:29.899409 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:39:29.900467 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:39:29.902485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:30.277282 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m00:39:30.279824 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:39:30.424885 [info ] [Thread-1 (]: 5 of 23 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.58s]
[0m00:39:30.426278 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:39:30.427373 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:39:30.428300 [info ] [Thread-1 (]: 6 of 23 START test not_null_rsi_rsi_14d ........................................ [RUN]
[0m00:39:30.429506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:39:30.430531 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:39:30.435970 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:39:30.453601 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:39:30.457540 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:39:30.477684 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:39:30.478848 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:39:30.479830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:30.870567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m00:39:30.873631 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:39:30.983838 [info ] [Thread-1 (]: 6 of 23 PASS not_null_rsi_rsi_14d .............................................. [[32mPASS[0m in 0.55s]
[0m00:39:30.985976 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:39:30.987913 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:39:30.989711 [info ] [Thread-1 (]: 7 of 23 START test not_null_rsi_symbol ......................................... [RUN]
[0m00:39:30.991225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:39:30.992705 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:39:30.998773 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:39:31.039756 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:39:31.043616 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:39:31.071297 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:39:31.072480 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:39:31.073741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:31.477478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m00:39:31.480659 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:39:31.574355 [info ] [Thread-1 (]: 7 of 23 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.58s]
[0m00:39:31.576199 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:39:31.577603 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:39:31.578926 [info ] [Thread-1 (]: 8 of 23 START test not_null_rsi_trade_date ..................................... [RUN]
[0m00:39:31.580362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:39:31.581475 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:39:31.587693 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:39:31.625699 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:39:31.629473 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:39:31.661618 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:39:31.662695 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:39:31.663570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:31.987970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m00:39:31.990820 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:39:32.119257 [info ] [Thread-1 (]: 8 of 23 PASS not_null_rsi_trade_date ........................................... [[32mPASS[0m in 0.54s]
[0m00:39:32.120945 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:39:32.121937 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:39:32.122735 [info ] [Thread-1 (]: 9 of 23 START test not_null_stock_indicators_rsi_14d ........................... [RUN]
[0m00:39:32.123660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:39:32.124520 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:39:32.129777 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:39:32.149228 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:39:32.152740 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:39:32.170990 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:39:32.171937 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:39:32.172688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:32.598796 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe467-0205-0fb8-0004-59ff002d63e6
[0m00:39:32.600171 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m00:39:32.601398 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:39:32.717548 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:39:32.719278 [error] [Thread-1 (]: 9 of 23 ERROR not_null_stock_indicators_rsi_14d ................................ [[31mERROR[0m in 0.60s]
[0m00:39:32.721078 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:39:32.722099 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:39:32.723197 [info ] [Thread-1 (]: 10 of 23 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:39:32.724625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:39:32.725760 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:39:32.731157 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:39:32.766797 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:39:32.771793 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:39:32.814439 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:39:32.816006 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:39:32.817447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:33.189346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m00:39:33.195262 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:39:33.304629 [info ] [Thread-1 (]: 10 of 23 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.58s]
[0m00:39:33.306527 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:39:33.307867 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:39:33.309195 [info ] [Thread-1 (]: 11 of 23 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:39:33.310578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:39:33.311830 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:39:33.317303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:39:33.347178 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:39:33.351135 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:39:33.385642 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:39:33.387383 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:39:33.388648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:33.702952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m00:39:33.706445 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:39:33.800349 [info ] [Thread-1 (]: 11 of 23 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.49s]
[0m00:39:33.801621 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:39:33.802802 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:39:33.803840 [info ] [Thread-1 (]: 12 of 23 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:39:33.804663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:39:33.805336 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:39:33.810397 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:39:33.827890 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:39:33.832173 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:39:33.847396 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:39:33.848188 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:39:33.848762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:34.147439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m00:39:34.149907 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:39:34.268721 [info ] [Thread-1 (]: 12 of 23 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.46s]
[0m00:39:34.270554 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:39:34.272024 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:39:34.272976 [info ] [Thread-1 (]: 13 of 23 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:39:34.274053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:39:34.274859 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:39:34.279931 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:39:34.308354 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:39:34.311922 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:39:34.342372 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:39:34.343689 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:39:34.344816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:34.712416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe467-0205-0f94-0004-59ff002d55aa
[0m00:39:34.713330 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m00:39:34.714115 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:39:34.850374 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:39:34.851513 [error] [Thread-1 (]: 13 of 23 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.58s]
[0m00:39:34.852765 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:39:34.854003 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:39:34.855097 [info ] [Thread-1 (]: 14 of 23 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:39:34.856276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:39:34.857344 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:39:34.862731 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:39:34.885436 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:39:34.889315 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:39:34.909158 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:39:34.910191 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:39:34.911135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:35.364694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m00:39:35.369398 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:39:35.542203 [info ] [Thread-1 (]: 14 of 23 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.69s]
[0m00:39:35.543765 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:39:35.545137 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:39:35.546311 [info ] [Thread-1 (]: 15 of 23 START test positive_values_moving_averages_close_price_14d_ma ......... [RUN]
[0m00:39:35.547422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0)
[0m00:39:35.548482 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:39:35.555283 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:35.556705 [error] [Thread-1 (]: 15 of 23 ERROR positive_values_moving_averages_close_price_14d_ma .............. [[31mERROR[0m in 0.01s]
[0m00:39:35.557969 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:39:35.559056 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:39:35.560273 [info ] [Thread-1 (]: 16 of 23 START test positive_values_moving_averages_close_price_30d_ma ......... [RUN]
[0m00:39:35.561679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0, now test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77)
[0m00:39:35.562759 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:39:35.567672 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:35.568941 [error] [Thread-1 (]: 16 of 23 ERROR positive_values_moving_averages_close_price_30d_ma .............. [[31mERROR[0m in 0.01s]
[0m00:39:35.570228 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:39:35.571522 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:39:35.572817 [info ] [Thread-1 (]: 17 of 23 START test positive_values_moving_averages_close_price_7d_ma .......... [RUN]
[0m00:39:35.573879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77, now test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba)
[0m00:39:35.574747 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:39:35.579804 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:35.580921 [error] [Thread-1 (]: 17 of 23 ERROR positive_values_moving_averages_close_price_7d_ma ............... [[31mERROR[0m in 0.01s]
[0m00:39:35.582198 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:39:35.583041 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m00:39:35.584145 [info ] [Thread-1 (]: 18 of 23 START test positive_values_volume_summary_total_volume ................ [RUN]
[0m00:39:35.585051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba, now test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd)
[0m00:39:35.586098 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m00:39:35.592505 [debug] [Thread-1 (]: Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:35.593678 [error] [Thread-1 (]: 18 of 23 ERROR positive_values_volume_summary_total_volume ..................... [[31mERROR[0m in 0.01s]
[0m00:39:35.594749 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m00:39:35.595670 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:39:35.596733 [info ] [Thread-1 (]: 19 of 23 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m00:39:35.598068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m00:39:35.599068 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:39:35.604736 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:35.606020 [error] [Thread-1 (]: 19 of 23 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.01s]
[0m00:39:35.607258 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:39:35.608321 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:39:35.609510 [info ] [Thread-1 (]: 20 of 23 START test range_stock_indicators_rsi_14d__100__0 ..................... [RUN]
[0m00:39:35.610777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4)
[0m00:39:35.611772 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:39:35.616515 [debug] [Thread-1 (]: Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:35.617589 [error] [Thread-1 (]: 20 of 23 ERROR range_stock_indicators_rsi_14d__100__0 .......................... [[31mERROR[0m in 0.01s]
[0m00:39:35.619349 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:39:35.620806 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:39:35.621768 [info ] [Thread-1 (]: 21 of 23 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m00:39:35.622895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m00:39:35.623926 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:39:35.631426 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:39:35.673146 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:39:35.676694 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:39:35.704559 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:39:35.705641 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:39:35.706557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:36.102890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m00:39:36.107060 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m00:39:36.208221 [info ] [Thread-1 (]: 21 of 23 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.58s]
[0m00:39:36.210156 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:39:36.212249 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:39:36.214000 [info ] [Thread-1 (]: 22 of 23 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m00:39:36.215402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m00:39:36.216851 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:39:36.225579 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:39:36.258412 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:39:36.340526 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:39:36.363711 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:39:36.364936 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:39:36.365838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:36.711784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.346 seconds
[0m00:39:36.714050 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m00:39:36.804230 [info ] [Thread-1 (]: 22 of 23 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.59s]
[0m00:39:36.805532 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:39:36.806356 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:39:36.807199 [info ] [Thread-1 (]: 23 of 23 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m00:39:36.808140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m00:39:36.808826 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:39:36.815083 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:39:36.831889 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:39:36.835651 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:39:36.852246 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:39:36.853497 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:39:36.854591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:39:37.302898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m00:39:37.306076 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m00:39:37.531313 [info ] [Thread-1 (]: 23 of 23 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.72s]
[0m00:39:37.532902 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:39:37.535231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:39:37.536600 [debug] [MainThread]: Connection 'test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5' was properly closed.
[0m00:39:37.537917 [info ] [MainThread]: 
[0m00:39:37.538945 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 10.76 seconds (10.76s).
[0m00:39:37.542253 [debug] [MainThread]: Command end result
[0m00:39:37.675269 [info ] [MainThread]: 
[0m00:39:37.676513 [info ] [MainThread]: [31mCompleted with 10 errors and 0 warnings:[0m
[0m00:39:37.677544 [info ] [MainThread]: 
[0m00:39:37.678638 [error] [MainThread]: [31mFailure in test not_null_moving_averages_close_price_14d_ma (models/output/schema.yml)[0m
[0m00:39:37.679669 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m00:39:37.680569 [info ] [MainThread]: 
[0m00:39:37.681487 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/not_null_moving_averages_close_price_14d_ma.sql
[0m00:39:37.682509 [info ] [MainThread]: 
[0m00:39:37.683479 [error] [MainThread]: [31mFailure in test not_null_moving_averages_close_price_30d_ma (models/output/schema.yml)[0m
[0m00:39:37.684370 [error] [MainThread]:   Got 69 results, configured to fail if != 0
[0m00:39:37.685306 [info ] [MainThread]: 
[0m00:39:37.686654 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/not_null_moving_averages_close_price_30d_ma.sql
[0m00:39:37.688840 [info ] [MainThread]: 
[0m00:39:37.690338 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:39:37.691467 [info ] [MainThread]: 
[0m00:39:37.692894 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:39:37.694103 [info ] [MainThread]: 
[0m00:39:37.695265 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:37.696248 [info ] [MainThread]: 
[0m00:39:37.697273 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:37.698062 [info ] [MainThread]: 
[0m00:39:37.699085 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:37.699792 [info ] [MainThread]: 
[0m00:39:37.700997 [error] [MainThread]:   Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:37.701845 [info ] [MainThread]: 
[0m00:39:37.702953 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:37.704490 [info ] [MainThread]: 
[0m00:39:37.705327 [error] [MainThread]:   Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:39:37.706265 [info ] [MainThread]: 
[0m00:39:37.707140 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=10 SKIP=0 TOTAL=23
[0m00:39:37.708595 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.963053, "process_user_time": 4.560669, "process_kernel_time": 1.850037, "process_mem_max_rss": "244636", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:39:37.709869 [debug] [MainThread]: Command `dbt test` failed at 00:39:37.709755 after 12.96 seconds
[0m00:39:37.711358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0568a676e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a219b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a153aed0>]}
[0m00:39:37.712195 [debug] [MainThread]: Flushing usage events
[0m00:41:32.278668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86cb514c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86d365b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86cf13530>]}


============================== 00:41:32.285757 | 2e779def-fc02-4bf0-b7a9-8381f5990141 ==============================
[0m00:41:32.285757 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:41:32.286793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:41:33.197060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83701fda0>]}
[0m00:41:33.252006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86da1e840>]}
[0m00:41:33.253774 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:41:33.346392 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:41:33.737711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:41:33.739173 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m00:41:33.944624 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:41:33.946171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd83734baa0>]}
[0m00:41:34.121117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8346b6e40>]}
[0m00:41:34.295806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8347491c0>]}
[0m00:41:34.296934 [info ] [MainThread]: Found 6 models, 22 data tests, 3 sources, 459 macros
[0m00:41:34.297854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8347168d0>]}
[0m00:41:34.301203 [info ] [MainThread]: 
[0m00:41:34.302577 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:41:34.308466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:41:34.322418 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:41:34.323496 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:41:34.324603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:34.851852 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.527 seconds
[0m00:41:34.854087 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:41:34.979942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:41:34.989935 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:41:34.990991 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:41:34.991865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:41:35.307499 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.316 seconds
[0m00:41:35.310143 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:41:35.442635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd836ed2ab0>]}
[0m00:41:35.444356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:41:35.445605 [info ] [MainThread]: 
[0m00:41:35.455264 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:41:35.456667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m00:41:35.457792 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:41:35.465573 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:41:35.490728 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:41:35.491767 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:41:35.492683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:41:35.493601 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:41:35.497039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:41:35.524880 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:41:35.526060 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:41:35.527156 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:41:35.528302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:41:35.529210 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:41:35.532781 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:41:35.563654 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:41:35.593079 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:41:35.622071 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:41:35.623191 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:41:35.624138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:36.502743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m00:41:36.531198 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:41:36.618057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd836e92690>]}
[0m00:41:36.619572 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.09s]
[0m00:41:36.620715 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:41:36.621589 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:41:36.622738 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:41:36.623801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:41:36.624540 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:41:36.628047 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:41:36.644193 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:41:36.648129 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:41:36.662394 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:41:36.663392 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:41:36.664219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:37.542094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.878 seconds
[0m00:41:37.545064 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:41:37.638477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd834443dd0>]}
[0m00:41:37.639964 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.01s]
[0m00:41:37.641364 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:41:37.642586 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:41:37.643651 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:41:37.644649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m00:41:37.645525 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:41:37.665334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:41:37.692924 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:41:37.697444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:41:37.722516 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:41:37.723565 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT *
  FROM __dbt__cte__stock
  WHERE close IS NOT NULL AND close > 0
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average, only if enough rows exist
    CASE 
      WHEN COUNT(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ) = 7
      THEN ROUND(AVG(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2)
      ELSE NULL
    END AS close_price_7d_ma,

    -- 14-day moving average
    CASE 
      WHEN COUNT(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ) = 14
      THEN ROUND(AVG(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2)
      ELSE NULL
    END AS close_price_14d_ma,

    -- 30-day moving average
    CASE 
      WHEN COUNT(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ) = 30
      THEN ROUND(AVG(close) OVER (
        PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2)
      ELSE NULL
    END AS close_price_30d_ma

  FROM base
)

SELECT *
FROM moving_avg_calc
WHERE close_price_7d_ma IS NOT NULL  -- optional: ensure final output passes not_null
ORDER BY symbol, trade_date
        );
[0m00:41:37.724415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:38.897234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.173 seconds
[0m00:41:38.900236 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:41:39.005509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8367c1040>]}
[0m00:41:39.006901 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.36s]
[0m00:41:39.008115 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:41:39.008984 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:41:39.009898 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:41:39.010865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m00:41:39.011659 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:41:39.034453 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:41:39.069499 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:41:39.073156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:41:39.110543 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:41:39.111930 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
  WHERE close > 0  -- Filter out non-positive close prices
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss, only calculate after enough data is available
    CASE 
      WHEN COUNT(gain) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(gain) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_gain_14d,

    CASE 
      WHEN COUNT(loss) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(loss) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      WHEN avg_gain_14d IS NULL OR avg_loss_14d IS NULL THEN NULL  -- Ensure valid RSI
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * 
FROM rsi_final
WHERE rsi_14d IS NOT NULL  -- Ensure that RSI is valid
ORDER BY symbol, trade_date
        );
[0m00:41:39.113142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:40.106833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.994 seconds
[0m00:41:40.109629 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:41:40.222948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e779def-fc02-4bf0-b7a9-8381f5990141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8343c83b0>]}
[0m00:41:40.224219 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.21s]
[0m00:41:40.225445 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:41:40.227871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:40.228836 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:41:40.229963 [info ] [MainThread]: 
[0m00:41:40.230863 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m00:41:40.232372 [debug] [MainThread]: Command end result
[0m00:41:40.448247 [info ] [MainThread]: 
[0m00:41:40.449075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:41:40.449749 [info ] [MainThread]: 
[0m00:41:40.450867 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:41:40.452277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.264661, "process_user_time": 4.077693, "process_kernel_time": 1.963334, "process_mem_max_rss": "234932", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:41:40.453076 [debug] [MainThread]: Command `dbt run` succeeded at 00:41:40.452957 after 8.27 seconds
[0m00:41:40.453654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86d365b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86cd4d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86cda2c60>]}
[0m00:41:40.454191 [debug] [MainThread]: Flushing usage events
[0m00:41:44.288489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9f317800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9fdc88f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9f314080>]}


============================== 00:41:44.296630 | 9a11c2a3-6bb4-46fd-852f-6e98cbcf2c3c ==============================
[0m00:41:44.296630 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:41:44.297865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:41:45.247767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a11c2a3-6bb4-46fd-852f-6e98cbcf2c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6de436b0>]}
[0m00:41:45.293557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a11c2a3-6bb4-46fd-852f-6e98cbcf2c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d75b84320>]}
[0m00:41:45.295316 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:41:45.375000 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:41:45.918377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:41:45.919972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:41:45.960135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a11c2a3-6bb4-46fd-852f-6e98cbcf2c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9f7297c0>]}
[0m00:41:46.171866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a11c2a3-6bb4-46fd-852f-6e98cbcf2c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6d7f3a10>]}
[0m00:41:46.172799 [info ] [MainThread]: Found 6 models, 22 data tests, 3 sources, 459 macros
[0m00:41:46.173683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a11c2a3-6bb4-46fd-852f-6e98cbcf2c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6d962ab0>]}
[0m00:41:46.177122 [info ] [MainThread]: 
[0m00:41:46.178288 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:41:46.184235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:41:46.202788 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:41:46.204201 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:41:46.205428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:46.669776 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.464 seconds
[0m00:41:46.672636 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:41:46.788624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a11c2a3-6bb4-46fd-852f-6e98cbcf2c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3423a10>]}
[0m00:41:46.790037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:41:46.790971 [info ] [MainThread]: 
[0m00:41:46.802814 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:41:46.804230 [info ] [Thread-1 (]: 1 of 22 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:41:46.805641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:41:46.806674 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:41:46.824806 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:41:46.848770 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:41:46.875033 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:41:46.906356 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:41:46.907701 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:41:46.908867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:47.393023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m00:41:47.403749 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:41:47.499133 [error] [Thread-1 (]: 1 of 22 FAIL 21 not_null_moving_averages_close_price_14d_ma .................... [[31mFAIL 21[0m in 0.69s]
[0m00:41:47.500832 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:41:47.501967 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:41:47.502907 [info ] [Thread-1 (]: 2 of 22 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:41:47.503668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:41:47.504376 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:41:47.509325 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:41:47.530558 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:41:47.534317 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:41:47.551998 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:41:47.552808 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:41:47.553482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:47.945316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m00:41:47.947736 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:41:48.056640 [error] [Thread-1 (]: 2 of 22 FAIL 69 not_null_moving_averages_close_price_30d_ma .................... [[31mFAIL 69[0m in 0.55s]
[0m00:41:48.058225 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:41:48.059408 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:41:48.060471 [info ] [Thread-1 (]: 3 of 22 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:41:48.061683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:41:48.062503 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:41:48.068445 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:41:48.110654 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:41:48.115217 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:41:48.153569 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:41:48.154746 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:41:48.155788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:48.447190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m00:41:48.450551 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:41:48.697469 [info ] [Thread-1 (]: 3 of 22 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.64s]
[0m00:41:48.699277 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:41:48.701128 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:41:48.702476 [info ] [Thread-1 (]: 4 of 22 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:41:48.704016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:41:48.705145 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:41:48.710052 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:41:48.742806 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:41:48.747213 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:41:48.787970 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:41:48.789729 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:41:48.791122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:49.214730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m00:41:49.218401 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:41:49.347683 [info ] [Thread-1 (]: 4 of 22 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.64s]
[0m00:41:49.350312 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:41:49.352365 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:41:49.353706 [info ] [Thread-1 (]: 5 of 22 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:41:49.354999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:41:49.356343 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:41:49.361583 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:41:49.401731 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:41:49.407887 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:41:49.429260 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:41:49.430332 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:41:49.431255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:49.831962 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m00:41:49.835029 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:41:49.926840 [info ] [Thread-1 (]: 5 of 22 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.57s]
[0m00:41:49.928195 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:41:49.929247 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:41:49.929956 [info ] [Thread-1 (]: 6 of 22 START test not_null_rsi_rsi_14d ........................................ [RUN]
[0m00:41:49.930685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:41:49.931295 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:41:49.936468 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:41:49.953489 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:41:49.956710 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:41:49.976663 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:41:49.977655 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:41:49.978495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:50.346689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m00:41:50.351212 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:41:50.543844 [info ] [Thread-1 (]: 6 of 22 PASS not_null_rsi_rsi_14d .............................................. [[32mPASS[0m in 0.61s]
[0m00:41:50.545114 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:41:50.545916 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:41:50.546634 [info ] [Thread-1 (]: 7 of 22 START test not_null_rsi_symbol ......................................... [RUN]
[0m00:41:50.547395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:41:50.548265 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:41:50.553996 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:41:50.572643 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:41:50.576483 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:41:50.595061 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:41:50.595952 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:41:50.596564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:50.944097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m00:41:50.946745 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:41:51.069407 [info ] [Thread-1 (]: 7 of 22 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.52s]
[0m00:41:51.071687 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:41:51.073061 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:41:51.074309 [info ] [Thread-1 (]: 8 of 22 START test not_null_rsi_trade_date ..................................... [RUN]
[0m00:41:51.075615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:41:51.076735 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:41:51.082311 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:41:51.113249 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:41:51.118605 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:41:51.152237 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:41:51.153517 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:41:51.154742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:51.528550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m00:41:51.534154 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:41:51.626648 [info ] [Thread-1 (]: 8 of 22 PASS not_null_rsi_trade_date ........................................... [[32mPASS[0m in 0.55s]
[0m00:41:51.628798 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:41:51.630219 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:41:51.631560 [info ] [Thread-1 (]: 9 of 22 START test not_null_stock_indicators_rsi_14d ........................... [RUN]
[0m00:41:51.633394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:41:51.635150 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:41:51.640618 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:41:51.681685 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:41:51.687335 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:41:51.729608 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:41:51.731099 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:41:51.732245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:52.067967 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe469-0205-0f94-0004-59ff002d567a
[0m00:41:52.069368 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m00:41:52.070604 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:41:52.169423 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:41:52.170958 [error] [Thread-1 (]: 9 of 22 ERROR not_null_stock_indicators_rsi_14d ................................ [[31mERROR[0m in 0.54s]
[0m00:41:52.172415 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:41:52.173676 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:41:52.174891 [info ] [Thread-1 (]: 10 of 22 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:41:52.176078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:41:52.177201 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:41:52.181817 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:41:52.226053 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:41:52.230609 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:41:52.268864 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:41:52.269924 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:41:52.270936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:52.712648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m00:41:52.715372 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:41:52.805172 [info ] [Thread-1 (]: 10 of 22 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.63s]
[0m00:41:52.806393 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:41:52.807333 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:41:52.808145 [info ] [Thread-1 (]: 11 of 22 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:41:52.809110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:41:52.809830 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:41:52.814699 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:41:52.835337 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:41:52.838856 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:41:52.854664 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:41:52.855562 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:41:52.856374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:53.184377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m00:41:53.189818 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:41:53.304209 [info ] [Thread-1 (]: 11 of 22 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.49s]
[0m00:41:53.307102 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:41:53.309121 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:41:53.310749 [info ] [Thread-1 (]: 12 of 22 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:41:53.312285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:41:53.313505 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:41:53.320670 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:41:53.356997 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:41:53.360594 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:41:53.387765 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:41:53.388755 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:41:53.389458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:53.780054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m00:41:53.783093 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:41:53.876509 [info ] [Thread-1 (]: 12 of 22 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.56s]
[0m00:41:53.877858 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:41:53.878720 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:41:53.879575 [info ] [Thread-1 (]: 13 of 22 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:41:53.880697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:41:53.881622 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:41:53.888311 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:41:53.913165 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:41:53.916776 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:41:53.944105 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:41:53.945136 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:41:53.946029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:54.207168 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe469-0205-0c98-0004-59ff002d71f6
[0m00:41:54.208340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m00:41:54.209406 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:41:54.339077 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:41:54.340885 [error] [Thread-1 (]: 13 of 22 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.46s]
[0m00:41:54.342809 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:41:54.344330 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:41:54.345447 [info ] [Thread-1 (]: 14 of 22 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:41:54.346781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:41:54.347987 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:41:54.355910 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:41:54.383866 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:41:54.387959 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:41:54.409322 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:41:54.410525 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:41:54.411591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:54.789684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m00:41:54.792792 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:41:54.887472 [info ] [Thread-1 (]: 14 of 22 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.54s]
[0m00:41:54.889564 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:41:54.891184 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:41:54.892574 [info ] [Thread-1 (]: 15 of 22 START test positive_values_moving_averages_close_price_14d_ma ......... [RUN]
[0m00:41:54.893919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0)
[0m00:41:54.894913 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:41:54.902927 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:54.904583 [error] [Thread-1 (]: 15 of 22 ERROR positive_values_moving_averages_close_price_14d_ma .............. [[31mERROR[0m in 0.01s]
[0m00:41:54.905780 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:41:54.907234 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:41:54.908488 [info ] [Thread-1 (]: 16 of 22 START test positive_values_moving_averages_close_price_30d_ma ......... [RUN]
[0m00:41:54.909629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0, now test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77)
[0m00:41:54.910832 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:41:54.917355 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:54.918886 [error] [Thread-1 (]: 16 of 22 ERROR positive_values_moving_averages_close_price_30d_ma .............. [[31mERROR[0m in 0.01s]
[0m00:41:54.920302 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:41:54.921323 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:41:54.922408 [info ] [Thread-1 (]: 17 of 22 START test positive_values_moving_averages_close_price_7d_ma .......... [RUN]
[0m00:41:54.923879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77, now test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba)
[0m00:41:54.924922 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:41:54.930277 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:54.931695 [error] [Thread-1 (]: 17 of 22 ERROR positive_values_moving_averages_close_price_7d_ma ............... [[31mERROR[0m in 0.01s]
[0m00:41:54.933042 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:41:54.934642 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:41:54.935739 [info ] [Thread-1 (]: 18 of 22 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m00:41:54.937109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m00:41:54.938183 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:41:54.943952 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:54.945206 [error] [Thread-1 (]: 18 of 22 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.01s]
[0m00:41:54.946665 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:41:54.947804 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:41:54.949035 [info ] [Thread-1 (]: 19 of 22 START test range_stock_indicators_rsi_14d__100__0 ..................... [RUN]
[0m00:41:54.950395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4)
[0m00:41:54.951719 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:41:54.957333 [debug] [Thread-1 (]: Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:54.958586 [error] [Thread-1 (]: 19 of 22 ERROR range_stock_indicators_rsi_14d__100__0 .......................... [[31mERROR[0m in 0.01s]
[0m00:41:54.959786 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:41:54.960949 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:41:54.962059 [info ] [Thread-1 (]: 20 of 22 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m00:41:54.963359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m00:41:54.964277 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:41:54.973225 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:41:55.016286 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:41:55.021403 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:41:55.052950 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:41:55.054108 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:41:55.054980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:55.535391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m00:41:55.538439 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m00:41:55.652334 [info ] [Thread-1 (]: 20 of 22 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.69s]
[0m00:41:55.654593 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:41:55.656140 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:41:55.657340 [info ] [Thread-1 (]: 21 of 22 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m00:41:55.658774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m00:41:55.659861 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:41:55.666155 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:41:55.698659 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:41:55.705235 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:41:55.747403 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:41:55.748819 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:41:55.750249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:56.218110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m00:41:56.222631 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m00:41:56.354576 [info ] [Thread-1 (]: 21 of 22 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.70s]
[0m00:41:56.356064 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:41:56.357136 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:41:56.358062 [info ] [Thread-1 (]: 22 of 22 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m00:41:56.359127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m00:41:56.360026 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:41:56.366570 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:41:56.403469 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:41:56.412187 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:41:56.446972 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:41:56.448283 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:41:56.449300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:41:56.851825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m00:41:56.854647 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m00:41:56.964954 [info ] [Thread-1 (]: 22 of 22 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.61s]
[0m00:41:56.967404 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:41:56.970285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:56.971197 [debug] [MainThread]: Connection 'test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5' was properly closed.
[0m00:41:56.972137 [info ] [MainThread]: 
[0m00:41:56.972967 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 10.79 seconds (10.79s).
[0m00:41:56.975964 [debug] [MainThread]: Command end result
[0m00:41:57.078025 [info ] [MainThread]: 
[0m00:41:57.079052 [info ] [MainThread]: [31mCompleted with 9 errors and 0 warnings:[0m
[0m00:41:57.079852 [info ] [MainThread]: 
[0m00:41:57.080673 [error] [MainThread]: [31mFailure in test not_null_moving_averages_close_price_14d_ma (models/output/schema.yml)[0m
[0m00:41:57.081567 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m00:41:57.082444 [info ] [MainThread]: 
[0m00:41:57.083478 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/not_null_moving_averages_close_price_14d_ma.sql
[0m00:41:57.084621 [info ] [MainThread]: 
[0m00:41:57.085703 [error] [MainThread]: [31mFailure in test not_null_moving_averages_close_price_30d_ma (models/output/schema.yml)[0m
[0m00:41:57.086664 [error] [MainThread]:   Got 69 results, configured to fail if != 0
[0m00:41:57.087567 [info ] [MainThread]: 
[0m00:41:57.088310 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/not_null_moving_averages_close_price_30d_ma.sql
[0m00:41:57.088950 [info ] [MainThread]: 
[0m00:41:57.089683 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:41:57.090406 [info ] [MainThread]: 
[0m00:41:57.091007 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:41:57.091817 [info ] [MainThread]: 
[0m00:41:57.092578 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:57.093132 [info ] [MainThread]: 
[0m00:41:57.093769 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:57.094272 [info ] [MainThread]: 
[0m00:41:57.094860 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:57.095412 [info ] [MainThread]: 
[0m00:41:57.095948 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:57.096436 [info ] [MainThread]: 
[0m00:41:57.096903 [error] [MainThread]:   Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:41:57.097517 [info ] [MainThread]: 
[0m00:41:57.098024 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=9 SKIP=0 TOTAL=22
[0m00:41:57.099320 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.914996, "process_user_time": 4.396509, "process_kernel_time": 1.983934, "process_mem_max_rss": "242992", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:41:57.100710 [debug] [MainThread]: Command `dbt test` failed at 00:41:57.100505 after 12.92 seconds
[0m00:41:57.101647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9f677bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da35d29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da35d29f0>]}
[0m00:41:57.102412 [debug] [MainThread]: Flushing usage events
[0m00:46:26.829252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9244a56c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92455b7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9244e17530>]}


============================== 00:46:26.837934 | 95b9ca1d-d2b1-4af3-bc53-8181246a4ee2 ==============================
[0m00:46:26.837934 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:46:26.839300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:46:27.813030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920fb0c890>]}
[0m00:46:27.874092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920f2fc950>]}
[0m00:46:27.875607 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:46:27.961722 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:46:28.373211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:46:28.374558 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:46:28.595326 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:46:28.596277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92163d7590>]}
[0m00:46:28.797522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920c5bbc80>]}
[0m00:46:28.985487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920ea50980>]}
[0m00:46:28.986686 [info ] [MainThread]: Found 6 models, 22 data tests, 3 sources, 459 macros
[0m00:46:28.988012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920e8da240>]}
[0m00:46:28.991670 [info ] [MainThread]: 
[0m00:46:28.993006 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:46:28.998609 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:46:29.012082 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:46:29.013395 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:46:29.014490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:29.682398 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.668 seconds
[0m00:46:29.684677 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:46:29.797737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:46:29.809709 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:46:29.810907 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:46:29.811889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:46:30.141880 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.330 seconds
[0m00:46:30.144792 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:46:30.477649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920edd2ff0>]}
[0m00:46:30.478814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:46:30.479583 [info ] [MainThread]: 
[0m00:46:30.489526 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:46:30.490835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m00:46:30.491942 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:46:30.500598 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:46:30.525763 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:46:30.526743 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:46:30.527809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:46:30.528733 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:46:30.532600 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:46:30.552986 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:46:30.554208 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:46:30.555529 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:46:30.556732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:46:30.557649 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:46:30.561647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:46:30.584245 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:46:30.616627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:46:30.650381 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:46:30.651548 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:46:30.652656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:31.534495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.882 seconds
[0m00:46:31.563429 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:46:31.659527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920ed92e40>]}
[0m00:46:31.660893 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.10s]
[0m00:46:31.662031 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:46:31.662989 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:46:31.663966 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:46:31.665073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:46:31.665951 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:46:31.670641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:46:31.695413 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:46:31.698900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:46:31.723999 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:46:31.725118 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:46:31.726046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:32.569475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m00:46:32.573144 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:46:32.670318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920c34ec90>]}
[0m00:46:32.672107 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.00s]
[0m00:46:32.673701 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:46:32.674685 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:46:32.675630 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:46:32.676477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m00:46:32.677196 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:46:32.688785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:46:32.714970 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:46:32.719269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:46:32.741761 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:46:32.742890 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m00:46:32.743947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:33.570990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.827 seconds
[0m00:46:33.574259 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:46:33.662336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9245e93c20>]}
[0m00:46:33.663844 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 0.99s]
[0m00:46:33.665121 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:46:33.666050 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:46:33.667071 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:46:33.667935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m00:46:33.668758 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:46:33.691957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:46:33.715618 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:46:33.719418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:46:33.742977 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:46:33.744248 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
  WHERE close > 0  -- Filter out non-positive close prices
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss, only calculate after enough data is available
    CASE 
      WHEN COUNT(gain) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(gain) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_gain_14d,

    CASE 
      WHEN COUNT(loss) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(loss) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      WHEN avg_gain_14d IS NULL OR avg_loss_14d IS NULL THEN NULL  -- Ensure valid RSI
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * 
FROM rsi_final
WHERE rsi_14d IS NOT NULL  -- Ensure that RSI is valid
ORDER BY symbol, trade_date
        );
[0m00:46:33.745605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:34.794844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.049 seconds
[0m00:46:34.797731 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:46:34.892113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95b9ca1d-d2b1-4af3-bc53-8181246a4ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f920c354320>]}
[0m00:46:34.893324 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.22s]
[0m00:46:34.894693 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:46:34.899030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:34.900302 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:46:34.901549 [info ] [MainThread]: 
[0m00:46:34.902311 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.91 seconds (5.91s).
[0m00:46:34.903752 [debug] [MainThread]: Command end result
[0m00:46:35.095344 [info ] [MainThread]: 
[0m00:46:35.096739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:46:35.097892 [info ] [MainThread]: 
[0m00:46:35.098996 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:46:35.101019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.3779335, "process_user_time": 4.113154, "process_kernel_time": 1.941695, "process_mem_max_rss": "235892", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:46:35.102236 [debug] [MainThread]: Command `dbt run` succeeded at 00:46:35.102045 after 8.38 seconds
[0m00:46:35.103633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92442c35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92451f9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92451d5b20>]}
[0m00:46:35.105195 [debug] [MainThread]: Flushing usage events
[0m00:46:38.777904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51774321b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5179acb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5179acb860>]}


============================== 00:46:38.784454 | fb860351-e2f4-4832-b623-de6b05dd574f ==============================
[0m00:46:38.784454 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:46:38.785560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:46:39.786116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb860351-e2f4-4832-b623-de6b05dd574f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51789cea20>]}
[0m00:46:39.836950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb860351-e2f4-4832-b623-de6b05dd574f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51459e3320>]}
[0m00:46:39.838772 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:46:39.924214 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:46:40.443616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:46:40.444815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:46:40.486725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb860351-e2f4-4832-b623-de6b05dd574f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51456d5370>]}
[0m00:46:40.693665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb860351-e2f4-4832-b623-de6b05dd574f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51450339e0>]}
[0m00:46:40.695436 [info ] [MainThread]: Found 6 models, 22 data tests, 3 sources, 459 macros
[0m00:46:40.696917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb860351-e2f4-4832-b623-de6b05dd574f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5145574500>]}
[0m00:46:40.700848 [info ] [MainThread]: 
[0m00:46:40.702385 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:46:40.708332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:46:40.723956 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:46:40.725429 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:46:40.726510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:41.176229 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.450 seconds
[0m00:46:41.178893 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:46:41.290046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb860351-e2f4-4832-b623-de6b05dd574f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514527fa70>]}
[0m00:46:41.291119 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:46:41.291965 [info ] [MainThread]: 
[0m00:46:41.300640 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:46:41.301711 [info ] [Thread-1 (]: 1 of 22 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:46:41.302618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:46:41.303398 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:46:41.318115 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:46:41.340500 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:46:41.369652 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:46:41.401806 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:46:41.403267 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:46:41.404757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:41.792749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m00:46:41.805041 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:46:41.924655 [info ] [Thread-1 (]: 1 of 22 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.62s]
[0m00:46:41.925925 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:46:41.926834 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:46:41.927649 [info ] [Thread-1 (]: 2 of 22 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:46:41.928604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:46:41.929325 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:46:41.934454 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:46:41.960352 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:46:41.963830 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:46:41.988191 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:46:41.989741 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:46:41.990714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:42.414090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m00:46:42.416923 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:46:42.517101 [info ] [Thread-1 (]: 2 of 22 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.59s]
[0m00:46:42.519285 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:46:42.521035 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:46:42.522768 [info ] [Thread-1 (]: 3 of 22 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:46:42.524293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:46:42.525663 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:46:42.531373 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:46:42.558931 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:46:42.562458 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:46:42.591501 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:46:42.592715 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:46:42.593756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:43.036043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m00:46:43.040274 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:46:43.161028 [info ] [Thread-1 (]: 3 of 22 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.64s]
[0m00:46:43.163315 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:46:43.165059 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:46:43.166902 [info ] [Thread-1 (]: 4 of 22 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:46:43.168584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:46:43.169896 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:46:43.175843 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:46:43.209259 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:46:43.213563 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:46:43.243060 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:46:43.245293 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:46:43.246786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:43.680198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m00:46:43.683240 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:46:43.769216 [info ] [Thread-1 (]: 4 of 22 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.60s]
[0m00:46:43.770491 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:46:43.771837 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:46:43.773254 [info ] [Thread-1 (]: 5 of 22 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:46:43.774557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:46:43.775561 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:46:43.781292 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:46:43.811074 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:46:43.816396 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:46:43.842595 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:46:43.843741 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:46:43.844649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:44.135382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m00:46:44.140112 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:46:44.236424 [info ] [Thread-1 (]: 5 of 22 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.46s]
[0m00:46:44.238613 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:46:44.240354 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:46:44.242088 [info ] [Thread-1 (]: 6 of 22 START test not_null_rsi_rsi_14d ........................................ [RUN]
[0m00:46:44.244001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:46:44.245643 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:46:44.251676 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:46:44.283418 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:46:44.287668 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:46:44.317475 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:46:44.318540 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:46:44.319603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:44.675495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m00:46:44.678478 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:46:44.773706 [info ] [Thread-1 (]: 6 of 22 PASS not_null_rsi_rsi_14d .............................................. [[32mPASS[0m in 0.53s]
[0m00:46:44.775544 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:46:44.776805 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:46:44.777916 [info ] [Thread-1 (]: 7 of 22 START test not_null_rsi_symbol ......................................... [RUN]
[0m00:46:44.779120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:46:44.780119 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:46:44.785386 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:46:44.820335 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:46:44.826133 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:46:44.857027 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:46:44.858917 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:46:44.860272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:45.276342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m00:46:45.280158 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:46:45.592633 [info ] [Thread-1 (]: 7 of 22 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.81s]
[0m00:46:45.593974 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:46:45.594958 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:46:45.595891 [info ] [Thread-1 (]: 8 of 22 START test not_null_rsi_trade_date ..................................... [RUN]
[0m00:46:45.596958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:46:45.597841 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:46:45.603178 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:46:45.631269 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:46:45.634888 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:46:45.663062 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:46:45.664023 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:46:45.665000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:46.004996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.340 seconds
[0m00:46:46.009865 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:46:46.126217 [info ] [Thread-1 (]: 8 of 22 PASS not_null_rsi_trade_date ........................................... [[32mPASS[0m in 0.53s]
[0m00:46:46.127508 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:46:46.128265 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:46:46.129045 [info ] [Thread-1 (]: 9 of 22 START test not_null_stock_indicators_rsi_14d ........................... [RUN]
[0m00:46:46.129960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:46:46.130779 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:46:46.135940 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:46:46.165427 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:46:46.168932 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:46:46.192787 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:46:46.193732 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:46:46.194495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:46.586468 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe46e-0205-0fb8-0004-59ff002d668a
[0m00:46:46.587813 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m00:46:46.589423 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:46:46.723605 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:46:46.724882 [error] [Thread-1 (]: 9 of 22 ERROR not_null_stock_indicators_rsi_14d ................................ [[31mERROR[0m in 0.59s]
[0m00:46:46.726095 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:46:46.726987 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:46:46.728228 [info ] [Thread-1 (]: 10 of 22 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:46:46.729224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:46:46.730165 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:46:46.735163 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:46:46.755161 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:46:46.758396 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:46:46.777091 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:46:46.778033 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:46:46.778808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:47.106429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m00:46:47.109983 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:46:47.219962 [info ] [Thread-1 (]: 10 of 22 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.49s]
[0m00:46:47.222330 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:46:47.224128 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:46:47.225752 [info ] [Thread-1 (]: 11 of 22 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:46:47.227183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:46:47.228487 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:46:47.233985 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:46:47.275624 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:46:47.279664 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:46:47.320250 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:46:47.321633 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:46:47.322757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:47.762680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m00:46:47.767289 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:46:47.873317 [info ] [Thread-1 (]: 11 of 22 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.65s]
[0m00:46:47.874761 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:46:47.879899 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:46:47.880872 [info ] [Thread-1 (]: 12 of 22 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:46:47.881920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:46:47.882809 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:46:47.890806 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:46:47.911299 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:46:47.914876 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:46:47.930868 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:46:47.931783 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:46:47.932495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:48.267854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.335 seconds
[0m00:46:48.271210 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:46:48.392684 [info ] [Thread-1 (]: 12 of 22 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.51s]
[0m00:46:48.394004 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:46:48.394993 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:46:48.395799 [info ] [Thread-1 (]: 13 of 22 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:46:48.396780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:46:48.397546 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:46:48.402634 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:46:48.426870 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:46:48.430507 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:46:48.456984 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:46:48.457957 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:46:48.458846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:48.749042 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe46e-0205-0f94-0004-59ff002d586a
[0m00:46:48.750970 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m00:46:48.752941 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:46:48.886526 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:46:48.887758 [error] [Thread-1 (]: 13 of 22 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.49s]
[0m00:46:48.889114 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:46:48.890206 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:46:48.891140 [info ] [Thread-1 (]: 14 of 22 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:46:48.892493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:46:48.893621 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:46:48.898798 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:46:48.927768 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:46:48.931816 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:46:48.959975 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:46:48.961113 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:46:48.962092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:49.265301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m00:46:49.269659 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:46:49.375558 [info ] [Thread-1 (]: 14 of 22 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.48s]
[0m00:46:49.377348 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:46:49.378584 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:46:49.379862 [info ] [Thread-1 (]: 15 of 22 START test positive_values_moving_averages_close_price_14d_ma ......... [RUN]
[0m00:46:49.381245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0)
[0m00:46:49.382401 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:46:49.389441 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:49.390829 [error] [Thread-1 (]: 15 of 22 ERROR positive_values_moving_averages_close_price_14d_ma .............. [[31mERROR[0m in 0.01s]
[0m00:46:49.392199 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:46:49.393430 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:46:49.394614 [info ] [Thread-1 (]: 16 of 22 START test positive_values_moving_averages_close_price_30d_ma ......... [RUN]
[0m00:46:49.395886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0, now test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77)
[0m00:46:49.397093 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:46:49.402514 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:49.403881 [error] [Thread-1 (]: 16 of 22 ERROR positive_values_moving_averages_close_price_30d_ma .............. [[31mERROR[0m in 0.01s]
[0m00:46:49.405429 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:46:49.406817 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:46:49.407934 [info ] [Thread-1 (]: 17 of 22 START test positive_values_moving_averages_close_price_7d_ma .......... [RUN]
[0m00:46:49.409293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77, now test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba)
[0m00:46:49.410493 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:46:49.416325 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:49.417801 [error] [Thread-1 (]: 17 of 22 ERROR positive_values_moving_averages_close_price_7d_ma ............... [[31mERROR[0m in 0.01s]
[0m00:46:49.419098 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:46:49.420393 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:46:49.421790 [info ] [Thread-1 (]: 18 of 22 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m00:46:49.423389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m00:46:49.424591 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:46:49.429784 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:49.431148 [error] [Thread-1 (]: 18 of 22 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.01s]
[0m00:46:49.432535 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:46:49.433711 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:46:49.435119 [info ] [Thread-1 (]: 19 of 22 START test range_stock_indicators_rsi_14d__100__0 ..................... [RUN]
[0m00:46:49.436332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4)
[0m00:46:49.437733 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:46:49.442904 [debug] [Thread-1 (]: Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:49.444204 [error] [Thread-1 (]: 19 of 22 ERROR range_stock_indicators_rsi_14d__100__0 .......................... [[31mERROR[0m in 0.01s]
[0m00:46:49.445606 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:46:49.446751 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:46:49.447940 [info ] [Thread-1 (]: 20 of 22 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m00:46:49.449267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m00:46:49.450278 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:46:49.459264 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:46:49.500256 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:46:49.504017 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:46:49.544040 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:46:49.545517 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:46:49.546848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:50.033034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m00:46:50.037589 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m00:46:50.130857 [info ] [Thread-1 (]: 20 of 22 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.68s]
[0m00:46:50.132505 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:46:50.133666 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:46:50.134712 [info ] [Thread-1 (]: 21 of 22 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m00:46:50.136168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m00:46:50.137553 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:46:50.144639 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:46:50.173268 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:46:50.178851 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:46:50.209261 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:46:50.210711 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:46:50.211793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:50.739686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m00:46:50.744091 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m00:46:50.843719 [info ] [Thread-1 (]: 21 of 22 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.71s]
[0m00:46:50.844882 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:46:50.845772 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:46:50.846558 [info ] [Thread-1 (]: 22 of 22 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m00:46:50.847441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m00:46:50.848318 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:46:50.855490 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:46:50.874687 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:46:50.878403 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:46:50.899994 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:46:50.901129 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:46:50.902321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:51.334192 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m00:46:51.337095 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m00:46:51.468089 [info ] [Thread-1 (]: 22 of 22 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.62s]
[0m00:46:51.469622 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:46:51.472393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:51.473418 [debug] [MainThread]: Connection 'test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5' was properly closed.
[0m00:46:51.474378 [info ] [MainThread]: 
[0m00:46:51.475433 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 10.77 seconds (10.77s).
[0m00:46:51.478335 [debug] [MainThread]: Command end result
[0m00:46:51.605455 [info ] [MainThread]: 
[0m00:46:51.606457 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m00:46:51.607385 [info ] [MainThread]: 
[0m00:46:51.608619 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:46:51.609652 [info ] [MainThread]: 
[0m00:46:51.610654 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:46:51.611486 [info ] [MainThread]: 
[0m00:46:51.612374 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:51.613162 [info ] [MainThread]: 
[0m00:46:51.614022 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:51.614862 [info ] [MainThread]: 
[0m00:46:51.615669 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:51.616428 [info ] [MainThread]: 
[0m00:46:51.617185 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:51.617805 [info ] [MainThread]: 
[0m00:46:51.618610 [error] [MainThread]:   Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:46:51.619441 [info ] [MainThread]: 
[0m00:46:51.620497 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=7 SKIP=0 TOTAL=22
[0m00:46:51.621873 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.938538, "process_user_time": 4.45422, "process_kernel_time": 1.937958, "process_mem_max_rss": "244072", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:46:51.623054 [debug] [MainThread]: Command `dbt test` failed at 00:46:51.622897 after 12.94 seconds
[0m00:46:51.623985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5177778c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51799f2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514592b2f0>]}
[0m00:46:51.624753 [debug] [MainThread]: Flushing usage events
[0m00:49:52.560888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba2f220f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba3c4d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba2f22300>]}


============================== 00:49:52.567763 | 0895a410-b5e3-4de9-8bb0-a522000a7c73 ==============================
[0m00:49:52.567763 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:49:52.569092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:49:53.504482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b71195d30>]}
[0m00:49:53.549179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b730e9d30>]}
[0m00:49:53.550860 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:49:53.624750 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:49:54.113225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:49:54.114505 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:49:54.302856 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:49:54.304094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba2eb7bf0>]}
[0m00:49:54.527390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b71021d90>]}
[0m00:49:54.721639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b70fd55e0>]}
[0m00:49:54.722774 [info ] [MainThread]: Found 6 models, 22 data tests, 3 sources, 459 macros
[0m00:49:54.723840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b70ce0080>]}
[0m00:49:54.727726 [info ] [MainThread]: 
[0m00:49:54.729274 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:49:54.735081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:49:54.751408 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:49:54.752669 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:49:54.753661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:55.244327 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.491 seconds
[0m00:49:55.247691 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:49:55.394674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:49:55.403903 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:49:55.405318 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:49:55.406523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:49:55.786141 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.380 seconds
[0m00:49:55.788980 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:49:55.885834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b7135a810>]}
[0m00:49:55.887306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:49:55.888293 [info ] [MainThread]: 
[0m00:49:55.898139 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:49:55.899452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m00:49:55.900412 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:49:55.912764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:49:55.936470 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:49:55.937514 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:49:55.938374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:49:55.939135 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:49:55.942940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:49:55.965468 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:49:55.966610 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:49:55.967835 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:49:55.969015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:49:55.970476 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:49:55.975591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:49:55.995391 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:49:56.031327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:49:56.055697 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:49:56.057461 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:49:56.058910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:56.992549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.934 seconds
[0m00:49:57.014922 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:49:57.116314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b7131a420>]}
[0m00:49:57.117898 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.15s]
[0m00:49:57.119237 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:49:57.120165 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:49:57.121263 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:49:57.122299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:49:57.123258 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:49:57.127982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:49:57.155246 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:49:57.159374 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:49:57.195086 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:49:57.196746 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:49:57.198284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:58.288844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.091 seconds
[0m00:49:58.291862 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:49:58.521767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b620c8200>]}
[0m00:49:58.523168 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.40s]
[0m00:49:58.524678 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:49:58.525666 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:49:58.526700 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:49:58.527703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m00:49:58.528574 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:49:58.542853 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:49:58.567808 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:49:58.572150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:49:58.596752 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:49:58.597923 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
    SELECT
        symbol,
        trade_date,
        close,

        -- 7-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_7d_ma,

        -- 14-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_14d_ma,

        -- 30-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_30d_ma

    FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date;
[0m00:49:58.599040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:49:58.875574 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe471-0205-0fb8-0004-59ff002d679a
[0m00:49:58.876778 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 50 at position 27 unexpected ';'.
[0m00:49:58.877932 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:49:58.971638 [debug] [Thread-1 (]: Database Error in model moving_averages (models/output/moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/moving_averages.sql
[0m00:49:58.972704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b62076960>]}
[0m00:49:58.974394 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model analytics.moving_averages ................ [[31mERROR[0m in 0.45s]
[0m00:49:58.975835 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:49:58.976633 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:49:58.978315 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:49:58.979269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m00:49:58.980094 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:49:59.002701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:49:59.025568 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:49:59.029112 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:49:59.053115 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:49:59.054362 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
  WHERE close > 0  -- Filter out non-positive close prices
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss, only calculate after enough data is available
    CASE 
      WHEN COUNT(gain) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(gain) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_gain_14d,

    CASE 
      WHEN COUNT(loss) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(loss) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      WHEN avg_gain_14d IS NULL OR avg_loss_14d IS NULL THEN NULL  -- Ensure valid RSI
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * 
FROM rsi_final
WHERE rsi_14d IS NOT NULL  -- Ensure that RSI is valid
ORDER BY symbol, trade_date
        );
[0m00:49:59.055464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:50:00.104171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.049 seconds
[0m00:50:00.107947 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:50:00.197464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0895a410-b5e3-4de9-8bb0-a522000a7c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b620a7f50>]}
[0m00:50:00.198952 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.22s]
[0m00:50:00.200225 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:50:00.202877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:50:00.203760 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:50:00.204849 [info ] [MainThread]: 
[0m00:50:00.205681 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m00:50:00.207266 [debug] [MainThread]: Command end result
[0m00:50:00.421133 [info ] [MainThread]: 
[0m00:50:00.422265 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:50:00.423572 [info ] [MainThread]: 
[0m00:50:00.425075 [error] [MainThread]:   Database Error in model moving_averages (models/output/moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/moving_averages.sql
[0m00:50:00.426175 [info ] [MainThread]: 
[0m00:50:00.427243 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:50:00.429065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.965745, "process_user_time": 4.024299, "process_kernel_time": 1.981967, "process_mem_max_rss": "238884", "process_in_blocks": "40", "process_out_blocks": "8", "command_success": false}
[0m00:50:00.429928 [debug] [MainThread]: Command `dbt run` failed at 00:50:00.429768 after 7.97 seconds
[0m00:50:00.430880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba3c4d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba3751280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba36eac90>]}
[0m00:50:00.431983 [debug] [MainThread]: Flushing usage events
[0m00:50:40.496861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca857bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca857be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca857bd10>]}


============================== 00:50:40.504250 | 0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3 ==============================
[0m00:50:40.504250 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:50:40.505387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:50:41.608402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca9d9a480>]}
[0m00:50:41.667791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cac541d30>]}
[0m00:50:41.669359 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:50:41.756106 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:50:42.622496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:50:42.624726 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m00:50:42.842181 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:50:42.843433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c72a9b7d0>]}
[0m00:50:43.078488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca9cfe2d0>]}
[0m00:50:43.335346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c72816930>]}
[0m00:50:43.337440 [info ] [MainThread]: Found 6 models, 22 data tests, 3 sources, 459 macros
[0m00:50:43.339322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7046d4c0>]}
[0m00:50:43.343838 [info ] [MainThread]: 
[0m00:50:43.345649 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:50:43.354793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:50:43.379854 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:50:43.381488 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:50:43.382964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:44.123410 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.740 seconds
[0m00:50:44.126375 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:50:44.237657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:50:44.247810 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:50:44.248974 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:50:44.249981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:50:44.642587 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.393 seconds
[0m00:50:44.645876 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:50:44.773642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c726099a0>]}
[0m00:50:44.775340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:50:44.776386 [info ] [MainThread]: 
[0m00:50:44.786113 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:50:44.787199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m00:50:44.788459 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:50:44.798154 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:50:44.823437 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:50:44.824925 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:50:44.826493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:50:44.827539 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:50:44.831550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:50:44.854925 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:50:44.856110 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:50:44.857258 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:50:44.858357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:50:44.859431 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:50:44.863268 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:50:44.888954 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:50:44.923509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:50:44.964665 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:50:44.965898 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:50:44.967175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:50:46.104602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m00:50:46.141135 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:50:46.240354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c72b8ad50>]}
[0m00:50:46.241931 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.38s]
[0m00:50:46.243204 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:50:46.244332 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:50:46.245506 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:50:46.246870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:50:46.247873 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:50:46.253301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:50:46.277686 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:50:46.281542 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:50:46.304826 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:50:46.306244 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:50:46.307292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:50:47.412034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.105 seconds
[0m00:50:47.415039 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:50:47.558226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c70147140>]}
[0m00:50:47.559521 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.31s]
[0m00:50:47.560794 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:50:47.561798 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:50:47.562945 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:50:47.564017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m00:50:47.565210 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:50:47.591317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:50:47.616475 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:50:47.621734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:50:47.649813 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:50:47.651338 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
    SELECT
        symbol,
        trade_date,
        close,

        -- 7-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_7d_ma,

        -- 14-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_14d_ma,

        -- 30-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_30d_ma

    FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m00:50:47.652868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:50:48.648216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.995 seconds
[0m00:50:48.652333 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:50:48.767450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca9cff860>]}
[0m00:50:48.769302 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.20s]
[0m00:50:48.771829 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:50:48.773440 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:50:48.774960 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:50:48.776307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m00:50:48.777542 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:50:48.805315 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:50:48.831461 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:50:48.835613 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:50:48.865168 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:50:48.866557 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
  WHERE close > 0  -- Filter out non-positive close prices
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss, only calculate after enough data is available
    CASE 
      WHEN COUNT(gain) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(gain) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_gain_14d,

    CASE 
      WHEN COUNT(loss) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(loss) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      WHEN avg_gain_14d IS NULL OR avg_loss_14d IS NULL THEN NULL  -- Ensure valid RSI
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * 
FROM rsi_final
WHERE rsi_14d IS NOT NULL  -- Ensure that RSI is valid
ORDER BY symbol, trade_date
        );
[0m00:50:48.867555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:50:49.780187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.913 seconds
[0m00:50:49.783166 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:50:49.868853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa43b26-2a84-4283-aad2-1a2ce8a0a9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c700e7e60>]}
[0m00:50:49.870165 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.09s]
[0m00:50:49.872062 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:50:49.875694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:50:49.876756 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:50:49.878049 [info ] [MainThread]: 
[0m00:50:49.879397 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m00:50:49.881269 [debug] [MainThread]: Command end result
[0m00:50:50.089971 [info ] [MainThread]: 
[0m00:50:50.091043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:50:50.092025 [info ] [MainThread]: 
[0m00:50:50.093278 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:50:50.094969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.714254, "process_user_time": 4.457933, "process_kernel_time": 2.07836, "process_mem_max_rss": "250992", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:50:50.096482 [debug] [MainThread]: Command `dbt run` succeeded at 00:50:50.096228 after 9.72 seconds
[0m00:50:50.098020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cac6e6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7289bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca9b856d0>]}
[0m00:50:50.099577 [debug] [MainThread]: Flushing usage events
[0m00:50:54.282272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb995dfaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9cf29a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9aff4380>]}


============================== 00:50:54.294980 | 3ea73624-08eb-4018-a89a-3fd305e59768 ==============================
[0m00:50:54.294980 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:50:54.296622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:50:55.329328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ea73624-08eb-4018-a89a-3fd305e59768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb635f9400>]}
[0m00:50:55.381340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ea73624-08eb-4018-a89a-3fd305e59768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb63cb2cf0>]}
[0m00:50:55.383087 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:50:55.473082 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:50:56.275348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:50:56.276458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:50:56.320765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ea73624-08eb-4018-a89a-3fd305e59768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb635242f0>]}
[0m00:50:56.565052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ea73624-08eb-4018-a89a-3fd305e59768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb636798e0>]}
[0m00:50:56.566403 [info ] [MainThread]: Found 6 models, 22 data tests, 3 sources, 459 macros
[0m00:50:56.567234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ea73624-08eb-4018-a89a-3fd305e59768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb69db0d70>]}
[0m00:50:56.571729 [info ] [MainThread]: 
[0m00:50:56.573508 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:50:56.580022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:50:56.598454 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:50:56.599606 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:50:56.600740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:57.129500 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.529 seconds
[0m00:50:57.132741 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:50:57.245040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ea73624-08eb-4018-a89a-3fd305e59768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb62ff5340>]}
[0m00:50:57.246403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:50:57.247438 [info ] [MainThread]: 
[0m00:50:57.257745 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:50:57.258998 [info ] [Thread-1 (]: 1 of 22 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:50:57.260184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:50:57.261453 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:50:57.281608 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:50:57.316754 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:50:57.340113 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:50:57.384982 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:50:57.386152 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:50:57.387082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:50:57.869529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m00:50:57.881707 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:50:57.991157 [info ] [Thread-1 (]: 1 of 22 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.73s]
[0m00:50:57.992716 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:50:57.993997 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:50:57.995088 [info ] [Thread-1 (]: 2 of 22 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:50:57.996245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:50:57.997157 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:50:58.003121 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:50:58.051709 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:50:58.057348 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:50:58.099771 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:50:58.101321 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:50:58.102784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:50:58.574348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m00:50:58.576911 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:50:58.692346 [info ] [Thread-1 (]: 2 of 22 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.70s]
[0m00:50:58.693978 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:50:58.695036 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:50:58.697030 [info ] [Thread-1 (]: 3 of 22 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:50:58.699112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:50:58.700171 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:50:58.706127 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:50:58.748087 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:50:58.751747 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:50:58.802399 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:50:58.804585 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:50:58.805868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:50:59.242361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.436 seconds
[0m00:50:59.245215 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:50:59.382795 [info ] [Thread-1 (]: 3 of 22 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.68s]
[0m00:50:59.384417 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:50:59.385637 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:50:59.386601 [info ] [Thread-1 (]: 4 of 22 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:50:59.389116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:50:59.391185 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:50:59.397395 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:50:59.439170 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:50:59.443261 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:50:59.485821 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:50:59.487791 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:50:59.489212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:00.227088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m00:51:00.231821 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:51:00.335114 [info ] [Thread-1 (]: 4 of 22 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.95s]
[0m00:51:00.337153 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:51:00.338257 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:51:00.339464 [info ] [Thread-1 (]: 5 of 22 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:51:00.340639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:51:00.341693 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:51:00.348795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:51:00.389532 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:51:00.396292 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:51:00.431921 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:51:00.433274 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:51:00.434372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:00.917137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m00:51:00.920086 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:51:01.061376 [info ] [Thread-1 (]: 5 of 22 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.72s]
[0m00:51:01.062681 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:51:01.063762 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:51:01.064670 [info ] [Thread-1 (]: 6 of 22 START test not_null_rsi_rsi_14d ........................................ [RUN]
[0m00:51:01.065648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:51:01.066561 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:51:01.071959 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:51:01.103913 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:51:01.108345 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:51:01.141710 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:51:01.142960 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:51:01.143955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:01.587938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m00:51:01.591278 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:51:01.710826 [info ] [Thread-1 (]: 6 of 22 PASS not_null_rsi_rsi_14d .............................................. [[32mPASS[0m in 0.64s]
[0m00:51:01.712854 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:51:01.714419 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:51:01.715732 [info ] [Thread-1 (]: 7 of 22 START test not_null_rsi_symbol ......................................... [RUN]
[0m00:51:01.717146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:51:01.718316 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:51:01.728252 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:51:01.759545 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:51:01.763546 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:51:01.795049 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:51:01.796638 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:51:01.797867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:02.274832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m00:51:02.279534 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:51:02.409810 [info ] [Thread-1 (]: 7 of 22 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.69s]
[0m00:51:02.412165 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:51:02.413935 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:51:02.415726 [info ] [Thread-1 (]: 8 of 22 START test not_null_rsi_trade_date ..................................... [RUN]
[0m00:51:02.416797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:51:02.418390 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:51:02.427152 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:51:02.487703 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:51:02.491965 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:51:02.539760 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:51:02.542061 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:51:02.543814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:02.905270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m00:51:02.910083 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:51:03.048845 [info ] [Thread-1 (]: 8 of 22 PASS not_null_rsi_trade_date ........................................... [[32mPASS[0m in 0.63s]
[0m00:51:03.051670 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:51:03.055397 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:51:03.057004 [info ] [Thread-1 (]: 9 of 22 START test not_null_stock_indicators_rsi_14d ........................... [RUN]
[0m00:51:03.060030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:51:03.061735 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:51:03.070865 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:51:03.111696 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:51:03.116403 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:51:03.145454 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:51:03.146460 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:51:03.147271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:03.427075 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe473-0205-0bb1-0004-59ff002d8442
[0m00:51:03.428349 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m00:51:03.429333 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:51:03.533361 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:51:03.535374 [error] [Thread-1 (]: 9 of 22 ERROR not_null_stock_indicators_rsi_14d ................................ [[31mERROR[0m in 0.48s]
[0m00:51:03.537257 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:51:03.538958 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:51:03.541320 [info ] [Thread-1 (]: 10 of 22 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:51:03.542698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:51:03.543942 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:51:03.552366 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:51:03.578568 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:51:03.582756 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:51:03.608287 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:51:03.609441 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:51:03.610482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:04.019684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m00:51:04.027575 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:51:04.145844 [info ] [Thread-1 (]: 10 of 22 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.60s]
[0m00:51:04.147413 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:51:04.148508 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:51:04.149433 [info ] [Thread-1 (]: 11 of 22 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:51:04.150437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:51:04.151344 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:51:04.160756 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:51:04.187107 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:51:04.192733 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:51:04.215567 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:51:04.216465 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:51:04.217382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:04.590143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m00:51:04.594411 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:51:04.703237 [info ] [Thread-1 (]: 11 of 22 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.55s]
[0m00:51:04.704875 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:51:04.706352 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:51:04.707415 [info ] [Thread-1 (]: 12 of 22 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:51:04.708680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:51:04.709598 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:51:04.716012 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:51:04.740573 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:51:04.744086 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:51:04.769164 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:51:04.770201 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:51:04.771012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:05.350680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m00:51:05.356018 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:51:05.456810 [info ] [Thread-1 (]: 12 of 22 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.75s]
[0m00:51:05.459388 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:51:05.461407 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:51:05.463220 [info ] [Thread-1 (]: 13 of 22 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:51:05.465131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:51:05.466930 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:51:05.477210 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:51:05.536656 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:51:05.542337 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:51:05.608269 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:51:05.609911 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:51:05.611762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:05.887713 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe473-0205-0bb1-0004-59ff002d844e
[0m00:51:05.889392 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m00:51:05.891256 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:51:05.998390 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:51:05.999814 [error] [Thread-1 (]: 13 of 22 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.53s]
[0m00:51:06.001672 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:51:06.002752 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:51:06.003754 [info ] [Thread-1 (]: 14 of 22 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:51:06.004799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:51:06.006667 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:51:06.016244 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:51:06.035319 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:51:06.039839 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:51:06.055631 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:51:06.056769 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:51:06.057821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:06.682815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m00:51:06.687715 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:51:06.801463 [info ] [Thread-1 (]: 14 of 22 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.80s]
[0m00:51:06.803385 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:51:06.805386 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:51:06.806656 [info ] [Thread-1 (]: 15 of 22 START test positive_values_moving_averages_close_price_14d_ma ......... [RUN]
[0m00:51:06.810510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0)
[0m00:51:06.812458 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:51:06.824072 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:06.826519 [error] [Thread-1 (]: 15 of 22 ERROR positive_values_moving_averages_close_price_14d_ma .............. [[31mERROR[0m in 0.02s]
[0m00:51:06.829285 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m00:51:06.830930 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:51:06.832946 [info ] [Thread-1 (]: 16 of 22 START test positive_values_moving_averages_close_price_30d_ma ......... [RUN]
[0m00:51:06.835400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0, now test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77)
[0m00:51:06.838217 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:51:06.850914 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:06.853731 [error] [Thread-1 (]: 16 of 22 ERROR positive_values_moving_averages_close_price_30d_ma .............. [[31mERROR[0m in 0.02s]
[0m00:51:06.855436 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m00:51:06.857134 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:51:06.858627 [info ] [Thread-1 (]: 17 of 22 START test positive_values_moving_averages_close_price_7d_ma .......... [RUN]
[0m00:51:06.859795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77, now test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba)
[0m00:51:06.860986 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:51:06.867948 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:06.869542 [error] [Thread-1 (]: 17 of 22 ERROR positive_values_moving_averages_close_price_7d_ma ............... [[31mERROR[0m in 0.01s]
[0m00:51:06.870880 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m00:51:06.872039 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:51:06.873399 [info ] [Thread-1 (]: 18 of 22 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m00:51:06.874973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m00:51:06.876346 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:51:06.884790 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:06.886443 [error] [Thread-1 (]: 18 of 22 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.01s]
[0m00:51:06.887823 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:51:06.889136 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:51:06.890636 [info ] [Thread-1 (]: 19 of 22 START test range_stock_indicators_rsi_14d__100__0 ..................... [RUN]
[0m00:51:06.892105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4)
[0m00:51:06.893702 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:51:06.900443 [debug] [Thread-1 (]: Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:06.902086 [error] [Thread-1 (]: 19 of 22 ERROR range_stock_indicators_rsi_14d__100__0 .......................... [[31mERROR[0m in 0.01s]
[0m00:51:06.903363 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:51:06.904670 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:51:06.905913 [info ] [Thread-1 (]: 20 of 22 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m00:51:06.907436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m00:51:06.908741 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:51:06.918772 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:51:06.968819 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:51:06.975902 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:51:07.026723 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:51:07.028763 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:51:07.030888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:07.611743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m00:51:07.616642 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m00:51:07.719722 [info ] [Thread-1 (]: 20 of 22 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.81s]
[0m00:51:07.721672 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:51:07.722820 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:51:07.723943 [info ] [Thread-1 (]: 21 of 22 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m00:51:07.725034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m00:51:07.725915 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:51:07.732077 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:51:07.763444 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:51:07.769487 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:51:07.807906 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:51:07.809287 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:51:07.810487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:08.348865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m00:51:08.351734 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m00:51:08.500844 [info ] [Thread-1 (]: 21 of 22 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.78s]
[0m00:51:08.502905 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:51:08.504331 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:51:08.505948 [info ] [Thread-1 (]: 22 of 22 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m00:51:08.507449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m00:51:08.510505 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:51:08.521331 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:51:08.590311 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:51:08.595128 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:51:08.643104 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:51:08.644412 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:51:08.645662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:09.138062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m00:51:09.140978 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m00:51:09.237034 [info ] [Thread-1 (]: 22 of 22 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.73s]
[0m00:51:09.238384 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:51:09.241327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:09.242315 [debug] [MainThread]: Connection 'test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5' was properly closed.
[0m00:51:09.243211 [info ] [MainThread]: 
[0m00:51:09.243932 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 12.67 seconds (12.67s).
[0m00:51:09.246767 [debug] [MainThread]: Command end result
[0m00:51:09.356038 [info ] [MainThread]: 
[0m00:51:09.358027 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m00:51:09.358980 [info ] [MainThread]: 
[0m00:51:09.359901 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:51:09.360782 [info ] [MainThread]: 
[0m00:51:09.361529 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:51:09.362138 [info ] [MainThread]: 
[0m00:51:09.362768 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:09.363473 [info ] [MainThread]: 
[0m00:51:09.364840 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:09.366545 [info ] [MainThread]: 
[0m00:51:09.369098 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:09.370656 [info ] [MainThread]: 
[0m00:51:09.371654 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:09.372852 [info ] [MainThread]: 
[0m00:51:09.374551 [error] [MainThread]:   Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:51:09.375268 [info ] [MainThread]: 
[0m00:51:09.375927 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=7 SKIP=0 TOTAL=22
[0m00:51:09.377323 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 15.222281, "process_user_time": 4.960592, "process_kernel_time": 2.067633, "process_mem_max_rss": "251408", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:51:09.378294 [debug] [MainThread]: Command `dbt test` failed at 00:51:09.378158 after 15.22 seconds
[0m00:51:09.379210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9955ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9966e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9966e030>]}
[0m00:51:09.380181 [debug] [MainThread]: Flushing usage events
[0m00:52:48.360460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb610d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb5c4f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb6a9ce30>]}


============================== 00:52:48.367655 | 1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319 ==============================
[0m00:52:48.367655 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:52:48.368731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:52:49.477940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b84787770>]}
[0m00:52:49.537768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb7414470>]}
[0m00:52:49.539316 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:52:49.629934 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:52:50.386603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:52:50.389648 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m00:52:50.636805 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:52:50.638345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7fb9d6d0>]}
[0m00:52:50.853007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d530dd0>]}
[0m00:52:51.036707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d5b1a90>]}
[0m00:52:51.038015 [info ] [MainThread]: Found 6 models, 19 data tests, 3 sources, 459 macros
[0m00:52:51.039004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7d592780>]}
[0m00:52:51.042145 [info ] [MainThread]: 
[0m00:52:51.043368 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:52:51.048897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:52:51.063815 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:52:51.065069 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:52:51.066014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:51.606140 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.540 seconds
[0m00:52:51.609110 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:52:51.715083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:52:51.727326 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:52:51.728422 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:52:51.729461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:52:52.127794 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.398 seconds
[0m00:52:52.131016 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:52:52.250299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb6f7fcb0>]}
[0m00:52:52.251720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:52:52.252616 [info ] [MainThread]: 
[0m00:52:52.264092 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:52:52.265404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m00:52:52.266584 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:52:52.276768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:52:52.308884 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:52:52.310432 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:52:52.311753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:52:52.313446 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:52:52.320981 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:52:52.360108 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:52:52.361857 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:52:52.363411 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:52:52.365241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:52:52.366809 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:52:52.373206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:52:52.408876 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:52:52.450501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:52:52.491473 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:52:52.493734 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:52:52.495877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:53.415983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.920 seconds
[0m00:52:53.450655 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:52:53.666306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7fc761e0>]}
[0m00:52:53.667593 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.30s]
[0m00:52:53.668585 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:52:53.669530 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:52:53.670936 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:52:53.672176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:52:53.673174 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:52:53.677908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:52:53.701698 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:52:53.707203 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:52:53.728583 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:52:53.731279 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:52:53.733447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:54.690018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.957 seconds
[0m00:52:54.694023 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:52:54.812446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7ca365d0>]}
[0m00:52:54.813868 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.14s]
[0m00:52:54.815193 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:52:54.816135 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:52:54.817127 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:52:54.818066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m00:52:54.818918 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:52:54.834986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:52:54.850773 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:52:54.856453 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:52:54.874500 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:52:54.875621 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
    SELECT
        symbol,
        trade_date,
        close,

        -- 7-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_7d_ma,

        -- 14-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_14d_ma,

        -- 30-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_30d_ma

    FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m00:52:54.876500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:55.838158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.962 seconds
[0m00:52:55.841267 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:52:55.949496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7ca01910>]}
[0m00:52:55.950745 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.13s]
[0m00:52:55.951666 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:52:55.952451 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:52:55.953325 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:52:55.954179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m00:52:55.954826 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:52:55.976664 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:52:55.997511 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:52:56.001194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:52:56.023746 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:52:56.025219 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
  WHERE close > 0  -- Filter out non-positive close prices
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss, only calculate after enough data is available
    CASE 
      WHEN COUNT(gain) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(gain) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_gain_14d,

    CASE 
      WHEN COUNT(loss) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(loss) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      WHEN avg_gain_14d IS NULL OR avg_loss_14d IS NULL THEN NULL  -- Ensure valid RSI
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * 
FROM rsi_final
WHERE rsi_14d IS NOT NULL  -- Ensure that RSI is valid
ORDER BY symbol, trade_date
        );
[0m00:52:56.026528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:57.209333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.183 seconds
[0m00:52:57.212354 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:52:57.309386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec1e55a-d9cc-48d5-b9f6-77d9b4bcc319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7cabbd10>]}
[0m00:52:57.311427 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.35s]
[0m00:52:57.313014 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:52:57.319797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:57.321010 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:52:57.322096 [info ] [MainThread]: 
[0m00:52:57.323616 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.28 seconds (6.28s).
[0m00:52:57.325329 [debug] [MainThread]: Command end result
[0m00:52:57.535637 [info ] [MainThread]: 
[0m00:52:57.537003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:52:57.538062 [info ] [MainThread]: 
[0m00:52:57.539067 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:52:57.540668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.279477, "process_user_time": 4.556567, "process_kernel_time": 2.086746, "process_mem_max_rss": "233384", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:52:57.542004 [debug] [MainThread]: Command `dbt run` succeeded at 00:52:57.541863 after 9.28 seconds
[0m00:52:57.544280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb9832990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb98329c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb5d4b320>]}
[0m00:52:57.546872 [debug] [MainThread]: Flushing usage events
[0m00:53:02.295276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd43207560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd40c8f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd40bd7aa0>]}


============================== 00:53:02.305539 | 9b98e5ae-cf3b-4394-add6-bef85a338264 ==============================
[0m00:53:02.305539 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:53:02.316405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m00:53:03.242266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b98e5ae-cf3b-4394-add6-bef85a338264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0b1308f0>]}
[0m00:53:03.295245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b98e5ae-cf3b-4394-add6-bef85a338264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0b5485f0>]}
[0m00:53:03.298059 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:53:03.382788 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:53:03.899796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:53:03.900829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:53:03.953560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b98e5ae-cf3b-4394-add6-bef85a338264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd115715b0>]}
[0m00:53:04.176782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b98e5ae-cf3b-4394-add6-bef85a338264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0a86c410>]}
[0m00:53:04.178075 [info ] [MainThread]: Found 6 models, 19 data tests, 3 sources, 459 macros
[0m00:53:04.179145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b98e5ae-cf3b-4394-add6-bef85a338264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0ad40170>]}
[0m00:53:04.183548 [info ] [MainThread]: 
[0m00:53:04.186249 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:53:04.196966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:53:04.226233 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:53:04.227157 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:53:04.228274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:04.806769 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.578 seconds
[0m00:53:04.812662 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:53:04.916373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b98e5ae-cf3b-4394-add6-bef85a338264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0acc7920>]}
[0m00:53:04.918531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:53:04.920205 [info ] [MainThread]: 
[0m00:53:04.937318 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:53:04.938368 [info ] [Thread-1 (]: 1 of 19 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:53:04.940412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:53:04.943576 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:53:04.967486 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:53:05.015068 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:53:05.039056 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:53:05.077049 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:53:05.078406 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:53:05.079463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:05.564952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m00:53:05.574989 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:53:05.690844 [info ] [Thread-1 (]: 1 of 19 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.75s]
[0m00:53:05.692284 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:53:05.693355 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:53:05.694312 [info ] [Thread-1 (]: 2 of 19 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:53:05.695574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:53:05.696713 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:53:05.703340 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:53:05.731717 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:53:05.735486 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:53:05.765446 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:53:05.766407 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:53:05.767311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:06.286326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m00:53:06.294415 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:53:06.407082 [info ] [Thread-1 (]: 2 of 19 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.71s]
[0m00:53:06.409094 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:53:06.410409 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:53:06.411912 [info ] [Thread-1 (]: 3 of 19 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:53:06.413607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:53:06.414913 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:53:06.423049 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:53:06.455089 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:53:06.458754 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:53:06.494170 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:53:06.495320 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:53:06.496518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:06.971047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m00:53:06.977276 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:53:07.084253 [info ] [Thread-1 (]: 3 of 19 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.67s]
[0m00:53:07.085817 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:53:07.086898 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:53:07.089229 [info ] [Thread-1 (]: 4 of 19 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:53:07.090574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:53:07.091657 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:53:07.101309 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:53:07.125596 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:53:07.130418 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:53:07.221281 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:53:07.222439 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:53:07.224020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:07.570802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m00:53:07.573764 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:53:07.670288 [info ] [Thread-1 (]: 4 of 19 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.58s]
[0m00:53:07.672085 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:53:07.673814 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:53:07.675379 [info ] [Thread-1 (]: 5 of 19 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:53:07.676902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:53:07.678132 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:53:07.683304 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:53:07.714276 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:53:07.717690 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:53:07.752250 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:53:07.753988 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:53:07.755254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:08.058610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m00:53:08.063831 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:53:08.176981 [info ] [Thread-1 (]: 5 of 19 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.50s]
[0m00:53:08.179415 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:53:08.181449 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:53:08.183460 [info ] [Thread-1 (]: 6 of 19 START test not_null_rsi_rsi_14d ........................................ [RUN]
[0m00:53:08.185409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:53:08.187660 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:53:08.199292 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:53:08.229340 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:53:08.233953 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:53:08.274485 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:53:08.276209 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:53:08.277255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:08.919528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m00:53:08.924872 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:53:09.027871 [info ] [Thread-1 (]: 6 of 19 PASS not_null_rsi_rsi_14d .............................................. [[32mPASS[0m in 0.84s]
[0m00:53:09.030041 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:53:09.031636 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:53:09.033073 [info ] [Thread-1 (]: 7 of 19 START test not_null_rsi_symbol ......................................... [RUN]
[0m00:53:09.034581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:53:09.036091 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:53:09.044481 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:53:09.076947 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:53:09.081236 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:53:09.121727 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:53:09.123187 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:53:09.124689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:09.590961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m00:53:09.595585 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:53:09.708845 [info ] [Thread-1 (]: 7 of 19 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.67s]
[0m00:53:09.710188 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:53:09.711190 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:53:09.712124 [info ] [Thread-1 (]: 8 of 19 START test not_null_rsi_trade_date ..................................... [RUN]
[0m00:53:09.712996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:53:09.713651 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:53:09.719030 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:53:09.741602 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:53:09.745608 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:53:09.764735 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:53:09.765644 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:53:09.766435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:10.103033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m00:53:10.105553 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:53:10.197283 [info ] [Thread-1 (]: 8 of 19 PASS not_null_rsi_trade_date ........................................... [[32mPASS[0m in 0.48s]
[0m00:53:10.198435 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:53:10.199223 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:53:10.199860 [info ] [Thread-1 (]: 9 of 19 START test not_null_stock_indicators_rsi_14d ........................... [RUN]
[0m00:53:10.200697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:53:10.201361 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:53:10.206659 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:53:10.230294 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:53:10.233991 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:53:10.255081 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:53:10.256254 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:53:10.257195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:10.540799 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe475-0205-0bb1-0004-59ff002d8516
[0m00:53:10.541974 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m00:53:10.543378 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:53:10.649513 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:53:10.650934 [error] [Thread-1 (]: 9 of 19 ERROR not_null_stock_indicators_rsi_14d ................................ [[31mERROR[0m in 0.45s]
[0m00:53:10.652399 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:53:10.653529 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:53:10.655028 [info ] [Thread-1 (]: 10 of 19 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:53:10.656251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:53:10.657375 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:53:10.663119 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:53:10.700636 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:53:10.706870 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:53:10.748316 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:53:10.749495 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:53:10.750985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:11.199746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m00:53:11.202540 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:53:11.301505 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.64s]
[0m00:53:11.302688 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:53:11.303568 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:53:11.304687 [info ] [Thread-1 (]: 11 of 19 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:53:11.305831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:53:11.306677 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:53:11.312210 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:53:11.336797 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:53:11.340316 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:53:11.377450 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:53:11.379232 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:53:11.380697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:11.729772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m00:53:11.732350 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:53:11.865819 [info ] [Thread-1 (]: 11 of 19 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.56s]
[0m00:53:11.867048 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:53:11.867767 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:53:11.868435 [info ] [Thread-1 (]: 12 of 19 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:53:11.869644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:53:11.870419 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:53:11.875720 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:53:11.905351 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:53:11.909256 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:53:11.948077 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:53:11.949496 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:53:11.951005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:12.343507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m00:53:12.348147 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:53:12.470760 [info ] [Thread-1 (]: 12 of 19 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.60s]
[0m00:53:12.472571 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:53:12.473825 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:53:12.474847 [info ] [Thread-1 (]: 13 of 19 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:53:12.476074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:53:12.477063 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:53:12.484572 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:53:12.505582 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:53:12.509970 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:53:12.529863 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:53:12.531156 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:53:12.532038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:12.802186 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe475-0205-0c96-0004-59ff002d93d6
[0m00:53:12.803170 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m00:53:12.804303 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:53:12.914422 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:53:12.916406 [error] [Thread-1 (]: 13 of 19 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.44s]
[0m00:53:12.918412 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:53:12.919805 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:53:12.921028 [info ] [Thread-1 (]: 14 of 19 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:53:12.923096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:53:12.924408 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:53:12.934073 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:53:12.967295 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:53:12.972042 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:53:13.018588 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:53:13.019484 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:53:13.020243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:13.402652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m00:53:13.405883 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:53:13.510967 [info ] [Thread-1 (]: 14 of 19 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.59s]
[0m00:53:13.513536 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:53:13.515489 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:53:13.517064 [info ] [Thread-1 (]: 15 of 19 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m00:53:13.518487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m00:53:13.519832 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:53:13.532392 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:53:13.533780 [error] [Thread-1 (]: 15 of 19 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.02s]
[0m00:53:13.534807 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:53:13.535740 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:53:13.536730 [info ] [Thread-1 (]: 16 of 19 START test range_stock_indicators_rsi_14d__100__0 ..................... [RUN]
[0m00:53:13.538142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4)
[0m00:53:13.540603 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:53:13.548802 [debug] [Thread-1 (]: Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:53:13.549991 [error] [Thread-1 (]: 16 of 19 ERROR range_stock_indicators_rsi_14d__100__0 .......................... [[31mERROR[0m in 0.01s]
[0m00:53:13.550994 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m00:53:13.552111 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:53:13.552992 [info ] [Thread-1 (]: 17 of 19 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m00:53:13.554115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m00:53:13.555503 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:53:13.565886 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:53:13.598457 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:53:13.602297 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:53:13.636078 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:53:13.637417 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:53:13.638491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:14.008359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.370 seconds
[0m00:53:14.014082 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m00:53:14.114971 [info ] [Thread-1 (]: 17 of 19 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.56s]
[0m00:53:14.120877 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:53:14.126381 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:53:14.127988 [info ] [Thread-1 (]: 18 of 19 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m00:53:14.129620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m00:53:14.131065 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:53:14.148282 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:53:14.178146 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:53:14.183446 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:53:14.207782 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:53:14.209008 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:53:14.209980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:14.575903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m00:53:14.579060 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m00:53:14.678373 [info ] [Thread-1 (]: 18 of 19 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.55s]
[0m00:53:14.679770 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:53:14.680886 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:53:14.681704 [info ] [Thread-1 (]: 19 of 19 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m00:53:14.682916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m00:53:14.684015 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:53:14.690912 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:53:14.722554 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:53:14.726565 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:53:14.765406 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:53:14.766837 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:53:14.768018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:15.294458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m00:53:15.298063 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m00:53:15.427036 [info ] [Thread-1 (]: 19 of 19 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.74s]
[0m00:53:15.428225 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:53:15.430486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:15.431402 [debug] [MainThread]: Connection 'test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5' was properly closed.
[0m00:53:15.432246 [info ] [MainThread]: 
[0m00:53:15.432910 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 11.25 seconds (11.25s).
[0m00:53:15.435925 [debug] [MainThread]: Command end result
[0m00:53:15.545052 [info ] [MainThread]: 
[0m00:53:15.546129 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:53:15.547090 [info ] [MainThread]: 
[0m00:53:15.547943 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:53:15.548743 [info ] [MainThread]: 
[0m00:53:15.549561 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:53:15.550317 [info ] [MainThread]: 
[0m00:53:15.551250 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:53:15.552280 [info ] [MainThread]: 
[0m00:53:15.553161 [error] [MainThread]:   Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:53:15.553887 [info ] [MainThread]: 
[0m00:53:15.554677 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=4 SKIP=0 TOTAL=19
[0m00:53:15.556362 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 13.449059, "process_user_time": 4.765452, "process_kernel_time": 1.950826, "process_mem_max_rss": "228728", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:53:15.557518 [debug] [MainThread]: Command `dbt test` failed at 00:53:15.557251 after 13.45 seconds
[0m00:53:15.558281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd43207560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0b0039e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0aed1490>]}
[0m00:53:15.559086 [debug] [MainThread]: Flushing usage events
[0m00:54:18.710893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd3d5fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd2266a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd2265d60>]}


============================== 00:54:18.719423 | 92d54ffb-3e49-481e-b468-5148a0926571 ==============================
[0m00:54:18.719423 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:54:18.720636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:54:19.873744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd2ee2a80>]}
[0m00:54:19.933439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda0e06f60>]}
[0m00:54:19.935072 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:54:20.029730 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:54:20.741031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:54:20.743549 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m00:54:20.991052 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:54:20.992328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd20159a0>]}
[0m00:54:21.238817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd99d3c8c0>]}
[0m00:54:21.430351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd99dcda30>]}
[0m00:54:21.431680 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:54:21.432635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd99da1190>]}
[0m00:54:21.436192 [info ] [MainThread]: 
[0m00:54:21.437496 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:54:21.442808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m00:54:21.459893 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m00:54:21.460901 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m00:54:21.461713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:21.986033 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.524 seconds
[0m00:54:21.989694 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m00:54:22.110563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m00:54:22.122726 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:54:22.123984 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:54:22.125011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:22.490952 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.366 seconds
[0m00:54:22.493808 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:54:22.597202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd360be00>]}
[0m00:54:22.598624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:54:22.599611 [info ] [MainThread]: 
[0m00:54:22.610085 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m00:54:22.611469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m00:54:22.612646 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m00:54:22.621976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m00:54:22.648514 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m00:54:22.649899 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m00:54:22.651281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m00:54:22.652602 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m00:54:22.656810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m00:54:22.680450 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m00:54:22.681687 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m00:54:22.683029 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m00:54:22.684229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m00:54:22.685697 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m00:54:22.689831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m00:54:22.712395 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m00:54:22.746782 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m00:54:22.766740 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m00:54:22.768646 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:54:22.770172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:23.632506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m00:54:23.662159 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m00:54:23.767695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda03ba9c0>]}
[0m00:54:23.769166 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.08s]
[0m00:54:23.770937 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m00:54:23.772459 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m00:54:23.774366 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m00:54:23.776070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m00:54:23.777547 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m00:54:23.782511 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m00:54:23.807549 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m00:54:23.811897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m00:54:23.838959 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m00:54:23.840279 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m00:54:23.841384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:24.621265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m00:54:24.624243 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m00:54:24.718164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd99234da0>]}
[0m00:54:24.719650 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 0.94s]
[0m00:54:24.721004 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m00:54:24.722103 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m00:54:24.723355 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m00:54:24.724536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m00:54:24.725750 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m00:54:24.742196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m00:54:24.769186 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m00:54:24.773662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m00:54:24.811363 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m00:54:24.813081 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
    SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
    SELECT
        symbol,
        trade_date,
        close,

        -- 7-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_7d_ma,

        -- 14-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_14d_ma,

        -- 30-day moving average (ensuring positive values)
        ROUND(GREATEST(
            AVG(close) OVER (
                PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
            ), 0), 2
        ) AS close_price_30d_ma

    FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m00:54:24.814631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:25.577480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m00:54:25.580810 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m00:54:25.908217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd992a6ae0>]}
[0m00:54:25.909810 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.18s]
[0m00:54:25.911274 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m00:54:25.912595 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m00:54:25.914216 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m00:54:25.915726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m00:54:25.917013 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m00:54:25.942303 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m00:54:25.963385 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m00:54:25.968166 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m00:54:25.993495 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m00:54:25.994799 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
  WHERE close > 0  -- Filter out non-positive close prices
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss, only calculate after enough data is available
    CASE 
      WHEN COUNT(gain) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(gain) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_gain_14d,

    CASE 
      WHEN COUNT(loss) OVER (PARTITION BY symbol ORDER BY trade_date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) = 14
      THEN AVG(loss) OVER (
        PARTITION BY symbol ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      )
      ELSE NULL
    END AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      WHEN avg_gain_14d IS NULL OR avg_loss_14d IS NULL THEN NULL  -- Ensure valid RSI
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * 
FROM rsi_final
WHERE rsi_14d IS NOT NULL  -- Ensure that RSI is valid
ORDER BY symbol, trade_date
        );
[0m00:54:25.995828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:27.075282 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.079 seconds
[0m00:54:27.078093 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m00:54:27.183554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92d54ffb-3e49-481e-b468-5148a0926571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd991f7b00>]}
[0m00:54:27.185568 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.27s]
[0m00:54:27.187695 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m00:54:27.190918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:27.192125 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m00:54:27.193320 [info ] [MainThread]: 
[0m00:54:27.194667 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m00:54:27.196458 [debug] [MainThread]: Command end result
[0m00:54:27.392360 [info ] [MainThread]: 
[0m00:54:27.393508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:54:27.394361 [info ] [MainThread]: 
[0m00:54:27.395198 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:54:27.396961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.794357, "process_user_time": 4.708691, "process_kernel_time": 2.17168, "process_mem_max_rss": "250776", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m00:54:27.398023 [debug] [MainThread]: Command `dbt run` succeeded at 00:54:27.397839 after 8.80 seconds
[0m00:54:27.399183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd99eaed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd99eacdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd99281790>]}
[0m00:54:27.400301 [debug] [MainThread]: Flushing usage events
[0m00:54:32.044720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf8d85100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf5c49c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf7620230>]}


============================== 00:54:32.052545 | a27b3ef1-5bf7-4814-b2a2-a6c5d6f8afc0 ==============================
[0m00:54:32.052545 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:54:32.053738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:54:33.035213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a27b3ef1-5bf7-4814-b2a2-a6c5d6f8afc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf67752e0>]}
[0m00:54:33.090346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a27b3ef1-5bf7-4814-b2a2-a6c5d6f8afc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc5b96f60>]}
[0m00:54:33.094101 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m00:54:33.176871 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:54:33.830389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:54:33.831631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:54:33.880543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a27b3ef1-5bf7-4814-b2a2-a6c5d6f8afc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efccbe76e10>]}
[0m00:54:34.093239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a27b3ef1-5bf7-4814-b2a2-a6c5d6f8afc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcbf585130>]}
[0m00:54:34.094329 [info ] [MainThread]: Found 6 models, 18 data tests, 3 sources, 459 macros
[0m00:54:34.095124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a27b3ef1-5bf7-4814-b2a2-a6c5d6f8afc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf723e3f0>]}
[0m00:54:34.098244 [info ] [MainThread]: 
[0m00:54:34.099546 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:54:34.105244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m00:54:34.124574 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m00:54:34.125728 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m00:54:34.126782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:34.610370 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.484 seconds
[0m00:54:34.613126 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m00:54:34.709075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a27b3ef1-5bf7-4814-b2a2-a6c5d6f8afc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcbfa8f770>]}
[0m00:54:34.710764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:54:34.711979 [info ] [MainThread]: 
[0m00:54:34.722696 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:54:34.724000 [info ] [Thread-1 (]: 1 of 18 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m00:54:34.725510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m00:54:34.726748 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:54:34.745823 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:54:34.783070 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:54:34.803584 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:54:34.849401 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m00:54:34.851148 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m00:54:34.853958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:35.248391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m00:54:35.264055 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m00:54:35.372092 [info ] [Thread-1 (]: 1 of 18 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.65s]
[0m00:54:35.373741 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m00:54:35.374952 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:54:35.376162 [info ] [Thread-1 (]: 2 of 18 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m00:54:35.377536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m00:54:35.378679 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:54:35.385151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:54:35.421052 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:54:35.424280 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:54:35.462596 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m00:54:35.463766 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m00:54:35.464844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:35.986302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m00:54:35.990627 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m00:54:36.094794 [info ] [Thread-1 (]: 2 of 18 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.72s]
[0m00:54:36.097148 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m00:54:36.098669 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:54:36.100009 [info ] [Thread-1 (]: 3 of 18 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m00:54:36.101651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m00:54:36.102957 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:54:36.110861 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:54:36.134025 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:54:36.138430 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:54:36.159333 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m00:54:36.160519 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m00:54:36.161341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:36.502087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.341 seconds
[0m00:54:36.505499 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m00:54:36.660856 [info ] [Thread-1 (]: 3 of 18 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.56s]
[0m00:54:36.662251 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m00:54:36.663133 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:54:36.663994 [info ] [Thread-1 (]: 4 of 18 START test not_null_moving_averages_symbol ............................. [RUN]
[0m00:54:36.665003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m00:54:36.665948 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:54:36.672545 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:54:36.690305 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:54:36.693693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:54:36.712602 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m00:54:36.713443 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m00:54:36.714324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:37.018997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m00:54:37.023126 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m00:54:37.125321 [info ] [Thread-1 (]: 4 of 18 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.46s]
[0m00:54:37.126910 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m00:54:37.128376 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:54:37.129586 [info ] [Thread-1 (]: 5 of 18 START test not_null_moving_averages_trade_date ......................... [RUN]
[0m00:54:37.131040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m00:54:37.132419 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:54:37.144925 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:54:37.168487 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:54:37.172751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:54:37.204651 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m00:54:37.205645 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m00:54:37.206623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:37.665315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m00:54:37.667983 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m00:54:37.762817 [info ] [Thread-1 (]: 5 of 18 PASS not_null_moving_averages_trade_date ............................... [[32mPASS[0m in 0.63s]
[0m00:54:37.764370 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m00:54:37.765918 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:54:37.767150 [info ] [Thread-1 (]: 6 of 18 START test not_null_rsi_rsi_14d ........................................ [RUN]
[0m00:54:37.768646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m00:54:37.770207 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:54:37.779063 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:54:37.830924 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:54:37.836881 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:54:37.884689 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m00:54:37.886695 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:54:37.888435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.222285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.334 seconds
[0m00:54:38.225341 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m00:54:38.322153 [info ] [Thread-1 (]: 6 of 18 PASS not_null_rsi_rsi_14d .............................................. [[32mPASS[0m in 0.55s]
[0m00:54:38.324318 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m00:54:38.326114 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:54:38.328036 [info ] [Thread-1 (]: 7 of 18 START test not_null_rsi_symbol ......................................... [RUN]
[0m00:54:38.330042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m00:54:38.331292 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:54:38.337983 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:54:38.361237 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:54:38.365766 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:54:38.386361 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m00:54:38.387890 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m00:54:38.389036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:38.813203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m00:54:38.816066 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m00:54:38.911168 [info ] [Thread-1 (]: 7 of 18 PASS not_null_rsi_symbol ............................................... [[32mPASS[0m in 0.58s]
[0m00:54:38.912830 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m00:54:38.914466 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:54:38.915509 [info ] [Thread-1 (]: 8 of 18 START test not_null_rsi_trade_date ..................................... [RUN]
[0m00:54:38.916587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m00:54:38.917510 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:54:38.925159 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:54:38.941298 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:54:38.945607 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:54:38.963581 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m00:54:38.964684 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m00:54:38.965559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:39.297168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m00:54:39.299716 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m00:54:39.412485 [info ] [Thread-1 (]: 8 of 18 PASS not_null_rsi_trade_date ........................................... [[32mPASS[0m in 0.50s]
[0m00:54:39.413877 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m00:54:39.414947 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:54:39.416542 [info ] [Thread-1 (]: 9 of 18 START test not_null_stock_indicators_rsi_14d ........................... [RUN]
[0m00:54:39.418962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m00:54:39.420274 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:54:39.428296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:54:39.474095 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:54:39.480870 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:54:39.525226 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m00:54:39.527327 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m00:54:39.529318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:39.837641 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe476-0205-0fb8-0004-59ff002d6922
[0m00:54:39.839318 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m00:54:39.840852 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m00:54:39.957680 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:54:39.959170 [error] [Thread-1 (]: 9 of 18 ERROR not_null_stock_indicators_rsi_14d ................................ [[31mERROR[0m in 0.54s]
[0m00:54:39.960328 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m00:54:39.961470 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:54:39.962791 [info ] [Thread-1 (]: 10 of 18 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m00:54:39.964060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m00:54:39.965228 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:54:39.972124 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:54:40.006511 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:54:40.014085 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:54:40.054889 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m00:54:40.056210 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m00:54:40.057506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:40.412925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.355 seconds
[0m00:54:40.417029 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m00:54:40.536914 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.57s]
[0m00:54:40.538313 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m00:54:40.539355 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:54:40.540190 [info ] [Thread-1 (]: 11 of 18 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m00:54:40.541088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m00:54:40.541928 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:54:40.547724 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:54:40.572642 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:54:40.576739 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:54:40.600205 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m00:54:40.601351 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m00:54:40.602281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:41.106326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m00:54:41.110313 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m00:54:41.205866 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.66s]
[0m00:54:41.207304 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m00:54:41.208141 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:54:41.209031 [info ] [Thread-1 (]: 12 of 18 START test not_null_volume_summary_symbol ............................. [RUN]
[0m00:54:41.210626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m00:54:41.211504 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:54:41.216691 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:54:41.233933 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:54:41.238022 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:54:41.254269 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m00:54:41.255295 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m00:54:41.256144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:41.648069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m00:54:41.651131 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m00:54:41.737099 [info ] [Thread-1 (]: 12 of 18 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.53s]
[0m00:54:41.738544 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m00:54:41.739405 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:54:41.740152 [info ] [Thread-1 (]: 13 of 18 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m00:54:41.740947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m00:54:41.741758 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:54:41.747965 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:54:41.772278 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:54:41.776275 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:54:41.831388 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m00:54:41.832402 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m00:54:41.833319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:42.084662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe476-0205-0fb8-0004-59ff002d6926
[0m00:54:42.086139 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m00:54:42.087216 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m00:54:42.192557 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:54:42.193848 [error] [Thread-1 (]: 13 of 18 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.45s]
[0m00:54:42.194908 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m00:54:42.195685 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:54:42.196569 [info ] [Thread-1 (]: 14 of 18 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m00:54:42.197317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m00:54:42.198175 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:54:42.203423 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:54:42.231400 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:54:42.235272 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:54:42.263622 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m00:54:42.264617 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m00:54:42.265586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:42.619336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m00:54:42.622411 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m00:54:42.725859 [info ] [Thread-1 (]: 14 of 18 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.53s]
[0m00:54:42.729106 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m00:54:42.730411 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:54:42.731425 [info ] [Thread-1 (]: 15 of 18 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m00:54:42.732727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m00:54:42.733650 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:54:42.751526 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:42.755645 [error] [Thread-1 (]: 15 of 18 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.02s]
[0m00:54:42.757996 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m00:54:42.759237 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:54:42.761430 [info ] [Thread-1 (]: 16 of 18 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m00:54:42.763659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m00:54:42.764734 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:54:42.778902 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:54:42.801686 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:54:42.807533 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:54:42.828348 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m00:54:42.829523 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:54:42.830682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:43.361205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m00:54:43.364654 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m00:54:43.481268 [info ] [Thread-1 (]: 16 of 18 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.72s]
[0m00:54:43.482858 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m00:54:43.483859 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:54:43.484737 [info ] [Thread-1 (]: 17 of 18 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m00:54:43.485682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m00:54:43.486475 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:54:43.492884 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:54:43.515014 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:54:43.518725 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:54:43.541355 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m00:54:43.542759 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:54:43.544249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:43.896178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m00:54:43.901453 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m00:54:44.004460 [info ] [Thread-1 (]: 17 of 18 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.52s]
[0m00:54:44.005860 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m00:54:44.006696 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:54:44.007548 [info ] [Thread-1 (]: 18 of 18 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m00:54:44.008318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m00:54:44.009061 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:54:44.014892 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:54:44.038202 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:54:44.041983 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:54:44.066969 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m00:54:44.068091 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:54:44.069038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:44.586698 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m00:54:44.589271 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m00:54:44.759854 [info ] [Thread-1 (]: 18 of 18 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.75s]
[0m00:54:44.761052 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m00:54:44.763330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:44.764030 [debug] [MainThread]: Connection 'test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5' was properly closed.
[0m00:54:44.764898 [info ] [MainThread]: 
[0m00:54:44.765678 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 10.67 seconds (10.67s).
[0m00:54:44.768159 [debug] [MainThread]: Command end result
[0m00:54:44.879459 [info ] [MainThread]: 
[0m00:54:44.880840 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:54:44.881629 [info ] [MainThread]: 
[0m00:54:44.882708 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m00:54:44.883482 [info ] [MainThread]: 
[0m00:54:44.884358 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m00:54:44.885127 [info ] [MainThread]: 
[0m00:54:44.885871 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:54:44.886576 [info ] [MainThread]: 
[0m00:54:44.887372 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=3 SKIP=0 TOTAL=18
[0m00:54:44.888807 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.934394, "process_user_time": 4.661076, "process_kernel_time": 2.020951, "process_mem_max_rss": "240760", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:54:44.889674 [debug] [MainThread]: Command `dbt test` failed at 00:54:44.889539 after 12.94 seconds
[0m00:54:44.890481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcbf7ce810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf8f06c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcf61cce90>]}
[0m00:54:44.891206 [debug] [MainThread]: Flushing usage events
[0m06:48:37.158660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb51c2e8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb51d839dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb51ba98d70>]}


============================== 06:48:37.166536 | 25974b01-432b-4d74-b6c2-4a85fa3cc73b ==============================
[0m06:48:37.166536 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:48:37.167723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:48:38.280457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25974b01-432b-4d74-b6c2-4a85fa3cc73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb51b2970b0>]}
[0m06:48:38.341622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25974b01-432b-4d74-b6c2-4a85fa3cc73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e5ef9c40>]}
[0m06:48:38.344313 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m06:48:38.437341 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:48:38.819828 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_stock_project: output/schema.yml - Runtime Error
    Syntax error near line 58
    ------------------------------
    55 |           - not_null
    56 |           -positive_values    
    57 |   
    58 |   - name: rsi
    59 |     description: "Relative Strength Index (RSI) calculated from stock prices"
    60 |     columns:
    61 |       - name: trade_date
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 56, column 11
    could not find expected ':'
      in "<unicode string>", line 58, column 3
[0m06:48:38.821217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8235159, "process_user_time": 3.285824, "process_kernel_time": 2.177471, "process_mem_max_rss": "221884", "process_in_blocks": "34912", "process_out_blocks": "2192", "command_success": false}
[0m06:48:38.822136 [debug] [MainThread]: Command `dbt run` failed at 06:48:38.821982 after 1.82 seconds
[0m06:48:38.822862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb51beec8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e5d48a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4e7d38410>]}
[0m06:48:38.823497 [debug] [MainThread]: Flushing usage events
[0m06:51:26.636995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a81c15670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a83ee33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a830900b0>]}


============================== 06:51:26.643963 | b73d504b-f258-493d-a88d-368026dc2c2c ==============================
[0m06:51:26.643963 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:51:26.645142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:51:27.666690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b73d504b-f258-493d-a88d-368026dc2c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a4b68e570>]}
[0m06:51:27.721344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b73d504b-f258-493d-a88d-368026dc2c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a4b857b00>]}
[0m06:51:27.722892 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m06:51:27.817007 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:51:28.255177 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_stock_project: output/schema.yml - Runtime Error
    Syntax error near line 58
    ------------------------------
    55 |           - not_null
    56 |           -positive_values    
    57 |   
    58 |   - name: rsi
    59 |     description: "Relative Strength Index (RSI) calculated from stock prices"
    60 |     columns:
    61 |       - name: trade_date
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 56, column 11
    could not find expected ':'
      in "<unicode string>", line 58, column 3
[0m06:51:28.257001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7126402, "process_user_time": 3.255183, "process_kernel_time": 1.901345, "process_mem_max_rss": "224020", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:51:28.257969 [debug] [MainThread]: Command `dbt run` failed at 06:51:28.257849 after 1.71 seconds
[0m06:51:28.258693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a82f21e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a51de1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a50f1bd70>]}
[0m06:51:28.259447 [debug] [MainThread]: Flushing usage events
[0m06:53:05.861585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe17afd1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe17ad36a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe17d354e90>]}


============================== 06:53:05.867793 | 4f9f6617-e816-4069-8af4-7eca41b3c867 ==============================
[0m06:53:05.867793 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:53:05.868964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:53:06.859787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f9f6617-e816-4069-8af4-7eca41b3c867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe176d95eb0>]}
[0m06:53:06.918685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f9f6617-e816-4069-8af4-7eca41b3c867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe17a9ebda0>]}
[0m06:53:06.920501 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m06:53:07.042839 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:53:07.466302 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_stock_project: output/schema.yml - Runtime Error
    Syntax error near line 57
    ------------------------------
    54 |         tests:
    55 |           - not_null
    56 |           -positive_values    
    57 |   - name: rsi
    58 |     description: "Relative Strength Index (RSI) calculated from stock prices"
    59 |     columns:
    60 |       - name: trade_date
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 56, column 11
    could not find expected ':'
      in "<unicode string>", line 57, column 3
[0m06:53:07.467873 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7065718, "process_user_time": 3.006065, "process_kernel_time": 1.984003, "process_mem_max_rss": "232180", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:53:07.468750 [debug] [MainThread]: Command `dbt run` failed at 06:53:07.468640 after 1.71 seconds
[0m06:53:07.469577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe149141c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe148cec950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe148cecdd0>]}
[0m06:53:07.470577 [debug] [MainThread]: Flushing usage events
[0m06:53:50.157941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316791e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316575c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3165cbac00>]}


============================== 06:53:50.165207 | 0d7b3951-f5dc-465f-b2b4-7708028e5f27 ==============================
[0m06:53:50.165207 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:53:50.166426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:53:51.112224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31669ae990>]}
[0m06:53:51.169444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312fa4cc20>]}
[0m06:53:51.171073 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m06:53:51.270912 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:53:51.779205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m06:53:51.780485 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://models/output/actual_vs_forecast.sql
[0m06:53:51.781990 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m06:53:51.782872 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m06:53:51.783808 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m06:53:51.988637 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:53:51.990023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312f5088f0>]}
[0m06:53:52.300979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312d0f8260>]}
[0m06:53:52.502757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312cf09010>]}
[0m06:53:52.503896 [info ] [MainThread]: Found 7 models, 32 data tests, 3 sources, 459 macros
[0m06:53:52.505120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312f261a30>]}
[0m06:53:52.507902 [info ] [MainThread]: 
[0m06:53:52.509045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:53:52.513469 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m06:53:52.525847 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m06:53:52.527075 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m06:53:52.528174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:53.938629 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.410 seconds
[0m06:53:53.943210 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m06:53:54.126010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m06:53:54.136399 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m06:53:54.137853 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m06:53:54.138828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:54.547015 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.408 seconds
[0m06:53:54.549432 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m06:53:54.723491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312d0f85c0>]}
[0m06:53:54.724671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:53:54.725515 [info ] [MainThread]: 
[0m06:53:54.736586 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m06:53:54.737986 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m06:53:54.739439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m06:53:54.740620 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m06:53:54.750413 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m06:53:54.765266 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m06:53:54.797072 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m06:53:54.815855 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m06:53:54.816856 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (

with actual as (
  select
    symbol,
    date::date     as trade_date,
    actual::float  as actual_close
  from USER_DB_BLUEJAY.raw.FINAL_DATA
  where actual is not null
),

forecast as (
  select
    symbol,
    date::date     as forecast_date,
    forecast::float    as predicted_close,
    lower_bound::float as lower_bound,
    upper_bound::float as upper_bound
  from USER_DB_BLUEJAY.raw.FINAL_DATA
  where forecast is not null
)

select
  f.forecast_date,
  f.symbol,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close
from forecast f
left join actual a
  on f.symbol        = a.symbol
 and f.forecast_date = a.trade_date
        );
[0m06:53:54.817903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:56.390762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.573 seconds
[0m06:53:56.424461 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m06:53:56.589134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312c52cef0>]}
[0m06:53:56.590800 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 1.85s]
[0m06:53:56.591961 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m06:53:56.592795 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m06:53:56.593567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m06:53:56.594301 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m06:53:56.598070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m06:53:56.646848 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m06:53:56.647777 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m06:53:56.648679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m06:53:56.649575 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m06:53:56.653548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m06:53:56.715457 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m06:53:56.716600 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m06:53:56.717816 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m06:53:56.718869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m06:53:56.719893 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m06:53:56.723789 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m06:53:56.767173 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m06:53:56.772440 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m06:53:56.803779 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m06:53:56.805156 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,
  CAST("CLOSE" - LAG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE") AS FLOAT) AS daily_change,
  ROUND(AVG("CLOSE") OVER (PARTITION BY "SYMBOL" ORDER BY "DATE" ROWS BETWEEN 6 PRECEDING AND CURRENT ROW), 2) AS moving_avg_7
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m06:53:56.806386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:58.108359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.302 seconds
[0m06:53:58.111147 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m06:53:58.257317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312c549430>]}
[0m06:53:58.258549 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.54s]
[0m06:53:58.259681 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m06:53:58.260518 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m06:53:58.261525 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m06:53:58.262350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m06:53:58.262841 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m06:53:58.336323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m06:53:58.354852 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m06:53:58.358255 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m06:53:58.368670 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m06:53:58.369480 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  SUM(CAST(volume AS INTEGER)) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS weekly_volume
FROM USER_DB_BLUEJAY.raw.STOCK
        );
[0m06:53:58.370314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:59.932401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.562 seconds
[0m06:53:59.935064 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m06:54:00.085561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312cee8050>]}
[0m06:54:00.087958 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.82s]
[0m06:54:00.089805 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m06:54:00.091179 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m06:54:00.092494 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m06:54:00.093817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m06:54:00.094775 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m06:54:00.108240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m06:54:00.133616 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m06:54:00.138456 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m06:54:00.163679 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m06:54:00.164854 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m06:54:00.165817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:01.271646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.106 seconds
[0m06:54:01.274267 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m06:54:01.429419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3166913e60>]}
[0m06:54:01.430729 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.34s]
[0m06:54:01.431900 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m06:54:01.432722 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m06:54:01.433529 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m06:54:01.434400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m06:54:01.435122 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m06:54:01.450646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m06:54:01.474355 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m06:54:01.477742 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m06:54:01.492376 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m06:54:01.493417 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/marts/rsi_prices.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    
    -- 14-day average gain and loss
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,

    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d,0)))), 2)
    END AS rsi_14d
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m06:54:01.494251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:02.350722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m06:54:02.353434 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m06:54:02.492897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d7b3951-f5dc-465f-b2b4-7708028e5f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312f7fa720>]}
[0m06:54:02.494526 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.06s]
[0m06:54:02.495649 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m06:54:02.498017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:02.499104 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m06:54:02.500180 [info ] [MainThread]: 
[0m06:54:02.501147 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m06:54:02.503252 [debug] [MainThread]: Command end result
[0m06:54:02.602933 [info ] [MainThread]: 
[0m06:54:02.604179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:54:02.605177 [info ] [MainThread]: 
[0m06:54:02.606053 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:54:02.607936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.543659, "process_user_time": 4.584624, "process_kernel_time": 2.087552, "process_mem_max_rss": "239492", "process_in_blocks": "5392", "process_out_blocks": "2664"}
[0m06:54:02.609032 [debug] [MainThread]: Command `dbt run` succeeded at 06:54:02.608875 after 12.54 seconds
[0m06:54:02.609927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31654d35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312f1f35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312f1f3470>]}
[0m06:54:02.611041 [debug] [MainThread]: Flushing usage events
[0m06:54:06.060420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6131da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6131d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6131f560>]}


============================== 06:54:06.068633 | 8f56680f-d1fe-4f86-b61a-0cc6deb4236f ==============================
[0m06:54:06.068633 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:54:06.070105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:54:07.120176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f56680f-d1fe-4f86-b61a-0cc6deb4236f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a620ea900>]}
[0m06:54:07.170968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f56680f-d1fe-4f86-b61a-0cc6deb4236f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2b13c1a0>]}
[0m06:54:07.172509 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m06:54:07.259372 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:54:07.600742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:54:07.601591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:54:07.649132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f56680f-d1fe-4f86-b61a-0cc6deb4236f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2ac58b30>]}
[0m06:54:07.838614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f56680f-d1fe-4f86-b61a-0cc6deb4236f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2a78f830>]}
[0m06:54:07.839668 [info ] [MainThread]: Found 7 models, 32 data tests, 3 sources, 459 macros
[0m06:54:07.840501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f56680f-d1fe-4f86-b61a-0cc6deb4236f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a61b8acf0>]}
[0m06:54:07.843599 [info ] [MainThread]: 
[0m06:54:07.844623 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:54:07.849606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m06:54:07.866342 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m06:54:07.867892 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m06:54:07.869113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:08.545262 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.676 seconds
[0m06:54:08.549103 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m06:54:08.707867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f56680f-d1fe-4f86-b61a-0cc6deb4236f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2a9db170>]}
[0m06:54:08.708947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:54:08.709703 [info ] [MainThread]: 
[0m06:54:08.719743 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m06:54:08.720865 [info ] [Thread-1 (]: 1 of 32 START test not_null_actual_vs_forecast_forecast_date ................... [RUN]
[0m06:54:08.721955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e)
[0m06:54:08.722843 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m06:54:08.738315 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"
[0m06:54:08.772397 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m06:54:08.792478 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"
[0m06:54:08.820982 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"
[0m06:54:08.822057 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select forecast_date
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where forecast_date is null



      
    ) dbt_internal_test
[0m06:54:08.822942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:09.497675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m06:54:09.507137 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e: Close
[0m06:54:09.702048 [info ] [Thread-1 (]: 1 of 32 PASS not_null_actual_vs_forecast_forecast_date ......................... [[32mPASS[0m in 0.98s]
[0m06:54:09.704402 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e
[0m06:54:09.705948 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m06:54:09.707385 [info ] [Thread-1 (]: 2 of 32 START test not_null_actual_vs_forecast_lower_bound ..................... [RUN]
[0m06:54:09.708914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_forecast_date.7265b28c5e, now test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676)
[0m06:54:09.710207 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m06:54:09.715920 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"
[0m06:54:09.753393 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m06:54:09.757929 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"
[0m06:54:09.790726 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"
[0m06:54:09.792290 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_bound
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where lower_bound is null



      
    ) dbt_internal_test
[0m06:54:09.793490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:10.544951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m06:54:10.547662 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676: Close
[0m06:54:10.694472 [info ] [Thread-1 (]: 2 of 32 PASS not_null_actual_vs_forecast_lower_bound ........................... [[32mPASS[0m in 0.99s]
[0m06:54:10.695737 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676
[0m06:54:10.696945 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m06:54:10.697813 [info ] [Thread-1 (]: 3 of 32 START test not_null_actual_vs_forecast_predicted_close ................. [RUN]
[0m06:54:10.698664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_lower_bound.d120519676, now test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759)
[0m06:54:10.699376 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m06:54:10.704617 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"
[0m06:54:10.722911 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m06:54:10.725994 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"
[0m06:54:10.748407 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"
[0m06:54:10.749212 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select predicted_close
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where predicted_close is null



      
    ) dbt_internal_test
[0m06:54:10.749886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:11.216075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m06:54:11.218608 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759: Close
[0m06:54:11.417329 [info ] [Thread-1 (]: 3 of 32 PASS not_null_actual_vs_forecast_predicted_close ....................... [[32mPASS[0m in 0.72s]
[0m06:54:11.419546 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759
[0m06:54:11.420637 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m06:54:11.421626 [info ] [Thread-1 (]: 4 of 32 START test not_null_actual_vs_forecast_symbol .......................... [RUN]
[0m06:54:11.422598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_predicted_close.2f3d261759, now test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3)
[0m06:54:11.423344 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m06:54:11.428594 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"
[0m06:54:11.480252 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m06:54:11.487635 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"
[0m06:54:11.537824 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"
[0m06:54:11.539563 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where symbol is null



      
    ) dbt_internal_test
[0m06:54:11.541392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:12.012880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m06:54:12.016067 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3: Close
[0m06:54:12.167582 [info ] [Thread-1 (]: 4 of 32 PASS not_null_actual_vs_forecast_symbol ................................ [[32mPASS[0m in 0.74s]
[0m06:54:12.169315 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3
[0m06:54:12.170391 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m06:54:12.171490 [info ] [Thread-1 (]: 5 of 32 START test not_null_actual_vs_forecast_upper_bound ..................... [RUN]
[0m06:54:12.172593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_symbol.ae562346a3, now test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed)
[0m06:54:12.173660 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m06:54:12.178387 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"
[0m06:54:12.208417 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m06:54:12.213328 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"
[0m06:54:12.244656 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"
[0m06:54:12.245817 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_bound
from USER_DB_BLUEJAY.analytics.actual_vs_forecast
where upper_bound is null



      
    ) dbt_internal_test
[0m06:54:12.246865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:12.752826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m06:54:12.756402 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed: Close
[0m06:54:12.938861 [info ] [Thread-1 (]: 5 of 32 PASS not_null_actual_vs_forecast_upper_bound ........................... [[32mPASS[0m in 0.77s]
[0m06:54:12.940319 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed
[0m06:54:12.941375 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m06:54:12.942210 [info ] [Thread-1 (]: 6 of 32 START test not_null_moving_averages_close_price_14d_ma ................. [RUN]
[0m06:54:12.943187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_actual_vs_forecast_upper_bound.dec0375bed, now test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299)
[0m06:54:12.943896 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m06:54:12.949316 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m06:54:12.969946 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m06:54:12.974105 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m06:54:12.998366 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"
[0m06:54:12.999310 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_14d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_14d_ma is null



      
    ) dbt_internal_test
[0m06:54:13.000081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:13.549547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m06:54:13.554734 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299: Close
[0m06:54:13.749502 [info ] [Thread-1 (]: 6 of 32 PASS not_null_moving_averages_close_price_14d_ma ....................... [[32mPASS[0m in 0.81s]
[0m06:54:13.751236 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299
[0m06:54:13.752519 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m06:54:13.753549 [info ] [Thread-1 (]: 7 of 32 START test not_null_moving_averages_close_price_30d_ma ................. [RUN]
[0m06:54:13.754503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_14d_ma.80c6392299, now test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9)
[0m06:54:13.755137 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m06:54:13.760204 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m06:54:13.781447 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m06:54:13.785933 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m06:54:13.814709 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"
[0m06:54:13.815912 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_30d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_30d_ma is null



      
    ) dbt_internal_test
[0m06:54:13.817033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:14.246409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m06:54:14.249160 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9: Close
[0m06:54:14.427352 [info ] [Thread-1 (]: 7 of 32 PASS not_null_moving_averages_close_price_30d_ma ....................... [[32mPASS[0m in 0.67s]
[0m06:54:14.429403 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9
[0m06:54:14.430917 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m06:54:14.432229 [info ] [Thread-1 (]: 8 of 32 START test not_null_moving_averages_close_price_7d_ma .................. [RUN]
[0m06:54:14.433786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_30d_ma.dbfc8323c9, now test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438)
[0m06:54:14.435119 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m06:54:14.441321 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m06:54:14.478019 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m06:54:14.482767 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m06:54:14.516574 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"
[0m06:54:14.518104 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price_7d_ma
from USER_DB_BLUEJAY.analytics.moving_averages
where close_price_7d_ma is null



      
    ) dbt_internal_test
[0m06:54:14.519266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:14.919883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m06:54:14.923893 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438: Close
[0m06:54:15.107342 [info ] [Thread-1 (]: 8 of 32 PASS not_null_moving_averages_close_price_7d_ma ........................ [[32mPASS[0m in 0.67s]
[0m06:54:15.109523 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438
[0m06:54:15.110912 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m06:54:15.112427 [info ] [Thread-1 (]: 9 of 32 START test not_null_moving_averages_symbol ............................. [RUN]
[0m06:54:15.113980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_close_price_7d_ma.2ca253f438, now test.dbt_stock_project.not_null_moving_averages_symbol.153f328246)
[0m06:54:15.115322 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m06:54:15.121449 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m06:54:15.160072 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m06:54:15.164100 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m06:54:15.207038 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"
[0m06:54:15.208507 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_symbol.153f328246"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.moving_averages
where symbol is null



      
    ) dbt_internal_test
[0m06:54:15.209849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:15.844101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m06:54:15.846566 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_symbol.153f328246: Close
[0m06:54:15.995801 [info ] [Thread-1 (]: 9 of 32 PASS not_null_moving_averages_symbol ................................... [[32mPASS[0m in 0.88s]
[0m06:54:15.996999 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_symbol.153f328246
[0m06:54:15.998068 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m06:54:15.998868 [info ] [Thread-1 (]: 10 of 32 START test not_null_moving_averages_trade_date ........................ [RUN]
[0m06:54:15.999640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_symbol.153f328246, now test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8)
[0m06:54:16.000325 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m06:54:16.006125 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m06:54:16.023558 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m06:54:16.027337 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m06:54:16.044799 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"
[0m06:54:16.045714 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is null



      
    ) dbt_internal_test
[0m06:54:16.046929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:16.545807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m06:54:16.551020 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8: Close
[0m06:54:16.705751 [info ] [Thread-1 (]: 10 of 32 PASS not_null_moving_averages_trade_date .............................. [[32mPASS[0m in 0.71s]
[0m06:54:16.707388 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8
[0m06:54:16.708768 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m06:54:16.710070 [info ] [Thread-1 (]: 11 of 32 START test not_null_rsi_rsi_14d ....................................... [RUN]
[0m06:54:16.711183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_trade_date.ee03ad32e8, now test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db)
[0m06:54:16.712212 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m06:54:16.718379 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m06:54:16.738412 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m06:54:16.742049 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m06:54:16.759560 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"
[0m06:54:16.760376 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.rsi
where rsi_14d is null



      
    ) dbt_internal_test
[0m06:54:16.760999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:17.235552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m06:54:17.239908 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db: Close
[0m06:54:17.398639 [info ] [Thread-1 (]: 11 of 32 PASS not_null_rsi_rsi_14d ............................................. [[32mPASS[0m in 0.69s]
[0m06:54:17.400849 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db
[0m06:54:17.402403 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m06:54:17.403971 [info ] [Thread-1 (]: 12 of 32 START test not_null_rsi_symbol ........................................ [RUN]
[0m06:54:17.405348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_rsi_14d.579b4e87db, now test.dbt_stock_project.not_null_rsi_symbol.21add3cf05)
[0m06:54:17.406739 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m06:54:17.412230 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m06:54:17.442882 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m06:54:17.446181 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m06:54:17.473705 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"
[0m06:54:17.474804 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_symbol.21add3cf05"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.rsi
where symbol is null



      
    ) dbt_internal_test
[0m06:54:17.475875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:18.058717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m06:54:18.062847 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_symbol.21add3cf05: Close
[0m06:54:18.223006 [info ] [Thread-1 (]: 12 of 32 PASS not_null_rsi_symbol .............................................. [[32mPASS[0m in 0.82s]
[0m06:54:18.224363 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_symbol.21add3cf05
[0m06:54:18.225334 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m06:54:18.226190 [info ] [Thread-1 (]: 13 of 32 START test not_null_rsi_trade_date .................................... [RUN]
[0m06:54:18.227024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_symbol.21add3cf05, now test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167)
[0m06:54:18.227797 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m06:54:18.232566 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m06:54:18.248766 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m06:54:18.252142 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m06:54:18.280217 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"
[0m06:54:18.281399 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.rsi
where trade_date is null



      
    ) dbt_internal_test
[0m06:54:18.282447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:18.761968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m06:54:18.764401 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167: Close
[0m06:54:18.957035 [info ] [Thread-1 (]: 13 of 32 PASS not_null_rsi_trade_date .......................................... [[32mPASS[0m in 0.73s]
[0m06:54:18.958526 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167
[0m06:54:18.959624 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m06:54:18.960669 [info ] [Thread-1 (]: 14 of 32 START test not_null_stock_indicators_rsi_14d .......................... [RUN]
[0m06:54:18.961694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_trade_date.9b91b7a167, now test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021)
[0m06:54:18.962458 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m06:54:18.967350 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m06:54:18.997503 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m06:54:19.000850 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m06:54:19.030723 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"
[0m06:54:19.031958 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
where rsi_14d is null



      
    ) dbt_internal_test
[0m06:54:19.033008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:19.520413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe5de-0205-0f94-0004-59ff002ef5da
[0m06:54:19.521706 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI_14D'
[0m06:54:19.522853 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021: Close
[0m06:54:19.682748 [debug] [Thread-1 (]: Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m06:54:19.683922 [error] [Thread-1 (]: 14 of 32 ERROR not_null_stock_indicators_rsi_14d ............................... [[31mERROR[0m in 0.72s]
[0m06:54:19.685125 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021
[0m06:54:19.686184 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m06:54:19.687995 [info ] [Thread-1 (]: 15 of 32 START test not_null_stock_indicators_symbol ........................... [RUN]
[0m06:54:19.689500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_rsi_14d.cc9bce7021, now test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8)
[0m06:54:19.690643 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m06:54:19.696938 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m06:54:19.723328 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m06:54:19.727523 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m06:54:19.746211 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"
[0m06:54:19.747229 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.stock_indicators
where symbol is null



      
    ) dbt_internal_test
[0m06:54:19.748045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:20.301509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m06:54:20.305988 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8: Close
[0m06:54:20.490665 [info ] [Thread-1 (]: 15 of 32 PASS not_null_stock_indicators_symbol ................................. [[32mPASS[0m in 0.80s]
[0m06:54:20.492544 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8
[0m06:54:20.493573 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m06:54:20.494495 [info ] [Thread-1 (]: 16 of 32 START test not_null_stock_indicators_trade_date ....................... [RUN]
[0m06:54:20.495620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_symbol.40c4f4f9c8, now test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773)
[0m06:54:20.496316 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m06:54:20.501470 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m06:54:20.526811 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m06:54:20.530402 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m06:54:20.555597 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"
[0m06:54:20.556574 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is null



      
    ) dbt_internal_test
[0m06:54:20.557507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:20.998645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m06:54:21.001186 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773: Close
[0m06:54:21.162146 [info ] [Thread-1 (]: 16 of 32 PASS not_null_stock_indicators_trade_date ............................. [[32mPASS[0m in 0.67s]
[0m06:54:21.163936 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773
[0m06:54:21.164818 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m06:54:21.165717 [info ] [Thread-1 (]: 17 of 32 START test not_null_volume_summary_symbol ............................. [RUN]
[0m06:54:21.166919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_indicators_trade_date.55f7f58773, now test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549)
[0m06:54:21.167827 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m06:54:21.172887 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m06:54:21.197765 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m06:54:21.201307 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m06:54:21.223058 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"
[0m06:54:21.224087 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_BLUEJAY.analytics.volume_summary
where symbol is null



      
    ) dbt_internal_test
[0m06:54:21.224967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:21.690319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m06:54:21.692364 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549: Close
[0m06:54:21.885537 [info ] [Thread-1 (]: 17 of 32 PASS not_null_volume_summary_symbol ................................... [[32mPASS[0m in 0.72s]
[0m06:54:21.886926 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549
[0m06:54:21.887831 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m06:54:21.888546 [info ] [Thread-1 (]: 18 of 32 START test not_null_volume_summary_total_volume ....................... [RUN]
[0m06:54:21.889272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_symbol.0972fa6549, now test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e)
[0m06:54:21.889842 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m06:54:21.894642 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m06:54:21.909632 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m06:54:21.913044 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m06:54:21.935272 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"
[0m06:54:21.936352 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_volume
from USER_DB_BLUEJAY.analytics.volume_summary
where total_volume is null



      
    ) dbt_internal_test
[0m06:54:21.937660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:22.363644 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe5de-0205-0c96-0004-59ff002f20fe
[0m06:54:22.364798 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'TOTAL_VOLUME'
[0m06:54:22.366004 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e: Close
[0m06:54:22.543071 [debug] [Thread-1 (]: Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m06:54:22.544675 [error] [Thread-1 (]: 18 of 32 ERROR not_null_volume_summary_total_volume ............................ [[31mERROR[0m in 0.66s]
[0m06:54:22.546056 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e
[0m06:54:22.547190 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m06:54:22.548047 [info ] [Thread-1 (]: 19 of 32 START test not_null_volume_summary_trade_date ......................... [RUN]
[0m06:54:22.548982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_total_volume.b2ee3af74e, now test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15)
[0m06:54:22.550010 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m06:54:22.555563 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m06:54:22.598259 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m06:54:22.603563 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m06:54:22.630625 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"
[0m06:54:22.631662 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trade_date
from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is null



      
    ) dbt_internal_test
[0m06:54:22.632313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:23.306963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m06:54:23.310304 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15: Close
[0m06:54:23.478236 [info ] [Thread-1 (]: 19 of 32 PASS not_null_volume_summary_trade_date ............................... [[32mPASS[0m in 0.93s]
[0m06:54:23.479381 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15
[0m06:54:23.480199 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m06:54:23.481002 [info ] [Thread-1 (]: 20 of 32 START test positive_values_moving_averages_close_price_14d_ma ......... [RUN]
[0m06:54:23.481986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_volume_summary_trade_date.7502e57d15, now test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0)
[0m06:54:23.482714 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m06:54:23.493960 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:23.495243 [error] [Thread-1 (]: 20 of 32 ERROR positive_values_moving_averages_close_price_14d_ma .............. [[31mERROR[0m in 0.01s]
[0m06:54:23.496490 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0
[0m06:54:23.497491 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m06:54:23.498215 [info ] [Thread-1 (]: 21 of 32 START test positive_values_moving_averages_close_price_30d_ma ......... [RUN]
[0m06:54:23.499351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_14d_ma.0906a1a3a0, now test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77)
[0m06:54:23.500229 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m06:54:23.506588 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:23.507598 [error] [Thread-1 (]: 21 of 32 ERROR positive_values_moving_averages_close_price_30d_ma .............. [[31mERROR[0m in 0.01s]
[0m06:54:23.508575 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77
[0m06:54:23.509142 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m06:54:23.509693 [info ] [Thread-1 (]: 22 of 32 START test positive_values_moving_averages_close_price_7d_ma .......... [RUN]
[0m06:54:23.510323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_30d_ma.082badad77, now test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba)
[0m06:54:23.510835 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m06:54:23.517396 [debug] [Thread-1 (]: Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:23.518510 [error] [Thread-1 (]: 22 of 32 ERROR positive_values_moving_averages_close_price_7d_ma ............... [[31mERROR[0m in 0.01s]
[0m06:54:23.519548 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba
[0m06:54:23.520667 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m06:54:23.521584 [info ] [Thread-1 (]: 23 of 32 START test positive_values_volume_summary_total_volume ................ [RUN]
[0m06:54:23.522746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_moving_averages_close_price_7d_ma.0e22a730ba, now test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd)
[0m06:54:23.523845 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m06:54:23.531860 [debug] [Thread-1 (]: Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:23.533016 [error] [Thread-1 (]: 23 of 32 ERROR positive_values_volume_summary_total_volume ..................... [[31mERROR[0m in 0.01s]
[0m06:54:23.534222 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd
[0m06:54:23.535164 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m06:54:23.536148 [info ] [Thread-1 (]: 24 of 32 START test range_rsi_rsi_14d__100__0 .................................. [RUN]
[0m06:54:23.537413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.positive_values_volume_summary_total_volume.eec40c30fd, now test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14)
[0m06:54:23.538428 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m06:54:23.546038 [debug] [Thread-1 (]: Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:23.547413 [error] [Thread-1 (]: 24 of 32 ERROR range_rsi_rsi_14d__100__0 ....................................... [[31mERROR[0m in 0.01s]
[0m06:54:23.549398 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14
[0m06:54:23.550933 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m06:54:23.552076 [info ] [Thread-1 (]: 25 of 32 START test range_stock_indicators_rsi_14d__100__0 ..................... [RUN]
[0m06:54:23.553445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_rsi_rsi_14d__100__0.7186e53d14, now test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4)
[0m06:54:23.554668 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m06:54:23.561449 [debug] [Thread-1 (]: Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:23.562675 [error] [Thread-1 (]: 25 of 32 ERROR range_stock_indicators_rsi_14d__100__0 .......................... [[31mERROR[0m in 0.01s]
[0m06:54:23.563858 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4
[0m06:54:23.564782 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m06:54:23.565950 [info ] [Thread-1 (]: 26 of 32 START test relationships_moving_averages_symbol__symbol__source_raw_stock_  [RUN]
[0m06:54:23.567132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.range_stock_indicators_rsi_14d__100__0.48fbd259b4, now test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe)
[0m06:54:23.567855 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m06:54:23.577586 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m06:54:23.614167 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m06:54:23.617446 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m06:54:23.638531 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"
[0m06:54:23.639389 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:54:23.640183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:24.265532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m06:54:24.268176 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe: Close
[0m06:54:24.433310 [info ] [Thread-1 (]: 26 of 32 PASS relationships_moving_averages_symbol__symbol__source_raw_stock_ .. [[32mPASS[0m in 0.87s]
[0m06:54:24.434734 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe
[0m06:54:24.435730 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m06:54:24.436906 [info ] [Thread-1 (]: 27 of 32 START test relationships_rsi_symbol__symbol__source_raw_stock_ ........ [RUN]
[0m06:54:24.438419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_symbol__symbol__source_raw_stock_.a82416bafe, now test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf)
[0m06:54:24.439329 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m06:54:24.445180 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m06:54:24.461334 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m06:54:24.464706 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m06:54:24.488671 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"
[0m06:54:24.489789 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:54:24.490667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:25.167566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m06:54:25.170527 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf: Close
[0m06:54:25.348129 [info ] [Thread-1 (]: 27 of 32 PASS relationships_rsi_symbol__symbol__source_raw_stock_ .............. [[32mPASS[0m in 0.91s]
[0m06:54:25.349515 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf
[0m06:54:25.350835 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m06:54:25.351866 [info ] [Thread-1 (]: 28 of 32 START test relationships_stock_indicators_symbol__symbol__source_raw_stock_  [RUN]
[0m06:54:25.353042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_symbol__symbol__source_raw_stock_.e438ec25cf, now test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5)
[0m06:54:25.353960 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m06:54:25.361071 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m06:54:25.382627 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m06:54:25.386229 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m06:54:25.408800 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"
[0m06:54:25.409871 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select symbol as from_field
    from USER_DB_BLUEJAY.analytics.stock_indicators
    where symbol is not null
),

parent as (
    select symbol as to_field
    from USER_DB_BLUEJAY.raw.STOCK
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:54:25.410822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:25.963369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m06:54:25.966393 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5: Close
[0m06:54:26.140675 [info ] [Thread-1 (]: 28 of 32 PASS relationships_stock_indicators_symbol__symbol__source_raw_stock_ . [[32mPASS[0m in 0.79s]
[0m06:54:26.142025 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5
[0m06:54:26.143134 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m06:54:26.144117 [info ] [Thread-1 (]: 29 of 32 START test unique_moving_averages_trade_date .......................... [RUN]
[0m06:54:26.145213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_stock_indicators_symbol__symbol__source_raw_stock_.4c37b2a9e5, now test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f)
[0m06:54:26.146135 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m06:54:26.155951 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"
[0m06:54:26.178384 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m06:54:26.184854 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"
[0m06:54:26.205218 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"
[0m06:54:26.206160 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m06:54:26.206997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:26.726508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m06:54:26.729283 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f: Close
[0m06:54:26.973564 [error] [Thread-1 (]: 29 of 32 FAIL 180 unique_moving_averages_trade_date ............................ [[31mFAIL 180[0m in 0.83s]
[0m06:54:26.974799 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f
[0m06:54:26.975528 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m06:54:26.976234 [info ] [Thread-1 (]: 30 of 32 START test unique_rsi_trade_date ...................................... [RUN]
[0m06:54:26.977039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_trade_date.ea128c105f, now test.dbt_stock_project.unique_rsi_trade_date.5701679003)
[0m06:54:26.977737 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m06:54:26.982772 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_trade_date.5701679003"
[0m06:54:27.001490 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m06:54:27.004977 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_trade_date.5701679003"
[0m06:54:27.020812 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_trade_date.5701679003"
[0m06:54:27.021961 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_trade_date.5701679003: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_trade_date.5701679003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m06:54:27.022895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:27.484541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m06:54:27.487617 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_trade_date.5701679003: Close
[0m06:54:27.636545 [error] [Thread-1 (]: 30 of 32 FAIL 180 unique_rsi_trade_date ........................................ [[31mFAIL 180[0m in 0.66s]
[0m06:54:27.638365 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_trade_date.5701679003
[0m06:54:27.639804 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m06:54:27.641020 [info ] [Thread-1 (]: 31 of 32 START test unique_stock_indicators_trade_date ......................... [RUN]
[0m06:54:27.642407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_trade_date.5701679003, now test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093)
[0m06:54:27.643820 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m06:54:27.650308 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"
[0m06:54:27.685859 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m06:54:27.691313 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"
[0m06:54:27.723752 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"
[0m06:54:27.724992 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.stock_indicators
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m06:54:27.725936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:28.220006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m06:54:28.222785 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093: Close
[0m06:54:28.386122 [error] [Thread-1 (]: 31 of 32 FAIL 180 unique_stock_indicators_trade_date ........................... [[31mFAIL 180[0m in 0.74s]
[0m06:54:28.387837 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093
[0m06:54:28.389118 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m06:54:28.390270 [info ] [Thread-1 (]: 32 of 32 START test unique_volume_summary_trade_date ........................... [RUN]
[0m06:54:28.391347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_stock_indicators_trade_date.35d5dac093, now test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8)
[0m06:54:28.392311 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m06:54:28.397530 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"
[0m06:54:28.415440 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m06:54:28.419134 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"
[0m06:54:28.435340 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"
[0m06:54:28.436293 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    trade_date as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.volume_summary
where trade_date is not null
group by trade_date
having count(*) > 1



      
    ) dbt_internal_test
[0m06:54:28.437548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:28.949759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.512 seconds
[0m06:54:28.952647 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8: Close
[0m06:54:29.111634 [error] [Thread-1 (]: 32 of 32 FAIL 180 unique_volume_summary_trade_date ............................. [[31mFAIL 180[0m in 0.72s]
[0m06:54:29.113752 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8
[0m06:54:29.117598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:29.118955 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_volume_summary_trade_date.ac9cc0fff8' was properly closed.
[0m06:54:29.120105 [info ] [MainThread]: 
[0m06:54:29.121299 [info ] [MainThread]: Finished running 32 data tests in 0 hours 0 minutes and 21.28 seconds (21.28s).
[0m06:54:29.126470 [debug] [MainThread]: Command end result
[0m06:54:29.240415 [info ] [MainThread]: 
[0m06:54:29.241464 [info ] [MainThread]: [31mCompleted with 12 errors and 0 warnings:[0m
[0m06:54:29.242330 [info ] [MainThread]: 
[0m06:54:29.243531 [error] [MainThread]:   Database Error in test not_null_stock_indicators_rsi_14d (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI_14D'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_stock_indicators_rsi_14d.sql
[0m06:54:29.244443 [info ] [MainThread]: 
[0m06:54:29.245374 [error] [MainThread]:   Database Error in test not_null_volume_summary_total_volume (models/output/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'TOTAL_VOLUME'
  compiled code at target/run/dbt_stock_project/models/output/schema.yml/not_null_volume_summary_total_volume.sql
[0m06:54:29.246242 [info ] [MainThread]: 
[0m06:54:29.247063 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_14d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:29.247900 [info ] [MainThread]: 
[0m06:54:29.248801 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_30d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:29.249600 [info ] [MainThread]: 
[0m06:54:29.251141 [error] [MainThread]:   Compilation Error in test positive_values_moving_averages_close_price_7d_ma (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:29.252371 [info ] [MainThread]: 
[0m06:54:29.253355 [error] [MainThread]:   Compilation Error in test positive_values_volume_summary_total_volume (models/output/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:29.254730 [info ] [MainThread]: 
[0m06:54:29.256329 [error] [MainThread]:   Compilation Error in test range_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:29.257954 [info ] [MainThread]: 
[0m06:54:29.259069 [error] [MainThread]:   Compilation Error in test range_stock_indicators_rsi_14d__100__0 (models/output/schema.yml)
  'test_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m06:54:29.259944 [info ] [MainThread]: 
[0m06:54:29.260964 [error] [MainThread]: [31mFailure in test unique_moving_averages_trade_date (models/output/schema.yml)[0m
[0m06:54:29.262151 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m06:54:29.263348 [info ] [MainThread]: 
[0m06:54:29.264518 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_moving_averages_trade_date.sql
[0m06:54:29.265574 [info ] [MainThread]: 
[0m06:54:29.266659 [error] [MainThread]: [31mFailure in test unique_rsi_trade_date (models/output/schema.yml)[0m
[0m06:54:29.267894 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m06:54:29.269060 [info ] [MainThread]: 
[0m06:54:29.270308 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_rsi_trade_date.sql
[0m06:54:29.271527 [info ] [MainThread]: 
[0m06:54:29.273018 [error] [MainThread]: [31mFailure in test unique_stock_indicators_trade_date (models/output/schema.yml)[0m
[0m06:54:29.274090 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m06:54:29.275187 [info ] [MainThread]: 
[0m06:54:29.276170 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_stock_indicators_trade_date.sql
[0m06:54:29.277193 [info ] [MainThread]: 
[0m06:54:29.278195 [error] [MainThread]: [31mFailure in test unique_volume_summary_trade_date (models/output/schema.yml)[0m
[0m06:54:29.279075 [error] [MainThread]:   Got 180 results, configured to fail if != 0
[0m06:54:29.279831 [info ] [MainThread]: 
[0m06:54:29.280600 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/unique_volume_summary_trade_date.sql
[0m06:54:29.281345 [info ] [MainThread]: 
[0m06:54:29.282151 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=12 SKIP=0 TOTAL=32
[0m06:54:29.283906 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 23.32457, "process_user_time": 4.718105, "process_kernel_time": 2.064171, "process_mem_max_rss": "243264", "process_in_blocks": "2496", "process_out_blocks": "24", "command_success": false}
[0m06:54:29.285221 [debug] [MainThread]: Command `dbt test` failed at 06:54:29.285033 after 23.33 seconds
[0m06:54:29.286382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6175dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2b07be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2b466ab0>]}
[0m06:54:29.287963 [debug] [MainThread]: Flushing usage events
[0m07:24:59.688143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e51077d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e6df27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e53bf8c0>]}


============================== 07:24:59.697308 | f2c3aa4a-32e3-41b7-861c-3cba5ac0f494 ==============================
[0m07:24:59.697308 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:24:59.698586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:25:01.459530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8af5d5880>]}
[0m07:25:01.508289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e5102750>]}
[0m07:25:01.510553 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:25:01.600823 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:25:02.136491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m07:25:02.138421 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m07:25:02.139532 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/actual_vs_forecast.sql
[0m07:25:02.140716 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/input/stock.sql
[0m07:25:02.141667 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/input/stock_forecast.sql
[0m07:25:02.142541 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m07:25:02.143251 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/volume_summary.sql
[0m07:25:02.144072 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/stock_indicators.sql
[0m07:25:02.144914 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/moving_averages.sql
[0m07:25:02.376132 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:25:02.377342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8af4819a0>]}
[0m07:25:02.391223 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'forecast_vs_actual' in the 'models' section of file 'models/output/schema.yml'
[0m07:25:02.394235 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'weekly_volume' in the 'models' section of file 'models/output/schema.yml'
[0m07:25:02.539774 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_stock_project.unique_forecast_vs_actual_forecast_id.3feac0ae65' (models/output/schema.yml) depends on a node named 'forecast_vs_actual' in package '' which was not found
[0m07:25:02.541320 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_stock_project.not_null_forecast_vs_actual_forecast_id.482cee41d9' (models/output/schema.yml) depends on a node named 'forecast_vs_actual' in package '' which was not found
[0m07:25:02.542607 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_stock_project.not_null_forecast_vs_actual_symbol.0da54eead5' (models/output/schema.yml) depends on a node named 'forecast_vs_actual' in package '' which was not found
[0m07:25:02.543941 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_stock_project.relationships_forecast_vs_actual_symbol__symbol__ref_stock_.a394b48f36' (models/output/schema.yml) depends on a node named 'forecast_vs_actual' in package '' which was not found
[0m07:25:02.545327 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_stock_project.unique_weekly_volume_stock_id.899aa2a832' (models/output/schema.yml) depends on a node named 'weekly_volume' in package '' which was not found
[0m07:25:02.546469 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_stock_project.not_null_weekly_volume_stock_id.888679227a' (models/output/schema.yml) depends on a node named 'weekly_volume' in package '' which was not found
[0m07:25:02.547597 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_stock_project.relationships_weekly_volume_stock_id__stock_id__ref_stock_.205aaad332' (models/output/schema.yml) depends on a node named 'weekly_volume' in package '' which was not found
[0m07:25:02.625725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8acc64800>]}
[0m07:25:02.822471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8accff950>]}
[0m07:25:02.823902 [info ] [MainThread]: Found 7 models, 11 data tests, 3 sources, 459 macros
[0m07:25:02.825100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8af0d4dd0>]}
[0m07:25:02.827972 [info ] [MainThread]: 
[0m07:25:02.829230 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:25:02.834508 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m07:25:02.848249 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m07:25:02.849402 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m07:25:02.850404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:03.584633 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.736 seconds
[0m07:25:03.587132 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m07:25:03.743503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m07:25:03.752929 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:25:03.754164 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:25:03.755465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:04.813482 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.058 seconds
[0m07:25:04.816367 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:25:04.976550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8aee69fd0>]}
[0m07:25:04.978517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:25:04.979865 [info ] [MainThread]: 
[0m07:25:04.992322 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m07:25:04.993449 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m07:25:04.994532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m07:25:04.995254 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m07:25:05.003803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:25:05.030586 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m07:25:05.059127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:25:05.084662 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m07:25:05.086384 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (WITH actual AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,
    CAST(actual AS FLOAT) AS actual_close
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE actual IS NOT NULL
),

forecast AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS forecast_date,
    CAST(forecast AS FLOAT) AS predicted_close,
    CAST(lower_bound AS FLOAT) AS lower_bound,
    CAST(upper_bound AS FLOAT) AS upper_bound
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE forecast IS NOT NULL
)

SELECT
  f.symbol,
  f.forecast_date,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close,
  
  -- Composite primary key
  CONCAT(f.symbol, '_', f.forecast_date) AS forecast_id

FROM forecast f
LEFT JOIN actual a
  ON f.symbol = a.symbol
 AND f.forecast_date = a.trade_date

ORDER BY f.symbol, f.forecast_date
        );
[0m07:25:05.087967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:06.708641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.621 seconds
[0m07:25:06.735626 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m07:25:06.888889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8af40e4b0>]}
[0m07:25:06.890339 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 1.89s]
[0m07:25:06.891492 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m07:25:06.892329 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m07:25:06.893377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m07:25:06.894240 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m07:25:06.897777 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m07:25:06.919940 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m07:25:06.921161 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m07:25:06.922209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m07:25:06.923422 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m07:25:06.927084 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m07:25:06.953562 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m07:25:06.954518 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m07:25:06.955549 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m07:25:06.956739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m07:25:06.957663 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m07:25:06.961505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m07:25:06.981810 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m07:25:06.986525 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m07:25:07.008354 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m07:25:07.009973 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:25:07.011135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:08.228739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.217 seconds
[0m07:25:08.234263 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m07:25:08.394956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ac16d0a0>]}
[0m07:25:08.396332 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.44s]
[0m07:25:08.397466 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m07:25:08.398466 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m07:25:08.399588 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m07:25:08.400671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m07:25:08.401440 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m07:25:08.405331 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m07:25:08.420213 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m07:25:08.423848 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m07:25:08.444283 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m07:25:08.445252 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:25:08.446030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:10.171131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.725 seconds
[0m07:25:10.174001 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m07:25:10.380838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ac2b5c10>]}
[0m07:25:10.382673 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.98s]
[0m07:25:10.384183 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m07:25:10.386208 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m07:25:10.388566 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m07:25:10.389775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m07:25:10.390757 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m07:25:10.403811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m07:25:10.428537 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m07:25:10.433355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m07:25:10.453131 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m07:25:10.454262 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m07:25:10.455195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:11.468013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.013 seconds
[0m07:25:11.472292 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m07:25:11.673237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e657f890>]}
[0m07:25:11.674694 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.28s]
[0m07:25:11.676053 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m07:25:11.677140 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m07:25:11.678371 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m07:25:11.679631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m07:25:11.680644 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m07:25:11.700968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m07:25:11.723807 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m07:25:11.812124 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m07:25:11.843387 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m07:25:11.844407 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m07:25:11.845384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:13.168402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.323 seconds
[0m07:25:13.171932 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m07:25:13.327765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c3aa4a-32e3-41b7-861c-3cba5ac0f494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e50b78f0>]}
[0m07:25:13.329511 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.65s]
[0m07:25:13.331187 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m07:25:13.333856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:13.334918 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m07:25:13.335900 [info ] [MainThread]: 
[0m07:25:13.336956 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m07:25:13.338744 [debug] [MainThread]: Command end result
[0m07:25:13.444903 [info ] [MainThread]: 
[0m07:25:13.446426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:25:13.447534 [info ] [MainThread]: 
[0m07:25:13.448533 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:25:13.450631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.853688, "process_user_time": 4.669626, "process_kernel_time": 2.037092, "process_mem_max_rss": "248508", "process_in_blocks": "128608", "process_out_blocks": "8"}
[0m07:25:13.451668 [debug] [MainThread]: Command `dbt run` succeeded at 07:25:13.451538 after 13.85 seconds
[0m07:25:13.452785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8af7681a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e51077d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8acdff8f0>]}
[0m07:25:13.453552 [debug] [MainThread]: Flushing usage events
[0m07:25:17.947842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3fe0d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3f84b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c41084440>]}


============================== 07:25:17.955243 | 44f4ad46-58ca-4faf-8196-33c033a02b17 ==============================
[0m07:25:17.955243 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:25:17.956462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:25:18.909960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44f4ad46-58ca-4faf-8196-33c033a02b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0dc3cda0>]}
[0m07:25:18.973459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44f4ad46-58ca-4faf-8196-33c033a02b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3f5da090>]}
[0m07:25:18.975351 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:25:19.072668 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:25:19.520500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:25:19.521582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:25:19.563059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44f4ad46-58ca-4faf-8196-33c033a02b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0d6f7680>]}
[0m07:25:19.756521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44f4ad46-58ca-4faf-8196-33c033a02b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0d43fb60>]}
[0m07:25:19.757514 [info ] [MainThread]: Found 7 models, 11 data tests, 3 sources, 459 macros
[0m07:25:19.758465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f4ad46-58ca-4faf-8196-33c033a02b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0da22d50>]}
[0m07:25:19.761509 [info ] [MainThread]: 
[0m07:25:19.762803 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:25:19.771180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m07:25:19.787898 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:25:19.789019 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:25:19.790071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:20.429502 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.639 seconds
[0m07:25:20.432095 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:25:20.593501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44f4ad46-58ca-4faf-8196-33c033a02b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c40c17ef0>]}
[0m07:25:20.595209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:25:20.596276 [info ] [MainThread]: 
[0m07:25:20.606458 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.dbt_expectations_expect_column_values_to_be_between_rsi_rsi_14d__100__0.94c84a125c
[0m07:25:20.607965 [info ] [Thread-1 (]: 1 of 11 START test dbt_expectations_expect_column_values_to_be_between_rsi_rsi_14d__100__0  [RUN]
[0m07:25:20.609184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.dbt_expectations_expect_column_values_to_be_between_rsi_rsi_14d__100__0.94c84a125c)
[0m07:25:20.610340 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.dbt_expectations_expect_column_values_to_be_between_rsi_rsi_14d__100__0.94c84a125c
[0m07:25:20.632092 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:25:20.633877 [error] [Thread-1 (]: 1 of 11 ERROR dbt_expectations_expect_column_values_to_be_between_rsi_rsi_14d__100__0  [[31mERROR[0m in 0.02s]
[0m07:25:20.635439 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.dbt_expectations_expect_column_values_to_be_between_rsi_rsi_14d__100__0.94c84a125c
[0m07:25:20.636506 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:25:20.637495 [info ] [Thread-1 (]: 2 of 11 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m07:25:20.638675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.dbt_expectations_expect_column_values_to_be_between_rsi_rsi_14d__100__0.94c84a125c, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m07:25:20.639757 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:25:20.649433 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:25:20.671704 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:25:20.693473 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:25:20.719024 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:25:20.720104 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m07:25:20.721073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:21.352373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m07:25:21.364682 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m07:25:21.515993 [info ] [Thread-1 (]: 2 of 11 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.88s]
[0m07:25:21.517328 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:25:21.518327 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:25:21.519214 [info ] [Thread-1 (]: 3 of 11 START test not_null_rsi_stock_id ....................................... [RUN]
[0m07:25:21.520435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m07:25:21.521297 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:25:21.526404 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:25:21.553933 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:25:21.557770 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:25:21.577970 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:25:21.579102 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m07:25:21.580154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:22.103521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m07:25:22.106465 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m07:25:22.273777 [info ] [Thread-1 (]: 3 of 11 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.75s]
[0m07:25:22.275419 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:25:22.276629 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:25:22.277413 [info ] [Thread-1 (]: 4 of 11 START test not_null_stock_stock_id ..................................... [RUN]
[0m07:25:22.278496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m07:25:22.279312 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:25:22.288415 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:25:22.311080 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:25:22.331325 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:25:22.335861 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:25:22.356833 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:25:22.358002 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m07:25:22.358902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:23.060798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m07:25:23.065585 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m07:25:23.227164 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.95s]
[0m07:25:23.228933 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:25:23.230269 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:25:23.231328 [info ] [Thread-1 (]: 5 of 11 START test not_null_stock_symbol ....................................... [RUN]
[0m07:25:23.232445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m07:25:23.233312 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:25:23.240052 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:25:23.268179 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:25:23.272986 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:25:23.302419 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:25:23.303712 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m07:25:23.304674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:23.766387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m07:25:23.769348 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m07:25:23.932316 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.70s]
[0m07:25:23.933910 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:25:23.935176 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:25:23.936324 [info ] [Thread-1 (]: 6 of 11 START test not_null_stock_trade_date ................................... [RUN]
[0m07:25:23.937568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m07:25:23.938428 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:25:23.944430 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:25:23.968878 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:25:23.974503 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:25:24.000726 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:25:24.001977 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m07:25:24.002987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:24.459794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m07:25:24.463147 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m07:25:24.622501 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.68s]
[0m07:25:24.624109 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:25:24.625227 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:25:24.626388 [info ] [Thread-1 (]: 7 of 11 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m07:25:24.627370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m07:25:24.628386 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:25:24.642087 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:25:24.678089 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:25:24.682798 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:25:24.707415 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:25:24.708800 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:25:24.710134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:25.409898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m07:25:25.412376 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m07:25:25.585475 [info ] [Thread-1 (]: 7 of 11 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.96s]
[0m07:25:25.587138 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:25:25.588364 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:25:25.589363 [info ] [Thread-1 (]: 8 of 11 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m07:25:25.590529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m07:25:25.591483 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:25:25.600074 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:25:25.630313 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:25:25.634650 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:25:25.659651 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:25:25.660970 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:25:25.662246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:26.235737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m07:25:26.240717 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m07:25:26.444642 [info ] [Thread-1 (]: 8 of 11 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.85s]
[0m07:25:26.446334 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:25:26.447596 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:25:26.448514 [info ] [Thread-1 (]: 9 of 11 START test unique_moving_averages_stock_id ............................. [RUN]
[0m07:25:26.449546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m07:25:26.450520 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:25:26.459876 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:25:26.476813 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:25:26.480371 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:25:26.497984 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:25:26.499020 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:25:26.499825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:27.046680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m07:25:27.049894 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m07:25:27.229526 [info ] [Thread-1 (]: 9 of 11 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.78s]
[0m07:25:27.231156 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:25:27.232554 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:25:27.233814 [info ] [Thread-1 (]: 10 of 11 START test unique_rsi_stock_id ........................................ [RUN]
[0m07:25:27.235231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m07:25:27.236479 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:25:27.242113 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:25:27.259642 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:25:27.264387 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:25:27.285779 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:25:27.286802 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:25:27.287701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:27.773524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m07:25:27.777318 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m07:25:27.941664 [info ] [Thread-1 (]: 10 of 11 PASS unique_rsi_stock_id .............................................. [[32mPASS[0m in 0.71s]
[0m07:25:27.943123 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:25:27.944280 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:25:27.945146 [info ] [Thread-1 (]: 11 of 11 START test unique_stock_stock_id ...................................... [RUN]
[0m07:25:27.946101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m07:25:27.946994 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:25:27.955842 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:25:27.978434 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:25:27.982378 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:25:28.006366 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:25:28.007465 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:25:28.008365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:25:28.459624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.451 seconds
[0m07:25:28.464285 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m07:25:28.633100 [info ] [Thread-1 (]: 11 of 11 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.69s]
[0m07:25:28.634872 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:25:28.637757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:28.638989 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m07:25:28.640098 [info ] [MainThread]: 
[0m07:25:28.641062 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m07:25:28.643309 [debug] [MainThread]: Command end result
[0m07:25:28.754147 [info ] [MainThread]: 
[0m07:25:28.755243 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:25:28.756088 [info ] [MainThread]: 
[0m07:25:28.756900 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_rsi_rsi_14d__100__0 (models/output/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:25:28.757721 [info ] [MainThread]: 
[0m07:25:28.758572 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m07:25:28.759662 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.91482, "process_user_time": 4.100121, "process_kernel_time": 1.943761, "process_mem_max_rss": "240476", "process_in_blocks": "2312", "process_out_blocks": "8", "command_success": false}
[0m07:25:28.760549 [debug] [MainThread]: Command `dbt test` failed at 07:25:28.760413 after 10.92 seconds
[0m07:25:28.761271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3f623a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0d7202f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c3f1f3dd0>]}
[0m07:25:28.762030 [debug] [MainThread]: Flushing usage events
[0m07:32:17.989108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed468cc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed468cd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed46b39820>]}


============================== 07:32:17.997579 | dc1ec85f-037e-473f-961a-d81a6bd3e42b ==============================
[0m07:32:17.997579 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:32:17.998891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:32:18.925256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc1ec85f-037e-473f-961a-d81a6bd3e42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed17055430>]}
[0m07:32:18.978861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc1ec85f-037e-473f-961a-d81a6bd3e42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed170dd490>]}
[0m07:32:18.980334 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:32:19.067851 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:32:19.514487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:32:19.516135 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m07:32:19.706213 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:32:19.707760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dc1ec85f-037e-473f-961a-d81a6bd3e42b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed14597f50>]}
[0m07:32:19.810525 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/output/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', [0, 100]), ('strict', True)] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m07:32:19.812584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9197655, "process_user_time": 3.241255, "process_kernel_time": 1.80513, "process_mem_max_rss": "243024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:32:19.813761 [debug] [MainThread]: Command `dbt run` failed at 07:32:19.813637 after 1.92 seconds
[0m07:32:19.814906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4a5d2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4a433ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed0e564e30>]}
[0m07:32:19.816051 [debug] [MainThread]: Flushing usage events
[0m07:32:46.938638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7322bd0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73216f58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73217cc680>]}


============================== 07:32:46.946649 | 55afbfb8-e7b5-4c62-8312-613af28c3b4c ==============================
[0m07:32:46.946649 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:32:46.948255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:32:47.906725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55afbfb8-e7b5-4c62-8312-613af28c3b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72ebb52f60>]}
[0m07:32:47.964739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55afbfb8-e7b5-4c62-8312-613af28c3b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f1624560>]}
[0m07:32:47.966275 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:32:48.087335 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:32:48.574471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:32:48.575782 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m07:32:48.757490 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:32:48.758905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55afbfb8-e7b5-4c62-8312-613af28c3b4c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72f1da2cf0>]}
[0m07:32:48.859481 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_rsi_rsi_14d__True__0__100 (models/output/schema.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'strict'
[0m07:32:48.861231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.013608, "process_user_time": 3.391392, "process_kernel_time": 1.926471, "process_mem_max_rss": "237140", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:32:48.862216 [debug] [MainThread]: Command `dbt run` failed at 07:32:48.862124 after 2.01 seconds
[0m07:32:48.863056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7322bd0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f732234e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72eb132900>]}
[0m07:32:48.864009 [debug] [MainThread]: Flushing usage events
[0m07:33:30.127089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65336a1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6534140c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65336a62d0>]}


============================== 07:33:30.134993 | aea0f7d4-1a3a-4a94-83ab-91ddc5de918e ==============================
[0m07:33:30.134993 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:33:30.136320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:33:31.063823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fe051b20>]}
[0m07:33:31.112040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64ff17d220>]}
[0m07:33:31.113801 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:33:31.195536 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:33:31.684442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:33:31.686383 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m07:33:31.886893 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:33:31.888481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fd514530>]}
[0m07:33:32.085790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e3409730>]}
[0m07:33:32.287200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e34b2d20>]}
[0m07:33:32.288485 [info ] [MainThread]: Found 7 models, 11 data tests, 3 sources, 459 macros
[0m07:33:32.289437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e35c10d0>]}
[0m07:33:32.292364 [info ] [MainThread]: 
[0m07:33:32.293660 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:33:32.298915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m07:33:32.312443 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m07:33:32.313764 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m07:33:32.314986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:32.990872 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.676 seconds
[0m07:33:32.993994 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m07:33:33.211123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m07:33:33.221450 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:33:33.222492 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:33:33.223411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:33:33.810479 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.587 seconds
[0m07:33:33.815251 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:33:34.153893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e35e1190>]}
[0m07:33:34.155228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:33:34.156259 [info ] [MainThread]: 
[0m07:33:34.166000 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m07:33:34.167315 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m07:33:34.168463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m07:33:34.169260 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m07:33:34.178662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:33:34.200187 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m07:33:34.232495 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:33:34.255972 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m07:33:34.257173 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (WITH actual AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,
    CAST(actual AS FLOAT) AS actual_close
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE actual IS NOT NULL
),

forecast AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS forecast_date,
    CAST(forecast AS FLOAT) AS predicted_close,
    CAST(lower_bound AS FLOAT) AS lower_bound,
    CAST(upper_bound AS FLOAT) AS upper_bound
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE forecast IS NOT NULL
)

SELECT
  f.symbol,
  f.forecast_date,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close,
  
  -- Composite primary key
  CONCAT(f.symbol, '_', f.forecast_date) AS forecast_id

FROM forecast f
LEFT JOIN actual a
  ON f.symbol = a.symbol
 AND f.forecast_date = a.trade_date

ORDER BY f.symbol, f.forecast_date
        );
[0m07:33:34.258070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:36.014735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.757 seconds
[0m07:33:36.037398 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m07:33:36.289848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fda7b0e0>]}
[0m07:33:36.291129 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 2.12s]
[0m07:33:36.292299 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m07:33:36.293293 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m07:33:36.294137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m07:33:36.294971 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m07:33:36.298364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m07:33:36.317783 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m07:33:36.318742 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m07:33:36.319639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m07:33:36.320689 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m07:33:36.324885 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m07:33:36.342893 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m07:33:36.343854 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m07:33:36.344732 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m07:33:36.345813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m07:33:36.346673 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m07:33:36.350505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m07:33:36.365439 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m07:33:36.369325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m07:33:36.392439 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m07:33:36.393807 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:33:36.395028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:37.531426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m07:33:37.534203 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m07:33:37.694372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e2978290>]}
[0m07:33:37.696481 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.35s]
[0m07:33:37.698083 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m07:33:37.699303 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m07:33:37.700859 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m07:33:37.702304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m07:33:37.703326 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m07:33:37.707201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m07:33:37.732418 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m07:33:37.738913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m07:33:37.761552 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m07:33:37.762667 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:33:37.763615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:39.015081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.251 seconds
[0m07:33:39.017903 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m07:33:39.159610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e2990530>]}
[0m07:33:39.160983 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.46s]
[0m07:33:39.162128 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m07:33:39.163012 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m07:33:39.164053 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m07:33:39.165168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m07:33:39.166168 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m07:33:39.179768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m07:33:39.202069 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m07:33:39.207007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m07:33:39.230383 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m07:33:39.231656 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m07:33:39.232992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:40.414016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.181 seconds
[0m07:33:40.419226 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m07:33:40.591634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6534bebbc0>]}
[0m07:33:40.593038 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.43s]
[0m07:33:40.594103 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m07:33:40.594993 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m07:33:40.596000 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m07:33:40.596926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m07:33:40.597766 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m07:33:40.617206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m07:33:40.637034 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m07:33:40.642016 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m07:33:40.675833 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m07:33:40.677303 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m07:33:40.678532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:41.739864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.061 seconds
[0m07:33:41.742755 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m07:33:41.898256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aea0f7d4-1a3a-4a94-83ab-91ddc5de918e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e2968140>]}
[0m07:33:41.899692 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.30s]
[0m07:33:41.900769 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m07:33:41.902781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:33:41.903658 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m07:33:41.904636 [info ] [MainThread]: 
[0m07:33:41.905566 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.61 seconds (9.61s).
[0m07:33:41.907334 [debug] [MainThread]: Command end result
[0m07:33:42.116594 [info ] [MainThread]: 
[0m07:33:42.117763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:33:42.119145 [info ] [MainThread]: 
[0m07:33:42.120226 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:33:42.122208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.090979, "process_user_time": 4.080617, "process_kernel_time": 1.922473, "process_mem_max_rss": "253328", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:33:42.123486 [debug] [MainThread]: Command `dbt run` succeeded at 07:33:42.123323 after 12.09 seconds
[0m07:33:42.124491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653442d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653442d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653442e360>]}
[0m07:33:42.125438 [debug] [MainThread]: Flushing usage events
[0m07:33:46.079580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b530b3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b53759af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b53c8ccb0>]}


============================== 07:33:46.087169 | 74f93abe-8a70-4eea-920a-50c6b361ac6a ==============================
[0m07:33:46.087169 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:33:46.088337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:33:46.933745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74f93abe-8a70-4eea-920a-50c6b361ac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b212c3830>]}
[0m07:33:46.984713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74f93abe-8a70-4eea-920a-50c6b361ac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b21f515e0>]}
[0m07:33:46.986330 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:33:47.062594 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:33:47.531411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:33:47.532759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:33:47.574462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74f93abe-8a70-4eea-920a-50c6b361ac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b52b80ce0>]}
[0m07:33:47.788553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74f93abe-8a70-4eea-920a-50c6b361ac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b20b4c980>]}
[0m07:33:47.789665 [info ] [MainThread]: Found 7 models, 11 data tests, 3 sources, 459 macros
[0m07:33:47.790538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74f93abe-8a70-4eea-920a-50c6b361ac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b24918aa0>]}
[0m07:33:47.793199 [info ] [MainThread]: 
[0m07:33:47.794369 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:33:47.799908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m07:33:47.815843 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:33:47.817183 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:33:47.818388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:48.547959 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.729 seconds
[0m07:33:48.552364 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:33:48.724216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74f93abe-8a70-4eea-920a-50c6b361ac6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b212c05f0>]}
[0m07:33:48.726536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:33:48.728478 [info ] [MainThread]: 
[0m07:33:48.741379 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d
[0m07:33:48.742736 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_rsi_rsi_14d__0__100 ......................... [RUN]
[0m07:33:48.743999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d)
[0m07:33:48.745055 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d
[0m07:33:48.762576 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d"
[0m07:33:48.783435 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d
[0m07:33:48.807636 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d"
[0m07:33:48.829539 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d"
[0m07:33:48.830456 [debug] [Thread-1 (]: On test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rsi_14d as value_field,
        count(*) as n_records

    from USER_DB_BLUEJAY.analytics.rsi
    group by rsi_14d

)

select *
from all_values
where value_field not in (
    '0','100'
)



      
    ) dbt_internal_test
[0m07:33:48.831206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:49.541357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m07:33:49.554548 [debug] [Thread-1 (]: On test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d: Close
[0m07:33:49.716666 [error] [Thread-1 (]: 1 of 11 FAIL 509 accepted_values_rsi_rsi_14d__0__100 ........................... [[31mFAIL 509[0m in 0.97s]
[0m07:33:49.718468 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d
[0m07:33:49.720164 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:33:49.721628 [info ] [Thread-1 (]: 2 of 11 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m07:33:49.723005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.accepted_values_rsi_rsi_14d__0__100.21068c550d, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m07:33:49.724016 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:33:49.731200 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:33:49.757284 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:33:49.761427 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:33:49.784215 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:33:49.785244 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m07:33:49.786116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:50.310986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m07:33:50.314070 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m07:33:50.481520 [info ] [Thread-1 (]: 2 of 11 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.76s]
[0m07:33:50.483608 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:33:50.485224 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:33:50.486478 [info ] [Thread-1 (]: 3 of 11 START test not_null_rsi_stock_id ....................................... [RUN]
[0m07:33:50.488311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m07:33:50.489756 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:33:50.494828 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:33:50.525973 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:33:50.530378 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:33:50.559155 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:33:50.560193 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m07:33:50.561072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:51.020620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m07:33:51.023889 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m07:33:51.402716 [info ] [Thread-1 (]: 3 of 11 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.91s]
[0m07:33:51.404867 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:33:51.406425 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:33:51.407529 [info ] [Thread-1 (]: 4 of 11 START test not_null_stock_stock_id ..................................... [RUN]
[0m07:33:51.408708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m07:33:51.409744 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:33:51.417255 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:33:51.442184 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:33:51.463268 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:33:51.467588 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:33:51.490727 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:33:51.491774 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m07:33:51.492607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:51.975155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m07:33:51.978179 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m07:33:52.150773 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.74s]
[0m07:33:52.152364 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:33:52.153669 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:33:52.155144 [info ] [Thread-1 (]: 5 of 11 START test not_null_stock_symbol ....................................... [RUN]
[0m07:33:52.156630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m07:33:52.157580 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:33:52.164006 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:33:52.185352 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:33:52.189974 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:33:52.214405 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:33:52.215228 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m07:33:52.215890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:52.651111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m07:33:52.655982 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m07:33:52.835386 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.68s]
[0m07:33:52.836762 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:33:52.838807 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:33:52.840261 [info ] [Thread-1 (]: 6 of 11 START test not_null_stock_trade_date ................................... [RUN]
[0m07:33:52.842097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m07:33:52.843116 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:33:52.851266 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:33:52.874890 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:33:52.879636 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:33:52.905801 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:33:52.907218 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m07:33:52.908535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:53.424064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m07:33:53.428865 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m07:33:53.630439 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.79s]
[0m07:33:53.632395 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:33:53.633724 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:33:53.634999 [info ] [Thread-1 (]: 7 of 11 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m07:33:53.636134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m07:33:53.636962 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:33:53.648869 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:33:53.676279 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:33:53.679316 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:33:53.703912 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:33:53.705028 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:33:53.705968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:54.305407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m07:33:54.309629 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m07:33:54.465374 [info ] [Thread-1 (]: 7 of 11 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.83s]
[0m07:33:54.467222 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:33:54.468466 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:33:54.469591 [info ] [Thread-1 (]: 8 of 11 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m07:33:54.470759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m07:33:54.471938 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:33:54.480965 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:33:54.511061 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:33:54.514585 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:33:54.543737 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:33:54.544896 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:33:54.545971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:55.148987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m07:33:55.152621 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m07:33:55.315579 [info ] [Thread-1 (]: 8 of 11 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.84s]
[0m07:33:55.316956 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:33:55.317982 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:33:55.319047 [info ] [Thread-1 (]: 9 of 11 START test unique_moving_averages_stock_id ............................. [RUN]
[0m07:33:55.320228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m07:33:55.321235 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:33:55.330588 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:33:55.364959 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:33:55.369152 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:33:55.400398 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:33:55.401728 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:33:55.402818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:55.840314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m07:33:55.843194 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m07:33:55.998058 [info ] [Thread-1 (]: 9 of 11 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.68s]
[0m07:33:55.999453 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:33:56.000538 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:33:56.001477 [info ] [Thread-1 (]: 10 of 11 START test unique_rsi_stock_id ........................................ [RUN]
[0m07:33:56.002431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m07:33:56.003194 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:33:56.010054 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:33:56.033068 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:33:56.036745 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:33:56.060916 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:33:56.062562 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:33:56.064108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:56.463235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m07:33:56.466099 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m07:33:56.623969 [info ] [Thread-1 (]: 10 of 11 PASS unique_rsi_stock_id .............................................. [[32mPASS[0m in 0.62s]
[0m07:33:56.625495 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:33:56.626557 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:33:56.627527 [info ] [Thread-1 (]: 11 of 11 START test unique_stock_stock_id ...................................... [RUN]
[0m07:33:56.628677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m07:33:56.629568 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:33:56.636514 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:33:56.657089 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:33:56.660689 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:33:56.681417 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:33:56.682437 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:33:56.683117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:57.059835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m07:33:57.063564 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m07:33:57.237929 [info ] [Thread-1 (]: 11 of 11 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.61s]
[0m07:33:57.239451 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:33:57.241881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:33:57.242774 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m07:33:57.243780 [info ] [MainThread]: 
[0m07:33:57.244778 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 9.45 seconds (9.45s).
[0m07:33:57.247267 [debug] [MainThread]: Command end result
[0m07:33:57.355760 [info ] [MainThread]: 
[0m07:33:57.356826 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:33:57.357860 [info ] [MainThread]: 
[0m07:33:57.359098 [error] [MainThread]: [31mFailure in test accepted_values_rsi_rsi_14d__0__100 (models/output/schema.yml)[0m
[0m07:33:57.360245 [error] [MainThread]:   Got 509 results, configured to fail if != 0
[0m07:33:57.361273 [info ] [MainThread]: 
[0m07:33:57.362471 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/models/output/schema.yml/accepted_values_rsi_rsi_14d__0__100.sql
[0m07:33:57.363666 [info ] [MainThread]: 
[0m07:33:57.364804 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m07:33:57.366531 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 11.380471, "process_user_time": 4.063015, "process_kernel_time": 1.933923, "process_mem_max_rss": "240076", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:33:57.367760 [debug] [MainThread]: Command `dbt test` failed at 07:33:57.367598 after 11.38 seconds
[0m07:33:57.368708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b52ebfbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b215082c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b536f92b0>]}
[0m07:33:57.369569 [debug] [MainThread]: Flushing usage events
[0m07:41:15.294683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b66864230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6586fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b66c02de0>]}


============================== 07:41:15.301666 | 9f8eaa7b-e4e7-446f-8689-71c6b69431af ==============================
[0m07:41:15.301666 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:41:15.302910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:41:16.186118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f8eaa7b-e4e7-446f-8689-71c6b69431af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b65315850>]}
[0m07:41:16.235873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f8eaa7b-e4e7-446f-8689-71c6b69431af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b359b2c60>]}
[0m07:41:16.237532 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:41:16.344698 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:41:16.800369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:41:16.801832 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://tests/rsi_test.sql
[0m07:41:16.803098 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m07:41:17.088824 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:41:17.090140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9f8eaa7b-e4e7-446f-8689-71c6b69431af', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2ef241a0>]}
[0m07:41:17.180022 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/output/schema.yml:
  	test definition dictionary must have exactly one key, got [('custom', None), ('name', 'rsi_test')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m07:41:17.181779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9786863, "process_user_time": 3.418705, "process_kernel_time": 1.770039, "process_mem_max_rss": "226632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:41:17.183025 [debug] [MainThread]: Command `dbt run` failed at 07:41:17.182878 after 1.98 seconds
[0m07:41:17.184018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6592b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b64cfd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2eebc380>]}
[0m07:41:17.184965 [debug] [MainThread]: Flushing usage events
[0m07:41:59.648454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e66546480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6878a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e66bd3530>]}


============================== 07:41:59.655154 | d14252c1-133b-4774-b084-ba918d1f7e55 ==============================
[0m07:41:59.655154 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:41:59.656356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m07:42:00.493009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e35341fa0>]}
[0m07:42:00.539461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e34788ce0>]}
[0m07:42:00.541082 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:42:00.627661 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:42:01.072537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:42:01.073903 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://tests/rsi_test.sql
[0m07:42:01.075380 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m07:42:01.416581 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:42:01.417729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2e1d8ad0>]}
[0m07:42:01.588787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2e0da7e0>]}
[0m07:42:01.774638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2dfa82f0>]}
[0m07:42:01.775816 [info ] [MainThread]: Found 7 models, 12 data tests, 3 sources, 459 macros
[0m07:42:01.776690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2df5a420>]}
[0m07:42:01.779598 [info ] [MainThread]: 
[0m07:42:01.780796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:42:01.785926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m07:42:01.800593 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m07:42:01.801932 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m07:42:01.803331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:02.457145 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.654 seconds
[0m07:42:02.460493 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m07:42:02.618058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m07:42:02.627947 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:42:02.629088 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:42:02.629950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:03.097316 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.467 seconds
[0m07:42:03.099891 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:42:03.281086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2ddfe0c0>]}
[0m07:42:03.282899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:03.284145 [info ] [MainThread]: 
[0m07:42:03.295817 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m07:42:03.297311 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m07:42:03.298606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m07:42:03.299818 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m07:42:03.308594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:42:03.335182 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m07:42:03.368673 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:42:03.391651 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m07:42:03.392800 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (WITH actual AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,
    CAST(actual AS FLOAT) AS actual_close
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE actual IS NOT NULL
),

forecast AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS forecast_date,
    CAST(forecast AS FLOAT) AS predicted_close,
    CAST(lower_bound AS FLOAT) AS lower_bound,
    CAST(upper_bound AS FLOAT) AS upper_bound
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE forecast IS NOT NULL
)

SELECT
  f.symbol,
  f.forecast_date,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close,
  
  -- Composite primary key
  CONCAT(f.symbol, '_', f.forecast_date) AS forecast_id

FROM forecast f
LEFT JOIN actual a
  ON f.symbol = a.symbol
 AND f.forecast_date = a.trade_date

ORDER BY f.symbol, f.forecast_date
        );
[0m07:42:03.394037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:05.100948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.707 seconds
[0m07:42:05.127215 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m07:42:05.297225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3466a750>]}
[0m07:42:05.298601 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 2.00s]
[0m07:42:05.300038 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m07:42:05.301073 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m07:42:05.302171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m07:42:05.303347 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m07:42:05.307340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m07:42:05.332860 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m07:42:05.333971 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m07:42:05.335203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m07:42:05.336247 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m07:42:05.340001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m07:42:05.365677 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m07:42:05.366994 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m07:42:05.368034 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m07:42:05.369053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m07:42:05.370167 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m07:42:05.374252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m07:42:05.397783 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m07:42:05.401650 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m07:42:05.424897 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m07:42:05.426137 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:42:05.427281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:06.564718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m07:42:06.567972 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m07:42:06.715294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2d429070>]}
[0m07:42:06.717399 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.35s]
[0m07:42:06.719438 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m07:42:06.720848 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m07:42:06.722425 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m07:42:06.723919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m07:42:06.725141 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m07:42:06.728784 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m07:42:06.751592 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m07:42:06.756971 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m07:42:06.776520 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m07:42:06.777421 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:42:06.778156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:07.963917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.186 seconds
[0m07:42:07.967254 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m07:42:08.137747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2d467c80>]}
[0m07:42:08.139084 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.41s]
[0m07:42:08.140179 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m07:42:08.141075 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m07:42:08.142367 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m07:42:08.143531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m07:42:08.144343 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m07:42:08.157134 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m07:42:08.185781 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m07:42:08.191095 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m07:42:08.216285 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m07:42:08.217312 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m07:42:08.218415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:09.171660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.953 seconds
[0m07:42:09.174939 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m07:42:09.330879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2d483d70>]}
[0m07:42:09.332195 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.19s]
[0m07:42:09.333606 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m07:42:09.334608 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m07:42:09.335512 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m07:42:09.336678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m07:42:09.337692 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m07:42:09.436857 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m07:42:09.472893 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m07:42:09.476821 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m07:42:09.504046 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m07:42:09.505160 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m07:42:09.506191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:10.457098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.951 seconds
[0m07:42:10.460681 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m07:42:10.634254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14252c1-133b-4774-b084-ba918d1f7e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2e015820>]}
[0m07:42:10.635587 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.30s]
[0m07:42:10.636869 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m07:42:10.639878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:10.640843 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m07:42:10.642184 [info ] [MainThread]: 
[0m07:42:10.643339 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m07:42:10.645111 [debug] [MainThread]: Command end result
[0m07:42:10.745685 [info ] [MainThread]: 
[0m07:42:10.746842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:42:10.747767 [info ] [MainThread]: 
[0m07:42:10.748546 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:42:10.749988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.191866, "process_user_time": 4.051246, "process_kernel_time": 2.025623, "process_mem_max_rss": "239748", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:42:10.751146 [debug] [MainThread]: Command `dbt run` succeeded at 07:42:10.750951 after 11.19 seconds
[0m07:42:10.752358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2e01d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2e01c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2e01ca10>]}
[0m07:42:10.753575 [debug] [MainThread]: Flushing usage events
[0m07:42:14.847693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a0a6c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a2943740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a0a6c230>]}


============================== 07:42:14.854492 | fe1f2f05-7513-42d7-85ce-802c084cf5e0 ==============================
[0m07:42:14.854492 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:42:14.855707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:42:15.836634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe1f2f05-7513-42d7-85ce-802c084cf5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a0a8d4f0>]}
[0m07:42:15.892888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe1f2f05-7513-42d7-85ce-802c084cf5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb36b527020>]}
[0m07:42:15.894759 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:42:15.983931 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:42:16.446380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:42:16.447602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:42:16.492729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe1f2f05-7513-42d7-85ce-802c084cf5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb37728e330>]}
[0m07:42:16.697994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe1f2f05-7513-42d7-85ce-802c084cf5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb36aa5a660>]}
[0m07:42:16.699218 [info ] [MainThread]: Found 7 models, 12 data tests, 3 sources, 459 macros
[0m07:42:16.700175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe1f2f05-7513-42d7-85ce-802c084cf5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb36ac770e0>]}
[0m07:42:16.703971 [info ] [MainThread]: 
[0m07:42:16.705290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:42:16.711649 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m07:42:16.732466 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:42:16.733644 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:42:16.734658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:17.392534 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.658 seconds
[0m07:42:17.396927 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:42:17.555658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe1f2f05-7513-42d7-85ce-802c084cf5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb36b038ef0>]}
[0m07:42:17.556985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:17.558026 [info ] [MainThread]: 
[0m07:42:17.568900 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:42:17.569989 [info ] [Thread-1 (]: 1 of 12 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m07:42:17.571340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m07:42:17.572551 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:42:17.587119 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:42:17.615873 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:42:17.635652 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:42:17.661385 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:42:17.662225 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m07:42:17.662835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:18.440904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m07:42:18.452773 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m07:42:18.620306 [info ] [Thread-1 (]: 1 of 12 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 1.05s]
[0m07:42:18.621924 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:42:18.622906 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:42:18.623788 [info ] [Thread-1 (]: 2 of 12 START test not_null_rsi_stock_id ....................................... [RUN]
[0m07:42:18.625108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m07:42:18.626027 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:42:18.632282 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:42:18.651390 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:42:18.655625 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:42:18.674822 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:42:18.675743 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m07:42:18.676474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:19.358490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m07:42:19.363848 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m07:42:19.541992 [info ] [Thread-1 (]: 2 of 12 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.92s]
[0m07:42:19.544244 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:42:19.545913 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:42:19.547409 [info ] [Thread-1 (]: 3 of 12 START test not_null_stock_stock_id ..................................... [RUN]
[0m07:42:19.548914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m07:42:19.550236 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:42:19.559343 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:42:19.581530 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:42:19.608846 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:42:19.613335 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:42:19.634436 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:42:19.635444 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m07:42:19.636467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:20.069740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m07:42:20.075194 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m07:42:20.254858 [info ] [Thread-1 (]: 3 of 12 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.71s]
[0m07:42:20.256256 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:42:20.257337 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:42:20.258333 [info ] [Thread-1 (]: 4 of 12 START test not_null_stock_symbol ....................................... [RUN]
[0m07:42:20.259341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m07:42:20.260233 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:42:20.266697 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:42:20.288032 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:42:20.291756 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:42:20.315043 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:42:20.316107 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m07:42:20.317145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:20.733279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m07:42:20.735925 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m07:42:20.883531 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.62s]
[0m07:42:20.884853 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:42:20.886080 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:42:20.887068 [info ] [Thread-1 (]: 5 of 12 START test not_null_stock_trade_date ................................... [RUN]
[0m07:42:20.888093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m07:42:20.889135 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:42:20.895497 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:42:20.922346 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:42:20.927250 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:42:20.957768 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:42:20.959104 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m07:42:20.960263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:21.370539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m07:42:21.377114 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m07:42:21.550871 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.66s]
[0m07:42:21.553510 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:42:21.555298 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:42:21.557077 [info ] [Thread-1 (]: 6 of 12 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m07:42:21.558864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m07:42:21.560295 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:42:21.577082 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:42:21.604068 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:42:21.608607 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:42:21.632789 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:42:21.634193 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:42:21.635502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:22.362336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m07:42:22.365603 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m07:42:22.530391 [info ] [Thread-1 (]: 6 of 12 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.97s]
[0m07:42:22.532693 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:42:22.534743 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:42:22.536680 [info ] [Thread-1 (]: 7 of 12 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m07:42:22.538722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m07:42:22.540725 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:42:22.553032 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:42:22.592964 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:42:22.599697 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:42:22.632540 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:42:22.634205 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:42:22.636241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:23.376432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m07:42:23.379414 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m07:42:23.547095 [info ] [Thread-1 (]: 7 of 12 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 1.01s]
[0m07:42:23.548903 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:42:23.550296 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.rsi_test
[0m07:42:23.551359 [info ] [Thread-1 (]: 8 of 12 START test rsi_test .................................................... [RUN]
[0m07:42:23.552774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.rsi_test)
[0m07:42:23.554105 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.rsi_test
[0m07:42:23.557634 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.rsi_test"
[0m07:42:23.586383 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.rsi_test
[0m07:42:23.591026 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.rsi_test"
[0m07:42:23.616279 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.rsi_test"
[0m07:42:23.617155 [debug] [Thread-1 (]: On test.dbt_stock_project.rsi_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.rsi_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/rsi_14d_range_test.sql
SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi
WHERE rsi_14d < 0 OR rsi_14d > 100
      
    ) dbt_internal_test
[0m07:42:23.618264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:24.116678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m07:42:24.120214 [debug] [Thread-1 (]: On test.dbt_stock_project.rsi_test: Close
[0m07:42:24.297270 [info ] [Thread-1 (]: 8 of 12 PASS rsi_test .......................................................... [[32mPASS[0m in 0.74s]
[0m07:42:24.298831 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.rsi_test
[0m07:42:24.300183 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.rsi_test.df68c6f202
[0m07:42:24.302200 [info ] [Thread-1 (]: 9 of 12 START test rsi_test .................................................... [RUN]
[0m07:42:24.303950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.rsi_test, now test.dbt_stock_project.rsi_test.df68c6f202)
[0m07:42:24.305556 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.rsi_test.df68c6f202
[0m07:42:24.313516 [debug] [Thread-1 (]: Compilation Error in test rsi_test (models/output/schema.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:42:24.314638 [error] [Thread-1 (]: 9 of 12 ERROR rsi_test ......................................................... [[31mERROR[0m in 0.01s]
[0m07:42:24.315866 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.rsi_test.df68c6f202
[0m07:42:24.316893 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:42:24.318336 [info ] [Thread-1 (]: 10 of 12 START test unique_moving_averages_stock_id ............................ [RUN]
[0m07:42:24.319689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.rsi_test.df68c6f202, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m07:42:24.320849 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:42:24.328509 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:42:24.357481 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:42:24.364041 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:42:24.395709 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:42:24.396789 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:42:24.397890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:24.828612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m07:42:24.832296 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m07:42:25.011997 [info ] [Thread-1 (]: 10 of 12 PASS unique_moving_averages_stock_id .................................. [[32mPASS[0m in 0.69s]
[0m07:42:25.014496 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:42:25.016079 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:42:25.017050 [info ] [Thread-1 (]: 11 of 12 START test unique_rsi_stock_id ........................................ [RUN]
[0m07:42:25.018198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m07:42:25.019100 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:42:25.024757 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:42:25.060498 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:42:25.067040 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:42:25.099483 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:42:25.101076 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:42:25.102362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:25.576522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m07:42:25.580177 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m07:42:25.733739 [info ] [Thread-1 (]: 11 of 12 PASS unique_rsi_stock_id .............................................. [[32mPASS[0m in 0.72s]
[0m07:42:25.734983 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:42:25.736005 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:42:25.736839 [info ] [Thread-1 (]: 12 of 12 START test unique_stock_stock_id ...................................... [RUN]
[0m07:42:25.737987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m07:42:25.739187 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:42:25.746232 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:42:25.771462 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:42:25.775162 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:42:25.806532 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:42:25.807606 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:42:25.808529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:26.256331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m07:42:26.261742 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m07:42:26.489366 [info ] [Thread-1 (]: 12 of 12 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.75s]
[0m07:42:26.491059 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:42:26.493300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:26.494076 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m07:42:26.495001 [info ] [MainThread]: 
[0m07:42:26.496138 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 9.79 seconds (9.79s).
[0m07:42:26.498371 [debug] [MainThread]: Command end result
[0m07:42:26.628660 [info ] [MainThread]: 
[0m07:42:26.629836 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:42:26.630724 [info ] [MainThread]: 
[0m07:42:26.631569 [error] [MainThread]:   Compilation Error in test rsi_test (models/output/schema.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:42:26.632436 [info ] [MainThread]: 
[0m07:42:26.633408 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m07:42:26.634984 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 11.869304, "process_user_time": 4.185588, "process_kernel_time": 1.919625, "process_mem_max_rss": "234476", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:42:26.636012 [debug] [MainThread]: Command `dbt test` failed at 07:42:26.635867 after 11.87 seconds
[0m07:42:26.637081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a1e4ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb36b2c68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a2735850>]}
[0m07:42:26.638110 [debug] [MainThread]: Flushing usage events
[0m07:43:41.679712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14f1c9e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14f0198470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14f019b8c0>]}


============================== 07:43:41.686183 | d3ad6712-d472-4c06-b6c4-ed61bad30ab0 ==============================
[0m07:43:41.686183 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:43:41.687255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:42.637219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14f0e3e6c0>]}
[0m07:43:42.693623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ba8449e0>]}
[0m07:43:42.695457 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:43:42.783447 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:43:43.250620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:43:43.252057 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://tests/rsi_test.sql
[0m07:43:43.460713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ba1b02f0>]}
[0m07:43:43.647477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b9dc2b40>]}
[0m07:43:43.648619 [info ] [MainThread]: Found 7 models, 12 data tests, 3 sources, 459 macros
[0m07:43:43.649681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ba1d5850>]}
[0m07:43:43.652361 [info ] [MainThread]: 
[0m07:43:43.653681 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:43:43.658584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m07:43:43.670690 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m07:43:43.672046 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m07:43:43.673240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:44.301396 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.628 seconds
[0m07:43:44.305403 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m07:43:44.455271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m07:43:44.465162 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:43:44.466436 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:43:44.467827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:44.941612 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.474 seconds
[0m07:43:44.945684 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:43:45.115264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b9c7a870>]}
[0m07:43:45.116799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:45.117821 [info ] [MainThread]: 
[0m07:43:45.127062 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m07:43:45.128491 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m07:43:45.129871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m07:43:45.130981 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m07:43:45.139078 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:43:45.174541 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m07:43:45.209942 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:43:45.237429 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m07:43:45.238653 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (WITH actual AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,
    CAST(actual AS FLOAT) AS actual_close
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE actual IS NOT NULL
),

forecast AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS forecast_date,
    CAST(forecast AS FLOAT) AS predicted_close,
    CAST(lower_bound AS FLOAT) AS lower_bound,
    CAST(upper_bound AS FLOAT) AS upper_bound
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE forecast IS NOT NULL
)

SELECT
  f.symbol,
  f.forecast_date,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close,
  
  -- Composite primary key
  CONCAT(f.symbol, '_', f.forecast_date) AS forecast_id

FROM forecast f
LEFT JOIN actual a
  ON f.symbol = a.symbol
 AND f.forecast_date = a.trade_date

ORDER BY f.symbol, f.forecast_date
        );
[0m07:43:45.240018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:46.197987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.958 seconds
[0m07:43:46.223040 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m07:43:46.684833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ba32e570>]}
[0m07:43:46.686770 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 1.55s]
[0m07:43:46.688528 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m07:43:46.689942 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m07:43:46.691196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m07:43:46.692448 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m07:43:46.697940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m07:43:46.725149 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m07:43:46.726207 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m07:43:46.727392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m07:43:46.728509 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m07:43:46.732334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m07:43:46.755961 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m07:43:46.757000 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m07:43:46.758015 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m07:43:46.758988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m07:43:46.759808 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m07:43:46.763314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m07:43:46.785508 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m07:43:46.789501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m07:43:46.812524 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m07:43:46.813581 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:43:46.814421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:47.745518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m07:43:47.748571 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m07:43:47.982829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b912f860>]}
[0m07:43:47.984721 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.22s]
[0m07:43:47.986569 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m07:43:47.987881 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m07:43:47.989527 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m07:43:47.990859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m07:43:47.992176 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m07:43:47.996463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m07:43:48.025417 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m07:43:48.028996 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m07:43:48.051824 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m07:43:48.052838 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:43:48.054194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:48.997240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.943 seconds
[0m07:43:49.000229 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m07:43:49.159148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b9117ad0>]}
[0m07:43:49.160358 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.17s]
[0m07:43:49.161402 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m07:43:49.162073 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m07:43:49.162995 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m07:43:49.163771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m07:43:49.164419 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m07:43:49.177505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m07:43:49.198756 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m07:43:49.203129 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m07:43:49.222859 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m07:43:49.223909 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m07:43:49.224783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:50.205028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m07:43:50.207882 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m07:43:50.359319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14f142b7d0>]}
[0m07:43:50.360656 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.20s]
[0m07:43:50.361830 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m07:43:50.362864 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m07:43:50.363887 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m07:43:50.364902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m07:43:50.365672 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m07:43:50.383673 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m07:43:50.405670 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m07:43:50.411359 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m07:43:50.428290 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m07:43:50.429472 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m07:43:50.430912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:51.378393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.948 seconds
[0m07:43:51.381742 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m07:43:51.537566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3ad6712-d472-4c06-b6c4-ed61bad30ab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b9141f70>]}
[0m07:43:51.539691 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.17s]
[0m07:43:51.541185 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m07:43:51.544265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:51.545303 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m07:43:51.546313 [info ] [MainThread]: 
[0m07:43:51.547322 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m07:43:51.549053 [debug] [MainThread]: Command end result
[0m07:43:51.673205 [info ] [MainThread]: 
[0m07:43:51.674295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:51.675219 [info ] [MainThread]: 
[0m07:43:51.676168 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:43:51.677672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.088037, "process_user_time": 3.94113, "process_kernel_time": 1.809702, "process_mem_max_rss": "235736", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:43:51.678838 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:51.678711 after 10.09 seconds
[0m07:43:51.679803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14eff77470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14ba1d55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14f1463350>]}
[0m07:43:51.680987 [debug] [MainThread]: Flushing usage events
[0m07:43:55.960170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc8d57ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc98e52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc8d55100>]}


============================== 07:43:55.967479 | abeb8269-9771-4e33-bbaf-428132de0110 ==============================
[0m07:43:55.967479 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:43:55.968843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m07:43:56.911588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abeb8269-9771-4e33-bbaf-428132de0110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf93370500>]}
[0m07:43:56.957504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abeb8269-9771-4e33-bbaf-428132de0110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf992e84a0>]}
[0m07:43:56.959077 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:43:57.043922 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:43:57.534382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:57.535726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:57.587301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abeb8269-9771-4e33-bbaf-428132de0110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf93313800>]}
[0m07:43:57.813273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abeb8269-9771-4e33-bbaf-428132de0110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf92d52ae0>]}
[0m07:43:57.814383 [info ] [MainThread]: Found 7 models, 12 data tests, 3 sources, 459 macros
[0m07:43:57.815550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abeb8269-9771-4e33-bbaf-428132de0110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf939e1df0>]}
[0m07:43:57.818726 [info ] [MainThread]: 
[0m07:43:57.820101 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:43:57.826654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m07:43:57.847011 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:43:57.848228 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:43:57.849188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:58.532832 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.684 seconds
[0m07:43:58.536210 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:43:58.735776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abeb8269-9771-4e33-bbaf-428132de0110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf92f97350>]}
[0m07:43:58.737610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:58.738803 [info ] [MainThread]: 
[0m07:43:58.752116 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:43:58.753398 [info ] [Thread-1 (]: 1 of 12 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m07:43:58.754807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m07:43:58.756048 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:43:58.777902 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:43:58.797203 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:43:58.821040 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:43:58.843425 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:43:58.844488 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m07:43:58.845317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:59.541371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m07:43:59.552723 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m07:43:59.728037 [info ] [Thread-1 (]: 1 of 12 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.97s]
[0m07:43:59.729985 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:43:59.731483 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:43:59.732681 [info ] [Thread-1 (]: 2 of 12 START test not_null_rsi_stock_id ....................................... [RUN]
[0m07:43:59.733974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m07:43:59.735212 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:43:59.740472 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:43:59.779902 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:43:59.783462 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:43:59.805822 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:43:59.806852 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m07:43:59.807667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:00.330954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m07:44:00.335002 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m07:44:00.510850 [info ] [Thread-1 (]: 2 of 12 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.78s]
[0m07:44:00.512654 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:44:00.513818 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:44:00.514769 [info ] [Thread-1 (]: 3 of 12 START test not_null_stock_stock_id ..................................... [RUN]
[0m07:44:00.515800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m07:44:00.516707 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:44:00.524472 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:44:00.557521 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:44:00.580866 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:44:00.584925 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:44:00.602430 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:44:00.603436 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m07:44:00.604568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:01.010809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m07:44:01.013934 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m07:44:01.182780 [info ] [Thread-1 (]: 3 of 12 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.67s]
[0m07:44:01.184356 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:44:01.185372 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:44:01.186474 [info ] [Thread-1 (]: 4 of 12 START test not_null_stock_symbol ....................................... [RUN]
[0m07:44:01.187705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m07:44:01.188665 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:44:01.194289 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:44:01.218302 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:44:01.222102 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:44:01.246687 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:44:01.247866 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m07:44:01.248986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:01.679093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m07:44:01.681573 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m07:44:01.846903 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.66s]
[0m07:44:01.848364 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:44:01.849473 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:44:01.850576 [info ] [Thread-1 (]: 5 of 12 START test not_null_stock_trade_date ................................... [RUN]
[0m07:44:01.851818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m07:44:01.852753 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:44:01.859515 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:44:01.884715 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:44:01.890576 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:44:01.916474 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:44:01.918289 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m07:44:01.919551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:02.343880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m07:44:02.347908 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m07:44:02.543642 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.69s]
[0m07:44:02.544969 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:44:02.546034 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:44:02.547102 [info ] [Thread-1 (]: 6 of 12 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m07:44:02.548073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m07:44:02.548948 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:44:02.561064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:44:02.587297 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:44:02.590901 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:44:02.617498 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:44:02.618672 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:44:02.619494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:03.397678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m07:44:03.400265 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m07:44:03.580440 [info ] [Thread-1 (]: 6 of 12 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 1.03s]
[0m07:44:03.581767 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:44:03.582585 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:44:03.583532 [info ] [Thread-1 (]: 7 of 12 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m07:44:03.584483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m07:44:03.585477 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:44:03.595089 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:44:03.622254 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:44:03.626479 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:44:03.653466 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:44:03.654422 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:44:03.655546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:04.336429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m07:44:04.341509 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m07:44:04.513262 [info ] [Thread-1 (]: 7 of 12 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.93s]
[0m07:44:04.515145 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:44:04.516433 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.rsi_test
[0m07:44:04.517424 [info ] [Thread-1 (]: 8 of 12 START test rsi_test .................................................... [RUN]
[0m07:44:04.518353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.rsi_test)
[0m07:44:04.519137 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.rsi_test
[0m07:44:04.522572 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.rsi_test"
[0m07:44:04.544405 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.rsi_test
[0m07:44:04.548204 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.rsi_test"
[0m07:44:04.576873 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.rsi_test"
[0m07:44:04.578209 [debug] [Thread-1 (]: On test.dbt_stock_project.rsi_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.rsi_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/rsi_14d_range_test.sql
SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi
WHERE rsi_14d <= 0 OR rsi_14d >= 100
      
    ) dbt_internal_test
[0m07:44:04.579141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:05.027701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m07:44:05.032084 [debug] [Thread-1 (]: On test.dbt_stock_project.rsi_test: Close
[0m07:44:05.191451 [error] [Thread-1 (]: 8 of 12 FAIL 18 rsi_test ....................................................... [[31mFAIL 18[0m in 0.67s]
[0m07:44:05.193341 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.rsi_test
[0m07:44:05.194344 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.rsi_test.df68c6f202
[0m07:44:05.195334 [info ] [Thread-1 (]: 9 of 12 START test rsi_test .................................................... [RUN]
[0m07:44:05.196431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.rsi_test, now test.dbt_stock_project.rsi_test.df68c6f202)
[0m07:44:05.197288 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.rsi_test.df68c6f202
[0m07:44:05.204131 [debug] [Thread-1 (]: Compilation Error in test rsi_test (models/output/schema.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:44:05.205445 [error] [Thread-1 (]: 9 of 12 ERROR rsi_test ......................................................... [[31mERROR[0m in 0.01s]
[0m07:44:05.206774 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.rsi_test.df68c6f202
[0m07:44:05.207794 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:44:05.209003 [info ] [Thread-1 (]: 10 of 12 START test unique_moving_averages_stock_id ............................ [RUN]
[0m07:44:05.210268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.rsi_test.df68c6f202, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m07:44:05.211338 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:44:05.217498 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:44:05.250246 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:44:05.253811 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:44:05.280468 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:44:05.281553 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:44:05.282678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:05.835685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m07:44:05.840526 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m07:44:05.997069 [info ] [Thread-1 (]: 10 of 12 PASS unique_moving_averages_stock_id .................................. [[32mPASS[0m in 0.79s]
[0m07:44:05.999384 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:44:06.000907 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:44:06.002120 [info ] [Thread-1 (]: 11 of 12 START test unique_rsi_stock_id ........................................ [RUN]
[0m07:44:06.003562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m07:44:06.004508 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:44:06.009841 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:44:06.040351 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:44:06.044282 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:44:06.069052 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:44:06.070334 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:44:06.071450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:06.574747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m07:44:06.577953 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m07:44:06.752889 [info ] [Thread-1 (]: 11 of 12 PASS unique_rsi_stock_id .............................................. [[32mPASS[0m in 0.75s]
[0m07:44:06.754293 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:44:06.755152 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:44:06.756064 [info ] [Thread-1 (]: 12 of 12 START test unique_stock_stock_id ...................................... [RUN]
[0m07:44:06.757087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m07:44:06.757953 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:44:06.765031 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:44:06.794729 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:44:06.798581 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:44:06.820974 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:44:06.822182 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:44:06.823362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:07.242829 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m07:44:07.246815 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m07:44:07.408944 [info ] [Thread-1 (]: 12 of 12 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.65s]
[0m07:44:07.410781 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:44:07.413493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:07.414491 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m07:44:07.415426 [info ] [MainThread]: 
[0m07:44:07.416578 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 9.60 seconds (9.60s).
[0m07:44:07.419502 [debug] [MainThread]: Command end result
[0m07:44:07.535052 [info ] [MainThread]: 
[0m07:44:07.536800 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:44:07.537931 [info ] [MainThread]: 
[0m07:44:07.539089 [error] [MainThread]: [31mFailure in test rsi_test (tests/rsi_test.sql)[0m
[0m07:44:07.540224 [error] [MainThread]:   Got 18 results, configured to fail if != 0
[0m07:44:07.541232 [info ] [MainThread]: 
[0m07:44:07.542178 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/tests/rsi_test.sql
[0m07:44:07.543053 [info ] [MainThread]: 
[0m07:44:07.544066 [error] [MainThread]:   Compilation Error in test rsi_test (models/output/schema.yml)
  'test_custom' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:44:07.545073 [info ] [MainThread]: 
[0m07:44:07.546015 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m07:44:07.547602 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 11.685724, "process_user_time": 4.245239, "process_kernel_time": 1.893416, "process_mem_max_rss": "235380", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:44:07.548779 [debug] [MainThread]: Command `dbt test` failed at 07:44:07.548555 after 11.69 seconds
[0m07:44:07.549722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfcce61d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc942ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc9119ca0>]}
[0m07:44:07.550871 [debug] [MainThread]: Flushing usage events
[0m07:57:03.893634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e033bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3df70b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3df709b80>]}


============================== 07:57:03.902282 | 4e5abcab-f632-443e-b870-ecac098640e2 ==============================
[0m07:57:03.902282 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:57:03.903764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:57:05.502596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3df474620>]}
[0m07:57:05.550945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3df4ba1b0>]}
[0m07:57:05.553628 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:57:05.643020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:57:06.068565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:57:06.069972 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m07:57:06.271957 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:57:06.273242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ac1175f0>]}
[0m07:57:06.460393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ac1a7440>]}
[0m07:57:06.685166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a6fdea20>]}
[0m07:57:06.686881 [info ] [MainThread]: Found 7 models, 11 data tests, 3 sources, 459 macros
[0m07:57:06.688023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ad8dc980>]}
[0m07:57:06.690939 [info ] [MainThread]: 
[0m07:57:06.691983 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:57:06.696447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m07:57:06.712083 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m07:57:06.713376 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m07:57:06.714651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:57:07.367548 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.653 seconds
[0m07:57:07.370051 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m07:57:07.558479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m07:57:07.569254 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:57:07.570461 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:57:07.571522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:57:08.038253 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.467 seconds
[0m07:57:08.040982 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:57:08.209357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ac1a7da0>]}
[0m07:57:08.210438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:57:08.211523 [info ] [MainThread]: 
[0m07:57:08.223568 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m07:57:08.224864 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m07:57:08.226239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m07:57:08.227215 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m07:57:08.236233 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:57:08.260316 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m07:57:08.290228 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:57:08.320369 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m07:57:08.321576 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (WITH actual AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,
    CAST(actual AS FLOAT) AS actual_close
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE actual IS NOT NULL
),

forecast AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS forecast_date,
    CAST(forecast AS FLOAT) AS predicted_close,
    CAST(lower_bound AS FLOAT) AS lower_bound,
    CAST(upper_bound AS FLOAT) AS upper_bound
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE forecast IS NOT NULL
)

SELECT
  f.symbol,
  f.forecast_date,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close,
  
  -- Composite primary key
  CONCAT(f.symbol, '_', f.forecast_date) AS forecast_id

FROM forecast f
LEFT JOIN actual a
  ON f.symbol = a.symbol
 AND f.forecast_date = a.trade_date

ORDER BY f.symbol, f.forecast_date
        );
[0m07:57:08.322751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:09.856905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.534 seconds
[0m07:57:09.881377 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m07:57:10.034370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ad7e24e0>]}
[0m07:57:10.036176 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 1.81s]
[0m07:57:10.037655 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m07:57:10.038570 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m07:57:10.039639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m07:57:10.040590 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m07:57:10.044288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m07:57:10.064218 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m07:57:10.065239 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m07:57:10.066324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m07:57:10.067303 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m07:57:10.071310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m07:57:10.097516 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m07:57:10.098599 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m07:57:10.099761 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m07:57:10.100767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m07:57:10.101735 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m07:57:10.106118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m07:57:10.119958 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m07:57:10.123662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m07:57:10.136350 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m07:57:10.137483 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:57:10.138391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:11.367247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.229 seconds
[0m07:57:11.371160 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m07:57:11.523628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a64c7ef0>]}
[0m07:57:11.524821 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.42s]
[0m07:57:11.525856 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m07:57:11.526579 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m07:57:11.527394 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m07:57:11.528241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m07:57:11.528859 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m07:57:11.532203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m07:57:11.545347 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m07:57:11.548587 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m07:57:11.559824 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m07:57:11.560793 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:57:11.561726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:12.810918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.249 seconds
[0m07:57:12.813967 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m07:57:12.984221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a64e5f10>]}
[0m07:57:12.985792 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.46s]
[0m07:57:12.987012 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m07:57:12.987883 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m07:57:12.989041 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m07:57:12.990007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m07:57:12.990725 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m07:57:13.003717 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m07:57:13.023726 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m07:57:13.027749 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m07:57:13.043124 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m07:57:13.044117 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m07:57:13.045047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:14.090764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.046 seconds
[0m07:57:14.093246 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m07:57:14.232207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e08f7da0>]}
[0m07:57:14.233455 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.24s]
[0m07:57:14.234956 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m07:57:14.236003 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m07:57:14.236927 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m07:57:14.237721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m07:57:14.238316 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m07:57:14.254629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m07:57:14.273417 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m07:57:14.276770 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m07:57:14.291211 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m07:57:14.292237 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m07:57:14.293045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:15.251321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.958 seconds
[0m07:57:15.256230 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m07:57:15.430560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e5abcab-f632-443e-b870-ecac098640e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a64e5970>]}
[0m07:57:15.432391 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.19s]
[0m07:57:15.434052 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m07:57:15.437668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:57:15.438658 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m07:57:15.439564 [info ] [MainThread]: 
[0m07:57:15.440658 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.75 seconds (8.75s).
[0m07:57:15.442425 [debug] [MainThread]: Command end result
[0m07:57:15.612640 [info ] [MainThread]: 
[0m07:57:15.613975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:57:15.615030 [info ] [MainThread]: 
[0m07:57:15.615930 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:57:15.618618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.817169, "process_user_time": 4.126345, "process_kernel_time": 2.196649, "process_mem_max_rss": "250988", "process_in_blocks": "128608", "process_out_blocks": "8"}
[0m07:57:15.620661 [debug] [MainThread]: Command `dbt run` succeeded at 07:57:15.620432 after 11.82 seconds
[0m07:57:15.621771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3df654ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3af07d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3adaa28d0>]}
[0m07:57:15.623767 [debug] [MainThread]: Flushing usage events
[0m07:57:18.927163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2731019d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2731895fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27318951f0>]}


============================== 07:57:18.934542 | e8b7fe56-bee7-4192-9f96-f388e592f419 ==============================
[0m07:57:18.934542 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:57:18.936268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:57:19.986796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8b7fe56-bee7-4192-9f96-f388e592f419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27323769c0>]}
[0m07:57:20.033140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8b7fe56-bee7-4192-9f96-f388e592f419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fb2bd4f0>]}
[0m07:57:20.034714 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:57:20.113805 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:57:20.486499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:57:20.487187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:57:20.533848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8b7fe56-bee7-4192-9f96-f388e592f419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26faf1c230>]}
[0m07:57:20.747429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8b7fe56-bee7-4192-9f96-f388e592f419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26faa06750>]}
[0m07:57:20.748780 [info ] [MainThread]: Found 7 models, 11 data tests, 3 sources, 459 macros
[0m07:57:20.749957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8b7fe56-bee7-4192-9f96-f388e592f419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fb2d8470>]}
[0m07:57:20.753600 [info ] [MainThread]: 
[0m07:57:20.755144 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:57:20.760617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m07:57:20.776490 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:57:20.777687 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:57:20.778790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:57:21.414875 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.636 seconds
[0m07:57:21.417300 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:57:21.571730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8b7fe56-bee7-4192-9f96-f388e592f419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fac56240>]}
[0m07:57:21.573493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:57:21.574654 [info ] [MainThread]: 
[0m07:57:21.585122 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:57:21.586289 [info ] [Thread-1 (]: 1 of 11 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m07:57:21.587877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m07:57:21.588978 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:57:21.604087 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:57:21.634208 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:57:21.652300 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:57:21.680174 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:57:21.681198 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m07:57:21.682084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:22.395027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m07:57:22.404337 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m07:57:22.562808 [info ] [Thread-1 (]: 1 of 11 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.97s]
[0m07:57:22.564632 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:57:22.565772 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:57:22.566862 [info ] [Thread-1 (]: 2 of 11 START test not_null_rsi_stock_id ....................................... [RUN]
[0m07:57:22.567982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m07:57:22.568782 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:57:22.575095 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:57:22.603214 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:57:22.607999 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:57:22.637598 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:57:22.638699 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m07:57:22.639846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:23.158770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m07:57:23.160826 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m07:57:23.316067 [info ] [Thread-1 (]: 2 of 11 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.75s]
[0m07:57:23.317475 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:57:23.318317 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:57:23.319538 [info ] [Thread-1 (]: 3 of 11 START test not_null_stock_stock_id ..................................... [RUN]
[0m07:57:23.320507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m07:57:23.321109 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:57:23.328653 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:57:23.348539 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:57:23.359324 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:57:23.362875 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:57:23.384208 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:57:23.385278 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m07:57:23.386399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:23.769990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m07:57:23.773061 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m07:57:23.928445 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.61s]
[0m07:57:23.930787 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:57:23.932017 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:57:23.933748 [info ] [Thread-1 (]: 4 of 11 START test not_null_stock_symbol ....................................... [RUN]
[0m07:57:23.935862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m07:57:23.937869 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:57:23.949758 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:57:23.981418 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:57:23.985437 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:57:24.002518 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:57:24.003518 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m07:57:24.004356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:24.455261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.451 seconds
[0m07:57:24.459577 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m07:57:24.626664 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.69s]
[0m07:57:24.628053 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:57:24.628997 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:57:24.629690 [info ] [Thread-1 (]: 5 of 11 START test not_null_stock_trade_date ................................... [RUN]
[0m07:57:24.630760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m07:57:24.631437 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:57:24.638589 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:57:24.658695 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:57:24.662425 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:57:24.682721 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:57:24.683958 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m07:57:24.685290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:25.164151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m07:57:25.169088 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m07:57:25.342614 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.71s]
[0m07:57:25.344871 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:57:25.346176 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:57:25.347309 [info ] [Thread-1 (]: 6 of 11 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m07:57:25.348519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m07:57:25.349640 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:57:25.361478 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:57:25.396509 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:57:25.400044 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:57:25.424749 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:57:25.425795 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:57:25.426797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:26.040357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m07:57:26.043155 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m07:57:26.210542 [info ] [Thread-1 (]: 6 of 11 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.86s]
[0m07:57:26.212321 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:57:26.213818 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:57:26.215209 [info ] [Thread-1 (]: 7 of 11 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m07:57:26.216602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m07:57:26.217970 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:57:26.227244 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:57:26.268378 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:57:26.273008 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:57:26.317825 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:57:26.319656 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:57:26.321382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:26.807848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m07:57:26.810521 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m07:57:27.011013 [info ] [Thread-1 (]: 7 of 11 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.79s]
[0m07:57:27.012638 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:57:27.014222 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.rsi_test
[0m07:57:27.015618 [info ] [Thread-1 (]: 8 of 11 START test rsi_test .................................................... [RUN]
[0m07:57:27.016839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.rsi_test)
[0m07:57:27.017884 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.rsi_test
[0m07:57:27.023161 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.rsi_test"
[0m07:57:27.044908 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.rsi_test
[0m07:57:27.050272 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.rsi_test"
[0m07:57:27.074159 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.rsi_test"
[0m07:57:27.075554 [debug] [Thread-1 (]: On test.dbt_stock_project.rsi_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.rsi_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/rsi_14d_range_test.sql
SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi
WHERE rsi_14d <= 0 OR rsi_14d >= 100
      
    ) dbt_internal_test
[0m07:57:27.076535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:27.525173 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m07:57:27.529962 [debug] [Thread-1 (]: On test.dbt_stock_project.rsi_test: Close
[0m07:57:27.680232 [error] [Thread-1 (]: 8 of 11 FAIL 18 rsi_test ....................................................... [[31mFAIL 18[0m in 0.66s]
[0m07:57:27.681559 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.rsi_test
[0m07:57:27.682459 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:57:27.683142 [info ] [Thread-1 (]: 9 of 11 START test unique_moving_averages_stock_id ............................. [RUN]
[0m07:57:27.683898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.rsi_test, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m07:57:27.684872 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:57:27.693656 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:57:27.713840 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:57:27.717379 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:57:27.733957 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:57:27.735109 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:57:27.736276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:28.179983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m07:57:28.186013 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m07:57:28.382730 [info ] [Thread-1 (]: 9 of 11 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.70s]
[0m07:57:28.384874 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:57:28.386567 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:57:28.388059 [info ] [Thread-1 (]: 10 of 11 START test unique_rsi_stock_id ........................................ [RUN]
[0m07:57:28.389454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m07:57:28.390515 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:57:28.396931 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:57:28.435798 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:57:28.440773 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:57:28.471144 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:57:28.472113 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:57:28.473015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:29.231447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m07:57:29.234504 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m07:57:29.387608 [info ] [Thread-1 (]: 10 of 11 PASS unique_rsi_stock_id .............................................. [[32mPASS[0m in 1.00s]
[0m07:57:29.388823 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:57:29.389711 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:57:29.390523 [info ] [Thread-1 (]: 11 of 11 START test unique_stock_stock_id ...................................... [RUN]
[0m07:57:29.391513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m07:57:29.392324 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:57:29.400852 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:57:29.413907 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:57:29.417961 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:57:29.430610 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:57:29.431397 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:57:29.432074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:29.789525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m07:57:29.791862 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m07:57:29.950181 [info ] [Thread-1 (]: 11 of 11 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.56s]
[0m07:57:29.952073 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:57:29.954977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:57:29.955968 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m07:57:29.957109 [info ] [MainThread]: 
[0m07:57:29.958164 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 9.20 seconds (9.20s).
[0m07:57:29.960994 [debug] [MainThread]: Command end result
[0m07:57:30.081853 [info ] [MainThread]: 
[0m07:57:30.083107 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:57:30.084428 [info ] [MainThread]: 
[0m07:57:30.085731 [error] [MainThread]: [31mFailure in test rsi_test (tests/rsi_test.sql)[0m
[0m07:57:30.086799 [error] [MainThread]:   Got 18 results, configured to fail if != 0
[0m07:57:30.087879 [info ] [MainThread]: 
[0m07:57:30.089207 [info ] [MainThread]:   compiled code at target/compiled/dbt_stock_project/tests/rsi_test.sql
[0m07:57:30.090232 [info ] [MainThread]: 
[0m07:57:30.091397 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m07:57:30.093389 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 11.266391, "process_user_time": 3.990665, "process_kernel_time": 1.8816, "process_mem_max_rss": "240980", "process_in_blocks": "1976", "process_out_blocks": "8", "command_success": false}
[0m07:57:30.094549 [debug] [MainThread]: Command `dbt test` failed at 07:57:30.094417 after 11.27 seconds
[0m07:57:30.095589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f273110b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27310b2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27311e0cb0>]}
[0m07:57:30.096649 [debug] [MainThread]: Flushing usage events
[0m07:58:11.365960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c926894f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c945ba750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c926252e0>]}


============================== 07:58:11.373124 | b1a1cf38-5d46-4365-9679-f94af9d608dd ==============================
[0m07:58:11.373124 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:58:11.374282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:58:12.288743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c60214a70>]}
[0m07:58:12.337730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c95b9f8c0>]}
[0m07:58:12.339516 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:58:12.422587 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:58:12.874566 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m07:58:12.875964 [debug] [MainThread]: Partial parsing: deleted file: dbt_stock_project://tests/rsi_test.sql
[0m07:58:12.977148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5bf0f6b0>]}
[0m07:58:13.168345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5becd370>]}
[0m07:58:13.169630 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m07:58:13.170566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5bf1ef30>]}
[0m07:58:13.173391 [info ] [MainThread]: 
[0m07:58:13.174813 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:58:13.180029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m07:58:13.196661 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m07:58:13.197683 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m07:58:13.198625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:58:13.842372 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.644 seconds
[0m07:58:13.844721 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m07:58:14.020542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m07:58:14.029840 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:58:14.030929 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:58:14.031874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:58:14.501010 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.469 seconds
[0m07:58:14.504011 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:58:14.676701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5bc814f0>]}
[0m07:58:14.678028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:58:14.678976 [info ] [MainThread]: 
[0m07:58:14.687814 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m07:58:14.689422 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m07:58:14.690805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m07:58:14.692002 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m07:58:14.701010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:58:14.733826 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m07:58:14.765353 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m07:58:14.798557 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m07:58:14.799875 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (WITH actual AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,
    CAST(actual AS FLOAT) AS actual_close
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE actual IS NOT NULL
),

forecast AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS forecast_date,
    CAST(forecast AS FLOAT) AS predicted_close,
    CAST(lower_bound AS FLOAT) AS lower_bound,
    CAST(upper_bound AS FLOAT) AS upper_bound
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE forecast IS NOT NULL
)

SELECT
  f.symbol,
  f.forecast_date,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close,
  
  -- Composite primary key
  CONCAT(f.symbol, '_', f.forecast_date) AS forecast_id

FROM forecast f
LEFT JOIN actual a
  ON f.symbol = a.symbol
 AND f.forecast_date = a.trade_date

ORDER BY f.symbol, f.forecast_date
        );
[0m07:58:14.801022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:16.023440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.222 seconds
[0m07:58:16.045902 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m07:58:16.205645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c92689b50>]}
[0m07:58:16.207183 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 1.51s]
[0m07:58:16.208840 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m07:58:16.210276 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m07:58:16.211349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m07:58:16.212276 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m07:58:16.216134 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m07:58:16.230916 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m07:58:16.231805 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m07:58:16.232989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m07:58:16.234021 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m07:58:16.237872 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m07:58:16.253774 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m07:58:16.254756 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m07:58:16.256020 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m07:58:16.257039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m07:58:16.258006 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m07:58:16.262210 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m07:58:16.280248 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m07:58:16.284225 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m07:58:16.299161 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m07:58:16.299978 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:58:16.300821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:17.340669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.040 seconds
[0m07:58:17.343732 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m07:58:17.503120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5b20ede0>]}
[0m07:58:17.504858 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.25s]
[0m07:58:17.506626 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m07:58:17.507786 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m07:58:17.508855 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m07:58:17.509733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m07:58:17.510444 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m07:58:17.514623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m07:58:17.529127 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m07:58:17.533130 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m07:58:17.547939 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m07:58:17.548787 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m07:58:17.549384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:18.468469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.919 seconds
[0m07:58:18.471121 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m07:58:18.631715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5b2d3bf0>]}
[0m07:58:18.632989 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.12s]
[0m07:58:18.634154 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m07:58:18.635121 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m07:58:18.635940 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m07:58:18.636736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m07:58:18.637526 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m07:58:18.650047 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m07:58:18.670460 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m07:58:18.674320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m07:58:18.689541 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m07:58:18.690489 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m07:58:18.691197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:19.753579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.062 seconds
[0m07:58:19.758478 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m07:58:19.922859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9335ba10>]}
[0m07:58:19.924252 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.29s]
[0m07:58:19.925653 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m07:58:19.926676 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m07:58:19.927989 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m07:58:19.928925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m07:58:19.929760 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m07:58:19.946481 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m07:58:19.973601 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m07:58:19.977173 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m07:58:20.003950 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m07:58:20.005295 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m07:58:20.006448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:21.058473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.052 seconds
[0m07:58:21.061134 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m07:58:21.233911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1a1cf38-5d46-4365-9679-f94af9d608dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5b3b2e70>]}
[0m07:58:21.235287 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.30s]
[0m07:58:21.236932 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m07:58:21.239126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:58:21.240034 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m07:58:21.240889 [info ] [MainThread]: 
[0m07:58:21.241677 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m07:58:21.243332 [debug] [MainThread]: Command end result
[0m07:58:21.333495 [info ] [MainThread]: 
[0m07:58:21.334408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:58:21.335203 [info ] [MainThread]: 
[0m07:58:21.336596 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:58:21.338324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.064115, "process_user_time": 3.972937, "process_kernel_time": 1.876427, "process_mem_max_rss": "234232", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:58:21.339394 [debug] [MainThread]: Command `dbt run` succeeded at 07:58:21.339221 after 10.07 seconds
[0m07:58:21.340369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9209deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9209dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5b2488f0>]}
[0m07:58:21.341204 [debug] [MainThread]: Flushing usage events
[0m07:58:24.713406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da185e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da3be1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da1ebdbe0>]}


============================== 07:58:24.720541 | e53aa448-e4c5-435d-9ece-80eeb9629425 ==============================
[0m07:58:24.720541 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:58:24.721688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:58:25.625938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e53aa448-e4c5-435d-9ece-80eeb9629425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d703836b0>]}
[0m07:58:25.674825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e53aa448-e4c5-435d-9ece-80eeb9629425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da1f6c770>]}
[0m07:58:25.676542 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:58:25.764593 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:58:26.183801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:58:26.184939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:58:26.234046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e53aa448-e4c5-435d-9ece-80eeb9629425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d6bd446b0>]}
[0m07:58:26.433717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e53aa448-e4c5-435d-9ece-80eeb9629425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d6b9f7e90>]}
[0m07:58:26.434958 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m07:58:26.435921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e53aa448-e4c5-435d-9ece-80eeb9629425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d6bd09190>]}
[0m07:58:26.438801 [info ] [MainThread]: 
[0m07:58:26.440283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:58:26.445452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m07:58:26.460416 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m07:58:26.461709 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m07:58:26.462897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:58:27.125895 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.663 seconds
[0m07:58:27.128521 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m07:58:27.336182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e53aa448-e4c5-435d-9ece-80eeb9629425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d6be5b650>]}
[0m07:58:27.337496 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:58:27.338382 [info ] [MainThread]: 
[0m07:58:27.350124 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:58:27.351272 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m07:58:27.352174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m07:58:27.353409 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:58:27.369015 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:58:27.387784 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:58:27.405895 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:58:27.425756 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m07:58:27.426626 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m07:58:27.427227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:28.110540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m07:58:28.118341 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m07:58:28.290964 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.94s]
[0m07:58:28.292361 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m07:58:28.293240 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:58:28.294060 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m07:58:28.294929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m07:58:28.295611 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:58:28.300667 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:58:28.322447 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:58:28.326703 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:58:28.339985 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m07:58:28.340953 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m07:58:28.341703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:28.826174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m07:58:28.831064 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m07:58:28.992656 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.70s]
[0m07:58:28.994669 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m07:58:28.995860 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:58:28.997013 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m07:58:28.998203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m07:58:28.999365 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:58:29.007554 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:58:29.037582 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:58:29.058862 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:58:29.063215 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:58:29.076780 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m07:58:29.077966 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m07:58:29.078857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:29.491128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m07:58:29.493748 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m07:58:29.667065 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.67s]
[0m07:58:29.668569 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m07:58:29.669635 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:58:29.670523 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m07:58:29.671425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m07:58:29.672234 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:58:29.677918 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:58:29.704919 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:58:29.708725 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:58:29.734367 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m07:58:29.735298 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m07:58:29.736037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:30.287422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m07:58:30.290287 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m07:58:30.452774 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.78s]
[0m07:58:30.455189 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m07:58:30.457050 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:58:30.458637 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m07:58:30.460471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m07:58:30.461907 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:58:30.468856 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:58:30.496229 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:58:30.499781 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:58:30.526043 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m07:58:30.527270 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m07:58:30.528225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:31.016924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m07:58:31.019591 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m07:58:31.178535 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.72s]
[0m07:58:31.179520 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m07:58:31.180312 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:58:31.180901 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m07:58:31.181580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m07:58:31.182176 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:58:31.195719 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:58:31.210187 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:58:31.213249 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:58:31.227231 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m07:58:31.228028 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:58:31.228640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:31.700220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m07:58:31.705464 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m07:58:31.897779 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.72s]
[0m07:58:31.899568 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m07:58:31.900954 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:58:31.902448 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m07:58:31.904926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m07:58:31.906193 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:58:31.914703 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:58:31.942960 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:58:31.946456 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:58:31.973450 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m07:58:31.974357 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:58:31.975182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:32.602474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m07:58:32.605195 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m07:58:32.777870 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.87s]
[0m07:58:32.779521 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m07:58:32.780558 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:58:32.781280 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m07:58:32.782036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m07:58:32.782573 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:58:32.790702 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:58:32.808216 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:58:32.811895 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:58:32.835656 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m07:58:32.836747 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:58:32.838265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:33.338272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m07:58:33.341145 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m07:58:33.498885 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.72s]
[0m07:58:33.501326 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m07:58:33.502421 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:58:33.503538 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m07:58:33.504580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m07:58:33.505424 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:58:33.510757 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:58:33.532888 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:58:33.536799 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:58:33.552416 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m07:58:33.553540 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:58:33.554349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:34.077789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m07:58:34.080966 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m07:58:34.247641 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.74s]
[0m07:58:34.248931 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m07:58:34.249713 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:58:34.250840 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m07:58:34.251961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m07:58:34.252803 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:58:34.260310 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:58:34.276352 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:58:34.281442 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:58:34.295335 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m07:58:34.296252 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:58:34.297077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:34.701782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m07:58:34.705608 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m07:58:34.879284 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.63s]
[0m07:58:34.881245 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m07:58:34.884980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:58:34.886367 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m07:58:34.887801 [info ] [MainThread]: 
[0m07:58:34.889195 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 8.45 seconds (8.45s).
[0m07:58:34.892677 [debug] [MainThread]: Command end result
[0m07:58:35.001827 [info ] [MainThread]: 
[0m07:58:35.002954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:58:35.003753 [info ] [MainThread]: 
[0m07:58:35.004575 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m07:58:35.006158 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.375702, "process_user_time": 4.012018, "process_kernel_time": 1.796426, "process_mem_max_rss": "232168", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:58:35.007397 [debug] [MainThread]: Command `dbt test` succeeded at 07:58:35.007233 after 10.38 seconds
[0m07:58:35.008298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da185e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da1ebe0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d6b9f6b70>]}
[0m07:58:35.009280 [debug] [MainThread]: Flushing usage events
[0m07:58:38.929545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9d7de060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9dae8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9d7de270>]}


============================== 07:58:38.936660 | 0c9d6f2b-0856-41f9-b05a-72a58cd33c73 ==============================
[0m07:58:38.936660 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:58:38.937736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:58:39.906734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c9d6f2b-0856-41f9-b05a-72a58cd33c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6c09b8f0>]}
[0m07:58:39.959947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c9d6f2b-0856-41f9-b05a-72a58cd33c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9d7de060>]}
[0m07:58:39.961536 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m07:58:40.062114 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:58:40.442673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:58:40.444042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:58:40.496755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c9d6f2b-0856-41f9-b05a-72a58cd33c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9d7de120>]}
[0m07:58:40.678118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c9d6f2b-0856-41f9-b05a-72a58cd33c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a67841160>]}
[0m07:58:40.678999 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m07:58:40.679823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c9d6f2b-0856-41f9-b05a-72a58cd33c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a676b52e0>]}
[0m07:58:40.681990 [info ] [MainThread]: 
[0m07:58:40.682915 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:58:40.685347 [debug] [MainThread]: Command end result
[0m07:58:40.763040 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.9130266, "process_user_time": 3.324715, "process_kernel_time": 1.97498, "process_mem_max_rss": "223880", "process_in_blocks": "280", "process_out_blocks": "0"}
[0m07:58:40.763987 [debug] [MainThread]: Command `dbt snapshot` succeeded at 07:58:40.763853 after 1.91 seconds
[0m07:58:40.764695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa16ce930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a675ab260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6c61b050>]}
[0m07:58:40.765503 [debug] [MainThread]: Flushing usage events
[0m08:01:40.578985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ab4e7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1aa802c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1abae4bf0>]}


============================== 08:01:40.584926 | adac0a57-7dc1-4d56-b352-8a976dd334bc ==============================
[0m08:01:40.584926 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:01:40.585987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m08:01:41.399401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adac0a57-7dc1-4d56-b352-8a976dd334bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff179f4f320>]}
[0m08:01:41.455829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adac0a57-7dc1-4d56-b352-8a976dd334bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17a7e22d0>]}
[0m08:01:41.457769 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:01:41.553330 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:01:41.842480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:01:41.843592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:01:41.885310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adac0a57-7dc1-4d56-b352-8a976dd334bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff178fd0950>]}
[0m08:01:42.069172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adac0a57-7dc1-4d56-b352-8a976dd334bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17823c7a0>]}
[0m08:01:42.070370 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m08:01:42.071239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adac0a57-7dc1-4d56-b352-8a976dd334bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff178890830>]}
[0m08:01:42.074139 [info ] [MainThread]: 
[0m08:01:42.075499 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:01:42.082269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m08:01:42.100488 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:01:42.101475 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:01:42.102270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:42.742542 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.640 seconds
[0m08:01:42.746865 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:01:42.914652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adac0a57-7dc1-4d56-b352-8a976dd334bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1789dda30>]}
[0m08:01:42.916794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:01:42.918205 [info ] [MainThread]: 
[0m08:01:42.928398 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:01:42.929601 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m08:01:42.930722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m08:01:42.931766 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:01:42.946827 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:01:42.979520 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:01:42.998949 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:01:43.029296 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:01:43.030201 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m08:01:43.030915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:43.435390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m08:01:43.446485 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m08:01:43.611451 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.68s]
[0m08:01:43.612752 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:01:43.613737 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:01:43.614664 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m08:01:43.615752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m08:01:43.616918 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:01:43.623369 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:01:43.644684 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:01:43.649672 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:01:43.669828 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:01:43.670942 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m08:01:43.671729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:44.141062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m08:01:44.146435 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m08:01:44.317356 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.70s]
[0m08:01:44.318974 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:01:44.320350 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:01:44.321641 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m08:01:44.323079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m08:01:44.324421 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:01:44.337669 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:01:44.352653 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:01:44.366634 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:01:44.370577 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:01:44.386560 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:01:44.387526 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m08:01:44.388343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:44.855141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m08:01:44.857693 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m08:01:45.009992 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.69s]
[0m08:01:45.011177 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:01:45.012184 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:01:45.013283 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m08:01:45.014280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m08:01:45.015139 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:01:45.020805 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:01:45.036569 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:01:45.039448 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:01:45.052911 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:01:45.053694 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m08:01:45.054220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:45.463971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m08:01:45.468548 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m08:01:45.633995 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.62s]
[0m08:01:45.635179 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:01:45.635938 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:01:45.636627 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m08:01:45.637477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m08:01:45.638110 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:01:45.644492 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:01:45.670258 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:01:45.674726 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:01:45.700082 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:01:45.701128 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m08:01:45.702234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:46.142167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m08:01:46.144750 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m08:01:46.313202 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.68s]
[0m08:01:46.314714 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:01:46.315660 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:01:46.316662 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m08:01:46.317666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m08:01:46.318521 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:01:46.331952 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:01:46.365702 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:01:46.369307 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:01:46.404680 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:01:46.406185 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:01:46.407534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:46.954008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m08:01:46.957555 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m08:01:47.115831 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.80s]
[0m08:01:47.117110 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:01:47.118080 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:01:47.119108 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m08:01:47.120294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m08:01:47.121380 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:01:47.130496 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:01:47.144088 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:01:47.147346 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:01:47.161783 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:01:47.162649 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:01:47.163329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:47.559042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m08:01:47.562848 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m08:01:47.749870 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.63s]
[0m08:01:47.751083 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:01:47.752193 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:01:47.753070 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m08:01:47.754237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m08:01:47.755028 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:01:47.763893 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:01:47.780773 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:01:47.784558 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:01:47.801235 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:01:47.802174 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:01:47.802792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:48.196693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m08:01:48.199054 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m08:01:48.366354 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.61s]
[0m08:01:48.367785 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:01:48.368976 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:01:48.370215 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m08:01:48.371226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m08:01:48.372107 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:01:48.377109 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:01:48.405532 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:01:48.409386 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:01:48.438271 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:01:48.439270 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:01:48.440078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:48.871644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m08:01:48.874391 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m08:01:49.037380 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.67s]
[0m08:01:49.038902 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:01:49.040116 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:01:49.041244 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m08:01:49.042909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m08:01:49.044183 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:01:49.050688 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:01:49.069725 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:01:49.074377 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:01:49.088093 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:01:49.088905 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:01:49.089698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:49.480100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m08:01:49.482590 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m08:01:49.645136 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.60s]
[0m08:01:49.647535 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:01:49.650984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:49.652037 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m08:01:49.653104 [info ] [MainThread]: 
[0m08:01:49.654316 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 7.58 seconds (7.58s).
[0m08:01:49.656364 [debug] [MainThread]: Command end result
[0m08:01:49.754224 [info ] [MainThread]: 
[0m08:01:49.755390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:01:49.756365 [info ] [MainThread]: 
[0m08:01:49.757498 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m08:01:49.759004 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.2698965, "process_user_time": 3.650387, "process_kernel_time": 1.949525, "process_mem_max_rss": "230620", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:01:49.760728 [debug] [MainThread]: Command `dbt test` succeeded at 08:01:49.760394 after 9.27 seconds
[0m08:01:49.762090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ab3620f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17afa9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1aaccaa80>]}
[0m08:01:49.763271 [debug] [MainThread]: Flushing usage events
[0m08:01:52.974517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00a352b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab02ce6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00a35100>]}


============================== 08:01:52.980801 | f5a2656f-71d9-447d-b3b1-be8d04ff709e ==============================
[0m08:01:52.980801 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:01:52.981895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:01:53.940188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5a2656f-71d9-447d-b3b1-be8d04ff709e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaca61b3e0>]}
[0m08:01:53.990189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5a2656f-71d9-447d-b3b1-be8d04ff709e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab002b63c0>]}
[0m08:01:53.991722 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:01:54.073905 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:01:54.586112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:01:54.587930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:01:54.635409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5a2656f-71d9-447d-b3b1-be8d04ff709e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaca6e0410>]}
[0m08:01:54.834073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5a2656f-71d9-447d-b3b1-be8d04ff709e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaca51d430>]}
[0m08:01:54.835259 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m08:01:54.836163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a2656f-71d9-447d-b3b1-be8d04ff709e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacac209b0>]}
[0m08:01:54.838599 [info ] [MainThread]: 
[0m08:01:54.839501 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:01:54.841550 [debug] [MainThread]: Command end result
[0m08:01:54.956883 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.0724208, "process_user_time": 3.169514, "process_kernel_time": 1.851399, "process_mem_max_rss": "236264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:01:54.958055 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:01:54.957890 after 2.07 seconds
[0m08:01:54.958909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab02ce6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaca641f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaca345010>]}
[0m08:01:54.959836 [debug] [MainThread]: Flushing usage events
[0m08:02:10.685967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07a6851c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07a6eecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07ba70080>]}


============================== 08:02:10.693048 | e167e5a1-b94c-48dc-8ce5-1e16866ad963 ==============================
[0m08:02:10.693048 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:02:10.694339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:02:11.547874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e167e5a1-b94c-48dc-8ce5-1e16866ad963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07b3ee7b0>]}
[0m08:02:11.597173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e167e5a1-b94c-48dc-8ce5-1e16866ad963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb048215ca0>]}
[0m08:02:11.598916 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:02:11.680265 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:02:11.983674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:02:11.984779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:02:12.035015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e167e5a1-b94c-48dc-8ce5-1e16866ad963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb043c0ff80>]}
[0m08:02:12.218830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e167e5a1-b94c-48dc-8ce5-1e16866ad963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb043a03ef0>]}
[0m08:02:12.219747 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m08:02:12.220491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e167e5a1-b94c-48dc-8ce5-1e16866ad963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb043c7fd40>]}
[0m08:02:12.223427 [info ] [MainThread]: 
[0m08:02:12.224651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:02:12.230758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m08:02:12.246830 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:02:12.248166 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:02:12.249128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:12.855437 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.606 seconds
[0m08:02:12.858913 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:02:13.028918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e167e5a1-b94c-48dc-8ce5-1e16866ad963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb043c7e630>]}
[0m08:02:13.030413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:02:13.031442 [info ] [MainThread]: 
[0m08:02:13.041971 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:02:13.043041 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m08:02:13.044157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m08:02:13.045163 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:02:13.060713 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:02:13.089670 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:02:13.109388 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:02:13.147936 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:02:13.149216 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m08:02:13.150325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:13.619054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m08:02:13.633478 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m08:02:13.800549 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.76s]
[0m08:02:13.801887 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:02:13.802864 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:02:13.803691 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m08:02:13.804643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m08:02:13.805676 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:02:13.811474 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:02:13.831417 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:02:13.836475 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:02:13.851306 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:02:13.852407 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m08:02:13.853181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:14.347007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m08:02:14.351406 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m08:02:14.530335 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.73s]
[0m08:02:14.531959 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:02:14.533277 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:02:14.534291 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m08:02:14.535552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m08:02:14.536607 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:02:14.545390 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:02:14.575151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:02:14.604712 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:02:14.609443 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:02:14.634387 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:02:14.635645 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m08:02:14.636599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:15.118041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m08:02:15.120557 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m08:02:15.285084 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.75s]
[0m08:02:15.286788 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:02:15.288223 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:02:15.289654 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m08:02:15.291095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m08:02:15.292185 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:02:15.298376 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:02:15.324895 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:02:15.328453 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:02:15.353170 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:02:15.354173 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m08:02:15.355159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:15.866949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.512 seconds
[0m08:02:15.871378 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m08:02:16.051274 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.76s]
[0m08:02:16.053238 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:02:16.054805 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:02:16.055996 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m08:02:16.057229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m08:02:16.058170 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:02:16.064635 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:02:16.092549 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:02:16.096991 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:02:16.122652 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:02:16.124145 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m08:02:16.125456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:16.513716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m08:02:16.516490 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m08:02:16.694449 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.64s]
[0m08:02:16.695735 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:02:16.696709 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:02:16.697800 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m08:02:16.699073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m08:02:16.699961 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:02:16.715498 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:02:16.737269 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:02:16.741989 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:02:16.764173 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:02:16.765319 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:02:16.766325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:17.296655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m08:02:17.301168 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m08:02:17.677471 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.98s]
[0m08:02:17.679789 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:02:17.681631 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:02:17.683430 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m08:02:17.685290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m08:02:17.687116 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:02:17.697802 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:02:17.740674 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:02:17.746637 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:02:17.786360 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:02:17.787867 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:02:17.789473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:18.395492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m08:02:18.400152 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m08:02:18.565864 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.88s]
[0m08:02:18.567141 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:02:18.568101 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:02:18.568979 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m08:02:18.569987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m08:02:18.570746 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:02:18.578863 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:02:18.598545 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:02:18.601977 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:02:18.617756 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:02:18.618491 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:02:18.619073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:19.012093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.393 seconds
[0m08:02:19.015890 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m08:02:19.226585 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.66s]
[0m08:02:19.228326 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:02:19.229814 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:02:19.231347 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m08:02:19.232958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m08:02:19.234484 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:02:19.241057 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:02:19.283312 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:02:19.288042 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:02:19.323763 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:02:19.325061 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:02:19.326305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:19.777156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.451 seconds
[0m08:02:19.780069 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m08:02:20.027545 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.79s]
[0m08:02:20.029023 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:02:20.030235 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:02:20.031444 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m08:02:20.032530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m08:02:20.033473 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:02:20.041196 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:02:20.057277 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:02:20.062197 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:02:20.075195 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:02:20.076043 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:02:20.076918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:20.549862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m08:02:20.554332 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m08:02:20.948625 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.92s]
[0m08:02:20.950557 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:02:20.953923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:20.955436 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m08:02:20.956913 [info ] [MainThread]: 
[0m08:02:20.958117 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 8.73 seconds (8.73s).
[0m08:02:20.960612 [debug] [MainThread]: Command end result
[0m08:02:21.061437 [info ] [MainThread]: 
[0m08:02:21.062770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:21.063898 [info ] [MainThread]: 
[0m08:02:21.065087 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m08:02:21.066872 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.471953, "process_user_time": 3.936914, "process_kernel_time": 1.804135, "process_mem_max_rss": "235700", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:02:21.068326 [debug] [MainThread]: Command `dbt test` succeeded at 08:02:21.068108 after 10.47 seconds
[0m08:02:21.069552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07a6eecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07ad1adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb079dfbaa0>]}
[0m08:02:21.070741 [debug] [MainThread]: Flushing usage events
[0m08:02:24.662268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f283097c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f250df290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f250dd6a0>]}


============================== 08:02:24.669307 | cf275309-d9ea-4c9c-9c23-05fa3a63adb5 ==============================
[0m08:02:24.669307 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:02:24.670649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:02:25.642686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf275309-d9ea-4c9c-9c23-05fa3a63adb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25d82750>]}
[0m08:02:25.706817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf275309-d9ea-4c9c-9c23-05fa3a63adb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f24aa6e70>]}
[0m08:02:25.708866 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:02:25.814993 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:02:26.258547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:02:26.259943 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:02:26.297781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf275309-d9ea-4c9c-9c23-05fa3a63adb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ef57b5010>]}
[0m08:02:26.491402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf275309-d9ea-4c9c-9c23-05fa3a63adb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eeecbe3f0>]}
[0m08:02:26.492767 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m08:02:26.493869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf275309-d9ea-4c9c-9c23-05fa3a63adb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eeec8b7a0>]}
[0m08:02:26.496544 [info ] [MainThread]: 
[0m08:02:26.498047 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:02:26.500494 [debug] [MainThread]: Command end result
[0m08:02:26.606778 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.0460937, "process_user_time": 3.344335, "process_kernel_time": 1.689234, "process_mem_max_rss": "221740", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:02:26.607927 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:02:26.607770 after 2.05 seconds
[0m08:02:26.608828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f24e71a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eef0c0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f24e03e00>]}
[0m08:02:26.609649 [debug] [MainThread]: Flushing usage events
[0m08:02:48.105863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3101837350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3100b495e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3100e24cb0>]}


============================== 08:02:48.112777 | c8526117-329c-4aca-8191-0a1d3e09c04f ==============================
[0m08:02:48.112777 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:02:48.113610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:02:48.968213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8526117-329c-4aca-8191-0a1d3e09c04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310079fda0>]}
[0m08:02:49.015177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8526117-329c-4aca-8191-0a1d3e09c04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31018c11c0>]}
[0m08:02:49.017020 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:02:49.099366 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:02:49.599653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:02:49.600792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:02:49.642674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8526117-329c-4aca-8191-0a1d3e09c04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30cb2a10a0>]}
[0m08:02:49.867864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8526117-329c-4aca-8191-0a1d3e09c04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ca753fb0>]}
[0m08:02:49.869327 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m08:02:49.870387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8526117-329c-4aca-8191-0a1d3e09c04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ca9ae9c0>]}
[0m08:02:49.873330 [info ] [MainThread]: 
[0m08:02:49.874712 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:02:49.879821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m08:02:49.896242 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:02:49.897829 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:02:49.899256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:50.965564 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.066 seconds
[0m08:02:50.968384 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:02:51.140227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8526117-329c-4aca-8191-0a1d3e09c04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30cb5d01d0>]}
[0m08:02:51.141677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:02:51.142702 [info ] [MainThread]: 
[0m08:02:51.154227 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:02:51.155536 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m08:02:51.156713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m08:02:51.157898 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:02:51.177826 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:02:51.202128 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:02:51.224389 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:02:51.245465 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:02:51.246364 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m08:02:51.247087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:51.810650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m08:02:51.820082 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m08:02:51.992484 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.84s]
[0m08:02:51.993914 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:02:51.994994 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:02:51.995958 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m08:02:51.996970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m08:02:51.997770 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:02:52.003095 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:02:52.028840 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:02:52.033821 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:02:52.059843 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:02:52.060900 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m08:02:52.061761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:52.624052 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m08:02:52.628191 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m08:02:52.785640 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.79s]
[0m08:02:52.787128 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:02:52.788211 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:02:52.789103 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m08:02:52.789997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m08:02:52.790733 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:02:52.798078 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:02:52.823699 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:02:52.849512 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:02:52.853880 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:02:52.878884 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:02:52.879994 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m08:02:52.880918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:53.399265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m08:02:53.402035 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m08:02:53.558338 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.77s]
[0m08:02:53.559836 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:02:53.561016 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:02:53.561877 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m08:02:53.563175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m08:02:53.564061 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:02:53.570164 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:02:53.610260 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:02:53.615886 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:02:53.639427 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:02:53.640431 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m08:02:53.641565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:54.109501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m08:02:54.112342 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m08:02:54.338663 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.77s]
[0m08:02:54.340227 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:02:54.341357 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:02:54.342296 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m08:02:54.343401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m08:02:54.344338 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:02:54.350753 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:02:54.378579 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:02:54.382212 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:02:54.396984 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:02:54.398104 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m08:02:54.399035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:54.961690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m08:02:54.966379 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m08:02:55.146041 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.80s]
[0m08:02:55.147863 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:02:55.148946 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:02:55.149896 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m08:02:55.150982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m08:02:55.151956 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:02:55.163842 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:02:55.202243 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:02:55.206233 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:02:55.240372 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:02:55.241722 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:02:55.242761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:55.680927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m08:02:55.685411 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m08:02:55.829775 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.68s]
[0m08:02:55.831481 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:02:55.833254 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:02:55.834408 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m08:02:55.835738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m08:02:55.836893 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:02:55.847053 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:02:55.869158 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:02:55.872823 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:02:55.893314 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:02:55.894337 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:02:55.895318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:56.298413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m08:02:56.303099 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m08:02:56.497423 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.66s]
[0m08:02:56.499226 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:02:56.500338 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:02:56.501396 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m08:02:56.502511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m08:02:56.503207 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:02:56.510588 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:02:56.528874 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:02:56.532154 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:02:56.544798 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:02:56.545637 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:02:56.546547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:57.142462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m08:02:57.144901 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m08:02:57.334604 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.83s]
[0m08:02:57.336036 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:02:57.336851 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:02:57.337542 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m08:02:57.338772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m08:02:57.339914 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:02:57.346866 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:02:57.363024 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:02:57.366700 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:02:57.384936 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:02:57.386152 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:02:57.387152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:58.183270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m08:02:58.188018 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m08:02:58.355383 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 1.02s]
[0m08:02:58.356455 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:02:58.357396 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:02:58.358058 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m08:02:58.358875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m08:02:58.359654 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:02:58.366725 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:02:58.379787 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:02:58.384596 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:02:58.406554 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:02:58.407844 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:02:58.408738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:58.786877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m08:02:58.789663 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m08:02:58.937120 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.58s]
[0m08:02:58.938241 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:02:58.940573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:58.941731 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m08:02:58.942749 [info ] [MainThread]: 
[0m08:02:58.943469 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m08:02:58.945155 [debug] [MainThread]: Command end result
[0m08:02:59.028940 [info ] [MainThread]: 
[0m08:02:59.029907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:59.030635 [info ] [MainThread]: 
[0m08:02:59.031370 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m08:02:59.032756 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.020613, "process_user_time": 3.816613, "process_kernel_time": 1.80702, "process_mem_max_rss": "234388", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:02:59.034148 [debug] [MainThread]: Command `dbt test` succeeded at 08:02:59.033949 after 11.02 seconds
[0m08:02:59.035209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31011da6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3101319850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3101a14860>]}
[0m08:02:59.035950 [debug] [MainThread]: Flushing usage events
[0m08:03:02.323649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeabc6b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8762300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8763bc0>]}


============================== 08:03:02.329462 | dbf94c44-8eba-40cd-b1e4-404b8b59cf35 ==============================
[0m08:03:02.329462 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:03:02.330483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m08:03:03.196184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbf94c44-8eba-40cd-b1e4-404b8b59cf35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe72b7f3e0>]}
[0m08:03:03.255375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbf94c44-8eba-40cd-b1e4-404b8b59cf35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe73032ab0>]}
[0m08:03:03.257411 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:03:03.343175 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:03:03.894750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:03:03.896192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:03:03.939042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbf94c44-8eba-40cd-b1e4-404b8b59cf35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe73101100>]}
[0m08:03:04.129717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbf94c44-8eba-40cd-b1e4-404b8b59cf35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe7287aea0>]}
[0m08:03:04.131499 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m08:03:04.133001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbf94c44-8eba-40cd-b1e4-404b8b59cf35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea86fbb30>]}
[0m08:03:04.136208 [info ] [MainThread]: 
[0m08:03:04.137884 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:03:04.141572 [debug] [MainThread]: Command end result
[0m08:03:04.245023 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.0155096, "process_user_time": 3.108228, "process_kernel_time": 1.857927, "process_mem_max_rss": "234564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:03:04.246145 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:03:04.246008 after 2.02 seconds
[0m08:03:04.246992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea9097e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea94c3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea89fa2d0>]}
[0m08:03:04.247781 [debug] [MainThread]: Flushing usage events
[0m08:04:40.009945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37b546d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37c24ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37a37ef30>]}


============================== 08:04:40.016146 | 5653eeca-0868-46ed-a891-a4cca283dd31 ==============================
[0m08:04:40.016146 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:04:40.017528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m08:04:40.970956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34861b620>]}
[0m08:04:41.016183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34817cbc0>]}
[0m08:04:41.017826 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:04:41.126961 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:04:41.452622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:04:41.453644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:04:41.502663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff34387c920>]}
[0m08:04:41.666183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff343599220>]}
[0m08:04:41.667135 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m08:04:41.668088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff379424980>]}
[0m08:04:41.670644 [info ] [MainThread]: 
[0m08:04:41.671842 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:04:41.677307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m08:04:41.694751 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m08:04:41.695620 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m08:04:41.696226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:42.476370 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.780 seconds
[0m08:04:42.478877 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m08:04:42.640792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m08:04:42.650870 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:04:42.651946 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:04:42.652772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:04:45.366065 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 2.713 seconds
[0m08:04:45.368401 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:04:47.116171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37ae0be90>]}
[0m08:04:47.117783 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:04:47.118947 [info ] [MainThread]: 
[0m08:04:47.129103 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m08:04:47.130749 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m08:04:47.131958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.actual_vs_forecast)
[0m08:04:47.132954 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m08:04:47.141669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m08:04:47.160698 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m08:04:47.187735 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m08:04:47.210303 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m08:04:47.211295 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (WITH actual AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,
    CAST(actual AS FLOAT) AS actual_close
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE actual IS NOT NULL
),

forecast AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS forecast_date,
    CAST(forecast AS FLOAT) AS predicted_close,
    CAST(lower_bound AS FLOAT) AS lower_bound,
    CAST(upper_bound AS FLOAT) AS upper_bound
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE forecast IS NOT NULL
)

SELECT
  f.symbol,
  f.forecast_date,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close,
  
  -- Composite primary key
  CONCAT(f.symbol, '_', f.forecast_date) AS forecast_id

FROM forecast f
LEFT JOIN actual a
  ON f.symbol = a.symbol
 AND f.forecast_date = a.trade_date

ORDER BY f.symbol, f.forecast_date
        );
[0m08:04:47.211971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:49.460246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.248 seconds
[0m08:04:49.481563 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m08:04:49.654646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff343b82270>]}
[0m08:04:49.655980 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 2.52s]
[0m08:04:49.657440 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m08:04:49.658593 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m08:04:49.659976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m08:04:49.661113 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m08:04:49.665537 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m08:04:49.684995 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m08:04:49.686245 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m08:04:49.687640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m08:04:49.688581 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m08:04:49.692281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m08:04:49.709432 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m08:04:49.710332 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m08:04:49.711193 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m08:04:49.712003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m08:04:49.712685 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m08:04:49.716723 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m08:04:49.733031 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m08:04:49.737323 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m08:04:49.762622 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m08:04:49.763991 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m08:04:49.765016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:51.109218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.344 seconds
[0m08:04:51.112223 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m08:04:51.305620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342c1d6d0>]}
[0m08:04:51.306825 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.59s]
[0m08:04:51.307933 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m08:04:51.308914 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m08:04:51.309779 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m08:04:51.310921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m08:04:51.311965 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m08:04:51.315662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m08:04:51.335815 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m08:04:51.339257 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m08:04:51.353027 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m08:04:51.353721 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m08:04:51.354241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:52.395926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.042 seconds
[0m08:04:52.398923 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m08:04:52.604719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342d513a0>]}
[0m08:04:52.606049 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.29s]
[0m08:04:52.607600 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m08:04:52.608505 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m08:04:52.609545 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m08:04:52.610516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m08:04:52.611298 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m08:04:52.623540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m08:04:52.645880 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m08:04:52.650443 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m08:04:52.675675 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m08:04:52.676824 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m08:04:52.677782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:54.376644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.699 seconds
[0m08:04:54.380050 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m08:04:54.550327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37accfa40>]}
[0m08:04:54.551854 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.94s]
[0m08:04:54.553055 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m08:04:54.553858 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m08:04:54.554619 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m08:04:54.555478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m08:04:54.556085 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m08:04:54.572844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m08:04:54.587426 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m08:04:54.590559 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m08:04:54.603075 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m08:04:54.603833 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m08:04:54.604410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:55.764065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.160 seconds
[0m08:04:55.766763 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m08:04:55.953570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5653eeca-0868-46ed-a891-a4cca283dd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff342ae7020>]}
[0m08:04:55.954938 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.40s]
[0m08:04:55.956034 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m08:04:55.958576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:55.959693 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m08:04:55.961071 [info ] [MainThread]: 
[0m08:04:55.962363 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 14.29 seconds (14.29s).
[0m08:04:55.964396 [debug] [MainThread]: Command end result
[0m08:04:56.064213 [info ] [MainThread]: 
[0m08:04:56.065410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:04:56.066369 [info ] [MainThread]: 
[0m08:04:56.067548 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:04:56.069388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.156498, "process_user_time": 3.485958, "process_kernel_time": 1.963119, "process_mem_max_rss": "235932", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:04:56.070578 [debug] [MainThread]: Command `dbt run` succeeded at 08:04:56.070404 after 16.16 seconds
[0m08:04:56.071569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37b546d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37a050a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff37a455c40>]}
[0m08:04:56.072610 [debug] [MainThread]: Flushing usage events
[0m08:05:00.616503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73574e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb735b54cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7374dff20>]}


============================== 08:05:00.623877 | 0ea7d6fa-1a4a-4e45-8b13-60e63067fbe4 ==============================
[0m08:05:00.623877 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:05:00.624918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m08:05:01.489055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ea7d6fa-1a4a-4e45-8b13-60e63067fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ffdbb170>]}
[0m08:05:01.540582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ea7d6fa-1a4a-4e45-8b13-60e63067fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73539cce0>]}
[0m08:05:01.542096 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:05:01.635540 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:05:02.017414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:05:02.018594 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:05:02.061049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ea7d6fa-1a4a-4e45-8b13-60e63067fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ffb9c680>]}
[0m08:05:02.257020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ea7d6fa-1a4a-4e45-8b13-60e63067fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ff4f3bf0>]}
[0m08:05:02.258110 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m08:05:02.259310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ea7d6fa-1a4a-4e45-8b13-60e63067fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ff979e20>]}
[0m08:05:02.262696 [info ] [MainThread]: 
[0m08:05:02.264283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:05:02.270235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m08:05:02.289371 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:05:02.290637 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:05:02.291901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:02.879199 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.587 seconds
[0m08:05:02.881786 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:05:03.051495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ea7d6fa-1a4a-4e45-8b13-60e63067fbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb736d8bf80>]}
[0m08:05:03.052644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:05:03.053405 [info ] [MainThread]: 
[0m08:05:03.062886 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:05:03.064046 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m08:05:03.065291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m08:05:03.066403 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:05:03.082802 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:05:03.104387 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:05:03.124227 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:05:03.146212 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:05:03.147029 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m08:05:03.147705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:03.693861 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m08:05:03.703750 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m08:05:03.870003 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.80s]
[0m08:05:03.871104 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:05:03.871849 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:05:03.872559 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m08:05:03.873442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m08:05:03.874507 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:05:03.880895 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:05:03.897896 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:05:03.902413 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:05:03.919807 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:05:03.920904 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m08:05:03.921691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:05.063959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.142 seconds
[0m08:05:05.066904 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m08:05:05.231232 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 1.36s]
[0m08:05:05.232376 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:05:05.233159 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:05:05.233802 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m08:05:05.234513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m08:05:05.235202 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:05:05.244174 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:05:05.262149 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:05:05.281768 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:05:05.286362 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:05:05.299386 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:05:05.300240 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m08:05:05.300883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:05.708609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m08:05:05.711227 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m08:05:05.861003 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.63s]
[0m08:05:05.862522 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:05:05.863401 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:05:05.864064 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m08:05:05.864988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m08:05:05.865758 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:05:05.871711 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:05:05.887855 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:05:05.891360 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:05:05.911152 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:05:05.912296 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m08:05:05.913135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:06.312316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m08:05:06.315377 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m08:05:06.486104 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.62s]
[0m08:05:06.487351 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:05:06.488249 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:05:06.489004 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m08:05:06.489889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m08:05:06.490471 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:05:06.499016 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:05:06.520929 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:05:06.524436 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:05:06.543474 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:05:06.544720 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m08:05:06.545938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:06.945279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m08:05:06.948043 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m08:05:07.100565 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.61s]
[0m08:05:07.101978 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:05:07.103116 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:05:07.104034 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m08:05:07.105135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m08:05:07.106101 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:05:07.122514 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:05:07.142627 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:05:07.146368 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:05:07.163912 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:05:07.164898 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:05:07.165600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:07.647361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m08:05:07.652278 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m08:05:07.824776 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.72s]
[0m08:05:07.826977 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:05:07.828534 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:05:07.829816 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m08:05:07.831132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m08:05:07.832104 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:05:07.840836 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:05:07.868241 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:05:07.871966 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:05:07.899635 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:05:07.900583 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:05:07.901457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:08.465291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m08:05:08.467699 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m08:05:08.628449 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.80s]
[0m08:05:08.629703 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:05:08.630721 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:05:08.631671 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m08:05:08.632607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m08:05:08.633513 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:05:08.640629 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:05:08.670135 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:05:08.673649 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:05:08.694536 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:05:08.695434 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:05:08.696126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:09.093158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m08:05:09.095529 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m08:05:09.252639 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.62s]
[0m08:05:09.253898 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:05:09.254785 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:05:09.255378 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m08:05:09.256224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m08:05:09.256846 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:05:09.261818 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:05:09.277564 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:05:09.281146 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:05:09.296570 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:05:09.297607 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:05:09.298364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:09.795120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m08:05:09.797960 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m08:05:09.939812 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.68s]
[0m08:05:09.941045 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:05:09.942065 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:05:09.942891 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m08:05:09.943909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m08:05:09.944805 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:05:09.951962 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:05:09.967148 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:05:09.972152 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:05:09.985906 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:05:09.986831 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:05:09.987499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:05:10.417404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m08:05:10.420167 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m08:05:10.579529 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.64s]
[0m08:05:10.580951 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:05:10.583487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:05:10.584493 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m08:05:10.585283 [info ] [MainThread]: 
[0m08:05:10.586151 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 8.32 seconds (8.32s).
[0m08:05:10.588092 [debug] [MainThread]: Command end result
[0m08:05:10.684203 [info ] [MainThread]: 
[0m08:05:10.685456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:05:10.686450 [info ] [MainThread]: 
[0m08:05:10.687423 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m08:05:10.689051 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.157163, "process_user_time": 3.923413, "process_kernel_time": 1.875976, "process_mem_max_rss": "244640", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:05:10.690150 [debug] [MainThread]: Command `dbt test` succeeded at 08:05:10.690030 after 10.16 seconds
[0m08:05:10.691090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73574e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73574be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73537c2f0>]}
[0m08:05:10.692039 [debug] [MainThread]: Flushing usage events
[0m08:05:15.178872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f4b4c19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f4a26f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f4d3f6db0>]}


============================== 08:05:15.186651 | 03f97c83-5ed7-4a26-890e-e87083b6ab0a ==============================
[0m08:05:15.186651 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:05:15.188343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:05:16.271186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03f97c83-5ed7-4a26-890e-e87083b6ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f1a0eb6e0>]}
[0m08:05:16.356398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03f97c83-5ed7-4a26-890e-e87083b6ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f4a709610>]}
[0m08:05:16.358469 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:05:16.497947 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:05:16.917403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:05:16.918306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:05:16.961050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03f97c83-5ed7-4a26-890e-e87083b6ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f1841b860>]}
[0m08:05:17.126380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03f97c83-5ed7-4a26-890e-e87083b6ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f13d34f20>]}
[0m08:05:17.127655 [info ] [MainThread]: Found 7 models, 10 data tests, 3 sources, 459 macros
[0m08:05:17.128509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03f97c83-5ed7-4a26-890e-e87083b6ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f4ae519d0>]}
[0m08:05:17.130812 [info ] [MainThread]: 
[0m08:05:17.131769 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:05:17.133951 [debug] [MainThread]: Command end result
[0m08:05:17.217599 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.134271, "process_user_time": 3.752684, "process_kernel_time": 1.771266, "process_mem_max_rss": "234400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:05:17.218657 [debug] [MainThread]: Command `dbt snapshot` succeeded at 08:05:17.218534 after 2.14 seconds
[0m08:05:17.219436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f4b4c19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f49f03230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f4a1d5fa0>]}
[0m08:05:17.220445 [debug] [MainThread]: Flushing usage events
[0m08:11:30.750601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf3627c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf4306fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf24bb530>]}


============================== 08:11:30.757712 | 71e40b9e-5da1-41a9-a0c2-56912ea97448 ==============================
[0m08:11:30.757712 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:11:30.759060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m08:11:31.832011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc1188b60>]}
[0m08:11:31.880603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bc08e0500>]}
[0m08:11:31.882033 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:11:31.957330 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:11:32.524313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m08:11:32.525686 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://snapshots/snapshot_moving_average.sql
[0m08:11:32.526889 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://snapshots/snapshot_volume _summary.sql
[0m08:11:32.528026 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://snapshots/snapshot_rsi.sql
[0m08:11:32.529163 [debug] [MainThread]: Partial parsing: added file: dbt_stock_project://snapshots/snapshot_stock_indicators.sql
[0m08:11:32.815601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbb5b8410>]}
[0m08:11:33.027504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbb6017c0>]}
[0m08:11:33.028827 [info ] [MainThread]: Found 7 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m08:11:33.029684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbb725940>]}
[0m08:11:33.032660 [info ] [MainThread]: 
[0m08:11:33.033994 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:11:33.039632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m08:11:33.055098 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m08:11:33.056220 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m08:11:33.057438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:33.688264 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.632 seconds
[0m08:11:33.690680 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m08:11:33.913894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m08:11:33.923379 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:11:33.924454 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:11:33.925497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:34.388896 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.463 seconds
[0m08:11:34.391396 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:11:34.561157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m08:11:34.566235 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m08:11:34.567168 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m08:11:34.568220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:35.041210 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbe62b-0205-0fb8-0004-59ff002eecda
[0m08:11:35.042270 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m08:11:35.043305 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m08:11:35.044054 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m08:11:35.044828 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m08:11:35.211979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbb5bb950>]}
[0m08:11:35.213718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:11:35.214781 [info ] [MainThread]: 
[0m08:11:35.225897 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.actual_vs_forecast
[0m08:11:35.227191 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.actual_vs_forecast ...................... [RUN]
[0m08:11:35.228355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now model.dbt_stock_project.actual_vs_forecast)
[0m08:11:35.229649 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.actual_vs_forecast
[0m08:11:35.239005 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.actual_vs_forecast"
[0m08:11:35.258065 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.actual_vs_forecast
[0m08:11:35.292794 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.actual_vs_forecast"
[0m08:11:35.315500 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.actual_vs_forecast"
[0m08:11:35.316468 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.actual_vs_forecast"} */
create or replace transient table USER_DB_BLUEJAY.analytics.actual_vs_forecast
         as
        (WITH actual AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,
    CAST(actual AS FLOAT) AS actual_close
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE actual IS NOT NULL
),

forecast AS (
  SELECT
    symbol,
    CAST(date AS DATE) AS forecast_date,
    CAST(forecast AS FLOAT) AS predicted_close,
    CAST(lower_bound AS FLOAT) AS lower_bound,
    CAST(upper_bound AS FLOAT) AS upper_bound
  FROM USER_DB_BLUEJAY.raw.FINAL_DATA
  WHERE forecast IS NOT NULL
)

SELECT
  f.symbol,
  f.forecast_date,
  f.predicted_close,
  f.lower_bound,
  f.upper_bound,
  a.actual_close,
  
  -- Composite primary key
  CONCAT(f.symbol, '_', f.forecast_date) AS forecast_id

FROM forecast f
LEFT JOIN actual a
  ON f.symbol = a.symbol
 AND f.forecast_date = a.trade_date

ORDER BY f.symbol, f.forecast_date
        );
[0m08:11:35.317467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:36.955718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.638 seconds
[0m08:11:36.981183 [debug] [Thread-1 (]: On model.dbt_stock_project.actual_vs_forecast: Close
[0m08:11:37.124080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbbc7a810>]}
[0m08:11:37.125381 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.actual_vs_forecast ................. [[32mSUCCESS 1[0m in 1.89s]
[0m08:11:37.126594 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.actual_vs_forecast
[0m08:11:37.127515 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m08:11:37.128578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.actual_vs_forecast, now model.dbt_stock_project.stock)
[0m08:11:37.129804 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m08:11:37.133489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m08:11:37.167402 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m08:11:37.168954 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_forecast
[0m08:11:37.170156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_forecast)
[0m08:11:37.171380 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_forecast
[0m08:11:37.174911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_forecast"
[0m08:11:37.208361 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_forecast
[0m08:11:37.209811 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m08:11:37.211224 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.stock_indicators ........................ [RUN]
[0m08:11:37.212514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_forecast, now model.dbt_stock_project.stock_indicators)
[0m08:11:37.213789 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m08:11:37.218417 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m08:11:37.249413 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m08:11:37.253258 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m08:11:37.279702 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m08:11:37.281496 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m08:11:37.282932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:38.445236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.162 seconds
[0m08:11:38.451627 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m08:11:38.634518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bba987f50>]}
[0m08:11:38.636236 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.42s]
[0m08:11:38.637621 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m08:11:38.638965 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m08:11:38.640283 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.volume_summary .......................... [RUN]
[0m08:11:38.641550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m08:11:38.642741 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m08:11:38.646699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m08:11:38.672741 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m08:11:38.677373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m08:11:38.693853 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m08:11:38.694973 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m08:11:38.695708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:39.882729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.187 seconds
[0m08:11:39.887437 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m08:11:40.051048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbab308c0>]}
[0m08:11:40.052829 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.41s]
[0m08:11:40.054113 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m08:11:40.055128 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m08:11:40.056105 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_averages ......................... [RUN]
[0m08:11:40.057105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m08:11:40.057904 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m08:11:40.074295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m08:11:40.088772 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m08:11:40.093191 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m08:11:40.109495 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m08:11:40.110491 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m08:11:40.111242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:41.357540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.246 seconds
[0m08:11:41.362051 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m08:11:41.526043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf2d979e0>]}
[0m08:11:41.527775 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.47s]
[0m08:11:41.529557 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m08:11:41.531280 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m08:11:41.532642 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m08:11:41.534286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m08:11:41.535788 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m08:11:41.564384 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m08:11:41.595077 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m08:11:41.599541 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m08:11:41.620568 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m08:11:41.621977 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m08:11:41.623424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:42.903969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.281 seconds
[0m08:11:42.908803 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m08:11:43.096964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e40b9e-5da1-41a9-a0c2-56912ea97448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbaa82210>]}
[0m08:11:43.099137 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.56s]
[0m08:11:43.100921 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m08:11:43.104266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:43.105354 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m08:11:43.106622 [info ] [MainThread]: 
[0m08:11:43.107850 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 10.07 seconds (10.07s).
[0m08:11:43.110334 [debug] [MainThread]: Command end result
[0m08:11:43.209549 [info ] [MainThread]: 
[0m08:11:43.210703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:11:43.211754 [info ] [MainThread]: 
[0m08:11:43.212862 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:11:43.214811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.568315, "process_user_time": 4.105804, "process_kernel_time": 1.91632, "process_mem_max_rss": "250096", "process_in_blocks": "424", "process_out_blocks": "8"}
[0m08:11:43.216001 [debug] [MainThread]: Command `dbt run` succeeded at 08:11:43.215894 after 12.57 seconds
[0m08:11:43.216937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf3627c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bbb747bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bf18deae0>]}
[0m08:11:43.217819 [debug] [MainThread]: Flushing usage events
[0m08:11:46.768778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557abbb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557b2e72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557ad7a4b0>]}


============================== 08:11:46.776273 | 5dc17e19-84fd-4b14-ba23-14a0e0927dd8 ==============================
[0m08:11:46.776273 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:11:46.777556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:11:47.710438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dc17e19-84fd-4b14-ba23-14a0e0927dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55493e0da0>]}
[0m08:11:47.757262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dc17e19-84fd-4b14-ba23-14a0e0927dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5549a89d30>]}
[0m08:11:47.759003 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:11:47.835670 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:11:48.378736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:11:48.380178 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:11:48.426376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dc17e19-84fd-4b14-ba23-14a0e0927dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5548d085c0>]}
[0m08:11:48.616188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dc17e19-84fd-4b14-ba23-14a0e0927dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55488278c0>]}
[0m08:11:48.617395 [info ] [MainThread]: Found 7 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m08:11:48.618321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dc17e19-84fd-4b14-ba23-14a0e0927dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554886e390>]}
[0m08:11:48.621453 [info ] [MainThread]: 
[0m08:11:48.622684 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:11:48.628284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_snapshots'
[0m08:11:48.644463 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m08:11:48.645760 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m08:11:48.646956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:49.293565 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bbe62b-0205-0bb1-0004-59ff002f18ba
[0m08:11:49.295030 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m08:11:49.296411 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m08:11:49.297887 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m08:11:49.299336 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m08:11:49.475240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m08:11:49.478679 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:11:49.479530 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:11:49.480288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:49.884396 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.404 seconds
[0m08:11:49.887615 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:11:50.055294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dc17e19-84fd-4b14-ba23-14a0e0927dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55488140e0>]}
[0m08:11:50.056606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:11:50.057585 [info ] [MainThread]: 
[0m08:11:50.069264 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:11:50.070348 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m08:11:50.071548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m08:11:50.072458 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:11:50.099523 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:11:50.118582 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:11:50.141873 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:11:50.161443 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:11:50.162309 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m08:11:50.163027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:50.710489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m08:11:50.719770 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m08:11:50.884536 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.81s]
[0m08:11:50.886743 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:11:50.888206 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:11:50.889667 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m08:11:50.891195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m08:11:50.892283 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:11:50.897855 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:11:50.932317 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:11:50.935737 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:11:50.962540 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:11:50.963463 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m08:11:50.964230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:51.520678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m08:11:51.523545 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m08:11:51.678855 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.79s]
[0m08:11:51.680536 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:11:51.681774 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:11:51.682836 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m08:11:51.683980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m08:11:51.684990 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:11:51.692565 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:11:51.719183 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:11:51.745059 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:11:51.750235 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:11:51.770686 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:11:51.771788 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m08:11:51.772697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:52.172157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m08:11:52.174945 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m08:11:52.363432 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.68s]
[0m08:11:52.365274 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:11:52.366425 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:11:52.367393 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m08:11:52.368687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m08:11:52.369609 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:11:52.375820 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:11:52.400566 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:11:52.405566 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:11:52.430447 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:11:52.431629 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m08:11:52.432731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:52.836510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m08:11:52.839291 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m08:11:53.033164 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.66s]
[0m08:11:53.035005 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:11:53.036214 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:11:53.037344 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m08:11:53.038405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m08:11:53.039369 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:11:53.045205 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:11:53.073231 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:11:53.077035 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:11:53.103472 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:11:53.104704 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m08:11:53.105882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:53.458295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m08:11:53.461115 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m08:11:53.635558 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.60s]
[0m08:11:53.636641 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:11:53.637539 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:11:53.638245 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m08:11:53.639357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m08:11:53.640079 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:11:53.652896 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:11:53.674807 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:11:53.677932 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:11:53.701382 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:11:53.702326 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:11:53.703287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:54.401627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m08:11:54.404206 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m08:11:54.563916 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.92s]
[0m08:11:54.565358 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:11:54.566587 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:11:54.567637 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m08:11:54.568702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m08:11:54.569718 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:11:54.578614 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:11:54.608736 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:11:54.612262 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:11:54.634481 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:11:54.635409 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:11:54.636142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:55.186196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m08:11:55.190487 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m08:11:55.369569 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.80s]
[0m08:11:55.371003 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:11:55.371936 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:11:55.372916 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m08:11:55.373821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m08:11:55.374508 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:11:55.381682 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:11:55.409470 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:11:55.413155 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:11:55.440257 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:11:55.441455 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:11:55.442431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:55.971554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.529 seconds
[0m08:11:55.974667 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m08:11:56.146662 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.77s]
[0m08:11:56.148455 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:11:56.149852 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:11:56.150978 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m08:11:56.152063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m08:11:56.152938 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:11:56.158312 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:11:56.179519 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:11:56.183287 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:11:56.209814 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:11:56.210898 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:11:56.211825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:56.718350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m08:11:56.720753 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m08:11:56.901445 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.75s]
[0m08:11:56.903275 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:11:56.904806 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:11:56.906184 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m08:11:56.907475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m08:11:56.908744 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:11:56.915859 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:11:56.945734 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:11:56.951022 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:11:56.980485 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:11:56.981887 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:11:56.983103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:57.348878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m08:11:57.353149 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m08:11:57.508592 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.60s]
[0m08:11:57.510603 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:11:57.513973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:57.514979 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m08:11:57.516167 [info ] [MainThread]: 
[0m08:11:57.517156 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m08:11:57.519436 [debug] [MainThread]: Command end result
[0m08:11:57.637762 [info ] [MainThread]: 
[0m08:11:57.639000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:11:57.639786 [info ] [MainThread]: 
[0m08:11:57.640565 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m08:11:57.642169 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.96758, "process_user_time": 3.754364, "process_kernel_time": 1.986838, "process_mem_max_rss": "251692", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:11:57.643150 [debug] [MainThread]: Command `dbt test` succeeded at 08:11:57.643018 after 10.97 seconds
[0m08:11:57.644145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557b19d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557d4dfb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5548e9e420>]}
[0m08:11:57.645016 [debug] [MainThread]: Flushing usage events
[0m08:12:01.075078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff2867e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff0d12150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff353f0b0>]}


============================== 08:12:01.082043 | e0ce00fd-ee4a-414c-be58-99bd86f8622c ==============================
[0m08:12:01.082043 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:12:01.083259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:12:02.192717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff19e26c0>]}
[0m08:12:02.255522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc6f67890>]}
[0m08:12:02.257546 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:12:02.356636 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:12:02.999125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:12:03.000449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:12:03.058470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc03f67b0>]}
[0m08:12:03.269138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfc24df590>]}
[0m08:12:03.270396 [info ] [MainThread]: Found 7 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m08:12:03.271508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfba9234d0>]}
[0m08:12:03.274554 [info ] [MainThread]: 
[0m08:12:03.275940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:12:03.281844 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m08:12:03.298737 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m08:12:03.299795 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m08:12:03.300467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:03.944947 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.644 seconds
[0m08:12:03.948229 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m08:12:04.116985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now create_USER_DB_BLUEJAY_snapshots)
[0m08:12:04.119757 [debug] [ThreadPool]: Creating schema "database: "USER_DB_BLUEJAY"
schema: "snapshots"
"
[0m08:12:04.128089 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_BLUEJAY_snapshots"
[0m08:12:04.129390 [debug] [ThreadPool]: On create_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "create_USER_DB_BLUEJAY_snapshots"} */
create schema if not exists USER_DB_BLUEJAY.snapshots
[0m08:12:04.130623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:04.712742 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.582 seconds
[0m08:12:04.714776 [debug] [ThreadPool]: On create_USER_DB_BLUEJAY_snapshots: Close
[0m08:12:04.870912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_snapshots)
[0m08:12:04.881251 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m08:12:04.882431 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m08:12:04.883467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:05.307719 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.424 seconds
[0m08:12:05.310105 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m08:12:05.478212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m08:12:05.483817 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:12:05.485249 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:12:05.486512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:06.013057 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.526 seconds
[0m08:12:06.017645 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:12:06.190492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfbae90d40>]}
[0m08:12:06.191985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:12:06.192921 [info ] [MainThread]: 
[0m08:12:06.202244 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:12:06.203494 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.snapshot_moving_averages ....................... [RUN]
[0m08:12:06.204754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now snapshot.dbt_stock_project.snapshot_moving_averages)
[0m08:12:06.206159 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:12:06.214201 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:12:06.300563 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:12:06.302153 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m08:12:06.303644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:06.929976 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.626 seconds
[0m08:12:06.938372 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:12:06.939535 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:12:07.050262 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.109 seconds
[0m08:12:07.052562 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:12:07.099444 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:12:07.100664 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.snapshots.snapshot_moving_averages
         as
        (
    

    select *,
        md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1

    ) sbq



        );
[0m08:12:07.940092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m08:12:07.967092 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: Close
[0m08:12:08.116549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff1301880>]}
[0m08:12:08.118106 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshots.snapshot_moving_averages ....................... [[32mSUCCESS 1[0m in 1.91s]
[0m08:12:08.119285 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:12:08.120221 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_rsi
[0m08:12:08.121092 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.snapshot_rsi ................................... [RUN]
[0m08:12:08.122124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_moving_averages, now snapshot.dbt_stock_project.snapshot_rsi)
[0m08:12:08.123215 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_rsi
[0m08:12:08.127385 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_rsi
[0m08:12:08.132816 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m08:12:08.133892 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


with base as (
  select
    symbol,
    trade_date,
    rsi_14d
  from USER_DB_BLUEJAY.analytics.rsi
),

deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over(
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  rsi_14d
from deduped
where rn = 1

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m08:12:08.134840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:08.663581 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.529 seconds
[0m08:12:08.665457 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m08:12:08.666311 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:12:08.779448 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.112 seconds
[0m08:12:08.781148 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.snapshot_rsi"
[0m08:12:08.800124 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m08:12:08.801464 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
create or replace transient table USER_DB_BLUEJAY.snapshots.snapshot_rsi
         as
        (
    

    select *,
        md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


with base as (
  select
    symbol,
    trade_date,
    rsi_14d
  from USER_DB_BLUEJAY.analytics.rsi
),

deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over(
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  rsi_14d
from deduped
where rn = 1

    ) sbq



        );
[0m08:12:09.401136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m08:12:09.406413 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: Close
[0m08:12:09.593533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb9f76a80>]}
[0m08:12:09.595531 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshots.snapshot_rsi ................................... [[32mSUCCESS 1[0m in 1.47s]
[0m08:12:09.597016 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_rsi
[0m08:12:09.598163 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m08:12:09.599249 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.snapshot_stock_indicators ...................... [RUN]
[0m08:12:09.600404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_rsi, now snapshot.dbt_stock_project.snapshot_stock_indicators)
[0m08:12:09.601177 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m08:12:09.604931 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m08:12:09.609447 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_stock_indicators"
[0m08:12:09.610531 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


-- Aggregate first to guarantee exactly one row per symbol+date
select
  symbol,
  trade_date,
  max(rsi_14d) as rsi_14d
from USER_DB_BLUEJAY.analytics.stock_indicators
group by 1, 2

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m08:12:09.611984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:10.075111 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe62c-0205-0c98-0004-59ff002f088a
[0m08:12:10.075946 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 6
invalid identifier 'RSI_14D'
[0m08:12:10.076831 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: Close
[0m08:12:10.251017 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 24 at position 6
  invalid identifier 'RSI_14D'
[0m08:12:10.252354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfbad6d610>]}
[0m08:12:10.253855 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshots.snapshot_stock_indicators .................. [[31mERROR[0m in 0.65s]
[0m08:12:10.255174 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m08:12:10.256415 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m08:12:10.257884 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.snapshot_volume_summary ........................ [RUN]
[0m08:12:10.259117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_stock_indicators, now snapshot.dbt_stock_project.snapshot_volume_summary)
[0m08:12:10.260157 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_volume_summary
[0m08:12:10.265004 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_volume_summary
[0m08:12:10.271431 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m08:12:10.272549 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


with base as (
  select
    symbol,
    trade_date,
    total_volume
  from USER_DB_BLUEJAY.analytics.volume_summary
),

deduped as (
  select
    symbol,
    trade_date,
    total_volume,
    row_number() over(
      partition by symbol, trade_date
      order by total_volume desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  total_volume
from deduped
where rn = 1

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m08:12:10.273559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:10.662099 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe62c-0205-0f94-0004-59ff002efcde
[0m08:12:10.664034 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 4
invalid identifier 'TOTAL_VOLUME'
[0m08:12:10.665611 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: Close
[0m08:12:10.866760 [debug] [Thread-1 (]: Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 24 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m08:12:10.868003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ce00fd-ee4a-414c-be58-99bd86f8622c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfb9e3dfa0>]}
[0m08:12:10.869347 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshots.snapshot_volume_summary .................... [[31mERROR[0m in 0.61s]
[0m08:12:10.870781 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m08:12:10.873987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:10.875066 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.snapshot_volume_summary' was properly closed.
[0m08:12:10.876173 [info ] [MainThread]: 
[0m08:12:10.877127 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 7.60 seconds (7.60s).
[0m08:12:10.879026 [debug] [MainThread]: Command end result
[0m08:12:10.982283 [info ] [MainThread]: 
[0m08:12:10.983352 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:12:10.984503 [info ] [MainThread]: 
[0m08:12:10.985695 [error] [MainThread]:   Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 24 at position 6
  invalid identifier 'RSI_14D'
[0m08:12:10.986692 [info ] [MainThread]: 
[0m08:12:10.987556 [error] [MainThread]:   Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 24 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m08:12:10.988288 [info ] [MainThread]: 
[0m08:12:10.989048 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m08:12:10.990492 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 10.015191, "process_user_time": 4.172424, "process_kernel_time": 1.86661, "process_mem_max_rss": "239692", "process_in_blocks": "136", "process_out_blocks": "8", "command_success": false}
[0m08:12:10.991553 [debug] [MainThread]: Command `dbt snapshot` failed at 08:12:10.991362 after 10.02 seconds
[0m08:12:10.992368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff129d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff1824cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff0b16b10>]}
[0m08:12:10.993269 [debug] [MainThread]: Flushing usage events
[0m08:25:43.245726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f211a7d0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f211a78bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f211aa1c530>]}


============================== 08:25:43.253493 | 85c37458-4d44-4e1d-a0d5-023a02e492a6 ==============================
[0m08:25:43.253493 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:25:43.254534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:25:44.830804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85c37458-4d44-4e1d-a0d5-023a02e492a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f0b83c50>]}
[0m08:25:44.882472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85c37458-4d44-4e1d-a0d5-023a02e492a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e8e8fb30>]}
[0m08:25:44.885252 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:25:44.974054 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:25:45.481426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:25:45.482699 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_volume _summary.sql
[0m08:25:45.483570 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_stock_indicators.sql
[0m08:25:45.734326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85c37458-4d44-4e1d-a0d5-023a02e492a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e84acb30>]}
[0m08:25:45.939880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85c37458-4d44-4e1d-a0d5-023a02e492a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e8557260>]}
[0m08:25:45.940898 [info ] [MainThread]: Found 7 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m08:25:45.941979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85c37458-4d44-4e1d-a0d5-023a02e492a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20f0945af0>]}
[0m08:25:45.945765 [info ] [MainThread]: 
[0m08:25:45.947208 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:25:45.953685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m08:25:45.969477 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m08:25:45.970574 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m08:25:45.971452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:46.697923 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.726 seconds
[0m08:25:46.701886 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m08:25:46.857293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_snapshots)
[0m08:25:46.867701 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m08:25:46.868889 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m08:25:46.870001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:25:47.365895 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.496 seconds
[0m08:25:47.368496 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m08:25:47.526733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m08:25:47.529877 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:25:47.530679 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:25:47.531443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:25:47.986655 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.455 seconds
[0m08:25:47.991387 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:25:48.150916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85c37458-4d44-4e1d-a0d5-023a02e492a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20e88bb560>]}
[0m08:25:48.152486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:25:48.153704 [info ] [MainThread]: 
[0m08:25:48.170554 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:25:48.172220 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.snapshot_moving_averages ....................... [RUN]
[0m08:25:48.174013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now snapshot.dbt_stock_project.snapshot_moving_averages)
[0m08:25:48.175796 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:25:48.185606 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:25:48.256150 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:48.257413 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m08:25:48.258368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:25:49.108219 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.850 seconds
[0m08:25:49.120515 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:49.122045 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:25:49.294318 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.171 seconds
[0m08:25:49.304337 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:49.305555 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:25:49.397016 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m08:25:49.439673 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:49.440909 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m08:25:52.736190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.294 seconds
[0m08:25:52.742635 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:52.743829 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
[0m08:25:52.879933 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.135 seconds
[0m08:25:52.887875 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:52.889221 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:25:53.000003 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.109 seconds
[0m08:25:53.006880 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:53.008343 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
[0m08:25:53.100443 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m08:25:53.105370 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:53.106504 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:25:53.216277 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.109 seconds
[0m08:25:53.227213 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:53.228197 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
[0m08:25:53.335726 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.106 seconds
[0m08:25:53.359892 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:53.361073 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        

    with snapshot_query as (

        


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m08:25:53.583767 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.221 seconds
[0m08:25:53.594129 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:53.596155 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:25:53.701418 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.104 seconds
[0m08:25:53.704288 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:53.735517 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:53.737166 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
BEGIN
[0m08:25:53.890896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m08:25:53.893621 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:25:53.895613 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:38:09.037002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdb3e4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdad11a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdacb73b0>]}


============================== 08:38:09.051009 | de7b545a-4369-4dbd-bf3c-85827be7e985 ==============================
[0m08:38:09.051009 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:38:09.052057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m08:38:09.905801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de7b545a-4369-4dbd-bf3c-85827be7e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdc17ea50>]}
[0m08:38:09.950414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de7b545a-4369-4dbd-bf3c-85827be7e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bdb26c7a0>]}
[0m08:38:09.952383 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:38:10.025985 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:38:10.366457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:38:10.367838 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_stock_indicators.sql
[0m08:38:10.643952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de7b545a-4369-4dbd-bf3c-85827be7e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba88d6030>]}
[0m08:38:10.826209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de7b545a-4369-4dbd-bf3c-85827be7e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba88d6750>]}
[0m08:38:10.827629 [info ] [MainThread]: Found 7 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m08:38:10.828600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de7b545a-4369-4dbd-bf3c-85827be7e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba8a568d0>]}
[0m08:38:10.831094 [info ] [MainThread]: 
[0m08:38:10.832200 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:38:10.837445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m08:38:10.851560 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m08:38:10.852666 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m08:38:10.853864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:11.517680 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.664 seconds
[0m08:38:11.521856 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m08:38:11.684244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_snapshots)
[0m08:38:11.695902 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m08:38:11.697306 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m08:38:11.698508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:12.139174 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.441 seconds
[0m08:38:12.142569 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m08:38:12.312556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m08:38:12.317456 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:38:12.318656 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:38:12.319726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:12.778577 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.459 seconds
[0m08:38:12.780634 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:38:12.942458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de7b545a-4369-4dbd-bf3c-85827be7e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba876d970>]}
[0m08:38:12.943820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:38:12.944848 [info ] [MainThread]: 
[0m08:38:12.954186 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:38:12.955299 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.snapshot_moving_averages ....................... [RUN]
[0m08:38:12.956525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now snapshot.dbt_stock_project.snapshot_moving_averages)
[0m08:38:12.958305 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:38:12.966129 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:38:13.023025 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:13.024204 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m08:38:13.025310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:13.435391 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.410 seconds
[0m08:38:13.446223 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:13.447613 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:38:13.537144 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.088 seconds
[0m08:38:13.547133 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:13.548226 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:38:13.651955 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.103 seconds
[0m08:38:13.698717 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:13.700159 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m08:38:16.762845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.061 seconds
[0m08:38:16.770242 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:16.771653 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
[0m08:38:16.877658 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m08:38:16.881740 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:16.882746 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:38:17.007050 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.123 seconds
[0m08:38:17.011555 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:17.012652 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
[0m08:38:17.126313 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m08:38:17.130666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:17.131794 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:38:17.244790 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.112 seconds
[0m08:38:17.253029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:17.253990 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
[0m08:38:17.368875 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.114 seconds
[0m08:38:17.388477 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:17.390026 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        

    with snapshot_query as (

        


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m08:38:17.571642 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.180 seconds
[0m08:38:17.576208 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:17.577198 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:38:17.662033 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m08:38:17.663298 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:17.677432 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:17.678522 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
BEGIN
[0m08:38:17.802807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m08:38:17.803671 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:38:17.804440 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m08:47:43.038870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb99bfa030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9abcbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb996bb200>]}


============================== 08:47:43.046078 | cbde6203-d6fd-40d1-b59d-dc7e82bfa032 ==============================
[0m08:47:43.046078 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:47:43.047144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:47:44.033436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb63045010>]}
[0m08:47:44.083712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb697a1e50>]}
[0m08:47:44.085303 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:47:44.175859 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:47:44.765717 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
[0m08:47:44.767386 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/schema.yml
[0m08:47:44.768787 [debug] [MainThread]: Partial parsing: deleted file: dbt_stock_project://models/output/actual_vs_forecast.sql
[0m08:47:44.770386 [debug] [MainThread]: Partial parsing: deleted file: dbt_stock_project://models/input/stock_forecast.sql
[0m08:47:44.885043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb62c19220>]}
[0m08:47:45.096165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb6301d7c0>]}
[0m08:47:45.097271 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m08:47:45.098347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb631087a0>]}
[0m08:47:45.101265 [info ] [MainThread]: 
[0m08:47:45.102352 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:47:45.107620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m08:47:45.123221 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m08:47:45.124400 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m08:47:45.125466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:45.858206 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.733 seconds
[0m08:47:45.860769 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m08:47:46.026256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m08:47:46.036307 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:47:46.037401 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:47:46.038432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:46.513688 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.475 seconds
[0m08:47:46.518639 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:47:46.683176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m08:47:46.691736 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m08:47:46.693430 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m08:47:46.694772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:47.177523 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.483 seconds
[0m08:47:47.182095 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m08:47:47.344487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb632063f0>]}
[0m08:47:47.346191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:47:47.347259 [info ] [MainThread]: 
[0m08:47:47.357559 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m08:47:47.358908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now model.dbt_stock_project.stock)
[0m08:47:47.360041 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m08:47:47.369673 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m08:47:47.390966 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m08:47:47.392338 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m08:47:47.393594 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m08:47:47.394696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_indicators)
[0m08:47:47.395654 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m08:47:47.400246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m08:47:47.419754 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m08:47:47.454298 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m08:47:47.476542 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m08:47:47.477653 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m08:47:47.478713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:48.511273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.033 seconds
[0m08:47:48.543842 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m08:47:48.724616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb631c6240>]}
[0m08:47:48.726401 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.33s]
[0m08:47:48.727907 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m08:47:48.729081 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m08:47:48.730343 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m08:47:48.731627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m08:47:48.732979 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m08:47:48.736953 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m08:47:48.769229 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m08:47:48.775076 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m08:47:48.805095 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m08:47:48.806287 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m08:47:48.807301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:49.731119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m08:47:49.734099 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m08:47:49.926386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9a4738f0>]}
[0m08:47:49.928434 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.19s]
[0m08:47:49.930087 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m08:47:49.931336 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m08:47:49.932612 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m08:47:49.933722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m08:47:49.934806 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m08:47:49.945487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m08:47:49.976107 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m08:47:49.981705 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m08:47:50.004121 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m08:47:50.005012 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m08:47:50.005902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:50.960144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.954 seconds
[0m08:47:50.963111 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m08:47:51.137837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9a337950>]}
[0m08:47:51.139445 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.20s]
[0m08:47:51.140595 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m08:47:51.141626 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m08:47:51.142598 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m08:47:51.143792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m08:47:51.144708 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m08:47:51.163099 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m08:47:51.189591 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m08:47:51.193200 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m08:47:51.217372 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m08:47:51.218809 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m08:47:51.220138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:52.222382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.002 seconds
[0m08:47:52.227724 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m08:47:52.387987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbde6203-d6fd-40d1-b59d-dc7e82bfa032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb622a9f40>]}
[0m08:47:52.389118 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.24s]
[0m08:47:52.390088 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m08:47:52.391873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:52.392588 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m08:47:52.393286 [info ] [MainThread]: 
[0m08:47:52.393941 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.29 seconds (7.29s).
[0m08:47:52.395189 [debug] [MainThread]: Command end result
[0m08:47:52.505093 [info ] [MainThread]: 
[0m08:47:52.506232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:47:52.507053 [info ] [MainThread]: 
[0m08:47:52.507866 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:47:52.510625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.572924, "process_user_time": 3.821531, "process_kernel_time": 2.027337, "process_mem_max_rss": "240396", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m08:47:52.511690 [debug] [MainThread]: Command `dbt run` succeeded at 08:47:52.511513 after 9.57 seconds
[0m08:47:52.512470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb632393d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9917c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9930a360>]}
[0m08:47:52.513292 [debug] [MainThread]: Flushing usage events
[0m08:47:56.178609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f3e53ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f28613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f2860da0>]}


============================== 08:47:56.185890 | a327facc-ad3c-4e71-a8e6-5e6f401a8b0b ==============================
[0m08:47:56.185890 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:47:56.186993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:47:57.135661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a327facc-ad3c-4e71-a8e6-5e6f401a8b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c29c5e20>]}
[0m08:47:57.221366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a327facc-ad3c-4e71-a8e6-5e6f401a8b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c075ea50>]}
[0m08:47:57.224079 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:47:57.330835 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:47:57.856507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:47:57.857793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:47:57.915170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a327facc-ad3c-4e71-a8e6-5e6f401a8b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c036b320>]}
[0m08:47:58.139792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a327facc-ad3c-4e71-a8e6-5e6f401a8b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38bbdeb110>]}
[0m08:47:58.141306 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m08:47:58.142465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a327facc-ad3c-4e71-a8e6-5e6f401a8b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c0368e30>]}
[0m08:47:58.146139 [info ] [MainThread]: 
[0m08:47:58.147551 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:47:58.153838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m08:47:58.169525 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:47:58.170782 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:47:58.171841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:58.852617 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.681 seconds
[0m08:47:58.855955 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:47:59.007872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m08:47:59.011856 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m08:47:59.012771 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m08:47:59.013618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:59.467897 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.454 seconds
[0m08:47:59.470099 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m08:47:59.837454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a327facc-ad3c-4e71-a8e6-5e6f401a8b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c049b110>]}
[0m08:47:59.838894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:47:59.839841 [info ] [MainThread]: 
[0m08:47:59.850804 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:47:59.851983 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m08:47:59.853014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m08:47:59.853957 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:47:59.870030 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:47:59.901306 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:47:59.921302 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:47:59.953551 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m08:47:59.954716 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m08:47:59.955904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:00.565130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m08:48:00.577043 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m08:48:00.753511 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.90s]
[0m08:48:00.754763 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m08:48:00.755921 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:48:00.756796 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m08:48:00.757969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m08:48:00.758980 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:48:00.763786 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:48:00.787268 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:48:00.790657 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:48:00.820450 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m08:48:00.821527 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m08:48:00.822426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:01.415302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m08:48:01.419387 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m08:48:01.597621 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.84s]
[0m08:48:01.598968 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m08:48:01.600223 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:48:01.601358 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m08:48:01.602398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m08:48:01.603249 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:48:01.611583 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:48:01.631326 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:48:01.655646 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:48:01.660316 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:48:01.683442 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m08:48:01.684996 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m08:48:01.685852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:02.115859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m08:48:02.120558 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m08:48:02.285672 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.68s]
[0m08:48:02.287220 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m08:48:02.288411 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:48:02.289484 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m08:48:02.290898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m08:48:02.292024 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:48:02.297451 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:48:02.329025 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:48:02.332556 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:48:02.356955 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m08:48:02.357980 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m08:48:02.358809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:02.838217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m08:48:02.841207 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m08:48:02.999686 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.71s]
[0m08:48:03.001339 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m08:48:03.002394 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:48:03.003450 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m08:48:03.004512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m08:48:03.005266 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:48:03.011037 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:48:03.037737 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:48:03.041194 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:48:03.066879 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m08:48:03.068302 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m08:48:03.069518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:03.433244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m08:48:03.435964 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m08:48:03.598686 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.59s]
[0m08:48:03.600649 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m08:48:03.602121 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:48:03.603409 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m08:48:03.604732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m08:48:03.605769 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:48:03.623269 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:48:03.643942 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:48:03.647880 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:48:03.675889 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m08:48:03.677353 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:48:03.678612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:04.292747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m08:48:04.297641 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m08:48:04.478161 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.87s]
[0m08:48:04.480018 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m08:48:04.481172 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:48:04.482488 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m08:48:04.483507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m08:48:04.484261 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:48:04.492759 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:48:04.531864 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:48:04.536079 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:48:04.565866 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m08:48:04.567128 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:48:04.568211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:05.251445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m08:48:05.255509 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m08:48:05.413832 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.93s]
[0m08:48:05.415449 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m08:48:05.416476 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:48:05.417466 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m08:48:05.418395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m08:48:05.419122 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:48:05.427763 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:48:05.458764 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:48:05.462887 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:48:05.484911 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m08:48:05.485959 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:48:05.486817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:05.920273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m08:48:05.923334 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m08:48:06.084668 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.67s]
[0m08:48:06.086116 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m08:48:06.087417 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:48:06.088626 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m08:48:06.089918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m08:48:06.091109 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:48:06.096395 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:48:06.121561 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:48:06.125100 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:48:06.151548 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m08:48:06.152510 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:48:06.153319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:06.656058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m08:48:06.660380 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m08:48:06.826976 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.74s]
[0m08:48:06.828626 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m08:48:06.829637 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:48:06.830522 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m08:48:06.831493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m08:48:06.832488 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:48:06.839380 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:48:06.870071 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:48:06.873651 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:48:06.899186 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m08:48:06.900173 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:48:06.900944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:07.375074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m08:48:07.377788 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m08:48:07.545667 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.71s]
[0m08:48:07.547397 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m08:48:07.550172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:07.551279 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m08:48:07.552425 [info ] [MainThread]: 
[0m08:48:07.553346 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m08:48:07.555721 [debug] [MainThread]: Command end result
[0m08:48:07.689266 [info ] [MainThread]: 
[0m08:48:07.690414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:48:07.691422 [info ] [MainThread]: 
[0m08:48:07.692449 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m08:48:07.694011 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.617104, "process_user_time": 4.367778, "process_kernel_time": 1.721534, "process_mem_max_rss": "236648", "process_in_blocks": "1976", "process_out_blocks": "8"}
[0m08:48:07.695206 [debug] [MainThread]: Command `dbt test` succeeded at 08:48:07.695090 after 11.62 seconds
[0m08:48:07.696081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f2519700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38c0906e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38f2862f90>]}
[0m08:48:07.697043 [debug] [MainThread]: Flushing usage events
[0m08:48:11.237387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb665d22a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6a2c16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb68fc35f0>]}


============================== 08:48:11.243600 | 18be1295-cc6d-4b9b-9c70-55afeac98185 ==============================
[0m08:48:11.243600 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:48:11.244751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:48:12.269673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb665d22a0>]}
[0m08:48:12.328189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb349bcc20>]}
[0m08:48:12.330031 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m08:48:12.427393 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:48:12.984641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:48:12.985893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:48:13.036191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb35e38890>]}
[0m08:48:13.237475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb343c7800>]}
[0m08:48:13.238693 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m08:48:13.239747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb66618f50>]}
[0m08:48:13.242652 [info ] [MainThread]: 
[0m08:48:13.244032 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:48:13.250646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m08:48:13.266066 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m08:48:13.267389 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m08:48:13.268661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:13.928945 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.660 seconds
[0m08:48:13.932159 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m08:48:14.151748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m08:48:14.161441 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m08:48:14.162556 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m08:48:14.163290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:14.599492 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.436 seconds
[0m08:48:14.602813 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m08:48:14.778449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m08:48:14.784855 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m08:48:14.785794 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m08:48:14.786645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:15.249839 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.463 seconds
[0m08:48:15.254195 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m08:48:15.413320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb34b30650>]}
[0m08:48:15.414641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:48:15.415666 [info ] [MainThread]: 
[0m08:48:15.424941 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:48:15.426152 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.snapshot_moving_averages ....................... [RUN]
[0m08:48:15.427124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now snapshot.dbt_stock_project.snapshot_moving_averages)
[0m08:48:15.428036 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:48:15.437691 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_moving_averages
[0m08:48:15.496911 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:15.498209 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m08:48:15.499617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:16.018810 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.519 seconds
[0m08:48:16.030369 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:16.032088 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:48:16.124203 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.091 seconds
[0m08:48:16.132759 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:16.134034 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:48:16.258845 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.123 seconds
[0m08:48:16.303186 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:16.304861 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m08:48:19.454954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.148 seconds
[0m08:48:19.459116 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:19.460331 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
[0m08:48:19.644153 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.183 seconds
[0m08:48:19.649552 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:19.650845 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:48:19.767466 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.115 seconds
[0m08:48:19.772692 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:19.773812 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
[0m08:48:19.864792 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.090 seconds
[0m08:48:19.870425 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:19.871539 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m08:48:19.966577 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.094 seconds
[0m08:48:19.975087 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:19.976327 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
[0m08:48:20.086649 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.109 seconds
[0m08:48:20.111107 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:20.112689 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        

    with snapshot_query as (

        


with base as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma
  from USER_DB_BLUEJAY.analytics.moving_averages
),

deduped as (
  select
    symbol,
    trade_date,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    row_number() over(
      partition by symbol, trade_date
      order by trade_date desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m08:48:20.280911 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.167 seconds
[0m08:48:20.288281 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:20.289555 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m08:48:20.377083 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m08:48:20.378687 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:20.398347 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:20.400103 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
BEGIN
[0m08:48:20.515524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m08:48:20.516874 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m08:48:20.517952 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m09:13:44.951370 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: None
[0m09:13:44.953149 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m09:13:44.954466 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: Close
[0m09:13:45.128812 [debug] [Thread-1 (]: Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_stock_project/snapshots/snapshot_moving_average.sql
[0m09:13:45.131883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb340eb470>]}
[0m09:13:45.133648 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshots.snapshot_moving_averages ................... [[31mERROR[0m in 1529.70s]
[0m09:13:45.134895 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:13:45.136029 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:13:45.137947 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.snapshot_rsi ................................... [RUN]
[0m09:13:45.138968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_moving_averages, now snapshot.dbt_stock_project.snapshot_rsi)
[0m09:13:45.139674 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_rsi
[0m09:13:45.146269 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_rsi
[0m09:13:45.152195 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:45.153668 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        select rsi_14d from (
                


with base as (
  select
    symbol,
    trade_date,
    rsi_14d
  from USER_DB_BLUEJAY.analytics.rsi
),

deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over(
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  rsi_14d
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:13:45.154963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:45.842668 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.688 seconds
[0m09:13:45.847450 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:45.848709 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:13:45.979640 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.130 seconds
[0m09:13:45.986470 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:45.987786 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:13:46.120937 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.132 seconds
[0m09:13:46.128398 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:46.129592 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with base as (
  select
    symbol,
    trade_date,
    rsi_14d
  from USER_DB_BLUEJAY.analytics.rsi
),

deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over(
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  rsi_14d
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:13:49.286550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.155 seconds
[0m09:13:49.290654 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:49.291562 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
[0m09:13:49.427041 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.134 seconds
[0m09:13:49.433597 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:49.434996 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:13:49.521117 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.085 seconds
[0m09:13:49.526292 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:49.527546 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
[0m09:13:49.632500 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.102 seconds
[0m09:13:49.638014 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:49.639132 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:13:49.767057 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.127 seconds
[0m09:13:49.772290 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:49.773169 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
[0m09:13:49.869933 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.096 seconds
[0m09:13:49.875146 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:49.876170 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        


with base as (
  select
    symbol,
    trade_date,
    rsi_14d
  from USER_DB_BLUEJAY.analytics.rsi
),

deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over(
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  rsi_14d
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        ['symbol', 'trade_date'] as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m09:13:50.047253 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.170 seconds
[0m09:13:50.049741 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:50.050913 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:13:50.134603 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m09:13:50.136104 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:50.149502 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:50.150331 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
BEGIN
[0m09:13:50.279605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m09:13:50.280995 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:13:50.282313 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m09:27:31.239445 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: None
[0m09:27:31.242517 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m09:27:31.245606 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: Close
[0m09:27:31.410886 [debug] [Thread-1 (]: Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_stock_project/snapshots/snapshot_rsi.sql
[0m09:27:31.413169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb340bf020>]}
[0m09:27:31.416309 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshots.snapshot_rsi ............................... [[31mERROR[0m in 826.27s]
[0m09:27:31.418341 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:27:31.420079 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:27:31.422118 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.snapshot_stock_indicators ...................... [RUN]
[0m09:27:31.423560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_rsi, now snapshot.dbt_stock_project.snapshot_stock_indicators)
[0m09:27:31.424896 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:27:31.434110 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:27:31.447127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_stock_indicators"
[0m09:27:31.448858 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


-- Use the cleaned-up and final version of your model here
SELECT
  symbol,
  trade_date,
  rsi_14d,
  moving_avg_7,
  daily_change
FROM USER_DB_BLUEJAY.analytics.stock_indicators

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:27:31.450137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:31.977106 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe677-0205-0c96-0004-59ff002f81e2
[0m09:27:31.978975 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 2
invalid identifier 'RSI_14D'
[0m09:27:31.981015 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: Close
[0m09:27:32.133929 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 24 at position 2
  invalid identifier 'RSI_14D'
[0m09:27:32.135315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb340c19a0>]}
[0m09:27:32.136916 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshots.snapshot_stock_indicators .................. [[31mERROR[0m in 0.71s]
[0m09:27:32.138409 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:27:32.139729 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:27:32.140975 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.snapshot_volume_summary ........................ [RUN]
[0m09:27:32.142285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_stock_indicators, now snapshot.dbt_stock_project.snapshot_volume_summary)
[0m09:27:32.143420 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:27:32.148211 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:27:32.153418 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m09:27:32.154782 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


with base as (
  select
    symbol,
    trade_date,
    weekly_volume
  from USER_DB_BLUEJAY.analytics.volume_summary
),

deduped as (
  select
    symbol,
    trade_date,
    weekly_volume,
    row_number() over(
      partition by symbol, trade_date
      order by weekly_volume desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  weekly_volume
from deduped
where rn = 1

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:27:32.156173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:27:32.837082 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.681 seconds
[0m09:27:32.839123 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m09:27:32.840204 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m09:27:32.948608 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.107 seconds
[0m09:27:32.951523 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m09:27:32.984512 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m09:27:32.986089 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.snapshots.snapshot_volume_summary
         as
        (
    

    select *,
        md5(coalesce(cast(['symbol', 'trade_date'] as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


with base as (
  select
    symbol,
    trade_date,
    weekly_volume
  from USER_DB_BLUEJAY.analytics.volume_summary
),

deduped as (
  select
    symbol,
    trade_date,
    weekly_volume,
    row_number() over(
      partition by symbol, trade_date
      order by weekly_volume desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  weekly_volume
from deduped
where rn = 1

    ) sbq



        );
[0m09:27:33.700919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m09:27:33.753663 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: Close
[0m09:27:33.933211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18be1295-cc6d-4b9b-9c70-55afeac98185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2dfa2b70>]}
[0m09:27:33.935587 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshots.snapshot_volume_summary ........................ [[32mSUCCESS 1[0m in 1.79s]
[0m09:27:33.937360 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:27:33.945184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:33.946480 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.snapshot_volume_summary' was properly closed.
[0m09:27:33.948157 [info ] [MainThread]: 
[0m09:27:33.949451 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 39 minutes and 20.70 seconds (2360.70s).
[0m09:27:33.951605 [debug] [MainThread]: Command end result
[0m09:27:34.083911 [info ] [MainThread]: 
[0m09:27:34.085621 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:27:34.086764 [info ] [MainThread]: 
[0m09:27:34.088283 [error] [MainThread]:   Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_stock_project/snapshots/snapshot_moving_average.sql
[0m09:27:34.089551 [info ] [MainThread]: 
[0m09:27:34.090682 [error] [MainThread]:   Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/dbt_stock_project/snapshots/snapshot_rsi.sql
[0m09:27:34.091827 [info ] [MainThread]: 
[0m09:27:34.093127 [error] [MainThread]:   Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 24 at position 2
  invalid identifier 'RSI_14D'
[0m09:27:34.094389 [info ] [MainThread]: 
[0m09:27:34.095897 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m09:27:34.107084 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 2363.1663, "process_user_time": 4.500493, "process_kernel_time": 1.877689, "process_mem_max_rss": "232060", "process_in_blocks": "528", "process_out_blocks": "8", "command_success": false}
[0m09:27:34.110346 [debug] [MainThread]: Command `dbt snapshot` failed at 09:27:34.110135 after 2363.17 seconds
[0m09:27:34.112740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6683fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb66866b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb340c95e0>]}
[0m09:27:34.114069 [debug] [MainThread]: Flushing usage events
[0m09:38:38.142890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dbf77e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dc03f7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dbfb2cb60>]}


============================== 09:38:38.151572 | cf8ebb84-a9ca-4d28-9d54-f94402b33242 ==============================
[0m09:38:38.151572 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:38:38.152764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:38:39.780871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dbfc029c0>]}
[0m09:38:39.827495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8cda5220>]}
[0m09:38:39.829833 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m09:38:39.917761 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:38:40.498431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:38:40.499981 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_rsi.sql
[0m09:38:40.501087 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_volume _summary.sql
[0m09:38:40.501996 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_moving_average.sql
[0m09:38:40.503105 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_stock_indicators.sql
[0m09:38:40.813839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c533890>]}
[0m09:38:41.033825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c5139b0>]}
[0m09:38:41.034993 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m09:38:41.036017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c4abb00>]}
[0m09:38:41.038821 [info ] [MainThread]: 
[0m09:38:41.040138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:38:41.046366 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m09:38:41.060480 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m09:38:41.061667 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m09:38:41.062938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:41.815587 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.753 seconds
[0m09:38:41.818827 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m09:38:42.000387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_snapshots)
[0m09:38:42.010695 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m09:38:42.012079 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m09:38:42.013501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:42.521047 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.507 seconds
[0m09:38:42.523215 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m09:38:42.689707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m09:38:42.693334 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m09:38:42.694395 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m09:38:42.695119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:43.068402 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.373 seconds
[0m09:38:43.072586 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m09:38:43.254202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dbf6c19a0>]}
[0m09:38:43.255347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:38:43.256250 [info ] [MainThread]: 
[0m09:38:43.266032 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:38:43.267056 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.snapshot_moving_averages ....................... [RUN]
[0m09:38:43.268195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now snapshot.dbt_stock_project.snapshot_moving_averages)
[0m09:38:43.268839 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:38:43.277805 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:38:43.343050 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:38:43.344539 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select moving_avg_7 from (
                


with deduped as (
  select
    symbol,
    trade_date,
    moving_avg_7,
    row_number() over (
      partition by symbol, trade_date
      order by moving_avg_7 desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.moving_averages
)

select
  symbol,
  trade_date,
  moving_avg_7,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:38:43.345952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:43.719795 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe682-0205-0bba-0004-59ff002f711e
[0m09:38:43.721008 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'MOVING_AVG_7'
[0m09:38:43.722380 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: Close
[0m09:38:43.897176 [debug] [Thread-1 (]: Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'MOVING_AVG_7'
[0m09:38:43.899640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c349010>]}
[0m09:38:43.901102 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshots.snapshot_moving_averages ................... [[31mERROR[0m in 0.63s]
[0m09:38:43.902512 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:38:43.903662 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:38:43.905318 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.snapshot_rsi ................................... [RUN]
[0m09:38:43.906404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_moving_averages, now snapshot.dbt_stock_project.snapshot_rsi)
[0m09:38:43.907106 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_rsi
[0m09:38:43.912095 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_rsi
[0m09:38:43.918961 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:38:43.920122 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        select rsi_14d from (
                


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:38:43.921426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:44.836442 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.915 seconds
[0m09:38:44.847192 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:38:44.848536 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:38:44.951952 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.102 seconds
[0m09:38:44.961926 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:38:44.963034 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:38:45.088284 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.124 seconds
[0m09:38:45.134612 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:38:45.135652 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:38:45.333858 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe682-0205-0f94-0004-59ff002f47a2
[0m09:38:45.335741 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 37 at position 8
invalid identifier 'STOCK_ID'
[0m09:38:45.337528 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: Close
[0m09:38:45.653161 [debug] [Thread-1 (]: Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:38:45.654375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c0491c0>]}
[0m09:38:45.655826 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshots.snapshot_rsi ............................... [[31mERROR[0m in 1.75s]
[0m09:38:45.657069 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:38:45.658223 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:38:45.659285 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.snapshot_stock_indicators ...................... [RUN]
[0m09:38:45.660397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_rsi, now snapshot.dbt_stock_project.snapshot_stock_indicators)
[0m09:38:45.661401 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:38:45.665869 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:38:45.683149 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_stock_indicators"
[0m09:38:45.684471 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from (
  select
    symbol,
    trade_date,
    max(rsi_14d) as rsi_14d
  from USER_DB_BLUEJAY.analytics.stock_indicators
  group by 1, 2
)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:38:45.685601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:46.178499 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe682-0205-0fb8-0004-59ff002f37b2
[0m09:38:46.179492 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'RSI_14D'
[0m09:38:46.180644 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: Close
[0m09:38:46.343112 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:38:46.344413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d85f44f20>]}
[0m09:38:46.345756 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshots.snapshot_stock_indicators .................. [[31mERROR[0m in 0.68s]
[0m09:38:46.346927 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:38:46.348152 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:38:46.349412 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.snapshot_volume_summary ........................ [RUN]
[0m09:38:46.350470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_stock_indicators, now snapshot.dbt_stock_project.snapshot_volume_summary)
[0m09:38:46.351397 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:38:46.355330 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:38:46.359218 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m09:38:46.360406 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
select * from (
        select total_volume from (
                


with base as (
  select
    symbol,
    trade_date,
    total_volume
  from USER_DB_BLUEJAY.analytics.volume_summary
),

deduped as (
  select
    *,
    row_number() over (
      partition by symbol, trade_date
      order by total_volume desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  total_volume,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:38:46.361512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:46.769211 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe682-0205-0c96-0004-59ff002f82d2
[0m09:38:46.770486 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'TOTAL_VOLUME'
[0m09:38:46.772090 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: Close
[0m09:38:46.941541 [debug] [Thread-1 (]: Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:38:46.943176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ebb84-a9ca-4d28-9d54-f94402b33242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c22e000>]}
[0m09:38:46.945171 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshots.snapshot_volume_summary .................... [[31mERROR[0m in 0.59s]
[0m09:38:46.947221 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:38:46.950082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:46.951333 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.snapshot_volume_summary' was properly closed.
[0m09:38:46.952467 [info ] [MainThread]: 
[0m09:38:46.953384 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 5.91 seconds (5.91s).
[0m09:38:46.954842 [debug] [MainThread]: Command end result
[0m09:38:47.058525 [info ] [MainThread]: 
[0m09:38:47.059628 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:38:47.060402 [info ] [MainThread]: 
[0m09:38:47.061217 [error] [MainThread]:   Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'MOVING_AVG_7'
[0m09:38:47.061946 [info ] [MainThread]: 
[0m09:38:47.063066 [error] [MainThread]:   Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:38:47.064740 [info ] [MainThread]: 
[0m09:38:47.066097 [error] [MainThread]:   Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:38:47.066884 [info ] [MainThread]: 
[0m09:38:47.067683 [error] [MainThread]:   Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:38:47.068410 [info ] [MainThread]: 
[0m09:38:47.069257 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m09:38:47.071400 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 9.024187, "process_user_time": 4.249633, "process_kernel_time": 2.183792, "process_mem_max_rss": "246048", "process_in_blocks": "130088", "process_out_blocks": "8", "command_success": false}
[0m09:38:47.072452 [debug] [MainThread]: Command `dbt snapshot` failed at 09:38:47.072303 after 9.03 seconds
[0m09:38:47.073366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dbf77e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dbf30d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d8c25a0c0>]}
[0m09:38:47.074428 [debug] [MainThread]: Flushing usage events
[0m09:41:11.297881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86820563f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868299e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868245cb60>]}


============================== 09:41:11.307584 | cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea ==============================
[0m09:41:11.307584 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:41:11.308692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:41:12.897070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86509512b0>]}
[0m09:41:12.942886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8650524cb0>]}
[0m09:41:12.945701 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m09:41:13.029311 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:41:13.526265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:41:13.528041 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_moving_average.sql
[0m09:41:13.782343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864befcfb0>]}
[0m09:41:13.995926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864befd9d0>]}
[0m09:41:13.997662 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m09:41:13.998777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864bd8b590>]}
[0m09:41:14.002019 [info ] [MainThread]: 
[0m09:41:14.003203 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:41:14.008782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m09:41:14.021653 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m09:41:14.023152 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m09:41:14.024452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:14.730219 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.706 seconds
[0m09:41:14.734138 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m09:41:14.919606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m09:41:14.931316 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m09:41:14.932464 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m09:41:14.933506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:15.420250 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.487 seconds
[0m09:41:15.422815 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m09:41:15.576213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m09:41:15.582977 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m09:41:15.584124 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m09:41:15.585154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:16.046045 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.461 seconds
[0m09:41:16.048284 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m09:41:16.215619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8650466c60>]}
[0m09:41:16.217668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:41:16.219089 [info ] [MainThread]: 
[0m09:41:16.232922 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:41:16.234179 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.snapshot_moving_averages ....................... [RUN]
[0m09:41:16.235215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now snapshot.dbt_stock_project.snapshot_moving_averages)
[0m09:41:16.236188 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:41:16.244016 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:41:16.303452 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:41:16.304928 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                


with deduped as (
  select
    symbol,
    trade_date,
    close,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    stock_id,
    row_number() over (
      partition by stock_id
      order by close_price_30d_ma desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.moving_averages
)

select
  symbol,
  trade_date,
  close,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma,
  stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:41:16.306309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:16.959934 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.654 seconds
[0m09:41:16.971092 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:41:16.972461 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m09:41:17.081079 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.108 seconds
[0m09:41:17.091096 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:41:17.092181 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m09:41:17.204803 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.111 seconds
[0m09:41:17.266193 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:41:17.267555 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with deduped as (
  select
    symbol,
    trade_date,
    close,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    stock_id,
    row_number() over (
      partition by stock_id
      order by close_price_30d_ma desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.moving_averages
)

select
  symbol,
  trade_date,
  close,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma,
  stock_id
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:41:17.444876 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe685-0205-0f94-0004-59ff002f47aa
[0m09:41:17.445860 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 44 at position 8
invalid identifier 'STOCK_ID'
[0m09:41:17.447118 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: Close
[0m09:41:17.597837 [debug] [Thread-1 (]: Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 44 at position 8
  invalid identifier 'STOCK_ID'
[0m09:41:17.600353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864bdaf140>]}
[0m09:41:17.602016 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshots.snapshot_moving_averages ................... [[31mERROR[0m in 1.36s]
[0m09:41:17.603135 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:41:17.603998 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:41:17.605384 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.snapshot_rsi ................................... [RUN]
[0m09:41:17.606239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_moving_averages, now snapshot.dbt_stock_project.snapshot_rsi)
[0m09:41:17.607077 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_rsi
[0m09:41:17.611493 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_rsi
[0m09:41:17.618350 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:41:17.619537 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        select rsi_14d from (
                


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:41:17.620388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:18.058765 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.438 seconds
[0m09:41:18.063799 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:41:18.065073 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:41:18.165997 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.099 seconds
[0m09:41:18.172981 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:41:18.173840 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:41:18.278570 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.104 seconds
[0m09:41:18.285106 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:41:18.286435 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:41:18.447695 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe685-0205-0fb8-0004-59ff002f37d2
[0m09:41:18.450021 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 37 at position 8
invalid identifier 'STOCK_ID'
[0m09:41:18.451521 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: Close
[0m09:41:18.619628 [debug] [Thread-1 (]: Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:41:18.620889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864b271610>]}
[0m09:41:18.622346 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshots.snapshot_rsi ............................... [[31mERROR[0m in 1.01s]
[0m09:41:18.623655 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:41:18.624736 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:41:18.625908 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.snapshot_stock_indicators ...................... [RUN]
[0m09:41:18.627202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_rsi, now snapshot.dbt_stock_project.snapshot_stock_indicators)
[0m09:41:18.628512 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:41:18.633847 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:41:18.653165 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_stock_indicators"
[0m09:41:18.654307 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from (
  select
    symbol,
    trade_date,
    max(rsi_14d) as rsi_14d
  from USER_DB_BLUEJAY.analytics.stock_indicators
  group by 1, 2
)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:41:18.655494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:19.128634 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe685-0205-0fb8-0004-59ff002f37d6
[0m09:41:19.129738 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'RSI_14D'
[0m09:41:19.130830 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: Close
[0m09:41:19.285379 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:41:19.286399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864b342480>]}
[0m09:41:19.287609 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshots.snapshot_stock_indicators .................. [[31mERROR[0m in 0.66s]
[0m09:41:19.288708 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:41:19.289584 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:41:19.290542 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.snapshot_volume_summary ........................ [RUN]
[0m09:41:19.291481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_stock_indicators, now snapshot.dbt_stock_project.snapshot_volume_summary)
[0m09:41:19.292238 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:41:19.296359 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:41:19.301496 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m09:41:19.302436 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
select * from (
        select total_volume from (
                


with base as (
  select
    symbol,
    trade_date,
    total_volume
  from USER_DB_BLUEJAY.analytics.volume_summary
),

deduped as (
  select
    *,
    row_number() over (
      partition by symbol, trade_date
      order by total_volume desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  total_volume,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:41:19.303197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:19.692958 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe685-0205-0fb8-0004-59ff002f37da
[0m09:41:19.694087 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'TOTAL_VOLUME'
[0m09:41:19.695819 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: Close
[0m09:41:19.857228 [debug] [Thread-1 (]: Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:41:19.858439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbd47fbb-3efc-40aa-9d12-b83b8f24d7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864b3ef260>]}
[0m09:41:19.859710 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshots.snapshot_volume_summary .................... [[31mERROR[0m in 0.57s]
[0m09:41:19.860858 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:41:19.864021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:19.865336 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.snapshot_volume_summary' was properly closed.
[0m09:41:19.866480 [info ] [MainThread]: 
[0m09:41:19.867653 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m09:41:19.869181 [debug] [MainThread]: Command end result
[0m09:41:19.978169 [info ] [MainThread]: 
[0m09:41:19.979510 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:41:19.980537 [info ] [MainThread]: 
[0m09:41:19.981761 [error] [MainThread]:   Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 44 at position 8
  invalid identifier 'STOCK_ID'
[0m09:41:19.982604 [info ] [MainThread]: 
[0m09:41:19.983458 [error] [MainThread]:   Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:41:19.984108 [info ] [MainThread]: 
[0m09:41:19.985055 [error] [MainThread]:   Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:41:19.985777 [info ] [MainThread]: 
[0m09:41:19.986592 [error] [MainThread]:   Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:41:19.987348 [info ] [MainThread]: 
[0m09:41:19.988315 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m09:41:19.990566 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 8.778158, "process_user_time": 4.086902, "process_kernel_time": 2.063584, "process_mem_max_rss": "235208", "process_in_blocks": "128728", "process_out_blocks": "8", "command_success": false}
[0m09:41:19.991578 [debug] [MainThread]: Command `dbt snapshot` failed at 09:41:19.991460 after 8.78 seconds
[0m09:41:19.992515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8682b3f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86824eaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864b375580>]}
[0m09:41:19.993364 [debug] [MainThread]: Flushing usage events
[0m09:43:26.491872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4675be6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467865bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4675be60c0>]}


============================== 09:43:26.499113 | aa2e5077-7440-4aee-8585-f4493c1de6e0 ==============================
[0m09:43:26.499113 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:43:26.500420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:43:27.422627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46465e55e0>]}
[0m09:43:27.488470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467663ade0>]}
[0m09:43:27.490292 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m09:43:27.579170 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:43:28.052961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:43:28.054531 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_moving_average.sql
[0m09:43:28.306409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463f8e5310>]}
[0m09:43:28.502076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463f8e5d30>]}
[0m09:43:28.503082 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m09:43:28.503901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463fa2cd10>]}
[0m09:43:28.506650 [info ] [MainThread]: 
[0m09:43:28.507708 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:43:28.512634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m09:43:28.527934 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m09:43:28.528871 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m09:43:28.529445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:29.295924 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.766 seconds
[0m09:43:29.298632 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m09:43:29.481302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m09:43:29.491137 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m09:43:29.492140 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m09:43:29.493067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:30.107068 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.614 seconds
[0m09:43:30.110716 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m09:43:30.261949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m09:43:30.267502 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m09:43:30.268494 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m09:43:30.269504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:30.702736 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.433 seconds
[0m09:43:30.705142 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m09:43:30.857804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463f95c920>]}
[0m09:43:30.859800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:43:30.861634 [info ] [MainThread]: 
[0m09:43:30.870367 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:43:30.871801 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.snapshot_moving_averages ....................... [RUN]
[0m09:43:30.873018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now snapshot.dbt_stock_project.snapshot_moving_averages)
[0m09:43:30.874104 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:43:30.884493 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:43:30.958594 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:43:30.959819 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                


with deduped as (
  select
    symbol,
    trade_date,
    close,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    CONCAT(symbol, '_', trade_date) AS stock_id,
    row_number() over (
      partition by symbol, trade_date
      order by close_price_30d_ma desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.moving_averages
)

select
  symbol,
  trade_date,
  close,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma,
  stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:43:30.961147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:31.473897 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.513 seconds
[0m09:43:31.484208 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:43:31.485393 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m09:43:31.585790 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.099 seconds
[0m09:43:31.596997 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:43:31.598133 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m09:43:31.694492 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.095 seconds
[0m09:43:31.734189 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:43:31.735649 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with deduped as (
  select
    symbol,
    trade_date,
    close,
    close_price_7d_ma,
    close_price_14d_ma,
    close_price_30d_ma,
    CONCAT(symbol, '_', trade_date) AS stock_id,
    row_number() over (
      partition by symbol, trade_date
      order by close_price_30d_ma desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.moving_averages
)

select
  symbol,
  trade_date,
  close,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma,
  stock_id
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:43:31.920981 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe687-0205-0f94-0004-59ff002f47b2
[0m09:43:31.922132 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 44 at position 8
invalid identifier 'STOCK_ID'
[0m09:43:31.923250 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: Close
[0m09:43:32.083888 [debug] [Thread-1 (]: Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 44 at position 8
  invalid identifier 'STOCK_ID'
[0m09:43:32.085986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463edcc9b0>]}
[0m09:43:32.087427 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshots.snapshot_moving_averages ................... [[31mERROR[0m in 1.21s]
[0m09:43:32.088451 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:43:32.089320 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:43:32.090752 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.snapshot_rsi ................................... [RUN]
[0m09:43:32.091921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_moving_averages, now snapshot.dbt_stock_project.snapshot_rsi)
[0m09:43:32.092796 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_rsi
[0m09:43:32.097735 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_rsi
[0m09:43:32.103698 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:43:32.104746 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        select rsi_14d from (
                


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:43:32.105849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:32.565893 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.460 seconds
[0m09:43:32.573140 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:43:32.574630 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:43:32.700436 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.124 seconds
[0m09:43:32.707666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:43:32.708831 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:43:32.817080 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.107 seconds
[0m09:43:32.823986 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:43:32.825276 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:43:32.974000 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe687-0205-0c96-0004-59ff002f82ea
[0m09:43:32.975583 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 37 at position 8
invalid identifier 'STOCK_ID'
[0m09:43:32.976879 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: Close
[0m09:43:33.122868 [debug] [Thread-1 (]: Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:43:33.124153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463ee407d0>]}
[0m09:43:33.126099 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshots.snapshot_rsi ............................... [[31mERROR[0m in 1.03s]
[0m09:43:33.128392 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:43:33.129981 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:43:33.131804 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.snapshot_stock_indicators ...................... [RUN]
[0m09:43:33.133597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_rsi, now snapshot.dbt_stock_project.snapshot_stock_indicators)
[0m09:43:33.134925 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:43:33.140324 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:43:33.162679 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_stock_indicators"
[0m09:43:33.164115 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from (
  select
    symbol,
    trade_date,
    max(rsi_14d) as rsi_14d
  from USER_DB_BLUEJAY.analytics.stock_indicators
  group by 1, 2
)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:43:33.165232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:33.551263 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe687-0205-0c96-0004-59ff002f82ee
[0m09:43:33.552591 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'RSI_14D'
[0m09:43:33.553928 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: Close
[0m09:43:33.718419 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:43:33.719550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463ed80b30>]}
[0m09:43:33.720854 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshots.snapshot_stock_indicators .................. [[31mERROR[0m in 0.59s]
[0m09:43:33.721958 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:43:33.722773 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:43:33.724022 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.snapshot_volume_summary ........................ [RUN]
[0m09:43:33.725298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_stock_indicators, now snapshot.dbt_stock_project.snapshot_volume_summary)
[0m09:43:33.726239 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:43:33.730270 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:43:33.734635 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m09:43:33.735647 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
select * from (
        select total_volume from (
                


with base as (
  select
    symbol,
    trade_date,
    total_volume
  from USER_DB_BLUEJAY.analytics.volume_summary
),

deduped as (
  select
    *,
    row_number() over (
      partition by symbol, trade_date
      order by total_volume desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  total_volume,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:43:33.736625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:34.208847 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe687-0205-0bba-0004-59ff002f7142
[0m09:43:34.210213 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'TOTAL_VOLUME'
[0m09:43:34.211384 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: Close
[0m09:43:34.363148 [debug] [Thread-1 (]: Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:43:34.364629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2e5077-7440-4aee-8585-f4493c1de6e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463fca5460>]}
[0m09:43:34.366305 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshots.snapshot_volume_summary .................... [[31mERROR[0m in 0.64s]
[0m09:43:34.367860 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:43:34.370823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:34.371837 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.snapshot_volume_summary' was properly closed.
[0m09:43:34.372869 [info ] [MainThread]: 
[0m09:43:34.373809 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m09:43:34.375561 [debug] [MainThread]: Command end result
[0m09:43:34.472989 [info ] [MainThread]: 
[0m09:43:34.474345 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:43:34.475570 [info ] [MainThread]: 
[0m09:43:34.476545 [error] [MainThread]:   Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 44 at position 8
  invalid identifier 'STOCK_ID'
[0m09:43:34.477304 [info ] [MainThread]: 
[0m09:43:34.478162 [error] [MainThread]:   Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:43:34.478857 [info ] [MainThread]: 
[0m09:43:34.479765 [error] [MainThread]:   Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:43:34.480620 [info ] [MainThread]: 
[0m09:43:34.481456 [error] [MainThread]:   Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:43:34.482470 [info ] [MainThread]: 
[0m09:43:34.483481 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m09:43:34.485141 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 8.084566, "process_user_time": 3.80973, "process_kernel_time": 1.844711, "process_mem_max_rss": "237952", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:43:34.486206 [debug] [MainThread]: Command `dbt snapshot` failed at 09:43:34.486020 after 8.09 seconds
[0m09:43:34.487036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f467865bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4675e79df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463edabad0>]}
[0m09:43:34.487808 [debug] [MainThread]: Flushing usage events
[0m09:47:55.298608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a675c4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6866f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a66d99460>]}


============================== 09:47:55.306568 | 60fa7758-3844-4193-afb0-4825655d2e3a ==============================
[0m09:47:55.306568 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:47:55.307771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:47:56.197810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a352533e0>]}
[0m09:47:56.255005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a66d663c0>]}
[0m09:47:56.256673 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m09:47:56.341400 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:47:56.859438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:47:56.860858 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_moving_average.sql
[0m09:47:57.125973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a34c3bfb0>]}
[0m09:47:57.310716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a34a99e20>]}
[0m09:47:57.311948 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m09:47:57.313149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a34acb800>]}
[0m09:47:57.315737 [info ] [MainThread]: 
[0m09:47:57.317277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:47:57.325830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m09:47:57.340320 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m09:47:57.341538 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m09:47:57.342841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:58.033765 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.691 seconds
[0m09:47:58.036940 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m09:47:58.189599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m09:47:58.199542 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m09:47:58.200644 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m09:47:58.201594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:58.691604 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.490 seconds
[0m09:47:58.696463 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m09:47:58.924158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m09:47:58.929377 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m09:47:58.930387 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m09:47:58.931243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:59.334648 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.403 seconds
[0m09:47:59.337124 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m09:47:59.498489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a349a77a0>]}
[0m09:47:59.500429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:47:59.502003 [info ] [MainThread]: 
[0m09:47:59.513455 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:47:59.514830 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.snapshot_moving_averages ....................... [RUN]
[0m09:47:59.515855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now snapshot.dbt_stock_project.snapshot_moving_averages)
[0m09:47:59.516670 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:47:59.526949 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:47:59.594507 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:47:59.596029 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                


SELECT
  symbol,
  trade_date,
  close,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma,
  stock_id  -- ✅ must match the name created in moving_averages.sql
FROM USER_DB_BLUEJAY.analytics.moving_averages

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:47:59.597284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:59.981073 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.384 seconds
[0m09:47:59.992506 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:47:59.993768 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m09:48:00.114385 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.119 seconds
[0m09:48:00.123862 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:48:00.125054 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m09:48:00.219230 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.093 seconds
[0m09:48:00.268597 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:48:00.270299 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        


SELECT
  symbol,
  trade_date,
  close,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma,
  stock_id  -- ✅ must match the name created in moving_averages.sql
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:48:00.435126 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe68c-0205-0bb1-0004-59ff002f5546
[0m09:48:00.436514 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 8
invalid identifier 'STOCK_ID'
[0m09:48:00.437778 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: Close
[0m09:48:00.583699 [debug] [Thread-1 (]: Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'STOCK_ID'
[0m09:48:00.586131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a67599820>]}
[0m09:48:00.587795 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshots.snapshot_moving_averages ................... [[31mERROR[0m in 1.07s]
[0m09:48:00.589537 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:48:00.590968 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:48:00.593335 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.snapshot_rsi ................................... [RUN]
[0m09:48:00.594694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_moving_averages, now snapshot.dbt_stock_project.snapshot_rsi)
[0m09:48:00.595769 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_rsi
[0m09:48:00.601603 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_rsi
[0m09:48:00.608118 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:48:00.609201 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        select rsi_14d from (
                


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:48:00.610168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:01.072756 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.463 seconds
[0m09:48:01.076717 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:48:01.077729 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:48:01.293024 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.214 seconds
[0m09:48:01.298400 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:48:01.299776 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:48:01.414758 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.114 seconds
[0m09:48:01.421797 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:48:01.422989 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:48:01.576011 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe68c-0205-0f94-0004-59ff002f4932
[0m09:48:01.577872 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 37 at position 8
invalid identifier 'STOCK_ID'
[0m09:48:01.579686 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: Close
[0m09:48:01.722792 [debug] [Thread-1 (]: Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:48:01.723869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2ffc29c0>]}
[0m09:48:01.725210 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshots.snapshot_rsi ............................... [[31mERROR[0m in 1.13s]
[0m09:48:01.726913 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:48:01.728171 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:48:01.729707 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.snapshot_stock_indicators ...................... [RUN]
[0m09:48:01.731061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_rsi, now snapshot.dbt_stock_project.snapshot_stock_indicators)
[0m09:48:01.731997 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:48:01.737462 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:48:01.759065 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_stock_indicators"
[0m09:48:01.760397 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from (
  select
    symbol,
    trade_date,
    max(rsi_14d) as rsi_14d
  from USER_DB_BLUEJAY.analytics.stock_indicators
  group by 1, 2
)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:48:01.761493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:02.136284 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe68c-0205-0c96-0004-59ff002f8466
[0m09:48:02.137451 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'RSI_14D'
[0m09:48:02.138828 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: Close
[0m09:48:02.290804 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:48:02.292206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a66997410>]}
[0m09:48:02.293880 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshots.snapshot_stock_indicators .................. [[31mERROR[0m in 0.56s]
[0m09:48:02.295294 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:48:02.296644 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:48:02.298165 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.snapshot_volume_summary ........................ [RUN]
[0m09:48:02.299685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_stock_indicators, now snapshot.dbt_stock_project.snapshot_volume_summary)
[0m09:48:02.300813 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:48:02.304671 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:48:02.309257 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m09:48:02.310633 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
select * from (
        select total_volume from (
                


with base as (
  select
    symbol,
    trade_date,
    total_volume
  from USER_DB_BLUEJAY.analytics.volume_summary
),

deduped as (
  select
    *,
    row_number() over (
      partition by symbol, trade_date
      order by total_volume desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  total_volume,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:48:02.311885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:02.803546 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe68c-0205-0bba-0004-59ff002f72ce
[0m09:48:02.804823 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'TOTAL_VOLUME'
[0m09:48:02.805862 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: Close
[0m09:48:03.297838 [debug] [Thread-1 (]: Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:48:03.298981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60fa7758-3844-4193-afb0-4825655d2e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a34137980>]}
[0m09:48:03.300262 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshots.snapshot_volume_summary .................... [[31mERROR[0m in 1.00s]
[0m09:48:03.301822 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:48:03.304449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:03.305597 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.snapshot_volume_summary' was properly closed.
[0m09:48:03.306596 [info ] [MainThread]: 
[0m09:48:03.307436 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m09:48:03.308854 [debug] [MainThread]: Command end result
[0m09:48:03.419897 [info ] [MainThread]: 
[0m09:48:03.421349 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:48:03.422516 [info ] [MainThread]: 
[0m09:48:03.423636 [error] [MainThread]:   Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 27 at position 8
  invalid identifier 'STOCK_ID'
[0m09:48:03.424651 [info ] [MainThread]: 
[0m09:48:03.425759 [error] [MainThread]:   Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:48:03.426704 [info ] [MainThread]: 
[0m09:48:03.427598 [error] [MainThread]:   Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:48:03.428476 [info ] [MainThread]: 
[0m09:48:03.429460 [error] [MainThread]:   Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:48:03.430331 [info ] [MainThread]: 
[0m09:48:03.431285 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m09:48:03.432686 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 8.228422, "process_user_time": 3.923742, "process_kernel_time": 2.003931, "process_mem_max_rss": "236108", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:48:03.433649 [debug] [MainThread]: Command `dbt snapshot` failed at 09:48:03.433476 after 8.23 seconds
[0m09:48:03.434884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a675c4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a66d9b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2ff27500>]}
[0m09:48:03.436268 [debug] [MainThread]: Flushing usage events
[0m09:52:11.573999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7648d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e76c09040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e7648da00>]}


============================== 09:52:11.581277 | e803c769-0e27-49ac-91f8-3362e0114fd7 ==============================
[0m09:52:11.581277 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:52:11.582396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m09:52:12.484849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e803c769-0e27-49ac-91f8-3362e0114fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e446bdfd0>]}
[0m09:52:12.530867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e803c769-0e27-49ac-91f8-3362e0114fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e44839f10>]}
[0m09:52:12.532739 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m09:52:12.613998 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:52:13.099749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:13.101239 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_moving_average.sql
[0m09:52:13.234042 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  invalid syntax for function call expression
    line 3
      config(
[0m09:52:13.235553 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.7512016, "process_user_time": 2.967193, "process_kernel_time": 1.911748, "process_mem_max_rss": "226424", "process_in_blocks": "16", "command_success": false, "process_out_blocks": "0"}
[0m09:52:13.236449 [debug] [MainThread]: Command `dbt snapshot` failed at 09:52:13.236335 after 1.75 seconds
[0m09:52:13.237561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e76681760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4c645760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e448b1ca0>]}
[0m09:52:13.238411 [debug] [MainThread]: Flushing usage events
[0m09:54:17.645013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdc8161e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdc706180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bddebef60>]}


============================== 09:54:17.652942 | 6f6837f5-1527-4642-8f50-6841f7c8ca3b ==============================
[0m09:54:17.652942 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:54:17.654005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:54:18.587410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdcf42900>]}
[0m09:54:18.660704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bad3bff80>]}
[0m09:54:18.662579 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m09:54:18.760400 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:54:19.273040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:54:19.274669 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_moving_average.sql
[0m09:54:19.544313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba56dd280>]}
[0m09:54:19.737822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba570a600>]}
[0m09:54:19.738899 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m09:54:19.739780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba5d534a0>]}
[0m09:54:19.742428 [info ] [MainThread]: 
[0m09:54:19.743853 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:54:19.748977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m09:54:19.763539 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m09:54:19.764806 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m09:54:19.766067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:20.432333 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.666 seconds
[0m09:54:20.436430 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m09:54:20.578549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m09:54:20.588454 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m09:54:20.589606 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m09:54:20.590631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:21.018344 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.428 seconds
[0m09:54:21.021748 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m09:54:21.173302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m09:54:21.179923 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m09:54:21.180845 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m09:54:21.181818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:21.675633 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.494 seconds
[0m09:54:21.679380 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m09:54:21.841490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba5dc68d0>]}
[0m09:54:21.842938 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:54:21.843996 [info ] [MainThread]: 
[0m09:54:21.854158 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:54:21.855659 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.snapshot_moving_averages ....................... [RUN]
[0m09:54:21.856867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now snapshot.dbt_stock_project.snapshot_moving_averages)
[0m09:54:21.858127 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:54:21.866701 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:54:21.930086 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:54:21.931093 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                
  
-- ✅ CONFIG BLOCK MUST BE OUTSIDE THE SQL SELECT AND USE 'snapshot' FORMAT


SELECT
  symbol,
  trade_date,
  close,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma,
  CONCAT(symbol, '_', trade_date) AS stock_id  -- composite key defined here

FROM USER_DB_BLUEJAY.analytics.moving_averages

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:54:21.931993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:22.675112 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.743 seconds
[0m09:54:22.686426 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:54:22.687871 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m09:54:22.834390 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.145 seconds
[0m09:54:22.843675 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:54:22.844760 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
[0m09:54:22.984794 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.139 seconds
[0m09:54:23.037263 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_moving_averages"
[0m09:54:23.038668 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_moving_averages"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES__dbt_tmp"
         as
        (

    with snapshot_query as (

        
  
-- ✅ CONFIG BLOCK MUST BE OUTSIDE THE SQL SELECT AND USE 'snapshot' FORMAT


SELECT
  symbol,
  trade_date,
  close,
  close_price_7d_ma,
  close_price_14d_ma,
  close_price_30d_ma,
  CONCAT(symbol, '_', trade_date) AS stock_id  -- composite key defined here

FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_MOVING_AVERAGES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:54:23.172300 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe692-0205-0bb1-0004-59ff002f5576
[0m09:54:23.173457 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 30 at position 8
invalid identifier 'STOCK_ID'
[0m09:54:23.174513 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_moving_averages: Close
[0m09:54:23.343258 [debug] [Thread-1 (]: Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 30 at position 8
  invalid identifier 'STOCK_ID'
[0m09:54:23.345569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba4cef8f0>]}
[0m09:54:23.347454 [error] [Thread-1 (]: 1 of 4 ERROR snapshotting snapshots.snapshot_moving_averages ................... [[31mERROR[0m in 1.49s]
[0m09:54:23.349072 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_moving_averages
[0m09:54:23.350227 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:54:23.352082 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.snapshot_rsi ................................... [RUN]
[0m09:54:23.353353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_moving_averages, now snapshot.dbt_stock_project.snapshot_rsi)
[0m09:54:23.354269 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_rsi
[0m09:54:23.359067 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_rsi
[0m09:54:23.365860 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:54:23.367372 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        select rsi_14d from (
                


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:54:23.368498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:23.749281 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.381 seconds
[0m09:54:23.753387 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:54:23.754950 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:54:23.843577 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.087 seconds
[0m09:54:23.849863 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:54:23.850902 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m09:54:23.943849 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.092 seconds
[0m09:54:23.952070 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m09:54:23.953345 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m09:54:24.120601 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe692-0205-0c96-0004-59ff002f8482
[0m09:54:24.121661 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 37 at position 8
invalid identifier 'STOCK_ID'
[0m09:54:24.122823 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: Close
[0m09:54:24.420664 [debug] [Thread-1 (]: Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:54:24.421789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba4c48ce0>]}
[0m09:54:24.422951 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshots.snapshot_rsi ............................... [[31mERROR[0m in 1.07s]
[0m09:54:24.424119 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_rsi
[0m09:54:24.424971 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:54:24.425893 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.snapshot_stock_indicators ...................... [RUN]
[0m09:54:24.426781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_rsi, now snapshot.dbt_stock_project.snapshot_stock_indicators)
[0m09:54:24.427539 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:54:24.431811 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:54:24.449219 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_stock_indicators"
[0m09:54:24.450797 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from (
  select
    symbol,
    trade_date,
    max(rsi_14d) as rsi_14d
  from USER_DB_BLUEJAY.analytics.stock_indicators
  group by 1, 2
)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m09:54:24.452022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:25.083035 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe692-0205-0c96-0004-59ff002f8486
[0m09:54:25.084551 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'RSI_14D'
[0m09:54:25.086464 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: Close
[0m09:54:25.258059 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:54:25.259416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba4d79dc0>]}
[0m09:54:25.260958 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshots.snapshot_stock_indicators .................. [[31mERROR[0m in 0.83s]
[0m09:54:25.262297 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m09:54:25.263332 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:54:25.264497 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.snapshot_volume_summary ........................ [RUN]
[0m09:54:25.265474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_stock_indicators, now snapshot.dbt_stock_project.snapshot_volume_summary)
[0m09:54:25.266569 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:54:25.270839 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:54:25.275537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m09:54:25.276913 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
select * from (
        select total_volume from (
                


with base as (
  select
    symbol,
    trade_date,
    total_volume
  from USER_DB_BLUEJAY.analytics.volume_summary
),

deduped as (
  select
    *,
    row_number() over (
      partition by symbol, trade_date
      order by total_volume desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  total_volume,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m09:54:25.278268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:25.738264 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe692-0205-0f94-0004-59ff002f496e
[0m09:54:25.739531 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'TOTAL_VOLUME'
[0m09:54:25.741265 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: Close
[0m09:54:25.904768 [debug] [Thread-1 (]: Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:54:25.905951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6837f5-1527-4642-8f50-6841f7c8ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba4d78f80>]}
[0m09:54:25.907320 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshots.snapshot_volume_summary .................... [[31mERROR[0m in 0.64s]
[0m09:54:25.908460 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m09:54:25.910399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:25.911220 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.snapshot_volume_summary' was properly closed.
[0m09:54:25.911976 [info ] [MainThread]: 
[0m09:54:25.912769 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m09:54:25.914216 [debug] [MainThread]: Command end result
[0m09:54:26.008542 [info ] [MainThread]: 
[0m09:54:26.009655 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:54:26.010461 [info ] [MainThread]: 
[0m09:54:26.011257 [error] [MainThread]:   Database Error in snapshot snapshot_moving_averages (snapshots/snapshot_moving_average.sql)
  000904 (42000): SQL compilation error: error line 30 at position 8
  invalid identifier 'STOCK_ID'
[0m09:54:26.011915 [info ] [MainThread]: 
[0m09:54:26.012653 [error] [MainThread]:   Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m09:54:26.013280 [info ] [MainThread]: 
[0m09:54:26.013975 [error] [MainThread]:   Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m09:54:26.014751 [info ] [MainThread]: 
[0m09:54:26.015731 [error] [MainThread]:   Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m09:54:26.016707 [info ] [MainThread]: 
[0m09:54:26.017433 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m09:54:26.018656 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 8.478572, "process_user_time": 4.024821, "process_kernel_time": 1.802158, "process_mem_max_rss": "247948", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:54:26.019437 [debug] [MainThread]: Command `dbt snapshot` failed at 09:54:26.019317 after 8.48 seconds
[0m09:54:26.020178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdbbea030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba587b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bdbc3e210>]}
[0m09:54:26.021153 [debug] [MainThread]: Flushing usage events
[0m09:57:53.799497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f8926690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f6eccaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f7544cb0>]}


============================== 09:57:53.807366 | 6360c9d9-ae43-45b9-89a2-b4e631601451 ==============================
[0m09:57:53.807366 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:57:53.808608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m09:57:54.740025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6360c9d9-ae43-45b9-89a2-b4e631601451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c52b33e0>]}
[0m09:57:54.794741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6360c9d9-ae43-45b9-89a2-b4e631601451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c5478920>]}
[0m09:57:54.796422 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m09:57:54.886541 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:57:55.455131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:57:55.456694 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_moving_average.sql
[0m09:57:55.600632 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot moving_averages_snapshot (snapshots/snapshot_moving_average.sql)
  Encountered unknown tag 'config'.
    line 3
      {% config(
[0m09:57:55.602484 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.8939751, "process_user_time": 3.427855, "process_kernel_time": 1.793645, "process_mem_max_rss": "222596", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:57:55.603608 [debug] [MainThread]: Command `dbt snapshot` failed at 09:57:55.603446 after 1.90 seconds
[0m09:57:55.604569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f8926690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c4dc7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c4c85c40>]}
[0m09:57:55.605641 [debug] [MainThread]: Flushing usage events
[0m10:01:05.474650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653d928530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653d14f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653cba2420>]}


============================== 10:01:05.482206 | 68a0ab10-4fff-414d-9315-a633c9b75cd9 ==============================
[0m10:01:05.482206 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:01:05.483637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:01:06.402705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f650d119760>]}
[0m10:01:06.447930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653d737b60>]}
[0m10:01:06.449691 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:01:06.527530 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:01:07.033347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:01:07.034883 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_moving_average.sql
[0m10:01:07.291771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6506e18bc0>]}
[0m10:01:07.506827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6506d0e6f0>]}
[0m10:01:07.508463 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:01:07.509697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6506e3eed0>]}
[0m10:01:07.512308 [info ] [MainThread]: 
[0m10:01:07.513660 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:01:07.518459 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m10:01:07.531471 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m10:01:07.532749 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m10:01:07.534058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:08.238535 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.704 seconds
[0m10:01:08.241603 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m10:01:08.401337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m10:01:08.412093 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:01:08.413026 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:01:08.413728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:08.982764 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.569 seconds
[0m10:01:08.985423 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:01:09.203926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m10:01:09.210387 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:01:09.211448 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:01:09.212119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:09.713278 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.501 seconds
[0m10:01:09.716378 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:01:09.891483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653e5a7d40>]}
[0m10:01:09.892655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:01:09.893466 [info ] [MainThread]: 
[0m10:01:09.903296 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:01:09.904588 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.moving_averages_snapshot ....................... [RUN]
[0m10:01:09.905829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now snapshot.dbt_stock_project.moving_averages_snapshot)
[0m10:01:09.906642 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:01:09.916130 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:01:10.005014 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:01:10.006151 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m10:01:10.007096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:11.201183 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.194 seconds
[0m10:01:11.208296 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:01:11.209549 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:01:11.302754 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.092 seconds
[0m10:01:11.304443 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:01:11.330958 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:01:11.332138 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
create or replace transient table USER_DB_BLUEJAY.snapshots.moving_averages_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages

    ) sbq



        );
[0m10:01:12.510122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.177 seconds
[0m10:01:12.538563 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: Close
[0m10:01:12.701017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65073724e0>]}
[0m10:01:12.703069 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshots.moving_averages_snapshot ....................... [[32mSUCCESS 1[0m in 2.79s]
[0m10:01:12.704516 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:01:12.705806 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_rsi
[0m10:01:12.707001 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.snapshot_rsi ................................... [RUN]
[0m10:01:12.708375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.moving_averages_snapshot, now snapshot.dbt_stock_project.snapshot_rsi)
[0m10:01:12.709305 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_rsi
[0m10:01:12.713740 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_rsi
[0m10:01:12.721674 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m10:01:12.722815 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
select * from (
        select rsi_14d from (
                


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:01:12.723745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:13.247269 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.523 seconds
[0m10:01:13.260261 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m10:01:13.261817 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m10:01:13.373495 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.110 seconds
[0m10:01:13.379660 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m10:01:13.380634 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
[0m10:01:13.487675 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.106 seconds
[0m10:01:13.519995 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_rsi"
[0m10:01:13.521276 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_rsi"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        


with deduped as (
  select
    symbol,
    trade_date,
    rsi_14d,
    row_number() over (
      partition by symbol, trade_date
      order by rsi_14d desc
    ) as rn
  from USER_DB_BLUEJAY.analytics.rsi
)

select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:01:13.697094 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe699-0205-0bb1-0004-59ff002f559a
[0m10:01:13.698765 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 37 at position 8
invalid identifier 'STOCK_ID'
[0m10:01:13.700398 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_rsi: Close
[0m10:01:13.865878 [debug] [Thread-1 (]: Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m10:01:13.867320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65061a3860>]}
[0m10:01:13.868759 [error] [Thread-1 (]: 2 of 4 ERROR snapshotting snapshots.snapshot_rsi ............................... [[31mERROR[0m in 1.16s]
[0m10:01:13.870088 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_rsi
[0m10:01:13.871387 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m10:01:13.872821 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.snapshot_stock_indicators ...................... [RUN]
[0m10:01:13.873994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_rsi, now snapshot.dbt_stock_project.snapshot_stock_indicators)
[0m10:01:13.875117 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m10:01:13.879053 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m10:01:13.883831 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_stock_indicators"
[0m10:01:13.885111 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_stock_indicators"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        


select
  symbol,
  trade_date,
  rsi_14d,
  concat(symbol, '_', trade_date) as stock_id
from (
  select
    symbol,
    trade_date,
    max(rsi_14d) as rsi_14d
  from USER_DB_BLUEJAY.analytics.stock_indicators
  group by 1, 2
)

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m10:01:13.886335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:14.308524 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe699-0205-0fb8-0004-59ff002f399e
[0m10:01:14.310116 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 8
invalid identifier 'RSI_14D'
[0m10:01:14.311750 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_stock_indicators: Close
[0m10:01:14.481929 [debug] [Thread-1 (]: Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m10:01:14.483178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65048d9b80>]}
[0m10:01:14.484572 [error] [Thread-1 (]: 3 of 4 ERROR snapshotting snapshots.snapshot_stock_indicators .................. [[31mERROR[0m in 0.61s]
[0m10:01:14.485765 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_stock_indicators
[0m10:01:14.487017 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m10:01:14.488144 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.snapshot_volume_summary ........................ [RUN]
[0m10:01:14.489478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.snapshot_stock_indicators, now snapshot.dbt_stock_project.snapshot_volume_summary)
[0m10:01:14.490574 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.snapshot_volume_summary
[0m10:01:14.494804 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.snapshot_volume_summary
[0m10:01:14.499098 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.snapshot_volume_summary"
[0m10:01:14.500264 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.snapshot_volume_summary"} */
select * from (
        select total_volume from (
                


with base as (
  select
    symbol,
    trade_date,
    total_volume
  from USER_DB_BLUEJAY.analytics.volume_summary
),

deduped as (
  select
    *,
    row_number() over (
      partition by symbol, trade_date
      order by total_volume desc
    ) as rn
  from base
)

select
  symbol,
  trade_date,
  total_volume,
  concat(symbol, '_', trade_date) as stock_id
from deduped
where rn = 1

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:01:14.501393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:14.997047 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe699-0205-0f94-0004-59ff002f4982
[0m10:01:14.998106 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'TOTAL_VOLUME'
[0m10:01:14.999344 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.snapshot_volume_summary: Close
[0m10:01:15.191820 [debug] [Thread-1 (]: Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m10:01:15.192887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a0ab10-4fff-414d-9315-a633c9b75cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65048fb740>]}
[0m10:01:15.194633 [error] [Thread-1 (]: 4 of 4 ERROR snapshotting snapshots.snapshot_volume_summary .................... [[31mERROR[0m in 0.70s]
[0m10:01:15.196331 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.snapshot_volume_summary
[0m10:01:15.199196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:15.200206 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.snapshot_volume_summary' was properly closed.
[0m10:01:15.201108 [info ] [MainThread]: 
[0m10:01:15.201894 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 7.69 seconds (7.69s).
[0m10:01:15.203388 [debug] [MainThread]: Command end result
[0m10:01:15.316394 [info ] [MainThread]: 
[0m10:01:15.318606 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:01:15.320176 [info ] [MainThread]: 
[0m10:01:15.322124 [error] [MainThread]:   Database Error in snapshot snapshot_rsi (snapshots/snapshot_rsi.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'STOCK_ID'
[0m10:01:15.323861 [info ] [MainThread]: 
[0m10:01:15.325622 [error] [MainThread]:   Database Error in snapshot snapshot_stock_indicators (snapshots/snapshot_stock_indicators.sql)
  000904 (42000): SQL compilation error: error line 29 at position 8
  invalid identifier 'RSI_14D'
[0m10:01:15.326658 [info ] [MainThread]: 
[0m10:01:15.328009 [error] [MainThread]:   Database Error in snapshot snapshot_volume_summary (snapshots/snapshot_volume _summary.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VOLUME'
[0m10:01:15.329210 [info ] [MainThread]: 
[0m10:01:15.330517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m10:01:15.332537 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 9.947347, "process_user_time": 4.200363, "process_kernel_time": 1.855742, "process_mem_max_rss": "244376", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m10:01:15.334106 [debug] [MainThread]: Command `dbt snapshot` failed at 10:01:15.333840 after 9.95 seconds
[0m10:01:15.335485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653d202ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f653cfb7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65402ec500>]}
[0m10:01:15.336641 [debug] [MainThread]: Flushing usage events
[0m10:15:22.167360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6667ab7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666979e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6669cfaf00>]}


============================== 10:15:22.176645 | ee13d502-a1b0-4823-b2ff-b3e362f26e8f ==============================
[0m10:15:22.176645 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:15:22.178187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m10:15:23.778297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6635770b90>]}
[0m10:15:23.828638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66357947a0>]}
[0m10:15:23.831304 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:15:23.920136 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:15:24.412920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:15:24.414353 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_rsi.sql
[0m10:15:24.415578 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_stock_indicators.sql
[0m10:15:24.416598 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://snapshots/snapshot_volume _summary.sql
[0m10:15:24.417716 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m10:15:24.802450 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:15:24.803874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66340ecaa0>]}
[0m10:15:24.996881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6636ce4e30>]}
[0m10:15:25.231847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661ec3dd30>]}
[0m10:15:25.232970 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:15:25.233854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661ec16c60>]}
[0m10:15:25.236393 [info ] [MainThread]: 
[0m10:15:25.237698 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:25.243516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m10:15:25.257363 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m10:15:25.258584 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m10:15:25.259821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:26.007411 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.747 seconds
[0m10:15:26.012218 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m10:15:26.169540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_snapshots)
[0m10:15:26.180110 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:15:26.181554 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:15:26.182834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:26.621681 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.439 seconds
[0m10:15:26.623898 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:15:26.771947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m10:15:26.775683 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:15:26.776553 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:15:26.777329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:27.296046 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.519 seconds
[0m10:15:27.300496 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:15:27.465751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661ec3c800>]}
[0m10:15:27.467569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:27.468651 [info ] [MainThread]: 
[0m10:15:27.481371 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:15:27.482992 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.moving_averages_snapshot ....................... [RUN]
[0m10:15:27.485046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now snapshot.dbt_stock_project.moving_averages_snapshot)
[0m10:15:27.486398 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:15:27.498875 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:15:27.577196 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:27.578192 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:15:27.579071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:28.396579 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.817 seconds
[0m10:15:28.409304 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:28.410785 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:15:28.528161 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.116 seconds
[0m10:15:28.636383 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:28.637695 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:15:28.746220 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.107 seconds
[0m10:15:28.795667 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:28.796813 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:15:29.786393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.988 seconds
[0m10:15:29.793394 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:29.794789 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:15:29.917720 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.122 seconds
[0m10:15:29.922513 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:29.923558 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:15:30.081438 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.157 seconds
[0m10:15:30.086126 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:30.087168 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:15:30.193879 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.106 seconds
[0m10:15:30.199702 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:30.200953 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:15:30.287463 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.085 seconds
[0m10:15:30.296988 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:30.298174 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:15:30.408062 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.109 seconds
[0m10:15:30.434621 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:30.436069 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:15:30.768363 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.331 seconds
[0m10:15:30.773094 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:30.774292 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:15:30.890500 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.115 seconds
[0m10:15:30.893125 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:30.925916 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:30.927571 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
BEGIN
[0m10:15:31.079160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m10:15:31.080999 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:31.082542 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:15:31.504264 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.420 seconds
[0m10:15:31.505406 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:15:31.506386 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
COMMIT
[0m10:15:31.844144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m10:15:31.871513 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: Close
[0m10:15:32.023220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663408fda0>]}
[0m10:15:32.025223 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshots.moving_averages_snapshot ....................... [[32mSUCCESS 0[0m in 4.54s]
[0m10:15:32.027455 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:15:32.028872 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.rsi_snapshot
[0m10:15:32.030183 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.rsi_snapshot ................................... [RUN]
[0m10:15:32.031442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.moving_averages_snapshot, now snapshot.dbt_stock_project.rsi_snapshot)
[0m10:15:32.032437 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.rsi_snapshot
[0m10:15:32.037548 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.rsi_snapshot
[0m10:15:32.048569 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:15:32.049884 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m10:15:32.050797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:32.647379 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.596 seconds
[0m10:15:32.651028 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:15:32.652851 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:15:32.747450 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m10:15:32.749145 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:15:32.773868 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:15:32.775751 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
create or replace transient table USER_DB_BLUEJAY.snapshots.rsi_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi

    ) sbq



        );
[0m10:15:33.639566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m10:15:33.649079 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: Close
[0m10:15:33.800113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6634073e00>]}
[0m10:15:33.802387 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshots.rsi_snapshot ................................... [[32mSUCCESS 1[0m in 1.77s]
[0m10:15:33.804332 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.rsi_snapshot
[0m10:15:33.805816 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:15:33.807650 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.stock_data_snapshot ............................ [RUN]
[0m10:15:33.809264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.rsi_snapshot, now snapshot.dbt_stock_project.stock_data_snapshot)
[0m10:15:33.810464 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:15:33.815507 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:15:33.820841 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:15:33.822310 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m10:15:33.823799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:34.722455 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.899 seconds
[0m10:15:34.724749 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:15:34.725783 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:15:34.830720 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.104 seconds
[0m10:15:34.832219 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:15:34.854449 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:15:34.855948 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
create or replace transient table USER_DB_BLUEJAY.snapshots.stock_data_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators

    ) sbq



        );
[0m10:15:35.572489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m10:15:35.575892 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: Close
[0m10:15:35.742665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661ec3d9a0>]}
[0m10:15:35.744167 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshots.stock_data_snapshot ............................ [[32mSUCCESS 1[0m in 1.93s]
[0m10:15:35.745502 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:15:35.746548 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:15:35.747719 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.weekly_volume_snapshot ......................... [RUN]
[0m10:15:35.748804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.stock_data_snapshot, now snapshot.dbt_stock_project.weekly_volume_snapshot)
[0m10:15:35.749596 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:15:35.754853 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:15:35.761574 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:15:35.762759 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m10:15:35.763890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:36.308110 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.544 seconds
[0m10:15:36.311229 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:15:36.312684 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:15:36.447422 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.133 seconds
[0m10:15:36.449837 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:15:36.474911 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:15:36.476147 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
create or replace transient table USER_DB_BLUEJAY.snapshots.weekly_volume_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to

    from (
        



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK

    ) sbq



        );
[0m10:15:37.117176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.640 seconds
[0m10:15:37.120693 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: Close
[0m10:15:37.294920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee13d502-a1b0-4823-b2ff-b3e362f26e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66340c8fe0>]}
[0m10:15:37.296394 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshots.weekly_volume_snapshot ......................... [[32mSUCCESS 1[0m in 1.55s]
[0m10:15:37.297783 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:15:37.300731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:37.301711 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.weekly_volume_snapshot' was properly closed.
[0m10:15:37.302591 [info ] [MainThread]: 
[0m10:15:37.303394 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 12.07 seconds (12.07s).
[0m10:15:37.304843 [debug] [MainThread]: Command end result
[0m10:15:37.404421 [info ] [MainThread]: 
[0m10:15:37.405548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:37.407190 [info ] [MainThread]: 
[0m10:15:37.409200 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:15:37.412353 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.333234, "process_user_time": 4.788592, "process_kernel_time": 2.093756, "process_mem_max_rss": "243228", "process_in_blocks": "128616", "process_out_blocks": "8"}
[0m10:15:37.413598 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:15:37.413424 after 15.33 seconds
[0m10:15:37.414570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666758f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661ede6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f666751a9c0>]}
[0m10:15:37.415481 [debug] [MainThread]: Flushing usage events
[0m10:15:54.530347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3547e26d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3547ed6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3549b61e20>]}


============================== 10:15:54.537433 | 9770789a-3d2a-4c6d-a30f-e6a9258cd5eb ==============================
[0m10:15:54.537433 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:15:54.539092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:15:55.502948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3547a55400>]}
[0m10:15:55.553852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3517ff82c0>]}
[0m10:15:55.555660 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:15:55.632597 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:15:56.140258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:56.141469 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:56.198460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3516ec43b0>]}
[0m10:15:56.409072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35481f6420>]}
[0m10:15:56.410447 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:15:56.411408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35177ae8d0>]}
[0m10:15:56.414516 [info ] [MainThread]: 
[0m10:15:56.415747 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:56.420952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m10:15:56.438721 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m10:15:56.439677 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m10:15:56.440633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.089667 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.649 seconds
[0m10:15:57.093019 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m10:15:57.259810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_snapshots)
[0m10:15:57.269390 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:15:57.270535 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:15:57.271634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:57.736802 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.465 seconds
[0m10:15:57.739457 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:15:57.902816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m10:15:57.906598 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:15:57.907655 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:15:57.908694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:58.299178 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.390 seconds
[0m10:15:58.303868 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:15:58.464791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3515a9fe00>]}
[0m10:15:58.466478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:58.467723 [info ] [MainThread]: 
[0m10:15:58.477970 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m10:15:58.479437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m10:15:58.480476 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m10:15:58.487746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m10:15:58.516342 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m10:15:58.517599 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m10:15:58.518808 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m10:15:58.520181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_indicators)
[0m10:15:58.521319 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m10:15:58.525531 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m10:15:58.552067 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m10:15:58.581729 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m10:15:58.609313 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m10:15:58.610990 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m10:15:58.612322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:59.668123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.056 seconds
[0m10:15:59.693533 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m10:15:59.865532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35152d11c0>]}
[0m10:15:59.866835 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.34s]
[0m10:15:59.868018 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m10:15:59.869074 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m10:15:59.870126 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m10:15:59.871246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m10:15:59.872148 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m10:15:59.877280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m10:15:59.906084 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m10:15:59.910082 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m10:15:59.932988 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m10:15:59.933931 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m10:15:59.934793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:00.920158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.985 seconds
[0m10:16:00.925764 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m10:16:01.094102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35148d60c0>]}
[0m10:16:01.095638 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.22s]
[0m10:16:01.097618 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m10:16:01.098733 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m10:16:01.099992 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m10:16:01.101354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m10:16:01.102492 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m10:16:01.117155 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m10:16:01.138335 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m10:16:01.143879 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m10:16:01.168203 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m10:16:01.169494 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m10:16:01.170573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:02.436662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.266 seconds
[0m10:16:02.439474 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m10:16:02.613854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35148ae4b0>]}
[0m10:16:02.615260 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.51s]
[0m10:16:02.616401 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m10:16:02.617504 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m10:16:02.618609 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m10:16:02.619704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m10:16:02.620800 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m10:16:02.637839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m10:16:02.661255 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m10:16:02.665372 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m10:16:02.688407 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m10:16:02.689580 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date;
[0m10:16:02.690871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:03.256024 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe6a8-0205-0bb1-0004-59ff002f5622
[0m10:16:03.257447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 78 at position 27 unexpected ';'.
[0m10:16:03.259121 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m10:16:03.434758 [debug] [Thread-1 (]: Database Error in model rsi (models/output/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 78 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m10:16:03.436178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9770789a-3d2a-4c6d-a30f-e6a9258cd5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351492ed80>]}
[0m10:16:03.437678 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.rsi ............................ [[31mERROR[0m in 0.82s]
[0m10:16:03.439035 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m10:16:03.442982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:03.444220 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m10:16:03.445201 [info ] [MainThread]: 
[0m10:16:03.446150 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m10:16:03.447530 [debug] [MainThread]: Command end result
[0m10:16:03.538823 [info ] [MainThread]: 
[0m10:16:03.539949 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:16:03.541155 [info ] [MainThread]: 
[0m10:16:03.542642 [error] [MainThread]:   Database Error in model rsi (models/output/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 78 at position 27 unexpected ';'.
  compiled code at target/run/dbt_stock_project/models/output/rsi.sql
[0m10:16:03.543678 [info ] [MainThread]: 
[0m10:16:03.544786 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:16:03.546151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.11244, "process_user_time": 3.843612, "process_kernel_time": 1.979929, "process_mem_max_rss": "236696", "process_in_blocks": "528", "process_out_blocks": "8", "command_success": false}
[0m10:16:03.547326 [debug] [MainThread]: Command `dbt run` failed at 10:16:03.547199 after 9.11 seconds
[0m10:16:03.548213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3547e99bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3549b61e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35152cb410>]}
[0m10:16:03.549258 [debug] [MainThread]: Flushing usage events
[0m10:16:43.769994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b82cd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b82cd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b7d08a70>]}


============================== 10:16:43.777718 | 1b14674c-0915-4a49-9f7a-514ab83388d8 ==============================
[0m10:16:43.777718 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:16:43.778886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:16:44.670772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b831e990>]}
[0m10:16:44.720648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b7c4c200>]}
[0m10:16:44.722768 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:16:44.806197 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:16:45.286297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:16:45.288019 [debug] [MainThread]: Partial parsing: updated file: dbt_stock_project://models/output/rsi.sql
[0m10:16:45.475851 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:16:45.477430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff785717a70>]}
[0m10:16:45.669959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff784167f80>]}
[0m10:16:45.855957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7854076e0>]}
[0m10:16:45.857103 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:16:45.858021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff785edbad0>]}
[0m10:16:45.860688 [info ] [MainThread]: 
[0m10:16:45.861733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:16:45.866850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m10:16:45.883269 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m10:16:45.884058 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m10:16:45.884778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:46.502249 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.617 seconds
[0m10:16:46.505594 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m10:16:46.664184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m10:16:46.674438 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:16:46.675568 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:16:46.676743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:47.204926 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.528 seconds
[0m10:16:47.210179 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:16:47.443926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m10:16:47.448364 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:16:47.449484 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:16:47.450332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:47.860079 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.410 seconds
[0m10:16:47.863495 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:16:48.018542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78578ad50>]}
[0m10:16:48.019906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:16:48.020929 [info ] [MainThread]: 
[0m10:16:48.031408 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m10:16:48.032907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now model.dbt_stock_project.stock)
[0m10:16:48.034529 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m10:16:48.043799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m10:16:48.070311 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m10:16:48.071334 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m10:16:48.073698 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m10:16:48.075089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_indicators)
[0m10:16:48.076576 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m10:16:48.080708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m10:16:48.099338 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m10:16:48.126401 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m10:16:48.158362 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m10:16:48.159447 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m10:16:48.160302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:49.191081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.031 seconds
[0m10:16:49.216287 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m10:16:49.408602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78574e990>]}
[0m10:16:49.409957 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.33s]
[0m10:16:49.411259 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m10:16:49.412248 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m10:16:49.413368 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m10:16:49.414425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m10:16:49.415317 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m10:16:49.419340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m10:16:49.437054 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m10:16:49.440884 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m10:16:49.459005 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m10:16:49.460408 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m10:16:49.461351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:50.460881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.000 seconds
[0m10:16:50.465595 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m10:16:50.636453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77649f2f0>]}
[0m10:16:50.637718 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.22s]
[0m10:16:50.639298 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m10:16:50.640347 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m10:16:50.641620 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m10:16:50.642804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m10:16:50.643612 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m10:16:50.658258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m10:16:50.681996 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m10:16:50.688824 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m10:16:50.707838 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m10:16:50.709103 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m10:16:50.710281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:51.872991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.162 seconds
[0m10:16:51.876480 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m10:16:52.066877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b889f6e0>]}
[0m10:16:52.068811 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.42s]
[0m10:16:52.070159 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m10:16:52.071390 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m10:16:52.073076 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m10:16:52.074640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m10:16:52.075902 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m10:16:52.092834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m10:16:52.112825 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m10:16:52.116458 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m10:16:52.142613 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m10:16:52.143943 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m10:16:52.145253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:53.215675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.070 seconds
[0m10:16:53.218499 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m10:16:53.369087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b14674c-0915-4a49-9f7a-514ab83388d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff776402b10>]}
[0m10:16:53.370741 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.29s]
[0m10:16:53.371944 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m10:16:53.374686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:53.375785 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m10:16:53.376920 [info ] [MainThread]: 
[0m10:16:53.377832 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.52 seconds (7.52s).
[0m10:16:53.379366 [debug] [MainThread]: Command end result
[0m10:16:53.557462 [info ] [MainThread]: 
[0m10:16:53.559282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:53.560614 [info ] [MainThread]: 
[0m10:16:53.561731 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:16:53.563424 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.901097, "process_user_time": 4.040985, "process_kernel_time": 1.894149, "process_mem_max_rss": "235596", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m10:16:53.564734 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:53.564594 after 9.90 seconds
[0m10:16:53.565689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b82a4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b9bf6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b7e74aa0>]}
[0m10:16:53.566829 [debug] [MainThread]: Flushing usage events
[0m10:16:58.027942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b3d7e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b6b3bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b3d7c140>]}


============================== 10:16:58.035288 | 0b628713-7cd1-4c61-9253-17b3ccb2e22e ==============================
[0m10:16:58.035288 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:16:58.036648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m10:16:58.980539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b628713-7cd1-4c61-9253-17b3ccb2e22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b4d67620>]}
[0m10:16:59.045482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b628713-7cd1-4c61-9253-17b3ccb2e22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f847e814fe0>]}
[0m10:16:59.047193 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:16:59.147785 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:16:59.673490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:59.675203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:59.721523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b628713-7cd1-4c61-9253-17b3ccb2e22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f847e52e540>]}
[0m10:16:59.967102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b628713-7cd1-4c61-9253-17b3ccb2e22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f847dcfae10>]}
[0m10:16:59.968343 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:16:59.969226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b628713-7cd1-4c61-9253-17b3ccb2e22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f847dce7ec0>]}
[0m10:16:59.972351 [info ] [MainThread]: 
[0m10:16:59.974013 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:16:59.980030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m10:16:59.997810 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:16:59.999224 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:17:00.000494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:00.631174 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.631 seconds
[0m10:17:00.633974 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:17:00.798441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m10:17:00.802989 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:17:00.803918 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:17:00.804864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:01.288415 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.484 seconds
[0m10:17:01.291233 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:17:01.439832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b628713-7cd1-4c61-9253-17b3ccb2e22e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f847e4f45c0>]}
[0m10:17:01.441470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:01.442476 [info ] [MainThread]: 
[0m10:17:01.451993 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:17:01.453380 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m10:17:01.454827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m10:17:01.456062 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:17:01.474629 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m10:17:01.506523 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:17:01.530747 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m10:17:01.561795 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m10:17:01.563063 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m10:17:01.563975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:02.091869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m10:17:02.102276 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m10:17:02.271308 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.82s]
[0m10:17:02.273615 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:17:02.275340 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:17:02.276446 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m10:17:02.277603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m10:17:02.278689 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:17:02.284658 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m10:17:02.312961 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:17:02.317315 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m10:17:02.344028 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m10:17:02.345039 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m10:17:02.345775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:02.815425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m10:17:02.818542 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m10:17:02.981034 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.70s]
[0m10:17:02.982402 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:17:02.983552 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:17:02.984442 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m10:17:02.985571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m10:17:02.986498 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:17:02.994983 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:17:03.015998 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:17:03.043821 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:17:03.049143 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:17:03.076786 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:17:03.078010 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m10:17:03.079077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:03.576898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m10:17:03.581031 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m10:17:03.737746 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.75s]
[0m10:17:03.739395 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:17:03.740573 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:17:03.742059 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m10:17:03.743261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m10:17:03.744276 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:17:03.751452 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m10:17:03.773210 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:17:03.777518 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m10:17:03.800565 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m10:17:03.801575 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m10:17:03.802804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:04.297500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m10:17:04.301330 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m10:17:04.469258 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.73s]
[0m10:17:04.470643 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:17:04.471659 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:17:04.473378 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m10:17:04.474308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m10:17:04.475219 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:17:04.482835 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m10:17:04.510981 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:17:04.514623 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m10:17:04.541965 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m10:17:04.543279 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m10:17:04.544398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:05.188064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m10:17:05.192156 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m10:17:05.368385 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.89s]
[0m10:17:05.369694 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:17:05.370755 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:17:05.372437 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m10:17:05.373917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m10:17:05.375162 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:17:05.390306 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m10:17:05.413956 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:17:05.417872 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m10:17:05.440664 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m10:17:05.441995 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:17:05.443015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:05.993921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m10:17:05.998144 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m10:17:06.161521 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.79s]
[0m10:17:06.163297 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:17:06.164653 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:17:06.165902 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m10:17:06.167235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m10:17:06.168503 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:17:06.178192 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m10:17:06.214846 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:17:06.218409 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m10:17:06.247420 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m10:17:06.248582 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:17:06.249515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:06.810727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m10:17:06.813536 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m10:17:06.959087 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.79s]
[0m10:17:06.960716 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:17:06.961974 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:17:06.963198 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m10:17:06.964425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m10:17:06.965531 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:17:06.973081 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m10:17:07.003111 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:17:07.007484 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m10:17:07.026080 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m10:17:07.027012 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:17:07.027740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:07.452248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m10:17:07.455422 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m10:17:07.654271 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.69s]
[0m10:17:07.655668 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:17:07.656819 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:17:07.657859 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m10:17:07.658966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m10:17:07.659687 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:17:07.665992 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m10:17:07.707540 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:17:07.711368 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m10:17:07.752355 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m10:17:07.753727 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:17:07.755302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:08.407891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m10:17:08.411499 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m10:17:08.622590 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.96s]
[0m10:17:08.623973 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:17:08.624955 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:17:08.625803 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m10:17:08.626741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m10:17:08.627620 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:17:08.636511 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m10:17:08.661850 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:17:08.665737 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m10:17:08.689306 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m10:17:08.690443 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:17:08.691348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:09.077458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m10:17:09.081292 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m10:17:09.255325 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.63s]
[0m10:17:09.257154 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:17:09.259905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:09.260726 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m10:17:09.261641 [info ] [MainThread]: 
[0m10:17:09.262417 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 9.29 seconds (9.29s).
[0m10:17:09.264245 [debug] [MainThread]: Command end result
[0m10:17:09.383437 [info ] [MainThread]: 
[0m10:17:09.384710 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:09.385783 [info ] [MainThread]: 
[0m10:17:09.386717 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m10:17:09.388430 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.44759, "process_user_time": 4.283128, "process_kernel_time": 1.951425, "process_mem_max_rss": "236660", "process_in_blocks": "1976", "process_out_blocks": "8"}
[0m10:17:09.390431 [debug] [MainThread]: Command `dbt test` succeeded at 10:17:09.390226 after 11.45 seconds
[0m10:17:09.391646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b7569bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f847e33b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b4d016a0>]}
[0m10:17:09.392779 [debug] [MainThread]: Flushing usage events
[0m10:17:13.236900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c282aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c27c98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c12fe810>]}


============================== 10:17:13.246598 | 66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb ==============================
[0m10:17:13.246598 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:17:13.247755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:17:14.159338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5090b610a0>]}
[0m10:17:14.215877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f508b513620>]}
[0m10:17:14.217321 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:17:14.311332 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:17:14.886112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:14.887683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:14.943924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f508b326120>]}
[0m10:17:15.154649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f508af51bb0>]}
[0m10:17:15.157046 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:17:15.158630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5090a01010>]}
[0m10:17:15.162193 [info ] [MainThread]: 
[0m10:17:15.163860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:17:15.169311 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m10:17:15.185756 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m10:17:15.187364 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m10:17:15.188685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:15.820125 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.631 seconds
[0m10:17:15.823572 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m10:17:15.986485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_snapshots)
[0m10:17:15.997851 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:17:15.999046 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:17:16.000063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:16.434866 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.435 seconds
[0m10:17:16.437385 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:17:16.595165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m10:17:16.599914 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:17:16.601048 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:17:16.602138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:17.044285 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.442 seconds
[0m10:17:17.047325 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:17:17.222037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f508b3d0590>]}
[0m10:17:17.223639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:17.224626 [info ] [MainThread]: 
[0m10:17:17.236564 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:17:17.237967 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.moving_averages_snapshot ....................... [RUN]
[0m10:17:17.239753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now snapshot.dbt_stock_project.moving_averages_snapshot)
[0m10:17:17.241167 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:17:17.252449 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:17:17.329088 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:17.330259 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:17.331333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:17.786115 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.455 seconds
[0m10:17:17.796487 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:17.797820 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:17:17.904066 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m10:17:17.915391 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:17.916619 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:17:18.009003 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m10:17:18.053879 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:18.055474 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:17:18.652459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m10:17:18.656912 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:18.658102 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:17:18.757760 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.098 seconds
[0m10:17:18.762612 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:18.763873 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:17:18.870420 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m10:17:18.875744 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:18.876809 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:17:18.979523 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.102 seconds
[0m10:17:18.984718 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:18.985820 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:17:19.080076 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.093 seconds
[0m10:17:19.088365 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:19.089579 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:17:19.211753 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.121 seconds
[0m10:17:19.231102 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:19.232443 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:19.688005 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.454 seconds
[0m10:17:19.692918 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:19.693827 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:19.782515 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.088 seconds
[0m10:17:19.784685 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:19.819960 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:19.821417 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
BEGIN
[0m10:17:20.002539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m10:17:20.004283 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:20.005835 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:17:20.508052 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.500 seconds
[0m10:17:20.510107 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:17:20.511673 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
COMMIT
[0m10:17:20.916816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m10:17:20.942499 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: Close
[0m10:17:21.106837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f508b4d2840>]}
[0m10:17:21.108771 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshots.moving_averages_snapshot ....................... [[32mSUCCESS 0[0m in 3.87s]
[0m10:17:21.110137 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:17:21.111105 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.rsi_snapshot
[0m10:17:21.112149 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.rsi_snapshot ................................... [RUN]
[0m10:17:21.113159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.moving_averages_snapshot, now snapshot.dbt_stock_project.rsi_snapshot)
[0m10:17:21.114068 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.rsi_snapshot
[0m10:17:21.118225 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.rsi_snapshot
[0m10:17:21.123878 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:21.125333 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        select close, rsi_14d from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:21.126566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:21.679616 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.553 seconds
[0m10:17:21.684383 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:21.685836 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:17:21.779337 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.092 seconds
[0m10:17:21.784511 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:21.785529 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:17:21.889810 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.103 seconds
[0m10:17:21.896682 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:21.897898 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:17:22.660464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.761 seconds
[0m10:17:22.666793 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:22.667954 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m10:17:22.766336 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.097 seconds
[0m10:17:22.772086 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:22.773580 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:17:22.889132 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.114 seconds
[0m10:17:22.896590 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:22.897891 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m10:17:23.024001 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.125 seconds
[0m10:17:23.030839 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:23.032004 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:17:23.124244 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m10:17:23.130410 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:23.131629 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m10:17:23.248601 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.116 seconds
[0m10:17:23.254647 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:23.255655 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:23.461040 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.204 seconds
[0m10:17:23.464613 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:23.466438 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:23.547889 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m10:17:23.549100 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:23.569145 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:23.570190 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
BEGIN
[0m10:17:23.689119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m10:17:23.690238 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:23.691272 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "AVG_GAIN_14D", "AVG_LOSS_14D", "RSI_14D", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "AVG_GAIN_14D", "AVG_LOSS_14D", "RSI_14D", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:17:24.256938 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.565 seconds
[0m10:17:24.258944 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:17:24.260640 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
COMMIT
[0m10:17:24.602199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.340 seconds
[0m10:17:24.605320 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: Close
[0m10:17:24.760542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f508a447530>]}
[0m10:17:24.761931 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshots.rsi_snapshot ................................... [[32mSUCCESS 0[0m in 3.65s]
[0m10:17:24.763221 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.rsi_snapshot
[0m10:17:24.764136 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:17:24.765023 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.stock_data_snapshot ............................ [RUN]
[0m10:17:24.766089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.rsi_snapshot, now snapshot.dbt_stock_project.stock_data_snapshot)
[0m10:17:24.766921 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:17:24.771346 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:17:24.777440 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:24.778690 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        select close, volume, daily_change from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:24.779969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:25.277340 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.497 seconds
[0m10:17:25.284277 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:25.285885 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:17:25.399262 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m10:17:25.404355 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:25.405487 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:17:25.506861 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.100 seconds
[0m10:17:25.516568 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:25.517875 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:17:26.233852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m10:17:26.238791 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:26.240295 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m10:17:26.348962 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.108 seconds
[0m10:17:26.353534 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:26.354494 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:17:26.464307 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.109 seconds
[0m10:17:26.470601 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:26.471721 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m10:17:26.576623 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.104 seconds
[0m10:17:26.583690 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:26.584894 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:17:26.711823 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.126 seconds
[0m10:17:26.719039 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:26.720271 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m10:17:26.842220 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.121 seconds
[0m10:17:26.848843 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:26.850226 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:27.085880 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.234 seconds
[0m10:17:27.087988 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:27.089411 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:27.199961 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.109 seconds
[0m10:17:27.202519 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:27.237704 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:27.239096 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
BEGIN
[0m10:17:27.404066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m10:17:27.406096 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:27.407949 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "VOLUME", "DAILY_CHANGE", "MOVING_AVG_7", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "VOLUME", "DAILY_CHANGE", "MOVING_AVG_7", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:17:27.879274 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.470 seconds
[0m10:17:27.881500 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:17:27.883223 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
COMMIT
[0m10:17:28.282075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m10:17:28.286510 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: Close
[0m10:17:28.467250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5088ac68a0>]}
[0m10:17:28.468773 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshots.stock_data_snapshot ............................ [[32mSUCCESS 0[0m in 3.70s]
[0m10:17:28.469988 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:17:28.471006 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:17:28.471996 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.weekly_volume_snapshot ......................... [RUN]
[0m10:17:28.473038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.stock_data_snapshot, now snapshot.dbt_stock_project.weekly_volume_snapshot)
[0m10:17:28.474007 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:17:28.477971 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:17:28.483492 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:28.484862 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        select weekly_volume from (
                



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:28.486200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:28.966755 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.480 seconds
[0m10:17:28.971081 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:28.972501 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:17:29.091498 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.118 seconds
[0m10:17:29.096493 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:29.097664 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:17:29.204762 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.106 seconds
[0m10:17:29.213483 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:29.214731 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:17:29.736397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m10:17:29.740342 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:29.741359 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
[0m10:17:29.872663 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.130 seconds
[0m10:17:29.878043 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:29.879083 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:17:29.985875 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.106 seconds
[0m10:17:29.991561 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:29.992879 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
[0m10:17:30.115518 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.122 seconds
[0m10:17:30.121162 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:30.122356 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:17:30.223605 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.100 seconds
[0m10:17:30.229166 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:30.230420 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
[0m10:17:30.346916 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.115 seconds
[0m10:17:30.352725 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:30.354094 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:30.687720 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.332 seconds
[0m10:17:30.690125 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:30.691267 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:17:30.777978 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m10:17:30.779992 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:30.805759 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:30.807527 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
BEGIN
[0m10:17:30.949551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m10:17:30.950944 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:30.952393 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "WEEKLY_VOLUME", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "WEEKLY_VOLUME", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:17:31.499436 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.546 seconds
[0m10:17:31.500870 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:17:31.501958 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
COMMIT
[0m10:17:31.785788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.283 seconds
[0m10:17:31.790056 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: Close
[0m10:17:31.946093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66bf4977-3e3d-4b7d-b6ff-2b61036f4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5088ad9ac0>]}
[0m10:17:31.947715 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshots.weekly_volume_snapshot ......................... [[32mSUCCESS 0[0m in 3.47s]
[0m10:17:31.948909 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:17:31.951244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:31.952173 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.weekly_volume_snapshot' was properly closed.
[0m10:17:31.953021 [info ] [MainThread]: 
[0m10:17:31.953922 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 16.79 seconds (16.79s).
[0m10:17:31.955485 [debug] [MainThread]: Command end result
[0m10:17:32.053183 [info ] [MainThread]: 
[0m10:17:32.054337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:32.055102 [info ] [MainThread]: 
[0m10:17:32.056195 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:17:32.058647 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 18.912737, "process_user_time": 4.309359, "process_kernel_time": 2.029115, "process_mem_max_rss": "233428", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m10:17:32.060035 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:17:32.059815 after 18.91 seconds
[0m10:17:32.061163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f508af26f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c138f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c138e090>]}
[0m10:17:32.062183 [debug] [MainThread]: Flushing usage events
[0m10:18:40.978730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d2cff3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d0ff3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d07a7da0>]}


============================== 10:18:40.986914 | 903d209d-5d91-4906-ab1d-addfbde88487 ==============================
[0m10:18:40.986914 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:18:40.989212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:18:41.932172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d07a8a70>]}
[0m10:18:41.980697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609ab96e10>]}
[0m10:18:41.982132 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:18:42.070078 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:18:42.651002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:18:42.652483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:18:42.699262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609aaabe30>]}
[0m10:18:42.901875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609a612a50>]}
[0m10:18:42.903292 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:18:42.904521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d121ff80>]}
[0m10:18:42.907307 [info ] [MainThread]: 
[0m10:18:42.908679 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:18:42.913210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m10:18:42.928467 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m10:18:42.929760 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m10:18:42.930908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:43.534205 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.603 seconds
[0m10:18:43.536702 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m10:18:43.716717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m10:18:43.726741 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:18:43.728192 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:18:43.729186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:44.165336 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.436 seconds
[0m10:18:44.169933 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:18:44.334692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m10:18:44.342401 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:18:44.343911 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:18:44.345246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:44.787500 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.442 seconds
[0m10:18:44.790875 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:18:44.945591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d1e2bec0>]}
[0m10:18:44.946834 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:18:44.947707 [info ] [MainThread]: 
[0m10:18:44.957745 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m10:18:44.959407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now model.dbt_stock_project.stock)
[0m10:18:44.960584 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m10:18:44.968561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m10:18:45.001121 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m10:18:45.002244 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m10:18:45.003270 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m10:18:45.004561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_indicators)
[0m10:18:45.005658 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m10:18:45.009329 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m10:18:45.031961 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m10:18:45.065356 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m10:18:45.086807 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m10:18:45.088149 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m10:18:45.089168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:46.082636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m10:18:46.106689 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m10:18:46.348684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609ab965a0>]}
[0m10:18:46.350033 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.34s]
[0m10:18:46.351355 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m10:18:46.352422 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m10:18:46.353393 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m10:18:46.354465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m10:18:46.355230 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m10:18:46.360700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m10:18:46.376390 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m10:18:46.380779 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m10:18:46.397818 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m10:18:46.398776 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m10:18:46.399675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:47.346274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.947 seconds
[0m10:18:47.349318 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m10:18:47.624471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6099c9d4c0>]}
[0m10:18:47.626029 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.27s]
[0m10:18:47.627731 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m10:18:47.629087 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m10:18:47.630234 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m10:18:47.631555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m10:18:47.632496 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m10:18:47.646782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m10:18:47.667405 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m10:18:47.673274 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m10:18:47.697645 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m10:18:47.698741 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m10:18:47.699896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:48.758528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.059 seconds
[0m10:18:48.762463 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m10:18:48.928429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d1cefa70>]}
[0m10:18:48.930606 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.30s]
[0m10:18:48.932808 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m10:18:48.933909 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m10:18:48.934912 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m10:18:48.936146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m10:18:48.937001 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m10:18:48.955708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m10:18:48.971511 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m10:18:48.975374 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m10:18:48.994425 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m10:18:48.995581 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m10:18:48.996544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:49.921043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m10:18:49.924718 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m10:18:50.086030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '903d209d-5d91-4906-ab1d-addfbde88487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6099afb620>]}
[0m10:18:50.087293 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.15s]
[0m10:18:50.088968 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m10:18:50.091471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:50.092286 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m10:18:50.093289 [info ] [MainThread]: 
[0m10:18:50.094358 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.18 seconds (7.18s).
[0m10:18:50.095916 [debug] [MainThread]: Command end result
[0m10:18:50.208137 [info ] [MainThread]: 
[0m10:18:50.209401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:50.210796 [info ] [MainThread]: 
[0m10:18:50.211749 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:18:50.214089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.331275, "process_user_time": 3.702223, "process_kernel_time": 1.931594, "process_mem_max_rss": "244436", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m10:18:50.216330 [debug] [MainThread]: Command `dbt run` succeeded at 10:18:50.215972 after 9.33 seconds
[0m10:18:50.217595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d1d88d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609a5eef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6099da84a0>]}
[0m10:18:50.218447 [debug] [MainThread]: Flushing usage events
[0m10:18:54.348813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e6865130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e68d2b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e7dcfe90>]}


============================== 10:18:54.356848 | 25749757-da4d-49a5-8822-6f9b1f1328d3 ==============================
[0m10:18:54.356848 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:18:54.357981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m10:18:55.325093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25749757-da4d-49a5-8822-6f9b1f1328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b48eb2c0>]}
[0m10:18:55.373620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25749757-da4d-49a5-8822-6f9b1f1328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b5064770>]}
[0m10:18:55.375441 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:18:55.462099 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:18:56.059698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:18:56.061023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:18:56.117065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25749757-da4d-49a5-8822-6f9b1f1328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e9f269c0>]}
[0m10:18:56.343506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25749757-da4d-49a5-8822-6f9b1f1328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8afc3bc20>]}
[0m10:18:56.345478 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:18:56.346839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25749757-da4d-49a5-8822-6f9b1f1328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8afea9fd0>]}
[0m10:18:56.350470 [info ] [MainThread]: 
[0m10:18:56.352317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:18:56.361655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m10:18:56.381720 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:18:56.383077 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:18:56.384200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:57.025618 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.641 seconds
[0m10:18:57.029513 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:18:57.193266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m10:18:57.200110 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:18:57.201097 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:18:57.202238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:57.668465 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.466 seconds
[0m10:18:57.671434 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:18:57.846982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25749757-da4d-49a5-8822-6f9b1f1328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8b42b1340>]}
[0m10:18:57.848461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:18:57.849552 [info ] [MainThread]: 
[0m10:18:57.861684 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:18:57.863172 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m10:18:57.864483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m10:18:57.865524 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:18:57.885154 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m10:18:57.914983 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:18:57.940310 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m10:18:57.962145 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m10:18:57.963203 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m10:18:57.964792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:58.527302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m10:18:58.539602 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m10:18:58.693379 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.83s]
[0m10:18:58.694883 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:18:58.695931 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:18:58.696969 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m10:18:58.698037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m10:18:58.698943 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:18:58.705786 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m10:18:58.734887 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:18:58.739266 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m10:18:58.770659 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m10:18:58.771888 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m10:18:58.773076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:59.447466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m10:18:59.450495 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m10:18:59.619787 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.92s]
[0m10:18:59.621315 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:18:59.623192 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:18:59.624406 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m10:18:59.625529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m10:18:59.626546 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:18:59.635510 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:18:59.668476 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:18:59.692879 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:18:59.697330 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:18:59.723870 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:18:59.725251 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m10:18:59.726333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:00.116785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m10:19:00.120064 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m10:19:00.288841 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.66s]
[0m10:19:00.290500 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:19:00.291652 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:19:00.292638 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m10:19:00.293718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m10:19:00.294604 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:19:00.301143 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m10:19:00.326570 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:19:00.330750 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m10:19:00.357461 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m10:19:00.358800 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m10:19:00.359839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:00.816843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m10:19:00.821926 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m10:19:01.001996 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.71s]
[0m10:19:01.003441 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:19:01.004494 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:19:01.005967 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m10:19:01.007301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m10:19:01.008098 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:19:01.015409 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m10:19:01.042711 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:19:01.046327 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m10:19:01.071234 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m10:19:01.072961 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m10:19:01.074161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:01.537073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m10:19:01.541071 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m10:19:01.697293 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.69s]
[0m10:19:01.698853 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:19:01.699872 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:19:01.700996 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m10:19:01.702070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m10:19:01.703020 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:19:01.717446 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m10:19:01.744156 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:19:01.747997 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m10:19:01.776986 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m10:19:01.778641 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:19:01.780389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:02.464941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m10:19:02.467863 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m10:19:02.652540 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.95s]
[0m10:19:02.653851 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:19:02.655037 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:19:02.656513 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m10:19:02.657887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m10:19:02.658878 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:19:02.668698 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m10:19:02.700083 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:19:02.703694 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m10:19:02.735514 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m10:19:02.736633 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:19:02.737524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:03.276538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m10:19:03.279406 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m10:19:03.476220 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.82s]
[0m10:19:03.478023 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:19:03.479191 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:19:03.480056 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m10:19:03.481163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m10:19:03.482103 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:19:03.490859 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m10:19:03.531714 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:19:03.540175 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m10:19:03.569473 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m10:19:03.570942 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:19:03.572621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:04.100759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m10:19:04.104502 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m10:19:04.306379 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.82s]
[0m10:19:04.308256 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:19:04.309586 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:19:04.310716 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m10:19:04.311803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m10:19:04.312781 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:19:04.319963 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m10:19:04.349355 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:19:04.352969 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m10:19:04.384499 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m10:19:04.385471 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:19:04.387437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:04.777796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m10:19:04.781201 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m10:19:04.946457 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.63s]
[0m10:19:04.948015 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:19:04.949070 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:19:04.949933 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m10:19:04.950961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m10:19:04.951804 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:19:04.960469 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m10:19:04.990068 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:19:04.994299 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m10:19:05.022599 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m10:19:05.024770 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:19:05.025829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:05.424636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m10:19:05.430073 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m10:19:05.578993 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.63s]
[0m10:19:05.580910 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:19:05.584389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:05.585366 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m10:19:05.586770 [info ] [MainThread]: 
[0m10:19:05.588105 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m10:19:05.590757 [debug] [MainThread]: Command end result
[0m10:19:05.709951 [info ] [MainThread]: 
[0m10:19:05.711265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:05.712521 [info ] [MainThread]: 
[0m10:19:05.713719 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m10:19:05.716312 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.46835, "process_user_time": 4.13332, "process_kernel_time": 2.157391, "process_mem_max_rss": "244916", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m10:19:05.718605 [debug] [MainThread]: Command `dbt test` succeeded at 10:19:05.718028 after 11.47 seconds
[0m10:19:05.720632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e6865130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e6f27830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e6031460>]}
[0m10:19:05.722080 [debug] [MainThread]: Flushing usage events
[0m10:19:09.579827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb60d50fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb60afb77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb60afb77d0>]}


============================== 10:19:09.588419 | 8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7 ==============================
[0m10:19:09.588419 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:19:09.589847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:19:10.564287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb60aeffe00>]}
[0m10:19:10.623907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d981aab0>]}
[0m10:19:10.625748 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:19:10.716892 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:19:11.212364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:11.213635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:11.280490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d90a0a70>]}
[0m10:19:11.498367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d8dcf020>]}
[0m10:19:11.499930 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:19:11.501394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d9073a70>]}
[0m10:19:11.504862 [info ] [MainThread]: 
[0m10:19:11.506513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:19:11.512485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m10:19:11.531943 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m10:19:11.533272 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m10:19:11.534432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:12.174702 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.640 seconds
[0m10:19:12.177028 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m10:19:12.361824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m10:19:12.371981 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:19:12.373224 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:19:12.374253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:12.824061 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.450 seconds
[0m10:19:12.827155 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:19:12.978036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m10:19:12.983401 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:19:12.984627 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:19:12.985496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:13.425275 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.440 seconds
[0m10:19:13.428079 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:19:13.630451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d83eef30>]}
[0m10:19:13.631696 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:13.632609 [info ] [MainThread]: 
[0m10:19:13.644363 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:19:13.645678 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.moving_averages_snapshot ....................... [RUN]
[0m10:19:13.646775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now snapshot.dbt_stock_project.moving_averages_snapshot)
[0m10:19:13.647561 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:19:13.657612 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:19:13.731356 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:13.732948 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:13.734074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:14.248142 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.514 seconds
[0m10:19:14.260489 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:14.262087 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:19:14.413072 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.150 seconds
[0m10:19:14.429864 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:14.431251 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:19:14.555475 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.123 seconds
[0m10:19:14.617382 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:14.618847 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:19:15.415075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m10:19:15.422907 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:15.424550 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:19:15.541480 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.116 seconds
[0m10:19:15.546823 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:15.547983 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:19:15.684074 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.135 seconds
[0m10:19:15.690646 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:15.692243 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:19:15.792064 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.098 seconds
[0m10:19:15.798064 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:15.799199 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:19:15.885966 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.086 seconds
[0m10:19:15.895591 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:15.896630 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:19:16.008988 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.111 seconds
[0m10:19:16.039353 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:16.040610 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:16.235278 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.193 seconds
[0m10:19:16.241140 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:16.242258 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:16.349314 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.106 seconds
[0m10:19:16.350842 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:16.370024 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:16.371676 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
BEGIN
[0m10:19:16.540201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m10:19:16.541373 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:16.542188 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:19:17.114793 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.572 seconds
[0m10:19:17.116394 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:19:17.117561 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
COMMIT
[0m10:19:17.384887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m10:19:17.408785 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: Close
[0m10:19:17.565818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d9366a20>]}
[0m10:19:17.567354 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshots.moving_averages_snapshot ....................... [[32mSUCCESS 0[0m in 3.92s]
[0m10:19:17.568927 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:19:17.570003 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.rsi_snapshot
[0m10:19:17.571450 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.rsi_snapshot ................................... [RUN]
[0m10:19:17.572522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.moving_averages_snapshot, now snapshot.dbt_stock_project.rsi_snapshot)
[0m10:19:17.573365 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.rsi_snapshot
[0m10:19:17.577120 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.rsi_snapshot
[0m10:19:17.581508 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:17.582909 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        select close, rsi_14d from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:17.584133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:18.081154 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.497 seconds
[0m10:19:18.086172 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:18.088003 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:19:18.208604 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.119 seconds
[0m10:19:18.214190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:18.215295 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:19:18.330671 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.114 seconds
[0m10:19:18.337908 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:18.339388 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:19:19.008827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m10:19:19.013336 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:19.014530 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m10:19:19.147883 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.132 seconds
[0m10:19:19.153596 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:19.154717 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:19:19.291886 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.136 seconds
[0m10:19:19.297614 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:19.298540 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m10:19:19.416060 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.116 seconds
[0m10:19:19.423100 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:19.424793 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:19:19.619829 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.193 seconds
[0m10:19:19.627281 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:19.628390 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m10:19:19.789660 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.160 seconds
[0m10:19:19.797716 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:19.799017 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:20.174544 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.374 seconds
[0m10:19:20.177445 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:20.178832 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:20.283474 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.103 seconds
[0m10:19:20.286422 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:20.312605 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:20.314338 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
BEGIN
[0m10:19:20.446318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m10:19:20.447651 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:20.448616 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "AVG_GAIN_14D", "AVG_LOSS_14D", "RSI_14D", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "AVG_GAIN_14D", "AVG_LOSS_14D", "RSI_14D", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:19:21.047814 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.598 seconds
[0m10:19:21.049418 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:19:21.050607 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
COMMIT
[0m10:19:21.501996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m10:19:21.506161 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: Close
[0m10:19:21.650245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d8411340>]}
[0m10:19:21.652166 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshots.rsi_snapshot ................................... [[32mSUCCESS 0[0m in 4.08s]
[0m10:19:21.653817 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.rsi_snapshot
[0m10:19:21.655071 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:19:21.656915 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.stock_data_snapshot ............................ [RUN]
[0m10:19:21.658802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.rsi_snapshot, now snapshot.dbt_stock_project.stock_data_snapshot)
[0m10:19:21.660100 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:19:21.666416 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:19:21.673985 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:21.675608 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        select close, volume, daily_change from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:21.676910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:22.206201 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.529 seconds
[0m10:19:22.211334 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:22.213380 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:19:22.307655 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.093 seconds
[0m10:19:22.313989 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:22.315186 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:19:22.410050 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.094 seconds
[0m10:19:22.418298 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:22.420153 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:19:23.151038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m10:19:23.156494 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:23.157795 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m10:19:23.260515 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.101 seconds
[0m10:19:23.266752 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:23.268039 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:19:23.374594 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m10:19:23.380102 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:23.381636 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m10:19:23.494102 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.111 seconds
[0m10:19:23.500046 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:23.501113 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:19:23.599043 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m10:19:23.606106 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:23.607541 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m10:19:23.705454 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.096 seconds
[0m10:19:23.713508 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:23.714819 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:24.036285 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.320 seconds
[0m10:19:24.039899 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:24.041733 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:24.133447 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.090 seconds
[0m10:19:24.134809 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:24.160857 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:24.161828 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
BEGIN
[0m10:19:24.305723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m10:19:24.307091 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:24.308405 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "VOLUME", "DAILY_CHANGE", "MOVING_AVG_7", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "VOLUME", "DAILY_CHANGE", "MOVING_AVG_7", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:19:24.908309 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.599 seconds
[0m10:19:24.909675 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:19:24.910733 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
COMMIT
[0m10:19:25.172401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m10:19:25.176955 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: Close
[0m10:19:25.338548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d8425610>]}
[0m10:19:25.340184 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshots.stock_data_snapshot ............................ [[32mSUCCESS 0[0m in 3.68s]
[0m10:19:25.341419 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:19:25.342336 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:19:25.343306 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.weekly_volume_snapshot ......................... [RUN]
[0m10:19:25.344497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.stock_data_snapshot, now snapshot.dbt_stock_project.weekly_volume_snapshot)
[0m10:19:25.345304 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:19:25.349631 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:19:25.355936 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:25.357256 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        select weekly_volume from (
                



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:25.358292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:25.873895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.516 seconds
[0m10:19:25.878421 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:25.880277 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:19:25.996930 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.115 seconds
[0m10:19:26.003369 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:26.004587 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:19:26.109193 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.103 seconds
[0m10:19:26.117173 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:26.118774 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:19:26.761796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m10:19:26.766535 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:26.767569 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
[0m10:19:26.859187 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.090 seconds
[0m10:19:26.864202 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:26.865219 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:19:26.985728 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.120 seconds
[0m10:19:26.991677 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:26.993000 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
[0m10:19:27.111089 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.117 seconds
[0m10:19:27.115947 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:27.116955 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:19:27.295347 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.177 seconds
[0m10:19:27.302200 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:27.303320 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
[0m10:19:27.455378 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.151 seconds
[0m10:19:27.461741 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:27.463130 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:27.639698 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.175 seconds
[0m10:19:27.642191 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:27.643479 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:19:27.724768 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m10:19:27.726447 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:27.749745 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:27.751241 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
BEGIN
[0m10:19:27.861485 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m10:19:27.862491 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:27.863409 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "WEEKLY_VOLUME", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "WEEKLY_VOLUME", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:19:28.319133 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.455 seconds
[0m10:19:28.320533 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:19:28.321977 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
COMMIT
[0m10:19:28.592916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m10:19:28.595878 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: Close
[0m10:19:28.760210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e23db6e-2b23-4aaf-8c6e-8fd6918f56b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d8440680>]}
[0m10:19:28.762054 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshots.weekly_volume_snapshot ......................... [[32mSUCCESS 0[0m in 3.42s]
[0m10:19:28.763576 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:19:28.766380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:28.767380 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.weekly_volume_snapshot' was properly closed.
[0m10:19:28.768529 [info ] [MainThread]: 
[0m10:19:28.769518 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 17.26 seconds (17.26s).
[0m10:19:28.771220 [debug] [MainThread]: Command end result
[0m10:19:28.906476 [info ] [MainThread]: 
[0m10:19:28.907705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:28.908725 [info ] [MainThread]: 
[0m10:19:28.909880 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:19:28.911687 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 19.427296, "process_user_time": 4.665179, "process_kernel_time": 1.981923, "process_mem_max_rss": "244924", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m10:19:28.912920 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:19:28.912808 after 19.43 seconds
[0m10:19:28.913999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d8e5e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb60af64d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d8dd4560>]}
[0m10:19:28.915118 [debug] [MainThread]: Flushing usage events
[0m10:24:04.025641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244c3a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244c3bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244c3a2d0>]}


============================== 10:24:04.034160 | e87cabd4-a8b0-48f5-b842-32befc036425 ==============================
[0m10:24:04.034160 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:24:04.035240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:24:04.974274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2459a94f0>]}
[0m10:24:05.026992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20efb9520>]}
[0m10:24:05.028851 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:24:05.141084 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:24:05.640839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:05.642039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:05.693550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20f9f2c60>]}
[0m10:24:05.887832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20ecb95e0>]}
[0m10:24:05.888848 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:24:05.889791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20eae5f70>]}
[0m10:24:05.892557 [info ] [MainThread]: 
[0m10:24:05.893779 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:24:05.899395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m10:24:05.914043 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m10:24:05.915556 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m10:24:05.916756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:06.541717 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.625 seconds
[0m10:24:06.546226 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m10:24:06.712959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_snapshots)
[0m10:24:06.723629 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:24:06.724997 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:24:06.726056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:07.173354 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.447 seconds
[0m10:24:07.175830 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:24:07.338891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m10:24:07.344006 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:24:07.345623 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:24:07.346958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:07.829007 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.482 seconds
[0m10:24:07.833762 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:24:08.002488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20eff6840>]}
[0m10:24:08.004139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:08.005432 [info ] [MainThread]: 
[0m10:24:08.016835 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m10:24:08.018527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now model.dbt_stock_project.stock)
[0m10:24:08.019620 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m10:24:08.029096 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m10:24:08.052940 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m10:24:08.054046 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m10:24:08.055381 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m10:24:08.056623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_indicators)
[0m10:24:08.057830 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m10:24:08.062229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m10:24:08.081739 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m10:24:08.115958 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m10:24:08.137545 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m10:24:08.138744 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m10:24:08.139757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:09.111920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.972 seconds
[0m10:24:09.137199 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m10:24:09.297972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20efba420>]}
[0m10:24:09.299437 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.24s]
[0m10:24:09.300928 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m10:24:09.301972 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m10:24:09.303027 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m10:24:09.304111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m10:24:09.305000 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m10:24:09.310412 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m10:24:09.336019 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m10:24:09.340236 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m10:24:09.361840 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m10:24:09.362797 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m10:24:09.363961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:10.400404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.036 seconds
[0m10:24:10.403490 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m10:24:10.560295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20deb2b10>]}
[0m10:24:10.561884 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.26s]
[0m10:24:10.563286 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m10:24:10.564915 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m10:24:10.566389 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m10:24:10.567793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m10:24:10.568769 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m10:24:10.582162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m10:24:10.612370 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m10:24:10.619803 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m10:24:10.647220 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m10:24:10.648798 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m10:24:10.650169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:11.689149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.039 seconds
[0m10:24:11.693423 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m10:24:11.854715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2460bfb60>]}
[0m10:24:11.856705 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.29s]
[0m10:24:11.858145 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m10:24:11.859234 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m10:24:11.860450 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m10:24:11.861538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m10:24:11.862396 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m10:24:11.878538 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m10:24:11.905013 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m10:24:11.908813 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m10:24:11.934568 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m10:24:11.936094 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m10:24:11.937238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:13.021927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.085 seconds
[0m10:24:13.025023 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m10:24:13.208527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e87cabd4-a8b0-48f5-b842-32befc036425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20df0f440>]}
[0m10:24:13.210242 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.35s]
[0m10:24:13.211630 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m10:24:13.213791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:13.214732 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m10:24:13.215804 [info ] [MainThread]: 
[0m10:24:13.216769 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m10:24:13.218308 [debug] [MainThread]: Command end result
[0m10:24:13.322017 [info ] [MainThread]: 
[0m10:24:13.323038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:13.324063 [info ] [MainThread]: 
[0m10:24:13.324922 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:24:13.326419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.394646, "process_user_time": 3.980996, "process_kernel_time": 1.875757, "process_mem_max_rss": "234204", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m10:24:13.327587 [debug] [MainThread]: Command `dbt run` succeeded at 10:24:13.327482 after 9.40 seconds
[0m10:24:13.328593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe248ab29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244c3a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20eaab410>]}
[0m10:24:13.329396 [debug] [MainThread]: Flushing usage events
[0m10:24:17.015889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4c3aa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4c3a85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4bd17350>]}


============================== 10:24:17.022844 | c12e88c0-de3b-4c3c-963a-777a557addbd ==============================
[0m10:24:17.022844 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:24:17.023963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:24:17.988527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12e88c0-de3b-4c3c-963a-777a557addbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d1998ef60>]}
[0m10:24:18.048637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12e88c0-de3b-4c3c-963a-777a557addbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d1cecfe30>]}
[0m10:24:18.050233 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:24:18.147210 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:24:18.644744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:18.646175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:18.692114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12e88c0-de3b-4c3c-963a-777a557addbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d197797f0>]}
[0m10:24:18.915718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12e88c0-de3b-4c3c-963a-777a557addbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d1911b0b0>]}
[0m10:24:18.917388 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:24:18.918891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12e88c0-de3b-4c3c-963a-777a557addbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d19a0e8d0>]}
[0m10:24:18.922716 [info ] [MainThread]: 
[0m10:24:18.924463 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:24:18.931047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_analytics'
[0m10:24:18.952565 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:24:18.953514 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:24:18.954388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:19.545569 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.591 seconds
[0m10:24:19.549460 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:24:19.708741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m10:24:19.714638 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:24:19.716033 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:24:19.717113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:20.247566 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.530 seconds
[0m10:24:20.249940 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:24:20.410087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12e88c0-de3b-4c3c-963a-777a557addbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4cb1fd40>]}
[0m10:24:20.412089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:20.413484 [info ] [MainThread]: 
[0m10:24:20.424411 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:24:20.425885 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m10:24:20.426944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m10:24:20.427761 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:24:20.443145 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m10:24:20.469652 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:24:20.489914 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m10:24:20.532079 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m10:24:20.533926 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m10:24:20.535311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:21.083060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m10:24:21.092857 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m10:24:21.269638 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.84s]
[0m10:24:21.270901 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m10:24:21.271837 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:24:21.272630 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m10:24:21.273498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m10:24:21.274115 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:24:21.278834 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m10:24:21.304072 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:24:21.307468 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m10:24:21.334531 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m10:24:21.335650 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m10:24:21.336583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:21.967408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m10:24:21.970418 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m10:24:22.122855 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.85s]
[0m10:24:22.124320 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m10:24:22.125226 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:24:22.126377 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m10:24:22.127478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m10:24:22.128326 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:24:22.137152 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:24:22.169155 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:24:22.193608 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:24:22.198320 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:24:22.227293 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m10:24:22.228642 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m10:24:22.229607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:22.642666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.413 seconds
[0m10:24:22.646881 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m10:24:22.796963 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.67s]
[0m10:24:22.798554 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m10:24:22.799701 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:24:22.800882 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m10:24:22.802137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m10:24:22.803097 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:24:22.809064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m10:24:22.841715 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:24:22.845436 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m10:24:22.870342 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m10:24:22.871475 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m10:24:22.872542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:23.310868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m10:24:23.313501 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m10:24:23.511114 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.71s]
[0m10:24:23.512796 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m10:24:23.513982 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:24:23.515380 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m10:24:23.517281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m10:24:23.518210 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:24:23.525051 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m10:24:23.552609 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:24:23.555656 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m10:24:23.584444 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m10:24:23.585914 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m10:24:23.587061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:24.084443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m10:24:24.088594 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m10:24:24.296729 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.78s]
[0m10:24:24.298412 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m10:24:24.299819 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:24:24.300964 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m10:24:24.301908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m10:24:24.302633 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:24:24.316121 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m10:24:24.336078 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:24:24.340032 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m10:24:24.365585 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m10:24:24.366759 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:24:24.367643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:24.797204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m10:24:24.800666 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m10:24:24.953877 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.65s]
[0m10:24:24.956180 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m10:24:24.957379 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:24:24.958483 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m10:24:24.959497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m10:24:24.960436 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:24:24.969977 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m10:24:25.004840 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:24:25.008410 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m10:24:25.036900 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m10:24:25.038186 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:24:25.039200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:25.506462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m10:24:25.511607 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m10:24:25.667403 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.71s]
[0m10:24:25.669056 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m10:24:25.670153 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:24:25.670975 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m10:24:25.671857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m10:24:25.672676 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:24:25.679891 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m10:24:25.710135 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:24:25.713386 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m10:24:25.739359 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m10:24:25.740367 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:24:25.741204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:26.280438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m10:24:26.283095 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m10:24:26.463391 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.79s]
[0m10:24:26.465088 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m10:24:26.466480 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:24:26.467343 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m10:24:26.468336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m10:24:26.469072 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:24:26.476759 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m10:24:26.505586 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:24:26.509320 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m10:24:26.534819 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m10:24:26.535679 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:24:26.536505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:27.052396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m10:24:27.056863 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m10:24:27.230830 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.76s]
[0m10:24:27.233073 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m10:24:27.234704 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:24:27.235930 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m10:24:27.237455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m10:24:27.238768 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:24:27.246545 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m10:24:27.271772 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:24:27.275588 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m10:24:27.302725 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m10:24:27.303767 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:24:27.304543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:27.783511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m10:24:27.788479 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m10:24:27.938193 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.70s]
[0m10:24:27.940074 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m10:24:27.943062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:27.944139 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m10:24:27.944956 [info ] [MainThread]: 
[0m10:24:27.945830 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 9.02 seconds (9.02s).
[0m10:24:27.947666 [debug] [MainThread]: Command end result
[0m10:24:28.042782 [info ] [MainThread]: 
[0m10:24:28.044015 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:28.044858 [info ] [MainThread]: 
[0m10:24:28.045634 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m10:24:28.046795 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.124064, "process_user_time": 4.215456, "process_kernel_time": 1.843863, "process_mem_max_rss": "240188", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m10:24:28.047953 [debug] [MainThread]: Command `dbt test` succeeded at 10:24:28.047832 after 11.13 seconds
[0m10:24:28.048977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4f3d69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d4c250e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d19a04fb0>]}
[0m10:24:28.049951 [debug] [MainThread]: Flushing usage events
[0m10:24:31.561044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158a1c0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158abcf500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1589af5df0>]}


============================== 10:24:31.569950 | 3c9a93e6-4ffc-47a1-9a65-f4484e382130 ==============================
[0m10:24:31.569950 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:24:31.571177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:32.505171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1553ba3530>]}
[0m10:24:32.556382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1553d655e0>]}
[0m10:24:32.558007 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m10:24:32.643426 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:24:33.104449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:33.105649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:33.156203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158a2c9160>]}
[0m10:24:33.354673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15537a08f0>]}
[0m10:24:33.356003 [info ] [MainThread]: Found 5 models, 10 data tests, 4 snapshots, 3 sources, 459 macros
[0m10:24:33.356957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155a2a2660>]}
[0m10:24:33.359465 [info ] [MainThread]: 
[0m10:24:33.360727 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:24:33.366323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m10:24:33.381442 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m10:24:33.382771 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m10:24:33.384219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:33.984838 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.603 seconds
[0m10:24:33.988170 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m10:24:34.138718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_snapshots)
[0m10:24:34.149188 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m10:24:34.150617 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m10:24:34.152086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:34.551024 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.399 seconds
[0m10:24:34.555442 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m10:24:35.356914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m10:24:35.360725 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m10:24:35.361673 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m10:24:35.362728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:35.849017 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.486 seconds
[0m10:24:35.851710 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m10:24:36.049958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1553976a50>]}
[0m10:24:36.051425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:36.052447 [info ] [MainThread]: 
[0m10:24:36.061701 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:24:36.063358 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshots.moving_averages_snapshot ....................... [RUN]
[0m10:24:36.065175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now snapshot.dbt_stock_project.moving_averages_snapshot)
[0m10:24:36.066595 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:24:36.075093 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:24:36.152988 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:36.154630 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:36.155795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:36.676184 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.520 seconds
[0m10:24:36.686373 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:36.687681 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:24:36.790241 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.101 seconds
[0m10:24:36.799837 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:36.801046 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:24:36.908272 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.106 seconds
[0m10:24:36.948423 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:36.950099 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:24:37.999822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.048 seconds
[0m10:24:38.003785 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:38.004778 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:24:38.130073 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.124 seconds
[0m10:24:38.135162 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:38.136414 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:24:38.253165 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.115 seconds
[0m10:24:38.259122 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:38.260376 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:24:38.370094 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.109 seconds
[0m10:24:38.375295 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:38.376451 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m10:24:38.522985 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.146 seconds
[0m10:24:38.530179 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:38.531548 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m10:24:38.726871 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.194 seconds
[0m10:24:38.750341 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:38.752026 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:38.932696 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.179 seconds
[0m10:24:38.937773 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:38.938886 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:39.027070 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.087 seconds
[0m10:24:39.028843 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:39.049547 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:39.050412 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
BEGIN
[0m10:24:39.183290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m10:24:39.184688 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:39.185778 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:24:39.766631 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.579 seconds
[0m10:24:39.769031 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m10:24:39.770469 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
COMMIT
[0m10:24:40.033204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.261 seconds
[0m10:24:40.054723 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: Close
[0m10:24:40.201673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1553d2aa20>]}
[0m10:24:40.203308 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshots.moving_averages_snapshot ....................... [[32mSUCCESS 0[0m in 4.14s]
[0m10:24:40.204603 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m10:24:40.205608 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.rsi_snapshot
[0m10:24:40.206586 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshots.rsi_snapshot ................................... [RUN]
[0m10:24:40.207492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.moving_averages_snapshot, now snapshot.dbt_stock_project.rsi_snapshot)
[0m10:24:40.208327 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.rsi_snapshot
[0m10:24:40.212311 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.rsi_snapshot
[0m10:24:40.217651 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:40.218790 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        select close, rsi_14d from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:40.219963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:40.773864 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.554 seconds
[0m10:24:40.779633 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:40.780915 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:24:40.889368 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.107 seconds
[0m10:24:40.894523 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:40.895532 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:24:40.980057 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.083 seconds
[0m10:24:40.987607 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:40.988833 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:24:41.602335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m10:24:41.606235 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:41.607264 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m10:24:41.709962 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.102 seconds
[0m10:24:41.714955 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:41.716196 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:24:41.814833 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m10:24:41.819442 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:41.820808 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m10:24:41.927150 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.105 seconds
[0m10:24:41.931987 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:41.933181 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m10:24:42.029507 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.095 seconds
[0m10:24:42.035702 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:42.037037 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m10:24:42.148266 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.110 seconds
[0m10:24:42.157767 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:42.158814 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:42.444626 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.285 seconds
[0m10:24:42.446837 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:42.447971 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:42.531762 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m10:24:42.532924 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:42.552374 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:42.553394 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
BEGIN
[0m10:24:42.695528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m10:24:42.697081 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:42.698399 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "AVG_GAIN_14D", "AVG_LOSS_14D", "RSI_14D", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "AVG_GAIN_14D", "AVG_LOSS_14D", "RSI_14D", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:24:43.248531 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.549 seconds
[0m10:24:43.250536 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m10:24:43.252363 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
COMMIT
[0m10:24:43.484442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m10:24:43.487288 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: Close
[0m10:24:43.664984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1553ba3170>]}
[0m10:24:43.666633 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshots.rsi_snapshot ................................... [[32mSUCCESS 0[0m in 3.46s]
[0m10:24:43.667852 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.rsi_snapshot
[0m10:24:43.668619 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:24:43.669661 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshots.stock_data_snapshot ............................ [RUN]
[0m10:24:43.670600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.rsi_snapshot, now snapshot.dbt_stock_project.stock_data_snapshot)
[0m10:24:43.671495 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:24:43.676494 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:24:43.682594 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:43.683530 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        select close, volume, daily_change from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:43.684585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:44.145027 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.460 seconds
[0m10:24:44.150380 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:44.152140 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:24:44.260744 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.107 seconds
[0m10:24:44.267620 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:44.269013 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:24:44.390155 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.120 seconds
[0m10:24:44.398158 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:44.399491 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:24:45.184856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m10:24:45.189293 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:45.190879 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m10:24:45.307792 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.116 seconds
[0m10:24:45.312641 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:45.313778 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:24:45.402470 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.087 seconds
[0m10:24:45.409285 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:45.410382 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m10:24:45.531487 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.120 seconds
[0m10:24:45.536482 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:45.537821 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m10:24:45.664764 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.125 seconds
[0m10:24:45.671832 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:45.673135 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m10:24:45.805026 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.130 seconds
[0m10:24:45.812575 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:45.814491 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:46.044279 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.228 seconds
[0m10:24:46.046736 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:46.047859 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:46.312376 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.263 seconds
[0m10:24:46.313647 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:46.330288 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:46.331286 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
BEGIN
[0m10:24:46.526178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m10:24:46.527472 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:46.528259 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "VOLUME", "DAILY_CHANGE", "MOVING_AVG_7", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "VOLUME", "DAILY_CHANGE", "MOVING_AVG_7", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:24:47.164384 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.635 seconds
[0m10:24:47.165879 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m10:24:47.166787 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
COMMIT
[0m10:24:47.470666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m10:24:47.473836 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: Close
[0m10:24:47.633442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1552d39ee0>]}
[0m10:24:47.634921 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshots.stock_data_snapshot ............................ [[32mSUCCESS 0[0m in 3.96s]
[0m10:24:47.636296 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.stock_data_snapshot
[0m10:24:47.637426 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:24:47.638577 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshots.weekly_volume_snapshot ......................... [RUN]
[0m10:24:47.639734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.stock_data_snapshot, now snapshot.dbt_stock_project.weekly_volume_snapshot)
[0m10:24:47.640839 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:24:47.645659 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:24:47.653194 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:47.654693 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        select weekly_volume from (
                



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:47.655783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:48.150226 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.494 seconds
[0m10:24:48.154180 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:48.155670 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:24:48.256553 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.099 seconds
[0m10:24:48.262816 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:48.263911 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:24:48.355033 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.090 seconds
[0m10:24:48.361871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:48.363038 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m10:24:48.946828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m10:24:48.951040 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:48.952208 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
[0m10:24:49.146595 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.194 seconds
[0m10:24:49.153076 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:49.154173 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:24:49.333545 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.178 seconds
[0m10:24:49.338443 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:49.339469 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
[0m10:24:49.475811 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.135 seconds
[0m10:24:49.480669 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:49.481696 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
[0m10:24:49.578370 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.095 seconds
[0m10:24:49.585019 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:49.586149 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp"
[0m10:24:49.691426 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.104 seconds
[0m10:24:49.697520 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:49.698751 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT
    symbol,
    CAST(date AS DATE) AS trade_date,

    -- 7-day rolling (weekly) volume sum
    SUM(CAST(volume AS INTEGER)) OVER (
        PARTITION BY symbol
        ORDER BY CAST(date AS DATE)
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS weekly_volume,

    -- Composite key for uniqueness
    CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."WEEKLY_VOLUME" != source_data."WEEKLY_VOLUME"
        or
        (
            ((snapshotted_data."WEEKLY_VOLUME" is null) and not (source_data."WEEKLY_VOLUME" is null))
            or
            ((not snapshotted_data."WEEKLY_VOLUME" is null) and (source_data."WEEKLY_VOLUME" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:49.934223 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.234 seconds
[0m10:24:49.936099 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:49.937149 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:24:50.060032 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.122 seconds
[0m10:24:50.061768 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:50.082772 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:50.083788 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
BEGIN
[0m10:24:50.200764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m10:24:50.202035 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:50.202909 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."WEEKLY_VOLUME_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "WEEKLY_VOLUME", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "WEEKLY_VOLUME", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:24:50.727040 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.523 seconds
[0m10:24:50.729029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.weekly_volume_snapshot"
[0m10:24:50.730583 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.weekly_volume_snapshot"} */
COMMIT
[0m10:24:51.010997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m10:24:51.016656 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.weekly_volume_snapshot: Close
[0m10:24:51.171714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9a93e6-4ffc-47a1-9a65-f4484e382130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1552d4fda0>]}
[0m10:24:51.173408 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshots.weekly_volume_snapshot ......................... [[32mSUCCESS 0[0m in 3.53s]
[0m10:24:51.174745 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.weekly_volume_snapshot
[0m10:24:51.176831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:51.177489 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.weekly_volume_snapshot' was properly closed.
[0m10:24:51.178142 [info ] [MainThread]: 
[0m10:24:51.178958 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 17.82 seconds (17.82s).
[0m10:24:51.180549 [debug] [MainThread]: Command end result
[0m10:24:51.277042 [info ] [MainThread]: 
[0m10:24:51.278160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:51.280130 [info ] [MainThread]: 
[0m10:24:51.282123 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:24:51.284453 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 19.838406, "process_user_time": 4.282172, "process_kernel_time": 1.778627, "process_mem_max_rss": "227884", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m10:24:51.285999 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:24:51.285704 after 19.84 seconds
[0m10:24:51.287226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1589defbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155805eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1552d3b7a0>]}
[0m10:24:51.288322 [debug] [MainThread]: Flushing usage events
[0m18:17:17.801838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b0fb3bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8afbbccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8af9e2de0>]}


============================== 18:17:17.812019 | efe080a9-5072-4f53-9a7c-dda03260d0f0 ==============================
[0m18:17:17.812019 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:17:17.813173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:17:19.682151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b017d430>]}
[0m18:17:19.730478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8aee5e720>]}
[0m18:17:19.733157 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m18:17:19.831964 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:17:20.454285 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m18:17:20.455405 [debug] [MainThread]: Partial parsing: deleted file: dbt_stock_project://snapshots/snapshot_volume _summary.sql
[0m18:17:20.562677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d464050>]}
[0m18:17:20.757830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d28ca40>]}
[0m18:17:20.758671 [info ] [MainThread]: Found 5 models, 10 data tests, 3 snapshots, 3 sources, 459 macros
[0m18:17:20.759300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d4156d0>]}
[0m18:17:20.761550 [info ] [MainThread]: 
[0m18:17:20.762971 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:17:20.767908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m18:17:20.783853 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m18:17:20.785014 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m18:17:20.786205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:21.576336 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.790 seconds
[0m18:17:21.578553 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m18:17:21.718653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m18:17:21.728378 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m18:17:21.729526 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m18:17:21.730697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:22.138976 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.408 seconds
[0m18:17:22.143762 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m18:17:22.366098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m18:17:22.370234 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m18:17:22.371126 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m18:17:22.371932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:22.767999 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.396 seconds
[0m18:17:22.771348 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m18:17:22.906703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d5fed20>]}
[0m18:17:22.907556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:22.908077 [info ] [MainThread]: 
[0m18:17:22.917792 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock
[0m18:17:22.919116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now model.dbt_stock_project.stock)
[0m18:17:22.919968 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock
[0m18:17:22.928014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock"
[0m18:17:22.950159 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock
[0m18:17:22.951013 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.stock_indicators
[0m18:17:22.951840 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.stock_indicators ........................ [RUN]
[0m18:17:22.953004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock, now model.dbt_stock_project.stock_indicators)
[0m18:17:22.953672 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.stock_indicators
[0m18:17:22.958197 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.stock_indicators"
[0m18:17:22.973960 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.stock_indicators
[0m18:17:23.005567 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.stock_indicators"
[0m18:17:23.022619 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.stock_indicators"
[0m18:17:23.023694 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.stock_indicators"} */
create or replace transient table USER_DB_BLUEJAY.analytics.stock_indicators
         as
        (SELECT
  "SYMBOL" AS symbol,
  CAST("DATE" AS DATE) AS trade_date,
  CAST("CLOSE" AS FLOAT) AS close,
  CAST("VOLUME" AS INTEGER) AS volume,

  -- Daily change
  CAST("CLOSE" - LAG("CLOSE") OVER (
    PARTITION BY "SYMBOL"
    ORDER BY "DATE"
  ) AS FLOAT) AS daily_change,

  -- 7-day moving average of close price
  ROUND(
    AVG("CLOSE") OVER (
      PARTITION BY "SYMBOL"
      ORDER BY "DATE"
      ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ), 2
  ) AS moving_avg_7,

  -- Composite key
  CONCAT("SYMBOL", '_', CAST("DATE" AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m18:17:23.024853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:24.459255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.434 seconds
[0m18:17:24.481277 [debug] [Thread-1 (]: On model.dbt_stock_project.stock_indicators: Close
[0m18:17:24.598365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87d5c28d0>]}
[0m18:17:24.599499 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.stock_indicators ................... [[32mSUCCESS 1[0m in 1.64s]
[0m18:17:24.600359 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.stock_indicators
[0m18:17:24.600983 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.volume_summary
[0m18:17:24.601833 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.volume_summary .......................... [RUN]
[0m18:17:24.602713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.stock_indicators, now model.dbt_stock_project.volume_summary)
[0m18:17:24.603302 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.volume_summary
[0m18:17:24.606329 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.volume_summary"
[0m18:17:24.625236 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.volume_summary
[0m18:17:24.629146 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.volume_summary"
[0m18:17:24.656050 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.volume_summary"
[0m18:17:24.657461 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.volume_summary"} */
create or replace transient table USER_DB_BLUEJAY.analytics.volume_summary
         as
        (-- models/output/volume_summary.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  
  -- 7-day rolling (weekly) volume sum
  SUM(CAST(volume AS INTEGER)) OVER (
    PARTITION BY symbol
    ORDER BY CAST(date AS DATE)
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) AS weekly_volume,

  -- Composite key for uniqueness
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id

FROM USER_DB_BLUEJAY.raw.STOCK
ORDER BY symbol, trade_date
        );
[0m18:17:24.658435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:25.568737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.910 seconds
[0m18:17:25.574617 [debug] [Thread-1 (]: On model.dbt_stock_project.volume_summary: Close
[0m18:17:25.699868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87c7cedb0>]}
[0m18:17:25.701134 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.volume_summary ..................... [[32mSUCCESS 1[0m in 1.10s]
[0m18:17:25.702220 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.volume_summary
[0m18:17:25.703205 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.moving_averages
[0m18:17:25.704051 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_averages ......................... [RUN]
[0m18:17:25.704838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.volume_summary, now model.dbt_stock_project.moving_averages)
[0m18:17:25.705685 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.moving_averages
[0m18:17:25.718416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.moving_averages"
[0m18:17:25.735882 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.moving_averages
[0m18:17:25.740214 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.moving_averages"
[0m18:17:25.757718 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.moving_averages"
[0m18:17:25.758760 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.moving_averages"} */
create or replace transient table USER_DB_BLUEJAY.analytics.moving_averages
         as
        (-- models/output/moving_averages.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT * FROM __dbt__cte__stock
),

moving_avg_calc AS (
  SELECT
    symbol,
    trade_date,
    close,

    -- 7-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_7d_ma,

    -- 14-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_14d_ma,

    -- 30-day moving average
    ROUND(
      AVG(close) OVER (
        PARTITION BY symbol
        ORDER BY trade_date
        ROWS BETWEEN 29 PRECEDING AND CURRENT ROW
      ), 2
    ) AS close_price_30d_ma,

    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key

  FROM base
)

SELECT * FROM moving_avg_calc
ORDER BY symbol, trade_date
        );
[0m18:17:25.759536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:27.024900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.265 seconds
[0m18:17:27.027880 [debug] [Thread-1 (]: On model.dbt_stock_project.moving_averages: Close
[0m18:17:27.159189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8b0727d10>]}
[0m18:17:27.160569 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_averages .................... [[32mSUCCESS 1[0m in 1.45s]
[0m18:17:27.162136 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.moving_averages
[0m18:17:27.163274 [debug] [Thread-1 (]: Began running node model.dbt_stock_project.rsi
[0m18:17:27.164521 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.rsi ..................................... [RUN]
[0m18:17:27.165628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_stock_project.moving_averages, now model.dbt_stock_project.rsi)
[0m18:17:27.166447 [debug] [Thread-1 (]: Began compiling node model.dbt_stock_project.rsi
[0m18:17:27.187163 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_stock_project.rsi"
[0m18:17:27.203294 [debug] [Thread-1 (]: Began executing node model.dbt_stock_project.rsi
[0m18:17:27.207012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_stock_project.rsi"
[0m18:17:27.222663 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_stock_project.rsi"
[0m18:17:27.223690 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "model.dbt_stock_project.rsi"} */
create or replace transient table USER_DB_BLUEJAY.analytics.rsi
         as
        (-- models/output/rsi.sql

WITH  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), base AS (
  SELECT
    symbol,
    trade_date,
    close,
    LAG(close) OVER (
      PARTITION BY symbol ORDER BY trade_date
    ) AS prev_close
  FROM __dbt__cte__stock
),

gains_losses AS (
  SELECT
    symbol,
    trade_date,
    close,
    prev_close,
    CASE 
      WHEN close - prev_close > 0 THEN close - prev_close
      ELSE 0
    END AS gain,
    CASE 
      WHEN close - prev_close < 0 THEN ABS(close - prev_close)
      ELSE 0
    END AS loss
  FROM base
),

rsi_calc AS (
  SELECT
    symbol,
    trade_date,
    close,
    AVG(gain) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_gain_14d,
    AVG(loss) OVER (
      PARTITION BY symbol ORDER BY trade_date
      ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
    ) AS avg_loss_14d
  FROM gains_losses
),

rsi_final AS (
  SELECT
    symbol,
    trade_date,
    close,
    avg_gain_14d,
    avg_loss_14d,
    CASE 
      WHEN avg_loss_14d = 0 THEN 100
      ELSE ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2)
    END AS rsi_14d,
    CONCAT(symbol, '_', trade_date) AS stock_id  -- Composite key
  FROM rsi_calc
)

SELECT * FROM rsi_final
ORDER BY symbol, trade_date
        );
[0m18:17:27.224575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:28.096267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.872 seconds
[0m18:17:28.099382 [debug] [Thread-1 (]: On model.dbt_stock_project.rsi: Close
[0m18:17:28.238977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe080a9-5072-4f53-9a7c-dda03260d0f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87c5168d0>]}
[0m18:17:28.240267 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.07s]
[0m18:17:28.241376 [debug] [Thread-1 (]: Finished running node model.dbt_stock_project.rsi
[0m18:17:28.243329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:28.244127 [debug] [MainThread]: Connection 'model.dbt_stock_project.rsi' was properly closed.
[0m18:17:28.244812 [info ] [MainThread]: 
[0m18:17:28.245594 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m18:17:28.246961 [debug] [MainThread]: Command end result
[0m18:17:28.340220 [info ] [MainThread]: 
[0m18:17:28.341330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:28.342295 [info ] [MainThread]: 
[0m18:17:28.343341 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:17:28.346158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.673896, "process_user_time": 4.079719, "process_kernel_time": 2.411404, "process_mem_max_rss": "248900", "process_in_blocks": "142232", "process_out_blocks": "8"}
[0m18:17:28.347646 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:28.347424 after 10.68 seconds
[0m18:17:28.348963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8af2d0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87dad7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8af67a0f0>]}
[0m18:17:28.350286 [debug] [MainThread]: Flushing usage events
[0m18:17:32.619655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1d607f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1c70a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1ca108c0>]}


============================== 18:17:32.626103 | da500c95-5bff-4ae9-9a66-9a11db4a37ec ==============================
[0m18:17:32.626103 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:17:32.627156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:17:33.650637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da500c95-5bff-4ae9-9a66-9a11db4a37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1dceebd0>]}
[0m18:17:33.702740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da500c95-5bff-4ae9-9a66-9a11db4a37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1d83c350>]}
[0m18:17:33.704214 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m18:17:33.802652 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:17:34.267644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:34.268968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:34.320841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da500c95-5bff-4ae9-9a66-9a11db4a37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1c33d070>]}
[0m18:17:34.553454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da500c95-5bff-4ae9-9a66-9a11db4a37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de6532db0>]}
[0m18:17:34.554733 [info ] [MainThread]: Found 5 models, 10 data tests, 3 snapshots, 3 sources, 459 macros
[0m18:17:34.555717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da500c95-5bff-4ae9-9a66-9a11db4a37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de7732660>]}
[0m18:17:34.558401 [info ] [MainThread]: 
[0m18:17:34.559778 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:17:34.565384 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY_snapshots'
[0m18:17:34.580579 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m18:17:34.581962 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m18:17:34.583213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:35.160539 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.577 seconds
[0m18:17:35.163465 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m18:17:35.293708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now list_USER_DB_BLUEJAY_analytics)
[0m18:17:35.298687 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m18:17:35.300020 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m18:17:35.300984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:35.708593 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.408 seconds
[0m18:17:35.711049 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m18:17:35.822914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da500c95-5bff-4ae9-9a66-9a11db4a37ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de64f75c0>]}
[0m18:17:35.824146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:35.825121 [info ] [MainThread]: 
[0m18:17:35.833990 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m18:17:35.835113 [info ] [Thread-1 (]: 1 of 10 START test not_null_moving_averages_stock_id ........................... [RUN]
[0m18:17:35.836245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7)
[0m18:17:35.837222 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m18:17:35.854551 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m18:17:35.876869 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m18:17:35.898072 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m18:17:35.932879 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"
[0m18:17:35.934094 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is null



      
    ) dbt_internal_test
[0m18:17:35.935187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:36.443424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m18:17:36.456082 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7: Close
[0m18:17:36.596482 [info ] [Thread-1 (]: 1 of 10 PASS not_null_moving_averages_stock_id ................................. [[32mPASS[0m in 0.76s]
[0m18:17:36.598369 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7
[0m18:17:36.599914 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m18:17:36.601131 [info ] [Thread-1 (]: 2 of 10 START test not_null_rsi_stock_id ....................................... [RUN]
[0m18:17:36.602447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_moving_averages_stock_id.929634caa7, now test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66)
[0m18:17:36.603780 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m18:17:36.609101 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m18:17:36.644383 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m18:17:36.649647 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m18:17:36.680263 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"
[0m18:17:36.682153 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select stock_id
from USER_DB_BLUEJAY.analytics.rsi
where stock_id is null



      
    ) dbt_internal_test
[0m18:17:36.683269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:37.269625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m18:17:37.272713 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66: Close
[0m18:17:37.448242 [info ] [Thread-1 (]: 2 of 10 PASS not_null_rsi_stock_id ............................................. [[32mPASS[0m in 0.85s]
[0m18:17:37.449825 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66
[0m18:17:37.450805 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m18:17:37.451699 [info ] [Thread-1 (]: 3 of 10 START test not_null_stock_stock_id ..................................... [RUN]
[0m18:17:37.452784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_rsi_stock_id.f4eb37dd66, now test.dbt_stock_project.not_null_stock_stock_id.adc260baa6)
[0m18:17:37.453450 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m18:17:37.461505 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m18:17:37.481323 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m18:17:37.498493 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m18:17:37.502320 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m18:17:37.518045 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"
[0m18:17:37.518810 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_stock_id.adc260baa6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select stock_id
from __dbt__cte__stock
where stock_id is null



      
    ) dbt_internal_test
[0m18:17:37.519480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:37.921343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m18:17:37.923875 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_stock_id.adc260baa6: Close
[0m18:17:38.044412 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stock_stock_id ........................................... [[32mPASS[0m in 0.59s]
[0m18:17:38.046173 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_stock_id.adc260baa6
[0m18:17:38.047367 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m18:17:38.048339 [info ] [Thread-1 (]: 4 of 10 START test not_null_stock_symbol ....................................... [RUN]
[0m18:17:38.049243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_stock_id.adc260baa6, now test.dbt_stock_project.not_null_stock_symbol.03a9f8d775)
[0m18:17:38.049949 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m18:17:38.055893 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m18:17:38.084992 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m18:17:38.089135 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m18:17:38.118826 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"
[0m18:17:38.119835 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_symbol.03a9f8d775"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select symbol
from __dbt__cte__stock
where symbol is null



      
    ) dbt_internal_test
[0m18:17:38.120672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:38.426490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m18:17:38.429268 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_symbol.03a9f8d775: Close
[0m18:17:38.574400 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stock_symbol ............................................. [[32mPASS[0m in 0.52s]
[0m18:17:38.576057 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_symbol.03a9f8d775
[0m18:17:38.577378 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m18:17:38.578458 [info ] [Thread-1 (]: 5 of 10 START test not_null_stock_trade_date ................................... [RUN]
[0m18:17:38.579956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_symbol.03a9f8d775, now test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe)
[0m18:17:38.581092 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m18:17:38.589569 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m18:17:38.608423 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m18:17:38.613179 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m18:17:38.637243 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"
[0m18:17:38.638223 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select trade_date
from __dbt__cte__stock
where trade_date is null



      
    ) dbt_internal_test
[0m18:17:38.639099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:38.959494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m18:17:38.962563 [debug] [Thread-1 (]: On test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe: Close
[0m18:17:39.096310 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stock_trade_date ......................................... [[32mPASS[0m in 0.52s]
[0m18:17:39.097626 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe
[0m18:17:39.098760 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m18:17:39.099808 [info ] [Thread-1 (]: 6 of 10 START test relationships_moving_averages_stock_id__stock_id__ref_stock_  [RUN]
[0m18:17:39.100842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.not_null_stock_trade_date.f652f0b6fe, now test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961)
[0m18:17:39.101665 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m18:17:39.115754 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m18:17:39.137792 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m18:17:39.141162 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m18:17:39.165281 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"
[0m18:17:39.166546 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.moving_averages
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:17:39.167490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:39.628335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m18:17:39.631317 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961: Close
[0m18:17:39.758083 [info ] [Thread-1 (]: 6 of 10 PASS relationships_moving_averages_stock_id__stock_id__ref_stock_ ...... [[32mPASS[0m in 0.66s]
[0m18:17:39.759638 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961
[0m18:17:39.760815 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m18:17:39.761917 [info ] [Thread-1 (]: 7 of 10 START test relationships_rsi_stock_id__stock_id__ref_stock_ ............ [RUN]
[0m18:17:39.762957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_moving_averages_stock_id__stock_id__ref_stock_.17d59fa961, now test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e)
[0m18:17:39.763960 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m18:17:39.773017 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m18:17:39.800995 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m18:17:39.805968 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m18:17:39.835884 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"
[0m18:17:39.836693 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with  __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
), child as (
    select stock_id as from_field
    from USER_DB_BLUEJAY.analytics.rsi
    where stock_id is not null
),

parent as (
    select stock_id as to_field
    from __dbt__cte__stock
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:17:39.837489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:40.447149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m18:17:40.450228 [debug] [Thread-1 (]: On test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e: Close
[0m18:17:40.579044 [info ] [Thread-1 (]: 7 of 10 PASS relationships_rsi_stock_id__stock_id__ref_stock_ .................. [[32mPASS[0m in 0.82s]
[0m18:17:40.580638 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e
[0m18:17:40.582053 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m18:17:40.582946 [info ] [Thread-1 (]: 8 of 10 START test unique_moving_averages_stock_id ............................. [RUN]
[0m18:17:40.584050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.relationships_rsi_stock_id__stock_id__ref_stock_.43c4275f2e, now test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696)
[0m18:17:40.584954 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m18:17:40.591716 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m18:17:40.611203 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m18:17:40.614892 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m18:17:40.632248 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"
[0m18:17:40.633323 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.moving_averages
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:17:40.634042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:41.017171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m18:17:41.021085 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696: Close
[0m18:17:41.245941 [info ] [Thread-1 (]: 8 of 10 PASS unique_moving_averages_stock_id ................................... [[32mPASS[0m in 0.66s]
[0m18:17:41.247892 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696
[0m18:17:41.249353 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m18:17:41.250602 [info ] [Thread-1 (]: 9 of 10 START test unique_rsi_stock_id ......................................... [RUN]
[0m18:17:41.252206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_moving_averages_stock_id.9b825a5696, now test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d)
[0m18:17:41.253341 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m18:17:41.260201 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m18:17:41.298095 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m18:17:41.302040 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m18:17:41.339899 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"
[0m18:17:41.341282 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stock_id as unique_field,
    count(*) as n_records

from USER_DB_BLUEJAY.analytics.rsi
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:17:41.342303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:41.732375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m18:17:41.735371 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d: Close
[0m18:17:41.901528 [info ] [Thread-1 (]: 9 of 10 PASS unique_rsi_stock_id ............................................... [[32mPASS[0m in 0.65s]
[0m18:17:41.902855 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d
[0m18:17:41.903808 [debug] [Thread-1 (]: Began running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m18:17:41.904592 [info ] [Thread-1 (]: 10 of 10 START test unique_stock_stock_id ...................................... [RUN]
[0m18:17:41.905590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_stock_project.unique_rsi_stock_id.702efb4b3d, now test.dbt_stock_project.unique_stock_stock_id.2cb38703a3)
[0m18:17:41.906332 [debug] [Thread-1 (]: Began compiling node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m18:17:41.914433 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m18:17:41.934048 [debug] [Thread-1 (]: Began executing node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m18:17:41.937709 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m18:17:41.959065 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"
[0m18:17:41.959981 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "test.dbt_stock_project.unique_stock_stock_id.2cb38703a3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stock as (
-- models/input/stock.sql

SELECT
  symbol,
  CAST(date AS DATE) AS trade_date,
  CAST(open AS FLOAT) AS open,
  CAST(high AS FLOAT) AS high,
  CAST(low AS FLOAT) AS low,
  CAST(close AS FLOAT) AS close,
  CAST(volume AS INTEGER) AS volume,
  CONCAT(symbol, '_', CAST(date AS DATE)) AS stock_id  -- Composite primary key
FROM USER_DB_BLUEJAY.raw.STOCK
) select
    stock_id as unique_field,
    count(*) as n_records

from __dbt__cte__stock
where stock_id is not null
group by stock_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:17:41.960802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:42.439235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m18:17:42.441746 [debug] [Thread-1 (]: On test.dbt_stock_project.unique_stock_stock_id.2cb38703a3: Close
[0m18:17:42.561697 [info ] [Thread-1 (]: 10 of 10 PASS unique_stock_stock_id ............................................ [[32mPASS[0m in 0.66s]
[0m18:17:42.563235 [debug] [Thread-1 (]: Finished running node test.dbt_stock_project.unique_stock_stock_id.2cb38703a3
[0m18:17:42.565707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:42.566779 [debug] [MainThread]: Connection 'test.dbt_stock_project.unique_stock_stock_id.2cb38703a3' was properly closed.
[0m18:17:42.567655 [info ] [MainThread]: 
[0m18:17:42.568425 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 8.01 seconds (8.01s).
[0m18:17:42.570422 [debug] [MainThread]: Command end result
[0m18:17:42.672729 [info ] [MainThread]: 
[0m18:17:42.673733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:42.674643 [info ] [MainThread]: 
[0m18:17:42.675371 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m18:17:42.676938 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.136752, "process_user_time": 4.057814, "process_kernel_time": 1.91963, "process_mem_max_rss": "234864", "process_in_blocks": "1976", "process_out_blocks": "8"}
[0m18:17:42.677900 [debug] [MainThread]: Command `dbt test` succeeded at 18:17:42.677767 after 10.14 seconds
[0m18:17:42.678660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1d2e9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1cba63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1c70dc70>]}
[0m18:17:42.679673 [debug] [MainThread]: Flushing usage events
[0m18:17:46.348364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6631fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d64907cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6719ac00>]}


============================== 18:17:46.353812 | 8ee0c55b-b823-412f-a89f-7076157aa15e ==============================
[0m18:17:46.353812 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:17:46.354856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:47.391697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ee0c55b-b823-412f-a89f-7076157aa15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2ed362a0>]}
[0m18:17:47.447210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ee0c55b-b823-412f-a89f-7076157aa15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6437c7a0>]}
[0m18:17:47.448598 [info ] [MainThread]: Registered adapter: snowflake=1.8.1
[0m18:17:47.548158 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:17:48.031974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:48.033016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:48.086309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ee0c55b-b823-412f-a89f-7076157aa15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2eae9a00>]}
[0m18:17:48.261029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ee0c55b-b823-412f-a89f-7076157aa15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2e552b70>]}
[0m18:17:48.262056 [info ] [MainThread]: Found 5 models, 10 data tests, 3 snapshots, 3 sources, 459 macros
[0m18:17:48.263064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee0c55b-b823-412f-a89f-7076157aa15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2e55f890>]}
[0m18:17:48.265953 [info ] [MainThread]: 
[0m18:17:48.267244 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:17:48.272447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BLUEJAY'
[0m18:17:48.291033 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY"
[0m18:17:48.292336 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY"} */
show terse schemas in database USER_DB_BLUEJAY
    limit 10000
[0m18:17:48.293287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:48.862713 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.569 seconds
[0m18:17:48.865485 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY: Close
[0m18:17:49.029353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY, now list_USER_DB_BLUEJAY_analytics)
[0m18:17:49.039906 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_analytics"
[0m18:17:49.041430 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_analytics"} */
show terse objects in USER_DB_BLUEJAY.analytics limit 10000
[0m18:17:49.042268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:49.421947 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.379 seconds
[0m18:17:49.426869 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_analytics: Close
[0m18:17:49.562210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_analytics, now list_USER_DB_BLUEJAY_snapshots)
[0m18:17:49.569281 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BLUEJAY_snapshots"
[0m18:17:49.570260 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "connection_name": "list_USER_DB_BLUEJAY_snapshots"} */
show terse objects in USER_DB_BLUEJAY.snapshots limit 10000
[0m18:17:49.571016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:49.956277 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.385 seconds
[0m18:17:49.958649 [debug] [ThreadPool]: On list_USER_DB_BLUEJAY_snapshots: Close
[0m18:17:50.086726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ee0c55b-b823-412f-a89f-7076157aa15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2f083aa0>]}
[0m18:17:50.087706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:50.088538 [info ] [MainThread]: 
[0m18:17:50.098326 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m18:17:50.099828 [info ] [Thread-1 (]: 1 of 3 START snapshot snapshots.moving_averages_snapshot ....................... [RUN]
[0m18:17:50.100933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BLUEJAY_snapshots, now snapshot.dbt_stock_project.moving_averages_snapshot)
[0m18:17:50.101657 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.moving_averages_snapshot
[0m18:17:50.109817 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.moving_averages_snapshot
[0m18:17:50.173456 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:50.174524 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select close_price_7d_ma, close_price_14d_ma, close_price_30d_ma from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m18:17:50.175535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:50.599027 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.423 seconds
[0m18:17:50.610383 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:50.611955 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m18:17:50.705033 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.092 seconds
[0m18:17:50.716507 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:50.718006 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m18:17:50.803781 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.084 seconds
[0m18:17:50.846160 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:50.847508 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m18:17:51.920159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.071 seconds
[0m18:17:51.923546 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:51.924379 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m18:17:52.015734 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.090 seconds
[0m18:17:52.020494 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:52.021703 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m18:17:52.098361 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.075 seconds
[0m18:17:52.103885 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:52.104986 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m18:17:52.185801 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.079 seconds
[0m18:17:52.192516 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:52.193565 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
[0m18:17:52.285650 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m18:17:52.293556 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:52.294589 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp"
[0m18:17:52.422182 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.126 seconds
[0m18:17:52.444958 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:52.446514 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.moving_averages


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE_PRICE_7D_MA" != source_data."CLOSE_PRICE_7D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_7D_MA" is null) and not (source_data."CLOSE_PRICE_7D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_7D_MA" is null) and (source_data."CLOSE_PRICE_7D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_14D_MA" != source_data."CLOSE_PRICE_14D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_14D_MA" is null) and not (source_data."CLOSE_PRICE_14D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_14D_MA" is null) and (source_data."CLOSE_PRICE_14D_MA" is null))
        ) or snapshotted_data."CLOSE_PRICE_30D_MA" != source_data."CLOSE_PRICE_30D_MA"
        or
        (
            ((snapshotted_data."CLOSE_PRICE_30D_MA" is null) and not (source_data."CLOSE_PRICE_30D_MA" is null))
            or
            ((not snapshotted_data."CLOSE_PRICE_30D_MA" is null) and (source_data."CLOSE_PRICE_30D_MA" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m18:17:52.657578 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.210 seconds
[0m18:17:52.662158 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:52.663194 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:17:52.760826 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.097 seconds
[0m18:17:52.762041 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:52.777934 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:52.778797 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
BEGIN
[0m18:17:52.908795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m18:17:52.910072 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:52.911563 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."MOVING_AVERAGES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "CLOSE_PRICE_7D_MA", "CLOSE_PRICE_14D_MA", "CLOSE_PRICE_30D_MA", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:17:53.365729 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.453 seconds
[0m18:17:53.367651 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.moving_averages_snapshot"
[0m18:17:53.368960 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.moving_averages_snapshot"} */
COMMIT
[0m18:17:53.628780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m18:17:53.651243 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.moving_averages_snapshot: Close
[0m18:17:53.794130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ee0c55b-b823-412f-a89f-7076157aa15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2e9c0170>]}
[0m18:17:53.795880 [info ] [Thread-1 (]: 1 of 3 OK snapshotted snapshots.moving_averages_snapshot ....................... [[32mSUCCESS 0[0m in 3.69s]
[0m18:17:53.797397 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.moving_averages_snapshot
[0m18:17:53.798481 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.rsi_snapshot
[0m18:17:53.799551 [info ] [Thread-1 (]: 2 of 3 START snapshot snapshots.rsi_snapshot ................................... [RUN]
[0m18:17:53.800594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.moving_averages_snapshot, now snapshot.dbt_stock_project.rsi_snapshot)
[0m18:17:53.801514 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.rsi_snapshot
[0m18:17:53.804966 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.rsi_snapshot
[0m18:17:53.809341 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:53.810699 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        select close, rsi_14d from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m18:17:53.811983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:54.798998 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.987 seconds
[0m18:17:54.802812 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:54.803984 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m18:17:54.902250 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m18:17:54.907175 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:54.908209 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m18:17:55.005637 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m18:17:55.013624 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:55.014768 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m18:17:55.647522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m18:17:55.651097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:55.652182 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m18:17:55.764967 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.112 seconds
[0m18:17:55.769870 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:55.770748 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m18:17:55.907920 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.136 seconds
[0m18:17:55.914176 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:55.915319 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m18:17:56.018713 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.102 seconds
[0m18:17:56.023645 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:56.024644 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
[0m18:17:56.203955 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.178 seconds
[0m18:17:56.209496 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:56.210290 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp"
[0m18:17:56.301907 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.091 seconds
[0m18:17:56.308045 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:56.308983 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.rsi


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."RSI_14D" != source_data."RSI_14D"
        or
        (
            ((snapshotted_data."RSI_14D" is null) and not (source_data."RSI_14D" is null))
            or
            ((not snapshotted_data."RSI_14D" is null) and (source_data."RSI_14D" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m18:17:56.573817 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.264 seconds
[0m18:17:56.577050 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:56.578587 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:17:56.653304 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.073 seconds
[0m18:17:56.655402 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:56.695177 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:56.697053 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
BEGIN
[0m18:17:56.803783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m18:17:56.805164 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:56.806571 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."RSI_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "AVG_GAIN_14D", "AVG_LOSS_14D", "RSI_14D", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "AVG_GAIN_14D", "AVG_LOSS_14D", "RSI_14D", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:17:57.326281 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.517 seconds
[0m18:17:57.328394 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.rsi_snapshot"
[0m18:17:57.330201 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.rsi_snapshot"} */
COMMIT
[0m18:17:57.636002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m18:17:57.641640 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.rsi_snapshot: Close
[0m18:17:57.767465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ee0c55b-b823-412f-a89f-7076157aa15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2dac2120>]}
[0m18:17:57.770137 [info ] [Thread-1 (]: 2 of 3 OK snapshotted snapshots.rsi_snapshot ................................... [[32mSUCCESS 0[0m in 3.97s]
[0m18:17:57.771865 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.rsi_snapshot
[0m18:17:57.773326 [debug] [Thread-1 (]: Began running node snapshot.dbt_stock_project.stock_data_snapshot
[0m18:17:57.774639 [info ] [Thread-1 (]: 3 of 3 START snapshot snapshots.stock_data_snapshot ............................ [RUN]
[0m18:17:57.775901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_stock_project.rsi_snapshot, now snapshot.dbt_stock_project.stock_data_snapshot)
[0m18:17:57.776979 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_stock_project.stock_data_snapshot
[0m18:17:57.781448 [debug] [Thread-1 (]: Began executing node snapshot.dbt_stock_project.stock_data_snapshot
[0m18:17:57.786522 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:17:57.787765 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        select close, volume, daily_change from (
                



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators

            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m18:17:57.788958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:58.365881 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.577 seconds
[0m18:17:58.370830 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:17:58.372354 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m18:17:58.505700 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.132 seconds
[0m18:17:58.511462 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:17:58.512726 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m18:17:58.618537 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m18:17:58.624733 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:17:58.626081 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
create or replace temporary table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m18:17:59.477388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m18:17:59.481876 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:17:59.482960 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m18:17:59.584974 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.101 seconds
[0m18:17:59.590257 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:17:59.591359 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m18:17:59.692870 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.101 seconds
[0m18:17:59.697761 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:17:59.699075 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m18:17:59.791255 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.091 seconds
[0m18:17:59.798037 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:17:59.799100 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
[0m18:17:59.907486 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.107 seconds
[0m18:17:59.912390 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:17:59.913426 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
describe table "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp"
[0m18:18:00.006465 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.092 seconds
[0m18:18:00.022007 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:18:00.023472 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT *
FROM USER_DB_BLUEJAY.analytics.stock_indicators


    ),

    snapshotted_data as (

        select *, 
    
        stock_id as dbt_unique_key
    

        from "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(stock_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        stock_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."DAILY_CHANGE" != source_data."DAILY_CHANGE"
        or
        (
            ((snapshotted_data."DAILY_CHANGE" is null) and not (source_data."DAILY_CHANGE" is null))
            or
            ((not snapshotted_data."DAILY_CHANGE" is null) and (source_data."DAILY_CHANGE" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m18:18:00.259723 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.234 seconds
[0m18:18:00.263171 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:18:00.264623 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:18:00.347300 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.081 seconds
[0m18:18:00.348575 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:18:00.368988 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:18:00.369944 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
BEGIN
[0m18:18:00.484108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m18:18:00.485379 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:18:00.486487 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
merge into "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BLUEJAY"."SNAPSHOTS"."STOCK_DATA_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "TRADE_DATE", "CLOSE", "VOLUME", "DAILY_CHANGE", "MOVING_AVG_7", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "TRADE_DATE", "CLOSE", "VOLUME", "DAILY_CHANGE", "MOVING_AVG_7", "STOCK_ID", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:18:00.979757 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.492 seconds
[0m18:18:00.981835 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_stock_project.stock_data_snapshot"
[0m18:18:00.983618 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_stock_project", "target_name": "dev", "node_id": "snapshot.dbt_stock_project.stock_data_snapshot"} */
COMMIT
[0m18:18:01.256162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m18:18:01.259397 [debug] [Thread-1 (]: On snapshot.dbt_stock_project.stock_data_snapshot: Close
[0m18:18:01.376153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ee0c55b-b823-412f-a89f-7076157aa15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2db8c4a0>]}
[0m18:18:01.378075 [info ] [Thread-1 (]: 3 of 3 OK snapshotted snapshots.stock_data_snapshot ............................ [[32mSUCCESS 0[0m in 3.60s]
[0m18:18:01.379741 [debug] [Thread-1 (]: Finished running node snapshot.dbt_stock_project.stock_data_snapshot
[0m18:18:01.382895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:01.384059 [debug] [MainThread]: Connection 'snapshot.dbt_stock_project.stock_data_snapshot' was properly closed.
[0m18:18:01.385120 [info ] [MainThread]: 
[0m18:18:01.386094 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 13.12 seconds (13.12s).
[0m18:18:01.387538 [debug] [MainThread]: Command end result
[0m18:18:01.512925 [info ] [MainThread]: 
[0m18:18:01.514351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:01.515451 [info ] [MainThread]: 
[0m18:18:01.516535 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:18:01.518672 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.26828, "process_user_time": 4.15175, "process_kernel_time": 1.976073, "process_mem_max_rss": "229892", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m18:18:01.519997 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:18:01.519853 after 15.27 seconds
[0m18:18:01.520988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d64f7c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d654bb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d649ba1e0>]}
[0m18:18:01.522035 [debug] [MainThread]: Flushing usage events
